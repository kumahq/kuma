name: "CodeQL"

on:
  push:
    branches: ["master", "release-*"]
  pull_request:
    branches: ["master", "release-*"]
  schedule:
    - cron: '35 3 * * *' # Runs daily at 3:35 AM UTC
  workflow_dispatch: {}

permissions: read-all

concurrency:
  # Run only for most recent commit in PRs but for all commits on master
  # Ref: https://docs.github.com/en/actions/using-jobs/using-concurrency
  group: ${{ github.workflow }}-${{ github.head_ref || github.sha }}
  cancel-in-progress: true

jobs:
  get-checks-for-commits:
    runs-on: ubuntu-24.04

    steps:
      - id: checkout
        uses: actions/checkout@d632683dd7b4114ad314bca15554477dd762a938 # v4.2.0
      - run: |
          git rev-parse HEAD
          git log -1 --format=%H
          echo "${{ steps.checkout.outputs.commit }}"

#      - name: Get last 5 commits and their checks
#        env:
#          GH_TOKEN: ${{ secrets.GITHUB_TOKEN }}
#        run: |
#          # Get the last 5 commits
#          commits=$(gh api repos/${{ github.repository }}/commits --jq '.[0:5] | .[].sha')
#          echo "Fetching checks for the following commits:"
#          echo "$commits"
#
#          # Fetch checks for each commit
#          for sha in $commits; do
#            echo "Commit: $sha"
#            gh api repos/${{ github.repository }}/commits/$sha/statuses
#            echo ""
#          done

#  analyze:
#    runs-on: ubuntu-24.04
#    timeout-minutes: 30
#    permissions:
#      contents: read
#      actions: read
#      security-events: write
#    strategy:
#      fail-fast: false
#      matrix:
#        language: ['go']
#    steps:
#      - uses: actions/checkout@d632683dd7b4114ad314bca15554477dd762a938 # v4.2.0
#      - uses: actions/setup-go@3041bf56c941b39c61721a86cd11f3bb1338122a # v5.2.0
#        with:
#          go-version-file: go.mod
#      - name: Initialize CodeQL
#        uses: github/codeql-action/init@df409f7d9260372bd5f19e5b04e83cb3c43714ae # v3.27.9
#        with:
#          config-file: ./.github/codeql/codeql-config.yml
#          languages: ${{ matrix.language }}
#      - name: Autobuild
#        uses: github/codeql-action/autobuild@df409f7d9260372bd5f19e5b04e83cb3c43714ae # v3.27.9
#      - name: Perform CodeQL Analysis
#        uses: github/codeql-action/analyze@df409f7d9260372bd5f19e5b04e83cb3c43714ae # v3.27.9
#        with:
#          category: "/language:${{matrix.language}}"