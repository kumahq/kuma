#/meshes/default/dataplanes/dp-1/_layout 200
type: Mesh
name: default
meshServices:
  mode: Exclusive
---
type: Dataplane
name: dp-1
mesh: default
labels:
  kuma.io/zone: test-zone
networking:
  address: 127.0.0.1
  inbound:
    - port: 8080
      name: main-port
      tags:
        kuma.io/service: foo
        kuma.io/protocol: http
    - port: 8081
      name: secondary-port
      tags:
        kuma.io/service: foo
        kuma.io/protocol: tcp
  transparentProxying:
    redirectPortInbound: 15006
    redirectPortOutbound: 15001
    reachableBackends:
      refs:
        - kind: MeshService
          name: test-server-1
          port: 80
        - kind: MeshService
          name: test-server-2
---
type: MeshService
name: test-server-1
mesh: default
labels:
  kuma.io/display-name: test-server-1
  kuma.io/zone: test-zone
spec:
  selector:
    dataplaneTags:
      kuma.io/service: test-server
  ports:
    - port: 80
      targetPort: 80
      appProtocol: http
      name: main-port
    - port: 8080
      targetPort: 8080
      appProtocol: tcp
      name: secondary-port
---
type: MeshService
name: test-server-2
mesh: default
labels:
  kuma.io/display-name: test-server-2
  kuma.io/zone: test-zone
spec:
  selector:
    dataplaneTags:
      kuma.io/service: test-server
  ports:
    - port: 80
      targetPort: 80
      appProtocol: http
      name: main-port
    - port: 8080
      targetPort: 8080
      appProtocol: http
      name: secondary-port
---
type: MeshService
name: test-server-3
mesh: default
labels:
  kuma.io/display-name: test-server-3
  kuma.io/zone: test-zone
spec:
  selector:
    dataplaneTags:
      kuma.io/service: test-server
  ports:
    - port: 80
      targetPort: 80
      appProtocol: http
      name: main-port