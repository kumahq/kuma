---
apiVersion: discovery.k8s.io/v1
kind: EndpointSlice
metadata:
  name: example-ip4
  namespace: demo
  labels:
    kubernetes.io/service-name: example
addressType: IPv4
endpoints:
  - addresses:
      - 192.168.0.5
    targetRef:
      kind: Pod
      name: example-1
      namespace: demo
      uid: example-1-1
  - addresses:
      - 192.168.0.6
    targetRef:
      kind: Pod
      name: example-2
      namespace: demo
      uid: example-2-1
---
apiVersion: v1
kind: Service
metadata:
  namespace: demo
  name: example
  annotations:
    kuma.io/gateway: builtin
spec:
  clusterIP: None
  ports:
    - appProtocol: http
      port: 80
      targetPort: 8080
      protocol: TCP
    - port: 443
      targetPort: 8443
      protocol: TCP
---
apiVersion: v1
kind: Pod
metadata:
  namespace: demo
  name: example-1
  uid: example-1-1
  labels:
    statefulset.kubernetes.io/pod-name: example-1
spec:
  containers: []
status:
  podIP: 192.168.0.5
---
apiVersion: v1
kind: Pod
metadata:
  namespace: demo
  name: example-2
  uid: example-2-1
  labels:
    statefulset.kubernetes.io/pod-name: example-2
spec:
  containers: []
status:
  podIP: 192.168.0.6
---
apiVersion: kuma.io/v1alpha1
kind: MeshService
metadata:
  name: example-1-87ff74c98
  namespace: demo
  labels:
    k8s.kuma.io/is-headless-service: "true"
    k8s.kuma.io/service-name: example
    kuma.io/mesh: default
  ownerReferences:
    - apiVersion: v1
      kind: Pod
      name: example-1
      uid: example-1-1
spec:
  ports:
    - appProtocol: http
      name: "80"
      port: 80
      targetPort: 8080
    - appProtocol: tcp
      name: "443"
      port: 443
      targetPort: 8443
  selector:
    dataplaneRef:
      name: example-1.demo
---
apiVersion: kuma.io/v1alpha1
kind: MeshService
metadata:
  name: example-2-87ff74c98
  namespace: demo
  labels:
    k8s.kuma.io/is-headless-service: "true"
    k8s.kuma.io/service-name: example
    kuma.io/mesh: default
  ownerReferences:
    - apiVersion: v1
      kind: Pod
      name: example-2
      uid: example-2-1
spec:
  ports:
    - appProtocol: http
      name: "80"
      port: 80
      targetPort: 8080
    - appProtocol: tcp
      name: "443"
      port: 443
      targetPort: 8443
  selector:
    dataplaneRef:
      name: example-2.demo
---
apiVersion: v1
kind: Namespace
metadata:
  name: demo
  labels:
    kuma.io/sidecar-injection: enabled
---
apiVersion: kuma.io/v1alpha1
kind: Mesh
metadata:
  name: default
spec:
  meshServices:
    mode: Disabled
