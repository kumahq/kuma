connectTimeout: 5s
edsClusterConfig:
  edsConfig:
    ads: {}
    resourceApiVersion: V3
name: testCluster
transportSocketMatches:
- match:
    cluster: "1"
  name: backend{cluster=1,mesh=default}
  transportSocket:
    name: envoy.transport_sockets.tls
    typedConfig:
      '@type': type.googleapis.com/envoy.extensions.transport_sockets.tls.v3.UpstreamTlsContext
      commonTlsContext:
        alpnProtocols:
        - kuma
        combinedValidationContext:
          defaultValidationContext:
            matchTypedSubjectAltNames:
            - matcher:
                exact: spiffe://default/backend
              sanType: URI
          validationContextSdsSecretConfig:
            name: mesh_ca:secret:default
            sdsConfig:
              ads: {}
              resourceApiVersion: V3
        tlsCertificateSdsSecretConfigs:
        - name: identity_cert:secret:default
          sdsConfig:
            ads: {}
            resourceApiVersion: V3
      sni: backend{cluster=1,mesh=default}
- match:
    cluster: "2"
  name: backend{cluster=2,mesh=default}
  transportSocket:
    name: envoy.transport_sockets.tls
    typedConfig:
      '@type': type.googleapis.com/envoy.extensions.transport_sockets.tls.v3.UpstreamTlsContext
      commonTlsContext:
        alpnProtocols:
        - kuma
        combinedValidationContext:
          defaultValidationContext:
            matchTypedSubjectAltNames:
            - matcher:
                exact: spiffe://default/backend
              sanType: URI
          validationContextSdsSecretConfig:
            name: mesh_ca:secret:default
            sdsConfig:
              ads: {}
              resourceApiVersion: V3
        tlsCertificateSdsSecretConfigs:
        - name: identity_cert:secret:default
          sdsConfig:
            ads: {}
            resourceApiVersion: V3
      sni: backend{cluster=2,mesh=default}
type: EDS
