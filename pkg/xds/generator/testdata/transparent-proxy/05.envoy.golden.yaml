resources:
- name: self_transparentproxy_passthrough_inbound_ipv4
  resource:
    '@type': type.googleapis.com/envoy.config.cluster.v3.Cluster
    connectTimeout: 5s
    lbPolicy: CLUSTER_PROVIDED
    name: self_transparentproxy_passthrough_inbound_ipv4
    type: ORIGINAL_DST
    upstreamBindConfig:
      sourceAddress:
        address: 127.0.0.6
        portValue: 0
- name: self_transparentproxy_passthrough_inbound_ipv6
  resource:
    '@type': type.googleapis.com/envoy.config.cluster.v3.Cluster
    connectTimeout: 5s
    lbPolicy: CLUSTER_PROVIDED
    name: self_transparentproxy_passthrough_inbound_ipv6
    type: ORIGINAL_DST
    upstreamBindConfig:
      sourceAddress:
        address: ::6
        portValue: 0
- name: self_transparentproxy_passthrough_outbound_ipv4
  resource:
    '@type': type.googleapis.com/envoy.config.cluster.v3.Cluster
    connectTimeout: 5s
    lbPolicy: CLUSTER_PROVIDED
    name: self_transparentproxy_passthrough_outbound_ipv4
    type: ORIGINAL_DST
- name: self_transparentproxy_passthrough_outbound_ipv6
  resource:
    '@type': type.googleapis.com/envoy.config.cluster.v3.Cluster
    connectTimeout: 5s
    lbPolicy: CLUSTER_PROVIDED
    name: self_transparentproxy_passthrough_outbound_ipv6
    type: ORIGINAL_DST
- name: self_transparentproxy_passthrough_inbound_ipv4
  resource:
    '@type': type.googleapis.com/envoy.config.listener.v3.Listener
    address:
      socketAddress:
        address: 0.0.0.0
        portValue: 15006
    enableReusePort: false
    filterChains:
    - filters:
      - name: envoy.filters.network.tcp_proxy
        typedConfig:
          '@type': type.googleapis.com/envoy.extensions.filters.network.tcp_proxy.v3.TcpProxy
          cluster: self_transparentproxy_passthrough_inbound_ipv4
          statPrefix: self_transparentproxy_passthrough_inbound_ipv4
    name: self_transparentproxy_passthrough_inbound_ipv4
    trafficDirection: INBOUND
    useOriginalDst: true
- name: self_transparentproxy_passthrough_inbound_ipv6
  resource:
    '@type': type.googleapis.com/envoy.config.listener.v3.Listener
    address:
      socketAddress:
        address: '::'
        portValue: 15006
    enableReusePort: false
    filterChains:
    - filters:
      - name: envoy.filters.network.tcp_proxy
        typedConfig:
          '@type': type.googleapis.com/envoy.extensions.filters.network.tcp_proxy.v3.TcpProxy
          cluster: self_transparentproxy_passthrough_inbound_ipv6
          statPrefix: self_transparentproxy_passthrough_inbound_ipv6
    name: self_transparentproxy_passthrough_inbound_ipv6
    trafficDirection: INBOUND
    useOriginalDst: true
- name: self_transparentproxy_passthrough_outbound_ipv4
  resource:
    '@type': type.googleapis.com/envoy.config.listener.v3.Listener
    address:
      socketAddress:
        address: 0.0.0.0
        portValue: 15001
    filterChains:
    - filters:
      - name: envoy.filters.network.tcp_proxy
        typedConfig:
          '@type': type.googleapis.com/envoy.extensions.filters.network.tcp_proxy.v3.TcpProxy
          cluster: self_transparentproxy_passthrough_outbound_ipv4
          statPrefix: self_transparentproxy_passthrough_outbound_ipv4
    name: self_transparentproxy_passthrough_outbound_ipv4
    trafficDirection: OUTBOUND
    useOriginalDst: true
- name: self_transparentproxy_passthrough_outbound_ipv6
  resource:
    '@type': type.googleapis.com/envoy.config.listener.v3.Listener
    address:
      socketAddress:
        address: '::'
        portValue: 15001
    filterChains:
    - filters:
      - name: envoy.filters.network.tcp_proxy
        typedConfig:
          '@type': type.googleapis.com/envoy.extensions.filters.network.tcp_proxy.v3.TcpProxy
          cluster: self_transparentproxy_passthrough_outbound_ipv6
          statPrefix: self_transparentproxy_passthrough_outbound_ipv6
    name: self_transparentproxy_passthrough_outbound_ipv6
    trafficDirection: OUTBOUND
    useOriginalDst: true
