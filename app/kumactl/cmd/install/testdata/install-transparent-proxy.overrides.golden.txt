<<<<<<< HEAD
\* nat
-N (.*)_INBOUND
-N (.*)_OUTBOUND
-N (.*)_INBOUND_REDIRECT
-N (.*)_OUTBOUND_REDIRECT
-A PREROUTING -p tcp -j (.*)_INBOUND
-A OUTPUT -p tcp -j (.*)_OUTBOUND
-A (.*)_INBOUND -p tcp --dport 1000 -j RETURN
-A (.*)_INBOUND -p tcp --dport 1001 -j RETURN
-A (.*)_INBOUND -p tcp -j (.*)_INBOUND_REDIRECT
-A (.*)_OUTBOUND -p tcp --dport 2000 -j RETURN
-A (.*)_OUTBOUND -p tcp --dport 2001 -j RETURN
-A (.*)_OUTBOUND -s (.*) -o (.*) -j RETURN
-A (.*)_OUTBOUND -p tcp -o (.*) ! -d (.*) -m owner --uid-owner 0 -j (.*)_INBOUND_REDIRECT
-A (.*)_OUTBOUND -p tcp -o (.*) -m owner ! --uid-owner 0 -j RETURN
-A (.*)_OUTBOUND -m owner --uid-owner 0 -j RETURN
-A (.*)_OUTBOUND -d (.*) -j RETURN
-A (.*)_OUTBOUND -j (.*)_OUTBOUND_REDIRECT
-A (.*)_INBOUND_REDIRECT -p tcp -j REDIRECT --to-ports 12346
-A (.*)_OUTBOUND_REDIRECT -p tcp -j REDIRECT --to-ports 12345
=======
### IPv4 ###

* nat
-N KUMA_MESH_INBOUND
-N KUMA_MESH_OUTBOUND
-N KUMA_MESH_INBOUND_REDIRECT
-N KUMA_MESH_OUTBOUND_REDIRECT
-A PREROUTING -p tcp -j KUMA_MESH_INBOUND
-A OUTPUT -p tcp -j KUMA_MESH_OUTBOUND
-A KUMA_MESH_INBOUND -p tcp --dport 1000 -j RETURN
-A KUMA_MESH_INBOUND -p tcp --dport 1001 -j RETURN
-A KUMA_MESH_INBOUND -p tcp -j KUMA_MESH_INBOUND_REDIRECT
-A KUMA_MESH_OUTBOUND -p tcp --dport 2000 -j RETURN
-A KUMA_MESH_OUTBOUND -p tcp --dport 2001 -j RETURN
-A KUMA_MESH_OUTBOUND -s subnetPlaceholder/mask -o ifPlaceholder -j RETURN
-A KUMA_MESH_OUTBOUND -p tcp -o ifPlaceholder ! -d subnetPlaceholder/mask -m owner --uid-owner 0 -j KUMA_MESH_INBOUND_REDIRECT
-A KUMA_MESH_OUTBOUND -p tcp -o ifPlaceholder -m owner ! --uid-owner 0 -j RETURN
-A KUMA_MESH_OUTBOUND -m owner --uid-owner 0 -j RETURN
-A KUMA_MESH_OUTBOUND -d subnetPlaceholder/mask -j RETURN
-A KUMA_MESH_OUTBOUND -j KUMA_MESH_OUTBOUND_REDIRECT
-A KUMA_MESH_INBOUND_REDIRECT -p tcp -j REDIRECT --to-ports 12346
-A KUMA_MESH_OUTBOUND_REDIRECT -p tcp -j REDIRECT --to-ports 12345
COMMIT
>>>>>>> f732b34e9 (refactor(transparent-proxy): move executables to config (#10619))
