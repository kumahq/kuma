(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["dataplanes~dataplanes-gateway~dataplanes-ingress~dataplanes-standard"],{6663:function(t,e,a){"use strict";var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"entity-url-control"},[t.shouldDisplay?a("KClipboardProvider",{scopedSlots:t._u([{key:"default",fn:function(e){var n=e.copyToClipboard;return[a("KPop",{attrs:{placement:"bottom"}},[a("KButton",{attrs:{appearance:"secondary",size:"small"},on:{click:function(){n(t.url)}}},[a("KIcon",{attrs:{slot:"icon",icon:"externalLink"},slot:"icon"}),t._v(" "+t._s(t.copyButtonText)+" ")],1),a("div",{attrs:{slot:"content"},slot:"content"},[a("p",[t._v(t._s(t.confirmationText))])])],1)]}}],null,!1,1603401634)}):t._e()],1)},s=[],i=a("a026"),r=i["default"].extend({name:"EntityURLControl",props:{url:{type:String,required:!0},copyButtonText:{type:String,default:"Copy URL"},confirmationText:{type:String,default:"URL copied to clipboard!"}},computed:{shouldDisplay:function(){var t=this.$route.params.mesh||null;return!(!t||"all"===t)}}}),o=r,l=a("2877"),u=Object(l["a"])(o,n,s,!1,null,null,null);e["a"]=u.exports},"85e6":function(t,e,a){"use strict";var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("FrameSkeleton",[a("DataOverview",{attrs:{"page-size":t.pageSize,"has-error":t.hasError,"is-loading":t.isLoading,"empty-state":t.getEmptyState(),"display-data-table":!0,"table-data":t.buildTableData(),"table-data-is-empty":t.tableDataIsEmpty,"show-warnings":t.tableData.data.some((function(t){return t.withWarnings})),"table-data-function-text":"View","table-data-row":"name"},on:{tableAction:t.tableAction,reloadData:t.loadData}},[a("template",{slot:"additionalControls"},[a("KButton",{staticClass:"add-dp-button",attrs:{appearance:"primary",size:"small",to:t.dataplaneWizardRoute}},[a("span",{staticClass:"custom-control-icon"},[t._v(" + ")]),t._v(" Create data plane proxy ")]),this.$route.query.ns?a("KButton",{staticClass:"back-button",attrs:{appearance:"primary",size:"small",to:t.nsBackButtonRoute}},[a("span",{staticClass:"custom-control-icon"},[t._v(" ← ")]),t._v(" View All ")]):t._e()],1),a("template",{slot:"pagination"},[a("Pagination",{attrs:{"has-previous":t.previous.length>0,"has-next":t.hasNext},on:{next:t.goToNextPage,previous:t.goToPreviousPage}})],1)],2),!1===t.isEmpty?a("Tabs",{attrs:{"has-error":t.hasError,"is-loading":t.isLoading,tabs:t.filterTabs(),"initial-tab-override":"overview"}},[a("template",{slot:"tabHeader"},[a("div",[a("h3",[t._v(t._s(t.tabGroupTitle))])]),a("div",[a("EntityURLControl",{attrs:{url:t.shareUrl}})],1)]),a("template",{slot:"overview"},[a("LabelList",{attrs:{"has-error":t.entityHasError,"is-loading":t.entityIsLoading,"is-empty":t.entityIsEmpty}},[a("div",[a("ul",t._l(t.entity.basicData,(function(e,n){return a("li",{key:n},[a("div","status"===n?[a("h4",[t._v(t._s(n))]),a("div",{staticClass:"entity-status",class:{"is-offline":"offline"===e.status.toString().toLowerCase()||!1===e.status,"is-degraded":"partially degraded"===e.status.toString().toLowerCase()||!1===e.status}},[a("span",{staticClass:"entity-status__label"},[t._v(t._s(e.status))])]),a("div",{staticClass:"reason-list"},[a("ul",t._l(e.reason,(function(e){return a("li",{key:e},[a("span",{staticClass:"entity-status__dot"}),t._v(" "+t._s(e)+" ")])})),0)])]:[a("h4",[t._v(t._s(n))]),t._v(" "+t._s(e)+" ")])])})),0)]),a("div",[a("h4",[t._v("Tags")]),a("p",t._l(t.entity.tags,(function(e,n){return a("span",{key:n,staticClass:"tag-cols"},[a("span",[t._v(" "+t._s(e.label)+": ")]),a("span",[t._v(" "+t._s(e.value)+" ")])])})),0)])])],1),t.showMtls?a("template",{slot:"mtls"},[a("LabelList",{attrs:{"has-error":t.entityHasError,"is-loading":t.entityIsLoading,"is-empty":t.entityIsEmpty}},[t.entity.mtls?a("ul",t._l(t.entity.mtls,(function(e,n){return a("li",{key:n},[a("h4",[t._v(t._s(e.label))]),a("p",[t._v(" "+t._s(e.value)+" ")])])})),0):a("KAlert",{attrs:{appearance:"danger"}},[a("template",{slot:"alertMessage"},[t._v(" This data plane proxy does not yet have mTLS configured — "),a("a",{staticClass:"external-link",attrs:{href:"https://kuma.io/docs/"+t.version+"/documentation/security/#certificates",target:"_blank"}},[t._v(" Learn About Certificates in "+t._s(t.$productName)+" ")])])],2)],1)],1):t._e(),a("template",{slot:"yaml"},[a("YamlView",{attrs:{title:t.entityOverviewTitle,"has-error":t.entityHasError,"is-loading":t.entityIsLoading,"is-empty":t.entityIsEmpty,content:t.rawEntity}})],1),a("template",{slot:"warnings"},[a("Warnings",{attrs:{warnings:t.warnings}})],1)],2):t._e()],1)},s=[],i=(a("99af"),a("4de4"),a("7db0"),a("d81d"),a("13d5"),a("b0c0"),a("d3b7"),a("3ca3"),a("ddb0"),a("96cf"),a("1da1")),r=a("5530"),o=a("2f62"),l=a("bc1e"),u=a("dbf3"),c=a("6663"),p=a("b912"),d=a("1d10"),m=a("1799"),b=a("2778"),y=a("251b"),v=a("ff9d"),h=a("0ada"),g=a("63b5"),f="kuma.io/zone",w={name:"Dataplanes",components:{Warnings:g["a"],EntityURLControl:c["a"],FrameSkeleton:d["a"],Pagination:m["a"],DataOverview:b["a"],Tabs:y["a"],YamlView:v["a"],LabelList:h["a"]},mixins:[p["a"]],props:{nsBackButtonRoute:{type:Object,default:function(){return{name:"dataplanes"}}},emptyStateMsg:{type:String,default:"There are no data plane proxies present."},dataplaneApiParams:{type:Object,default:function(){return{}}},getDataplaneType:{type:Function,default:u["l"]},tableHeaders:{type:Array,default:function(){return[{key:"actions",hideLabel:!0},{label:"Status",key:"status"},{label:"Name",key:"name"},{label:"Mesh",key:"mesh"},{label:"Type",key:"type"},{label:"Tags",key:"tags"},{label:"Last Connected",key:"lastConnected"},{label:"Last Updated",key:"lastUpdated"},{label:"Total Updates",key:"totalUpdates"},{label:"Kuma DP version",key:"dpVersion"},{label:"Envoy version",key:"envoyVersion"},{key:"warnings",hideLabel:!0}]}},tabs:{type:Array,default:function(){return[{hash:"#overview",title:"Overview"},{hash:"#mtls",title:"Certificate Insights"},{hash:"#yaml",title:"YAML"},{hash:"#warnings",title:"Warnings"}]}},buildEntity:{type:Function,default:function(t,e,a){var n=a.mTLS?Object(u["n"])(a.mTLS):null;return{basicData:t,tags:e,mtls:n}}},addDataFields:{type:Function,default:function(){return{}}},showMtls:{type:Boolean,default:!0}},data:function(){return{isLoading:!0,isEmpty:!1,hasError:!1,entityIsLoading:!0,entityIsEmpty:!1,entityHasError:!1,warnings:[],tableDataIsEmpty:!1,tableData:{headers:[],data:[]},entity:[],rawEntity:null,firstEntity:null,pageSize:this.$pageSize,pageOffset:null,next:null,hasNext:!1,previous:[],tabGroupTitle:null,entityNamespace:null,entityOverviewTitle:null,shownTLSTab:!1}},computed:Object(r["a"])(Object(r["a"])({},Object(o["c"])({environment:"getEnvironment",queryNamespace:"getItemQueryNamespace",supportedVersions:"getSupportedVersions",supportedVersionsLoading:"getSupportedVersionsFetching",multicluster:"getMulticlusterStatus"})),{},{dataplaneWizardRoute:function(){return"universal"===this.environment?{name:"universal-dataplane"}:{name:"kubernetes-dataplane"}},version:function(){var t=this.$store.getters.getVersion;return null!==t?t:"latest"},shareUrl:function(){var t=this,e="".concat(window.location.origin,"/#"),a=this.entity,n=function(){return a.basicData?t.$route.query.ns?t.$route.fullPath:"".concat(e).concat(t.$route.fullPath,"?ns=").concat(a.basicData.name):null};return n()}}),watch:{$route:function(){this.loadData()}},beforeMount:function(){this.fetchSupportedVersions(),this.loadData()},methods:Object(r["a"])(Object(r["a"])({},Object(o["b"])(["fetchSupportedVersions"])),{},{init:function(){this.loadData()},getEmptyState:function(){return{title:"No Data",message:this.emptyStateMsg}},filterTabs:function(){return this.warnings.length?this.tabs:this.tabs.filter((function(t){return"#warnings"!==t.hash}))},buildTableData:function(){return Object(r["a"])(Object(r["a"])({},this.tableData),{},{headers:this.tableHeaders})},checkVersionsCompatibility:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return Object(u["h"])(this.supportedVersions,t,e)},goToPreviousPage:function(){this.pageOffset=this.previous.pop(),this.next=null,this.loadData()},goToNextPage:function(){this.previous.push(this.pageOffset),this.pageOffset=this.next,this.next=null,this.loadData()},tableAction:function(t){var e=t;this.$store.dispatch("updateSelectedTab",this.tabs[0].hash),this.$store.dispatch("updateSelectedTableRow",e.name),this.getEntity(e)},loadData:function(){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function e(){var a,n,s,o,c,p,d,m,b,y;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.isLoading=!0,a=t.$route.params.mesh||null,n=t.$route.query.ns||null,s=Object(r["a"])({size:t.pageSize,offset:t.pageOffset},t.dataplaneApiParams),o=function(){return"all"===a?t.$api.getAllDataplaneOverviews(s):n&&n.length&&"all"!==a?t.$api.getDataplaneOverviewFromMesh(a,n):t.$api.getAllDataplaneOverviewsFromMesh(a,s)},c=function(){var e=Object(i["a"])(regeneratorRuntime.mark((function e(a,n,s){var i,o,c,p,d,m,b,y,v,h,g,w,k,x,T,E,O,_,D,j,L,C,S,V,U,I,$,R,P,N;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t.$api.getDataplaneOverviewFromMesh(a,n);case 3:i=e.sent,o=i.dataplane,c=void 0===o?{}:o,p=i.dataplaneInsight,d=void 0===p?{}:p,m=i.name,b=void 0===m?"":m,y=i.mesh,v=void 0===y?"":y,h=d.subscriptions,g=void 0===h?[]:h,w=Object(u["i"])(c),k=Object(u["m"])(c,d),x=k.status,T={totalUpdates:0,totalRejectedUpdates:0,dpVersion:"-",envoyVersion:"-",selectedTime:NaN,selectedUpdateTime:NaN},E=g.reduce((function(t,e){var a=e.status,n=void 0===a?{}:a,s=e.connectTime,i=e.version,r=void 0===i?{}:i,o=n.total,l=void 0===o?{}:o,u=n.lastUpdateTime,c=l.responsesSent,p=void 0===c?"0":c,d=l.responsesRejected,m=void 0===d?"0":d,b=r.kumaDp,y=void 0===b?{}:b,v=r.envoy,h=void 0===v?{}:v,g=y.version,f=h.version,w=t.selectedTime,k=t.selectedUpdateTime,x=Date.parse(s),T=Date.parse(u);return x&&(!w||x>w)&&(w=x),T&&(!k||T>k)&&(k=T),{totalUpdates:t.totalUpdates+parseInt(p),totalRejectedUpdates:t.totalRejectedUpdates+parseInt(m),dpVersion:g||t.dpVersion,envoyVersion:f||t.envoyVersion,selectedTime:w,selectedUpdateTime:k}}),T),O=E.totalUpdates,_=E.totalRejectedUpdates,D=E.dpVersion,j=E.envoyVersion,L=E.selectedTime,C=E.selectedUpdateTime,S=L?Object(l["g"])(new Date(L).toUTCString()):"never",V=C?Object(l["g"])(new Date(C).toUTCString()):"never",U=Object(r["a"])({name:b,mesh:v,tags:w,status:x,lastConnected:S,lastUpdated:V,totalUpdates:O,totalRejectedUpdates:_,dpVersion:D,envoyVersion:j,withWarnings:!1,unsupportedEnvoyVersion:!1,unsupportedKumaDPVersion:!1,kumaDpAndKumaCpMismatch:!1,type:t.getDataplaneType()},t.addDataFields(c)),I=t.checkVersionsCompatibility(D,j),$=I.kind,e.t0=$,e.next=e.t0===u["b"]?19:e.t0===u["c"]?22:25;break;case 19:return U.unsupportedEnvoyVersion=!0,U.withWarnings=!0,e.abrupt("break",25);case 22:return U.unsupportedKumaDPVersion=!0,U.withWarnings=!0,e.abrupt("break",25);case 25:if(!t.multicluster){e.next=39;break}if(R=w.find((function(t){return t.label===f})),!R){e.next=39;break}return e.prev=28,e.next=31,Object(u["g"])(t.$api,R.value,D);case 31:P=e.sent,N=P.compatible,N||(U.withWarnings=!0,U.kumaDpAndKumaCpMismatch=!0),e.next=39;break;case 36:e.prev=36,e.t1=e["catch"](28),console.error(e.t1);case 39:return s.push(U),t.sortEntities(s),e.abrupt("return",s);case 44:e.prev=44,e.t2=e["catch"](0),console.error(e.t2);case 47:case"end":return e.stop()}}),e,null,[[0,44],[28,36]])})));return function(t,a,n){return e.apply(this,arguments)}}(),e.prev=6,e.next=9,o();case 9:if(p=e.sent,d=function(){var e=p;return"total"in e?0!==e.total&&e.items&&e.items.length>0?t.sortEntities(e.items):null:e},!d()){e.next=33;break}return p.next?(t.next=Object(l["e"])(p.next),t.hasNext=!0):t.hasNext=!1,m=[],b=n?d():d()[0],t.firstEntity=b.name,e.next=18,t.getEntity(b);case 18:return e.next=20,t.$store.dispatch("updateSelectedTableRow",t.firstEntity);case 20:if(!(n&&n.length&&a&&a.length)){e.next=25;break}return e.next=23,c(a,n,m);case 23:e.next=28;break;case 25:return y=d().map((function(t){return c(t.mesh,t.name,m)})),e.next=28,Promise.all(y);case 28:t.tableData.data=m,t.tableDataIsEmpty=!1,t.isEmpty=!1,e.next=38;break;case 33:return t.tableData.data=[],t.tableDataIsEmpty=!0,t.isEmpty=!0,e.next=38,t.getEntity(null);case 38:e.next=45;break;case 40:e.prev=40,e.t0=e["catch"](6),t.hasError=!0,t.isEmpty=!0,console.error(e.t0);case 45:setTimeout((function(){t.isLoading=!1}),"500");case 46:case"end":return e.stop()}}),e,null,[[6,40]])})))()},getEntity:function(t){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function a(){var n,s,i,o,c,p,d,m,b,y,v,h,g,w,k,x,T,E,O,_,D,j,L,C;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(e.entityIsLoading=!0,e.entityIsEmpty=!1,n=e.$route.params.mesh,!t){a.next=55;break}return s="all"===n?t.mesh:n,a.prev=5,a.next=8,e.$api.getDataplaneOverviewFromMesh(s,t.name);case 8:if(i=a.sent,o=Object(u["j"])(i),!o){a.next=44;break}if(c=["type","name","mesh"],p=Object(u["k"])(i)||{},d=Object(u["m"])(o,p),m=Object(u["i"])(o),b=Object(r["a"])(Object(r["a"])({},Object(l["f"])(o,c)),{},{status:d}),e.entity=e.buildEntity(b,m,p),e.entityNamespace=b.name,e.tabGroupTitle="Mesh: ".concat(b.name),e.entityOverviewTitle="Entity Overview for ".concat(b.name),e.warnings=[],y=p.subscriptions,v=void 0===y?[]:y,!v.length){a.next=41;break}if(h=v.pop(),g=h.version,w=void 0===g?{}:g,k=w.kumaDp,x=void 0===k?{}:k,T=w.envoy,E=void 0===T?{}:T,x&&E&&(O=e.checkVersionsCompatibility(x.version,E.version),_=O.kind,_!==u["a"]&&_!==u["d"]&&e.warnings.push(O)),!e.multicluster){a.next=41;break}if(D=m.find((function(t){return t.label===f})),!D){a.next=41;break}return a.prev=29,a.next=32,Object(u["g"])(e.$api,D.value,x.version);case 32:j=a.sent,L=j.compatible,C=j.payload,L||e.warnings.push({kind:u["f"],payload:C}),a.next=41;break;case 38:a.prev=38,a.t0=a["catch"](29),console.error(a.t0);case 41:e.rawEntity=Object(l["k"])(o),a.next=46;break;case 44:e.entity=null,e.entityIsEmpty=!0;case 46:a.next=52;break;case 48:a.prev=48,a.t1=a["catch"](5),e.entityHasError=!0,console.error(a.t1);case 52:setTimeout((function(){e.entityIsLoading=!1}),"500"),a.next=56;break;case 55:setTimeout((function(){e.entityIsEmpty=!0,e.entityIsLoading=!1}),"500");case 56:case"end":return a.stop()}}),a,null,[[5,48],[29,38]])})))()}})},k=w,x=(a("b207"),a("2877")),T=Object(x["a"])(k,n,s,!1,null,"553815f9",null);e["a"]=T.exports},b207:function(t,e,a){"use strict";a("ebb6")},ebb6:function(t,e,a){}}]);