(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["dataplanes-gateway"],{"0ad7":function(t,e,a){},"23d6":function(t,e,a){"use strict";var n=a("0ad7"),r=a.n(n);r.a},"254c":function(t,e,a){"use strict";var n=a("d435"),r=a.n(n);r.a},"3aab":function(t,e,a){},6663:function(t,e,a){"use strict";var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"entity-url-control"},[t.shouldDisplay?a("KClipboardProvider",{scopedSlots:t._u([{key:"default",fn:function(e){var n=e.copyToClipboard;return[a("KPop",{attrs:{placement:"bottom"}},[a("KButton",{attrs:{appearance:"secondary",size:"small"},on:{click:function(){n(t.url)}}},[a("KIcon",{attrs:{slot:"icon",icon:"externalLink"},slot:"icon"}),t._v("\n        "+t._s(t.copyButtonText)+"\n      ")],1),a("div",{attrs:{slot:"content"},slot:"content"},[a("p",[t._v(t._s(t.confirmationText))])])],1)]}}],null,!1,831954050)}):t._e()],1)},r=[],s={name:"EntityURLControl",props:{url:{type:String,required:!0},copyButtonText:{type:String,default:"Copy URL"},confirmationText:{type:String,default:"URL copied to clipboard!"}},computed:{shouldDisplay:function(){var t=this.$route.params.mesh||null;return!(!t||"all"===t)}}},i=s,o=a("2877"),l=Object(o["a"])(i,n,r,!1,null,null,null);e["a"]=l.exports},b3d5:function(t,e,a){"use strict";var n=a("3aab"),r=a.n(n);r.a},ba8f:function(t,e,a){"use strict";a.r(e);var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"gateway-dataplanes"},[a("FrameSkeleton",[a("DataOverview",{attrs:{"page-size":t.pageSize,"has-error":t.hasError,"is-loading":t.isLoading,"empty-state":t.empty_state,"display-data-table":!0,"table-data":t.tableData,"table-data-is-empty":t.tableDataIsEmpty,"table-data-function-text":"View","table-data-row":"name"},on:{tableAction:t.tableAction,reloadData:t.loadData}},[a("template",{slot:"additionalControls"},[a("KButton",{staticClass:"add-dp-button",attrs:{appearance:"primary",size:"small",to:t.dataplaneWizardRoute}},[a("span",{staticClass:"custom-control-icon"},[t._v("\n            +\n          ")]),t._v("\n          Create Dataplane\n        ")]),this.$route.query.ns?a("KButton",{staticClass:"back-button",attrs:{appearance:"primary",size:"small",to:{name:"gateway-dataplanes"}}},[a("span",{staticClass:"custom-control-icon"},[t._v("\n            ←\n          ")]),t._v("\n          View All\n        ")]):t._e()],1),a("template",{slot:"pagination"},[a("Pagination",{attrs:{"has-previous":t.previous.length>0,"has-next":t.hasNext},on:{next:t.goToNextPage,previous:t.goToPreviousPage}})],1)],2),!1===t.isEmpty?a("Tabs",{attrs:{"has-error":t.hasError,"is-loading":t.isLoading,tabs:t.tabs,"initial-tab-override":"overview"}},[a("template",{slot:"tabHeader"},[a("div",[a("h3",[t._v(t._s(t.tabGroupTitle))])]),a("div",[a("EntityURLControl",{attrs:{url:t.shareUrl}})],1)]),a("template",{slot:"overview"},[a("LabelList",{attrs:{"has-error":t.entityHasError,"is-loading":t.entityIsLoading,"is-empty":t.entityIsEmpty}},[a("div",[a("ul",t._l(t.entity.basicData,(function(e,n){return a("li",{key:n},[a("h4",[t._v(t._s(n))]),a("p",[t._v("\n                  "+t._s(e)+"\n                ")])])})),0)]),a("div",[a("h4",[t._v("Tags")]),a("p",t._l(t.entity.tags,(function(e,n){return a("span",{key:n,staticClass:"tag-cols"},[a("span",[t._v("\n                  "+t._s(e.label)+":\n                ")]),a("span",[t._v("\n                  "+t._s(e.value)+"\n                ")])])})),0)])])],1),a("template",{slot:"yaml"},[a("YamlView",{attrs:{title:t.entityOverviewTitle,"has-error":t.entityHasError,"is-loading":t.entityIsLoading,"is-empty":t.entityIsEmpty,content:t.rawEntity}})],1),a("template",{slot:"mtls"},[a("LabelList",{attrs:{"has-error":t.entityHasError,"is-loading":t.entityIsLoading,"is-empty":t.entityIsEmpty}},[t.entity.mtls?a("ul",t._l(t.entity.mtls,(function(e,n){return a("li",{key:n},[a("h4",[t._v(t._s(e.label))]),a("p",[t._v("\n                "+t._s(e.value)+"\n              ")])])})),0):a("KAlert",{attrs:{appearance:"danger"}},[a("template",{slot:"alertMessage"},[t._v("\n              This Dataplane does not yet have mTLS configured —\n              "),a("a",{staticClass:"external-link",attrs:{href:"https://kuma.io/docs/"+t.version+"/documentation/security/#certificates",target:"_blank"}},[t._v("\n                Learn About Certificates in Kuma\n              ")])])],2)],1)],1)],2):t._e()],1)],1)},r=[],s=(a("8e6e"),a("96cf"),a("3b8d")),i=(a("8615"),a("ac6a"),a("456d"),a("7f7f"),a("bd86")),o=a("2f62"),l=a("d7c2"),c=a("6663"),u=a("8218"),p=a("1d10"),d=a("1799"),v=a("2778"),f=a("251b"),y=a("ff9d"),h=a("0ada");function b(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),a.push.apply(a,n)}return a}function m(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?b(Object(a),!0).forEach((function(e){Object(i["a"])(t,e,a[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):b(Object(a)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))}))}return t}var g={name:"GatewayDataplanes",metaInfo:{title:"Gateway Dataplanes"},components:{EntityURLControl:c["a"],FrameSkeleton:p["a"],Pagination:d["a"],DataOverview:v["a"],Tabs:f["a"],YamlView:y["a"],LabelList:h["a"]},mixins:[u["a"]],data:function(){return{isLoading:!0,isEmpty:!1,hasError:!1,entityIsLoading:!0,entityIsEmpty:!1,entityHasError:!1,tableDataIsEmpty:!1,empty_state:{title:"No Data",message:"There are no Gateway Dataplanes present."},tableData:{headers:[{key:"actions",hideLabel:!0},{label:"Status",key:"status"},{label:"Name",key:"name"},{label:"Mesh",key:"mesh"},{label:"DP Type",key:"type"},{label:"Tags",key:"tags"},{label:"Last Connected",key:"lastConnected"},{label:"Last Updated",key:"lastUpdated"},{label:"Total Updates",key:"totalUpdates"}],data:[]},tabs:[{hash:"#overview",title:"Overview"},{hash:"#mtls",title:"Certificate Insights"},{hash:"#yaml",title:"YAML"}],entity:[],rawEntity:null,firstEntity:null,pageSize:this.$pageSize,pageOffset:null,next:null,hasNext:!1,previous:[],tabGroupTitle:null,entityNamespace:null,entityOverviewTitle:null,showmTLSTab:!1}},computed:m({},Object(o["b"])({environment:"getEnvironment",queryNamespace:"getItemQueryNamespace"}),{dataplaneWizardRoute:function(){return"universal"===this.environment?{name:"universal-dataplane"}:{name:"kubernetes-dataplane"}},version:function(){var t=this.$store.getters.getVersion;return null!==t?t:"latest"},shareUrl:function(){var t=this,e="".concat(window.location.origin,"#"),a=this.entity,n=function(){return a.basicData?t.$route.query.ns?t.$route.fullPath:"".concat(e).concat(t.$route.fullPath,"?ns=").concat(a.basicData.name):null};return n()}}),watch:{$route:function(t,e){this.loadData()}},beforeMount:function(){this.loadData()},methods:{init:function(){this.loadData()},goToPreviousPage:function(){this.pageOffset=this.previous.pop(),this.next=null,this.loadData()},goToNextPage:function(){this.previous.push(this.pageOffset),this.pageOffset=this.next,this.next=null,this.loadData()},tableAction:function(t){var e=t;this.$store.dispatch("updateSelectedTab",this.tabs[0].hash),this.$store.dispatch("updateSelectedTableRow",e.name),this.getEntity(e)},loadData:function(){var t=this;this.isLoading=!0;var e=this.$route.params.mesh||null,a=this.$route.query.ns||null,n={gateway:!0},r=function(){return"all"===e?t.$api.getAllDataplaneOverviews(n):a&&a.length&&"all"!==e?t.$api.getDataplaneOverviewFromMesh(e,a):t.$api.getAllDataplaneOverviewsFromMesh(e,n)},s=function(e,a,n){t.$api.getDataplaneOverviewFromMesh(e,a).then((function(e){var a,r,s="n/a",i=s,o=[],c="Offline",u=[],p=[],d=e.dataplane.networking.inbound||null,v=e.dataplane.networking.gateway||null,f=e.dataplane.networking.ingress||null,y=function(){return v?"Gateway":f?"Ingress":"Standard"};if(d||v||f){var h=[];if(d)for(var b=0;b<d.length;b++){var m=d[b].tags||null;if(m)for(var g=Object.keys(m),O=Object.values(m),w=0;w<g.length;w++)h.push({label:g[w],value:O[w]})}if(v){var E=v.tags||null;if(E)for(var k=0;k<Object.keys(E).length;k++)for(var D=Object.keys(E),_=Object.values(E),j=0;j<D.length;j++)h.push({label:D[j],value:_[j]})}if(f)for(var T=0;T<f.length;T++){var C=f[T].tags||null,L=f[T].service||null;if(L&&h.push({label:"service",value:L}),C)for(var x=Object.keys(C),P=Object.values(C),S=0;S<x.length;S++)h.push({label:x[S],value:P[S]})}i=h}else i="none";if(e.dataplaneInsight.subscriptions&&e.dataplaneInsight.subscriptions.length){e.dataplaneInsight.subscriptions.forEach((function(t){var e=t.status.total.responsesSent||0,a=t.connectTime||s,n=t.status.lastUpdateTime||s,r=t.disconnectTime||null;o.push(e),u.push(a),p.push(n),c=a&&a.length&&!r?"Online":"Offline"})),o=o.reduce((function(t,e){return t+e}));var I=u.reduce((function(t,e){return t&&e?t.MeasureDate>e.MeasureDate?t:e:null})),K=p.reduce((function(t,e){return t&&e?t.MeasureDate>e.MeasureDate?t:e:null})),$=new Date(I),R=new Date(K);a=I&&!isNaN($)?Object(l["c"])($):"never",r=K&&!isNaN(R)?Object(l["c"])(R):"never"}else a="never",r="never",o=0;return n.push({name:e.name,mesh:e.mesh,tags:i,status:c,lastConnected:a,lastUpdated:r,totalUpdates:o,type:y()}),t.sortEntities(n),n})).catch((function(t){console.error(t)}))},i=function(){return r().then((function(n){var r=function(){var e=n;return"total"in e?0!==e.total&&e.items&&e.items.length>0?t.sortEntities(e.items):null:e};if(r()){n.next?(t.next=Object(l["a"])(n.next),t.hasNext=!0):t.hasNext=!1;var i=[],o=a?r():r()[0];t.firstEntity=o.name,t.getEntity(o),t.$store.dispatch("updateSelectedTableRow",t.firstEntity),a&&a.length&&e&&e.length?s(e,a,i):r().forEach((function(t){s(t.mesh,t.name,i)})),t.tableData.data=i,t.tableDataIsEmpty=!1,t.isEmpty=!1}else t.tableData.data=[],t.tableDataIsEmpty=!0,t.isEmpty=!0,t.getEntity(null)})).catch((function(e){t.hasError=!0,t.isEmpty=!0,console.error(e)})).finally((function(){setTimeout((function(){t.isLoading=!1}),"500")}))};i()},getEntity:function(t){var e=this;this.entityIsLoading=!0,this.entityIsEmpty=!1;var a=this.$route.params.mesh;if(t&&null!==t){var n="all"===a?t.mesh:a;return this.$api.getDataplaneFromMesh(n,t.name).then((function(a){if(a){var r=["type","name","mesh"],i=function(){var a=Object(s["a"])(regeneratorRuntime.mark((function a(){var r,s,i,o,c,u;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return r=null,a.prev=1,a.next=4,e.$api.getDataplaneOverviewFromMesh(n,t.name);case 4:s=a.sent,s.dataplaneInsight.mTLS&&(i=s.dataplaneInsight.mTLS,o=new Date(i.certificateExpirationTime),c=new Date(o.getTime()+6e4*o.getTimezoneOffset()),u="\n                      ".concat(c.toLocaleDateString("en-US")," ").concat(c.getHours(),":").concat(c.getMinutes(),":").concat(c.getSeconds(),"\n                    "),r={certificateExpirationTime:{label:"Expiration Time",value:u},lastCertificateRegeneration:{label:"Last Generated",value:Object(l["c"])(i.lastCertificateRegeneration)},certificateRegenerations:{label:"Regenerations",value:i.certificateRegenerations}}),a.next=11;break;case 8:a.prev=8,a.t0=a["catch"](1),console.log(a.t0);case 11:return a.abrupt("return",r);case 12:case"end":return a.stop()}}),a,null,[[1,8]])})));return function(){return a.apply(this,arguments)}}(),o=function(){var t=a.networking||null,e=t.inbound||null,n=t.gateway||null,r=t.ingress||null;if(e||n||r){var s=[];if(e)for(var i=0;i<e.length;i++){var o=e[i].tags||null;if(o)for(var l=Object.keys(o),c=Object.values(o),u=0;u<l.length;u++)s.push({label:l[u],value:c[u]})}if(n){var p=n.tags||null;if(p)for(var d=0;d<Object.keys(p).length;d++)for(var v=Object.keys(p),f=Object.values(p),y=0;y<v.length;y++)s.push({label:v[y],value:f[y]})}if(r)for(var h=0;h<r.length;h++){var b=r[h].tags||null,m=r[h].service||null;if(m&&s.push({label:"service",value:m}),b)for(var g=Object.keys(b),O=Object.values(b),w=0;w<g.length;w++)s.push({label:g[w],value:O[w]})}return s}return null},c=function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.t0=m({},Object(l["b"])(a,r)),t.t1=m({},o()),t.next=4,i();case 4:return t.t2=t.sent,t.abrupt("return",{basicData:t.t0,tags:t.t1,mtls:t.t2});case 6:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}();c().then((function(t){e.entity=t,e.entityNamespace=t.basicData.name,e.tabGroupTitle="Mesh: ".concat(t.basicData.name),e.entityOverviewTitle="Entity Overview for ".concat(t.basicData.name)})),e.rawEntity=a}else e.entity=null,e.entityIsEmpty=!0})).catch((function(t){e.entityHasError=!0,console.error(t)})).finally((function(){setTimeout((function(){e.entityIsLoading=!1}),"500")}))}setTimeout((function(){e.entityIsEmpty=!0,e.entityIsLoading=!1}),"500")}}},O=g,w=(a("b3d5"),a("2877")),E=Object(w["a"])(O,n,r,!1,null,"0d69f10e",null);e["default"]=E.exports},d435:function(t,e,a){},ff9d:function(t,e,a){"use strict";var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"yaml-view"},[t.isReady?a("div",{staticClass:"yaml-view-content"},[t.isLoading||t.isEmpty?t._e():a("KCard",{attrs:{title:t.title,"border-variant":"noBorder"}},[a("template",{slot:"body"},[a("KTabs",{key:t.environment,attrs:{tabs:t.tabs},model:{value:t.activeTab.hash,callback:function(e){t.$set(t.activeTab,"hash",e)},expression:"activeTab.hash"}},[a("template",{slot:"universal"},[a("KClipboardProvider",{scopedSlots:t._u([{key:"default",fn:function(e){var n=e.copyToClipboard;return[a("KPop",{attrs:{placement:"bottom"}},[a("KButton",{staticClass:"copy-button",attrs:{appearance:"primary",size:"small"},on:{click:function(){n(t.yamlContent.universal)}}},[t._v("\n                  Copy Universal YAML\n                ")]),a("div",{attrs:{slot:"content"},slot:"content"},[a("p",[t._v("Entity copied to clipboard!")])])],1)]}}],null,!1,337484112)}),a("prism",{staticClass:"code-block",attrs:{language:"yaml",code:t.yamlContent.universal}})],1),a("template",{slot:"kubernetes"},[a("KClipboardProvider",{scopedSlots:t._u([{key:"default",fn:function(e){var n=e.copyToClipboard;return[a("KPop",{attrs:{placement:"bottom"}},[a("KButton",{staticClass:"copy-button",attrs:{appearance:"primary",size:"small"},on:{click:function(){n(t.yamlContent.kubernetes)}}},[t._v("\n                  Copy Kubernetes YAML\n                ")]),a("div",{attrs:{slot:"content"},slot:"content"},[a("p",[t._v("Entity copied to clipboard!")])])],1)]}}],null,!1,1046684688)}),a("prism",{staticClass:"code-block",attrs:{language:"yaml",code:t.yamlContent.kubernetes}})],1)],2)],1)],2)],1):t._e(),!0===t.loaders?a("div",[t.isLoading?a("KEmptyState",{attrs:{"cta-is-hidden":""}},[a("template",{slot:"title"},[a("div",{staticClass:"card-icon mb-3"},[a("KIcon",{attrs:{icon:"spinner",color:"rgba(0, 0, 0, 0.1)",size:"42"}})],1),t._v("\n        Data Loading...\n      ")])],2):t._e(),t.isEmpty&&!t.isLoading?a("KEmptyState",{attrs:{"cta-is-hidden":""}},[a("template",{slot:"title"},[a("div",{staticClass:"card-icon mb-3"},[a("KIcon",{staticClass:"kong-icon--centered",attrs:{color:"var(--yellow-base)",icon:"warning",size:"42"}})],1),t._v("\n        There is no data to display.\n      ")])],2):t._e(),t.hasError?a("KEmptyState",{attrs:{"cta-is-hidden":""}},[a("template",{slot:"title"},[a("div",{staticClass:"card-icon mb-3"},[a("KIcon",{staticClass:"kong-icon--centered",attrs:{color:"var(--yellow-base)",icon:"warning",size:"42"}})],1),t._v("\n        An error has occurred while trying to load this data.\n      ")])],2):t._e()],1):t._e()])},r=[],s=(a("8e6e"),a("ac6a"),a("456d"),a("7f7f"),a("bd86")),i=a("2f62"),o=a("2ccf"),l=a.n(o),c=(a("a878"),a("e80b")),u=a.n(c);function p(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),a.push.apply(a,n)}return a}function d(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?p(Object(a),!0).forEach((function(e){Object(s["a"])(t,e,a[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):p(Object(a)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))}))}return t}var v={name:"YamlView",components:{prism:l.a},props:{title:{type:String,default:null},content:{type:Object,default:null},loaders:{type:Boolean,default:!0},isLoading:{type:Boolean,default:!1},hasError:{type:Boolean,default:!1},isEmpty:{type:Boolean,default:!1}},data:function(){return{tabs:[{hash:"#universal",title:"Universal"},{hash:"#kubernetes",title:"Kubernetes"}]}},computed:d({},Object(i["b"])({environment:"getEnvironment"}),{isReady:function(){return!this.isEmpty&&!this.hasError&&!this.isLoading},activeTab:{get:function(){var t=this.environment;return{hash:"#".concat(t),nohash:t}},set:function(t){return{hash:"#".concat(t),nohash:t}}},yamlContent:function(){var t=this,e=this.content,a=function(){var e={},a=Object.assign({},t.content),n=a.name,r=a.type;return delete a.type,delete a.name,e.apiVersion="kuma.io/v1alpha1",e.kind=r,e.metadata={name:n},d({},e,{},a)},n={universal:u()(e),kubernetes:u()(a())};return n}})},f=v,y=(a("23d6"),a("254c"),a("2877")),h=Object(y["a"])(f,n,r,!1,null,"6babfd18",null);e["a"]=h.exports}}]);