(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d207d74"],{a1f4:function(t,e,a){"use strict";a.r(e);var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"dataplanes"},[a("FrameSkeleton",[a("DataOverview",{attrs:{"page-size":6,"has-error":t.hasError,"is-loading":t.isLoading,"is-empty":t.isEmpty,"empty-state":t.empty_state,"display-data-table":!0,"table-data":t.tableData,"table-data-is-empty":t.tableDataIsEmpty,"table-data-function-text":"View","table-data-row":"name"},on:{tableAction:t.tableAction,reloadData:t.bootstrap}}),a("Tabs",{attrs:{"has-error":t.hasError,"is-loading":t.isLoading,"is-empty":t.isEmpty,tabs:t.tabs,"tab-group-title":t.tabGroupTitle,"initial-tab-override":"overview"}},[a("template",{slot:"overview"},[a("LabelList",{attrs:{"has-error":t.entityHasError,"is-loading":t.entityIsLoading,"is-empty":t.entityIsEmpty,items:t.entity}})],1),a("template",{slot:"yaml"},[a("YamlView",{attrs:{title:t.entityOverviewTitle,"has-error":t.entityHasError,"is-loading":t.entityIsLoading,"is-empty":t.entityIsEmpty,content:t.rawEntity}})],1)],2)],1)],1)},s=[],i=(a("8e6e"),a("bd86")),r=(a("8615"),a("456d"),a("ac6a"),a("7f7f"),a("d7c2")),o=a("8218"),l=a("1d10"),c=a("2778"),u=a("251b"),p=a("ff9d"),y=a("0ada");function h(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),a.push.apply(a,n)}return a}function b(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?h(Object(a),!0).forEach((function(e){Object(i["a"])(t,e,a[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):h(Object(a)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))}))}return t}var d={name:"Dataplanes",metaInfo:{title:"Dataplanes"},components:{FrameSkeleton:l["a"],DataOverview:c["a"],Tabs:u["a"],YamlView:p["a"],LabelList:y["a"]},mixins:[o["a"]],data:function(){return{isLoading:!0,isEmpty:!1,hasError:!1,entityIsLoading:!0,entityIsEmpty:!1,entityHasError:!1,tableDataIsEmpty:!1,empty_state:{title:"No Data",message:"There are no Dataplanes present."},tableData:{headers:[{key:"actions",hideLabel:!0},{label:"Status",key:"status"},{label:"Name",key:"name"},{label:"Mesh",key:"mesh"},{label:"Tags",key:"tags"},{label:"Last Connected",key:"lastConnected"},{label:"Last Updated",key:"lastUpdated"},{label:"Total Updates",key:"totalUpdates"}],data:[]},tabs:[{hash:"#overview",title:"Overview"},{hash:"#yaml",title:"YAML"}],entity:null,rawEntity:null,firstEntity:null}},computed:{tabGroupTitle:function(){var t=this.entity;return t?"Dataplane: ".concat(t.name):null},entityOverviewTitle:function(){var t=this.entity;return t?"Entity Overview for ".concat(t.name):null}},watch:{$route:function(t,e){this.bootstrap()}},beforeMount:function(){this.bootstrap()},methods:{tableAction:function(t){var e=t;this.$store.dispatch("updateSelectedTab",this.tabs[0].hash),this.$store.dispatch("updateSelectedTableRow",e.name),this.getEntity(e)},bootstrap:function(){var t=this;this.isLoading=!0,this.isEmpty=!1;var e=this.$route.params.mesh,a="all"===e?this.$api.getAllDataplanes():this.$api.getAllDataplanesFromMesh(e),n=function(){return a.then((function(e){if(e.items.length>0){var a=e.items,n=[];t.firstEntity=a[0].name,t.getEntity(a[0]),t.$store.dispatch("updateSelectedTableRow",t.firstEntity),a.forEach((function(e){t.$api.getDataplaneOverviewsFromMesh(e.mesh,e.name).then((function(e){var a,s,i="n/a",o=i,l=[],c="Offline",u=[],p=[],y=e.dataplane.networking.inbound,h=e.dataplane.networking.gateway;if(y||h){if(y)for(var b=0;b<y.length;b++){for(var d=y[b].tags,m=[],f=Object.keys(d),g=Object.values(d),v=0;v<f.length;v++)m.push({label:f[v],value:g[v]});o=m}else if(h)for(var w=h.tags,E=0;E<Object.keys(w).length;E++){for(var O=[],D=Object.keys(w),j=Object.values(w),k=0;k<D.length;k++)O.push({label:D[k],value:j[k]});o=O}}else o="none";if(e.dataplaneInsight.subscriptions&&e.dataplaneInsight.subscriptions.length){e.dataplaneInsight.subscriptions.forEach((function(t){var e=t.status.total.responsesSent||0,a=t.connectTime||i,n=t.status.lastUpdateTime||i,s=t.disconnectTime||null;l.push(e),u.push(a),p.push(n),c=a&&a.length&&!s?"Online":"Offline"})),l=l.reduce((function(t,e){return t+e}));var I=u.reduce((function(t,e){return t&&e?t.MeasureDate>e.MeasureDate?t:e:null})),L=p.reduce((function(t,e){return t&&e?t.MeasureDate>e.MeasureDate?t:e:null})),T=new Date(I),$=new Date(L);a=I&&!isNaN(T)?Object(r["b"])(T):"never",s=L&&!isNaN($)?Object(r["b"])($):"never"}else a="never",s="never",l=0;n.push({name:e.name,mesh:e.mesh,tags:o,status:c,lastConnected:a,lastUpdated:s,totalUpdates:l,type:"dataplane"}),t.sortEntities(n)})).catch((function(t){console.error(t)}))})),t.tableData.data=n,t.tableDataIsEmpty=!1}else t.tableData.data=[],t.tableDataIsEmpty=!0,t.getEntity(null)})).catch((function(e){t.hasError=!0,console.error(e)})).finally((function(){setTimeout((function(){t.isLoading=!1}),"500")}))};n()},getEntity:function(t){var e=this;this.entityIsLoading=!0,this.entityIsEmpty=!1;var a=this.$route.params.mesh;if(t&&null!==t){var n="all"===a?t.mesh:a;return this.$api.getDataplaneFromMesh(n,t.name).then((function(t){if(t){var a=["type","name","mesh","tags"],n=t.networking.inbound||t.networking.gateway,s=b({},Object(r["a"])(t,a),{},{tags:n[0].tags});e.entity=s,e.rawEntity=t}else e.entity=null,e.entityIsEmpty=!0})).catch((function(t){e.entityHasError=!0,console.error(t)})).finally((function(){setTimeout((function(){e.entityIsLoading=!1}),"500")}))}setTimeout((function(){e.entityIsEmpty=!0,e.entityIsLoading=!1}),"500")}}},m=d,f=a("2877"),g=Object(f["a"])(m,n,s,!1,null,null,null);e["default"]=g.exports}}]);