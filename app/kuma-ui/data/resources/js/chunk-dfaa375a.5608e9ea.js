(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-dfaa375a"],{"66bd":function(t,e,a){"use strict";var n=a("f561"),i=a.n(n);i.a},a1f4:function(t,e,a){"use strict";a.r(e);var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"dataplanes"},[a("FrameSkeleton",[a("DataOverview",{attrs:{"page-size":t.pageSize,"has-error":t.hasError,"is-loading":t.isLoading,"empty-state":t.empty_state,"display-data-table":!0,"table-data":t.tableData,"table-data-is-empty":t.tableDataIsEmpty,"table-data-function-text":"View","table-data-row":"name"},on:{tableAction:t.tableAction,reloadData:t.loadData}},[a("template",{slot:"additionalControls"},[a("KButton",{staticClass:"add-dp-button",attrs:{appearance:"primary",size:"small",to:t.dataplaneWizardRoute}},[a("span",{staticClass:"custom-control-icon"},[t._v("\n            +\n          ")]),t._v("\n          Create Dataplane\n        ")])],1),a("template",{slot:"pagination"},[a("Pagination",{attrs:{"has-previous":t.previous.length>0,"has-next":t.hasNext},on:{next:t.goToNextPage,previous:t.goToPreviousPage}})],1)],2),!1===t.isEmpty?a("Tabs",{attrs:{"has-error":t.hasError,"is-loading":t.isLoading,tabs:t.tabs,"tab-group-title":t.tabGroupTitle,"initial-tab-override":"overview"}},[a("template",{slot:"overview"},[a("LabelList",{attrs:{"has-error":t.entityHasError,"is-loading":t.entityIsLoading,"is-empty":t.entityIsEmpty}},[a("div",[a("ul",t._l(t.entity.basicData,(function(e,n){return a("li",{key:n},[a("h4",[t._v(t._s(n))]),a("p",[t._v("\n                  "+t._s(e)+"\n                ")])])})),0)]),a("div",[a("h4",[t._v("Tags")]),a("p",t._l(t.entity.tags,(function(e,n){return a("span",{key:n,staticClass:"tag-cols"},[a("span",[t._v("\n                  "+t._s(n)+":\n                ")]),a("span",[t._v("\n                  "+t._s(e)+"\n                ")])])})),0)])])],1),a("template",{slot:"yaml"},[a("YamlView",{attrs:{title:t.entityOverviewTitle,"has-error":t.entityHasError,"is-loading":t.entityIsLoading,"is-empty":t.entityIsEmpty,content:t.rawEntity}})],1),a("template",{slot:"mtls"},[a("LabelList",{attrs:{"has-error":t.entityHasError,"is-loading":t.entityIsLoading,"is-empty":t.entityIsEmpty}},[t.entity.mtls?a("ul",t._l(t.entity.mtls,(function(e,n){return a("li",{key:n},[a("h4",[t._v(t._s(e.label))]),a("p",[t._v("\n                "+t._s(e.value)+"\n              ")])])})),0):a("KAlert",{attrs:{appearance:"danger"}},[a("template",{slot:"alertMessage"},[t._v("\n              This Dataplane does not yet have mTLS configured â€”\n              "),a("a",{staticClass:"external-link",attrs:{href:"https://kuma.io/docs/"+t.version+"/documentation/security/#certificates",target:"_blank"}},[t._v("\n                Learn About Certificates in Kuma\n              ")])])],2)],1)],1)],2):t._e()],1)],1)},i=[],s=(a("8e6e"),a("96cf"),a("3b8d")),r=(a("8615"),a("456d"),a("ac6a"),a("7f7f"),a("bd86")),o=a("2f62"),l=a("d7c2"),c=a("8218"),u=a("1d10"),p=a("1799"),h=a("2778"),f=a("251b"),d=a("ff9d"),m=a("0ada");function g(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),a.push.apply(a,n)}return a}function b(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?g(Object(a),!0).forEach((function(e){Object(r["a"])(t,e,a[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):g(Object(a)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))}))}return t}var y={name:"Dataplanes",metaInfo:{title:"Dataplanes"},components:{FrameSkeleton:u["a"],Pagination:p["a"],DataOverview:h["a"],Tabs:f["a"],YamlView:d["a"],LabelList:m["a"]},mixins:[c["a"]],data:function(){return{isLoading:!0,isEmpty:!1,hasError:!1,entityIsLoading:!0,entityIsEmpty:!1,entityHasError:!1,tableDataIsEmpty:!1,empty_state:{title:"No Data",message:"There are no Dataplanes present."},tableData:{headers:[{key:"actions",hideLabel:!0},{label:"Status",key:"status"},{label:"Name",key:"name"},{label:"Mesh",key:"mesh"},{label:"Tags",key:"tags"},{label:"Last Connected",key:"lastConnected"},{label:"Last Updated",key:"lastUpdated"},{label:"Total Updates",key:"totalUpdates"}],data:[]},tabs:[{hash:"#overview",title:"Overview"},{hash:"#yaml",title:"YAML"},{hash:"#mtls",title:"Certificate Insights"}],entity:[],rawEntity:null,firstEntity:null,pageSize:this.$pageSize,pageOffset:null,next:null,hasNext:!1,previous:[],tabGroupTitle:null,entityOverviewTitle:null,showmTLSTab:!1}},computed:b({},Object(o["b"])({environment:"getEnvironment"}),{dataplaneWizardRoute:function(){return"universal"===this.environment?{name:"universal-dataplane"}:{name:"kubernetes-dataplane"}},version:function(){var t=this.$store.getters.getVersion;return null!==t?t:"latest"}}),watch:{$route:function(t,e){this.loadData()}},beforeMount:function(){this.loadData()},methods:{init:function(){this.loadData()},goToPreviousPage:function(){this.pageOffset=this.previous.pop(),this.next=null,this.loadData()},goToNextPage:function(){this.previous.push(this.pageOffset),this.pageOffset=this.next,this.next=null,this.loadData()},tableAction:function(t){var e=t;this.$store.dispatch("updateSelectedTab",this.tabs[0].hash),this.$store.dispatch("updateSelectedTableRow",e.name),this.getEntity(e)},loadData:function(){var t=this;this.isLoading=!0;var e=this.$route.params.mesh,a={size:this.pageSize,offset:this.pageOffset},n="all"===e?this.$api.getAllDataplanes(a):this.$api.getAllDataplanesFromMesh(e),i=function(){return n.then((function(e){if(e.items.length>0){e.next?(t.next=Object(l["a"])(e.next),t.hasNext=!0):t.hasNext=!1;var a=t.sortEntities(e.items),n=[];t.firstEntity=a[0].name,t.getEntity(a[0]),t.$store.dispatch("updateSelectedTableRow",t.firstEntity),a.forEach((function(e){t.$api.getDataplaneOverviewsFromMesh(e.mesh,e.name).then((function(e){var a,i,s="n/a",r=s,o=[],c="Offline",u=[],p=[],h=e.dataplane.networking.inbound,f=e.dataplane.networking.gateway;if(h||f){if(h)for(var d=0;d<h.length;d++){for(var m=h[d].tags,g=[],b=Object.keys(m),y=Object.values(m),v=0;v<b.length;v++)g.push({label:b[v],value:y[v]});r=g}else if(f)for(var w=f.tags,O=0;O<Object.keys(w).length;O++){for(var E=[],D=Object.keys(w),T=Object.values(w),k=0;k<D.length;k++)E.push({label:D[k],value:T[k]});r=E}}else r="none";if(e.dataplaneInsight.subscriptions&&e.dataplaneInsight.subscriptions.length){e.dataplaneInsight.subscriptions.forEach((function(t){var e=t.status.total.responsesSent||0,a=t.connectTime||s,n=t.status.lastUpdateTime||s,i=t.disconnectTime||null;o.push(e),u.push(a),p.push(n),c=a&&a.length&&!i?"Online":"Offline"})),o=o.reduce((function(t,e){return t+e}));var L=u.reduce((function(t,e){return t&&e?t.MeasureDate>e.MeasureDate?t:e:null})),j=p.reduce((function(t,e){return t&&e?t.MeasureDate>e.MeasureDate?t:e:null})),x=new Date(L),_=new Date(j);a=L&&!isNaN(x)?Object(l["c"])(x):"never",i=j&&!isNaN(_)?Object(l["c"])(_):"never"}else a="never",i="never",o=0;n.push({name:e.name,mesh:e.mesh,tags:r,status:c,lastConnected:a,lastUpdated:i,totalUpdates:o,type:"dataplane"}),t.sortEntities(n)})).catch((function(t){console.error(t)}))})),t.tableData.data=n,t.tableDataIsEmpty=!1,t.isEmpty=!1}else t.tableData.data=[],t.tableDataIsEmpty=!0,t.isEmpty=!0,t.getEntity(null)})).catch((function(e){t.hasError=!0,t.isEmpty=!0,console.error(e)})).finally((function(){setTimeout((function(){t.isLoading=!1}),"500")}))};i()},getEntity:function(t){var e=this;this.entityIsLoading=!0,this.entityIsEmpty=!1;var a=this.$route.params.mesh;if(t&&null!==t){var n="all"===a?t.mesh:a;return this.$api.getDataplaneFromMesh(n,t.name).then((function(a){if(a){var i=["type","name","mesh"],r=function(){var a=Object(s["a"])(regeneratorRuntime.mark((function a(){var i,s,r;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return i=null,a.prev=1,a.next=4,e.$api.getDataplaneOverviewsFromMesh(n,t.name);case 4:s=a.sent,s.dataplaneInsight.mTLS&&(r=s.dataplaneInsight.mTLS,i={certificateExpirationTime:{label:"Expiration Time",value:Object(l["c"])(r.certificateExpirationTime)},lastCertificateRegeneration:{label:"Last Generated",value:Object(l["c"])(r.lastCertificateRegeneration)},certificateRegenerations:{label:"Regenerations",value:r.certificateRegenerations}}),a.next=11;break;case 8:a.prev=8,a.t0=a["catch"](1),console.log(a.t0);case 11:return a.abrupt("return",i);case 12:case"end":return a.stop()}}),a,null,[[1,8]])})));return function(){return a.apply(this,arguments)}}(),o=a.networking.inbound&&a.networking.inbound.length>0?a.networking.inbound[0].tags:a.networking.gateway.tags,c=function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.t0=b({},Object(l["b"])(a,i)),t.t1=b({},o),t.next=4,r();case 4:return t.t2=t.sent,t.abrupt("return",{basicData:t.t0,tags:t.t1,mtls:t.t2});case 6:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}();c().then((function(t){e.entity=t,e.tabGroupTitle="Mesh: ".concat(t.basicData.name),e.entityOverviewTitle="Entity Overview for ".concat(t.basicData.name)})),e.rawEntity=a}else e.entity=null,e.entityIsEmpty=!0})).catch((function(t){e.entityHasError=!0,console.error(t)})).finally((function(){setTimeout((function(){e.entityIsLoading=!1}),"500")}))}setTimeout((function(){e.entityIsEmpty=!0,e.entityIsLoading=!1}),"500")}}},v=y,w=(a("66bd"),a("2877")),O=Object(w["a"])(v,n,i,!1,null,"f954a796",null);e["default"]=O.exports},f561:function(t,e,a){}}]);