(self["webpackChunkkuma_gui"]=self["webpackChunkkuma_gui"]||[]).push([[241],{73570:function(e,t,a){var n=a(49237),i="  ";function s(e){var t=typeof e;return e instanceof Array?"array":"string"==t?"string":"boolean"==t?"boolean":"number"==t?"number":"undefined"==t||null===e?"null":"hash"}function l(e,t){var a=s(e);switch(a){case"array":r(e,t);break;case"hash":o(e,t);break;case"string":c(e,t);break;case"null":t.push("null");break;case"number":t.push(e.toString());break;case"boolean":t.push(e?"true":"false");break}}function r(e,t){for(var a=0;a<e.length;a++){var n=e[a],s=[];l(n,s);for(var r=0;r<s.length;r++)t.push((0==r?"- ":i)+s[r])}}function o(e,t){for(var a in e){var n=[];if(e.hasOwnProperty(a)){var r=e[a];l(r,n);var o=s(r);if("string"==o||"null"==o||"number"==o||"boolean"==o)t.push(u(a)+": "+n[0]);else{t.push(u(a)+": ");for(var c=0;c<n.length;c++)t.push(i+n[c])}}}}function u(e){return e.match(/^[\w]+$/)?e:n.requiresDoubleQuoting(e)?n.escapeWithDoubleQuotes(e):n.requiresSingleQuoting(e)?n.escapeWithSingleQuotes(e):e}function c(e,t){t.push(u(e))}var d=function(e){"string"==typeof e&&(e=JSON.parse(e));var t=[];return l(e,t),t.join("\n")};e.exports=d},99997:function(e,t,a){"use strict";a.d(t,{Z:function(){return C}});var n=a(70821);const i=e=>((0,n.dD)("data-v-487d5c0d"),e=e(),(0,n.Cn)(),e),s={class:"yaml-view"},l={key:0,class:"yaml-view-content"},r=(0,n.Uk)(" Copy Universal YAML "),o=i((()=>(0,n._)("div",null,[(0,n._)("p",null,"Entity copied to clipboard!")],-1))),u=(0,n.Uk)(" Copy Kubernetes YAML "),c=i((()=>(0,n._)("div",null,[(0,n._)("p",null,"Entity copied to clipboard!")],-1))),d={key:1},h={class:"card-icon mb-3"},p=(0,n.Uk)(" Data Loading... "),y={class:"card-icon mb-3"},m=(0,n.Uk)(" There is no data to display. "),g={class:"card-icon mb-3"},b=(0,n.Uk)(" An error has occurred while trying to load this data. ");function f(e,t,a,i,f,w){const E=(0,n.up)("KButton"),v=(0,n.up)("KPop"),k=(0,n.up)("KClipboardProvider"),_=(0,n.up)("CodeBlock"),D=(0,n.up)("KTabs"),x=(0,n.up)("KCard"),C=(0,n.up)("KIcon"),S=(0,n.up)("KEmptyState");return(0,n.wg)(),(0,n.iD)("div",s,[w.isReady?((0,n.wg)(),(0,n.iD)("div",l,[a.isLoading||a.isEmpty?(0,n.kq)("",!0):((0,n.wg)(),(0,n.j4)(x,{key:0,title:w.yamlTitle,"border-variant":"noBorder"},{body:(0,n.w5)((()=>[((0,n.wg)(),(0,n.j4)(D,{key:e.environment,modelValue:w.activeTab.hash,"onUpdate:modelValue":t[0]||(t[0]=e=>w.activeTab.hash=e),tabs:f.tabs},{universal:(0,n.w5)((()=>[(0,n.Wm)(k,null,{default:(0,n.w5)((({copyToClipboard:e})=>[(0,n.Wm)(v,{placement:"bottom"},{content:(0,n.w5)((()=>[o])),default:(0,n.w5)((()=>[(0,n.Wm)(E,{class:"copy-button",appearance:"primary",size:"small",onClick:()=>{e(w.yamlContent.universal)}},{default:(0,n.w5)((()=>[r])),_:2},1032,["onClick"])])),_:2},1024)])),_:1}),(0,n.Wm)(_,{language:"yaml",code:w.yamlContent.universal},null,8,["code"])])),kubernetes:(0,n.w5)((()=>[(0,n.Wm)(k,null,{default:(0,n.w5)((({copyToClipboard:e})=>[(0,n.Wm)(v,{placement:"bottom"},{content:(0,n.w5)((()=>[c])),default:(0,n.w5)((()=>[(0,n.Wm)(E,{class:"copy-button",appearance:"primary",size:"small",onClick:()=>{e(w.yamlContent.kubernetes)}},{default:(0,n.w5)((()=>[u])),_:2},1032,["onClick"])])),_:2},1024)])),_:1}),(0,n.Wm)(_,{language:"yaml",code:w.yamlContent.kubernetes},null,8,["code"])])),_:1},8,["modelValue","tabs"]))])),_:1},8,["title"]))])):(0,n.kq)("",!0),!0===a.loaders?((0,n.wg)(),(0,n.iD)("div",d,[a.isLoading?((0,n.wg)(),(0,n.j4)(S,{key:0,"cta-is-hidden":""},{title:(0,n.w5)((()=>[(0,n._)("div",h,[(0,n.Wm)(C,{icon:"spinner",color:"rgba(0, 0, 0, 0.1)",size:"42"})]),p])),_:1})):(0,n.kq)("",!0),a.isEmpty&&!a.isLoading?((0,n.wg)(),(0,n.j4)(S,{key:1,"cta-is-hidden":""},{title:(0,n.w5)((()=>[(0,n._)("div",y,[(0,n.Wm)(C,{class:"kong-icon--centered",icon:"warning",color:"var(--black-75)","secondary-color":"var(--yellow-300)",size:"42"})]),m])),_:1})):(0,n.kq)("",!0),a.hasError?((0,n.wg)(),(0,n.j4)(S,{key:2,"cta-is-hidden":""},{title:(0,n.w5)((()=>[(0,n._)("div",g,[(0,n.Wm)(C,{class:"kong-icon--centered",icon:"warning",color:"var(--black-75)","secondary-color":"var(--yellow-300)",size:"42"})]),b])),_:1})):(0,n.kq)("",!0)])):(0,n.kq)("",!0)])}var w=a(33907),E=a(73570),v=a.n(E),k=a(61496),_={name:"YamlView",components:{CodeBlock:k.Z},props:{title:{type:String,default:null},content:{type:Object,default:null},loaders:{type:Boolean,default:!0},isLoading:{type:Boolean,default:!1},hasError:{type:Boolean,default:!1},isEmpty:{type:Boolean,default:!1}},data(){return{tabs:[{hash:"#universal",title:"Universal"},{hash:"#kubernetes",title:"Kubernetes"}]}},computed:{...(0,w.Se)({environment:"config/getEnvironment"}),isReady(){return!this.isEmpty&&!this.hasError&&!this.isLoading},activeTab:{get(){const e=this.environment;return{hash:`#${e}`,nohash:e}},set(e){return{hash:`#${e}`,nohash:e}}},yamlTitle(){return this.title?this.title:this.content?.name?`Entity Overview for ${this.content.name}`:"Entity Overview"},yamlContent(){const e=this.content,t=()=>{const e={},t=Object.assign({},this.content),{name:a,mesh:n,type:i}=t,s=()=>{const e=Object.assign({},this.content);return delete e.type,delete e.mesh,delete e.name,!!(e&&Object.entries(e).length>0)&&e};if(e.apiVersion="kuma.io/v1alpha1",e.kind=i,void 0!==n&&(e.mesh=t.mesh),a?.includes(".")){const t=a.split("."),n=t.pop(),i=t.join(".");e.metadata={name:i,namespace:n}}else e.metadata={name:a};return s()&&(e.spec=s()),e},a={universal:v()(e),kubernetes:v()(t())};return a}}},D=a(83744);const x=(0,D.Z)(_,[["render",f],["__scopeId","data-v-487d5c0d"]]);var C=x},95169:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return O}});var n=a(70821);const i=e=>((0,n.dD)("data-v-0199f7bd"),e=e(),(0,n.Cn)(),e),s={class:"all-meshes"},l=i((()=>(0,n._)("span",{class:"custom-control-icon"}," + ",-1))),r=(0,n.Uk)(" Create Mesh "),o={key:0},u={key:0},c={key:1},d={key:2},h={key:3},p={key:4},y={key:0},m={key:0,class:"label-cols"},g=(0,n.Uk)(" Disabled "),b=i((()=>(0,n._)("h4",null,"Locality Aware Loadbalancing",-1))),f={key:0},w=(0,n.Uk)(" Enabled "),E=(0,n.Uk)(" Disabled ");function v(e,t,a,i,v,k){const _=(0,n.up)("KButton"),D=(0,n.up)("DataOverview"),x=(0,n.up)("KBadge"),C=(0,n.up)("LabelList"),S=(0,n.up)("YamlView"),I=(0,n.up)("TabsWidget"),T=(0,n.up)("FrameSkeleton");return(0,n.wg)(),(0,n.iD)("div",s,[(0,n.Wm)(T,null,{default:(0,n.w5)((()=>[(0,n.Wm)(D,{"page-size":v.pageSize,"has-error":v.hasError,"is-loading":v.isLoading,"empty-state":v.empty_state,"table-data":v.tableData,"table-data-is-empty":v.tableDataIsEmpty,next:v.next,onTableAction:k.tableAction,onLoadData:t[0]||(t[0]=e=>k.loadData(e))},{additionalControls:(0,n.w5)((()=>[(0,n.Wm)(_,{class:"add-mesh-button",appearance:"primary",size:"small",to:{path:"/wizard/mesh"},onClick:k.onCreateClick},{default:(0,n.w5)((()=>[l,r])),_:1},8,["onClick"])])),_:1},8,["page-size","has-error","is-loading","empty-state","table-data","table-data-is-empty","next","onTableAction"]),!1===v.isEmpty?((0,n.wg)(),(0,n.j4)(I,{key:0,"has-error":v.hasError,"is-loading":v.isLoading,tabs:v.tabs,"initial-tab-override":"overview"},{tabHeader:(0,n.w5)((()=>[v.entity.basicData?((0,n.wg)(),(0,n.iD)("div",o,[(0,n._)("h3",null," Mesh: "+(0,n.zw)(v.entity.basicData.name),1)])):(0,n.kq)("",!0)])),overview:(0,n.w5)((()=>[(0,n.Wm)(C,{"has-error":v.entityHasError,"is-loading":v.entityIsLoading,"is-empty":v.entityIsEmpty},{default:(0,n.w5)((()=>[(0,n._)("div",null,[(0,n._)("ul",null,[((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(v.entity.basicData,((e,t)=>((0,n.wg)(),(0,n.iD)("li",{key:t},["creationTime"===t?((0,n.wg)(),(0,n.iD)("h4",u," Created ")):"modificationTime"===t?((0,n.wg)(),(0,n.iD)("h4",c," Last Modified ")):((0,n.wg)(),(0,n.iD)("h4",d,(0,n.zw)(t),1)),"creationTime"===t||"modificationTime"===t?((0,n.wg)(),(0,n.iD)("p",h,[(0,n.Uk)((0,n.zw)(k.readableDate(e))+" ",1),(0,n._)("em",null,"("+(0,n.zw)(k.rawDate(e))+")",1)])):((0,n.wg)(),(0,n.iD)("p",p,(0,n.zw)(e),1))])))),128))])]),v.entity.extendedData&&v.entity.extendedData.length?((0,n.wg)(),(0,n.iD)("div",y,[(0,n._)("ul",null,[((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(v.entity.extendedData,((e,t)=>((0,n.wg)(),(0,n.iD)("li",{key:t},[(0,n._)("h4",null,(0,n.zw)(e.label),1),e.value?((0,n.wg)(),(0,n.iD)("p",m,[(0,n._)("span",null,(0,n.zw)(e.value.type),1),(0,n._)("span",null,(0,n.zw)(e.value.name),1)])):((0,n.wg)(),(0,n.j4)(x,{key:1,appearance:"danger"},{default:(0,n.w5)((()=>[g])),_:1}))])))),128)),(0,n._)("li",null,[b,v.entity.localityEnabled?((0,n.wg)(),(0,n.iD)("p",f,[(0,n.Wm)(x,{appearance:"success"},{default:(0,n.w5)((()=>[w])),_:1})])):((0,n.wg)(),(0,n.j4)(x,{key:1,appearance:"danger"},{default:(0,n.w5)((()=>[E])),_:1}))])])])):(0,n.kq)("",!0)])),_:1},8,["has-error","is-loading","is-empty"])])),yaml:(0,n.w5)((()=>[(0,n.Wm)(S,{"has-error":v.entityHasError,"is-loading":v.entityIsLoading,"is-empty":v.entityIsEmpty,content:v.rawEntity},null,8,["has-error","is-loading","is-empty","content"])])),resources:(0,n.w5)((()=>[(0,n.Wm)(C,{"has-error":v.entityHasError,"is-loading":v.entityIsLoading,"is-empty":v.entityIsEmpty},{default:(0,n.w5)((()=>[((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(k.countCols,(e=>((0,n.wg)(),(0,n.iD)("div",{key:e},[(0,n._)("ul",null,[((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(k.counts.slice((e-1)*v.itemsPerCol,e*v.itemsPerCol),((e,t)=>((0,n.wg)(),(0,n.iD)("li",{key:t},[(0,n._)("h4",null,(0,n.zw)(e.title),1),(0,n._)("p",null,(0,n.zw)(k.formatValue(e.value)),1)])))),128))])])))),128))])),_:1},8,["has-error","is-loading","is-empty"])])),_:1},8,["has-error","is-loading","tabs"])):(0,n.kq)("",!0)])),_:1})])}var k=a(33907),_=a(51991),D=a(21180),x=a(70172),C=a(95814),S=a(70878),I=a(53419),T=a(82318),A=a(59713),L=a(18574),P=a(99997),W=a(52681),z=a(45689),R={name:"MeshesView",components:{FrameSkeleton:T.Z,DataOverview:A.Z,TabsWidget:L.Z,YamlView:P.Z,LabelList:W.Z},data(){return{isLoading:!0,isEmpty:!1,hasError:!1,entityIsLoading:!0,entityIsEmpty:!1,entityHasError:!1,tableDataIsEmpty:!1,empty_state:{title:"No Data",message:"There are no Meshes present."},tableData:{headers:[{key:"actions",hideLabel:!0},{label:"Name",key:"name"},{label:"Type",key:"type"}],data:[]},tabs:[{hash:"#overview",title:"Overview"},{hash:"#resources",title:"Resources"},{hash:"#yaml",title:"YAML"}],entity:{},rawEntity:{},pageSize:z.NR,next:null,itemsPerCol:3,meshInsight:(0,C.go)()}},computed:{...(0,k.rn)({policies:e=>e.policies}),...(0,k.Se)({featureFlags:"config/featureFlags"}),counts(){const e=this.policies.map((e=>({title:e.pluralDisplayName,value:this.meshInsight.policies[e.name]?.total||0})));return[{title:"Data plane proxies",value:this.meshInsight.dataplanes.total},...e]},countCols(){return Math.ceil(this.counts.length/this.itemsPerCol)}},watch:{$route(){this.isLoading=!0,this.isEmpty=!1,this.hasError=!1,this.entityIsLoading=!0,this.entityIsEmpty=!1,this.entityHasError=!1,this.tableDataIsEmpty=!1,this.loadData()}},beforeMount(){this.init()},methods:{init(){this.loadData()},onCreateClick(){_.fy.logger.info(S.T.CREATE_MESH_CLICKED)},tableAction(e){const t=e;this.getEntity(t)},async loadData(e="0"){this.isLoading=!0,this.isEmpty=!1;const t=this.$route.params.mesh;let a;"all"!==t&&(a=this.$route.params.mesh);try{const{data:t,next:n}=await(0,x.W)({getSingleEntity:D["default"].getMesh.bind(D["default"]),getAllEntities:D["default"].getAllMeshes.bind(D["default"]),size:this.pageSize,offset:e,query:a});this.next=n,t.length?(this.tableData.data=[...t],this.tableDataIsEmpty=!1,this.isEmpty=!1,this.getEntity({name:t[0].name})):(this.tableData.data=[],this.tableDataIsEmpty=!0,this.isEmpty=!0,this.entityIsEmpty=!0)}catch(n){this.hasError=!0,this.isEmpty=!0,console.error(n)}finally{this.isLoading=!1}},getEntity(e){if(this.entityIsLoading=!0,this.entityIsEmpty=!1,this.entityHasError=!1,e&&null!==e)return D["default"].getMesh({name:e.name}).then((t=>{if(t){D["default"].getMeshInsights({name:e.name}).then((e=>{this.meshInsight=e}));const a=(0,I.wy)(t,["type","name"]),n=()=>{const e=Object.entries((0,I.wy)(t,["mtls","logging","metrics","tracing"])),a=[];return e.forEach((e=>{const t=e[0],n=e[1]||null;if(n&&n.enabledBackend){const e=n.enabledBackend,i=n.backends.find((t=>t.name===e));i&&a.push({label:t,value:{type:i.type,name:i.name}})}else if(n&&n.defaultBackend){const e=n.defaultBackend,i=n.backends.find((t=>t.name===e));i&&a.push({label:t,value:{type:i.type,name:i.name}})}else if(n&&n.backends){const e=n.backends[0];e&&a.push({label:t,value:{type:e.type,name:e.name}})}else a.push({label:t,value:null})})),a},i=()=>{const{routing:e}=t;return e&&e.localityAwareLoadBalancing};this.entity={basicData:a,extendedData:n(),localityEnabled:i()},this.rawEntity=(0,I.RV)(t)}else this.entity={},this.entityIsEmpty=!0})).catch((e=>{this.entityHasError=!0,console.error(e)})).finally((()=>{setTimeout((()=>{this.entityIsLoading=!1}),"500")}));setTimeout((()=>{this.entityIsEmpty=!0,this.entityIsLoading=!1}),"500")},formatValue(e){return e?e.toLocaleString("en").toString():0},readableDate(e){return(0,I.tV)(e)},rawDate(e){return(0,I.Jx)(e)}}},N=a(83744);const M=(0,N.Z)(R,[["render",v],["__scopeId","data-v-0199f7bd"]]);var O=M},49237:function(e,t,a){var n,i;i=a(11665),n=function(){var e;function t(){}return t.LIST_ESCAPEES=["\\","\\\\",'\\"','"',"\0","","","","","","","","\b","\t","\n","\v","\f","\r","","","","","","","","","","","","","","","","","","",(e=String.fromCharCode)(133),e(160),e(8232),e(8233)],t.LIST_ESCAPED=["\\\\",'\\"','\\"','\\"',"\\0","\\x01","\\x02","\\x03","\\x04","\\x05","\\x06","\\a","\\b","\\t","\\n","\\v","\\f","\\r","\\x0e","\\x0f","\\x10","\\x11","\\x12","\\x13","\\x14","\\x15","\\x16","\\x17","\\x18","\\x19","\\x1a","\\e","\\x1c","\\x1d","\\x1e","\\x1f","\\N","\\_","\\L","\\P"],t.MAPPING_ESCAPEES_TO_ESCAPED=function(){var e,a,n,i;for(n={},e=a=0,i=t.LIST_ESCAPEES.length;0<=i?a<i:a>i;e=0<=i?++a:--a)n[t.LIST_ESCAPEES[e]]=t.LIST_ESCAPED[e];return n}(),t.PATTERN_CHARACTERS_TO_ESCAPE=new i("[\\x00-\\x1f]|Â|Â |â¨|â©"),t.PATTERN_MAPPING_ESCAPEES=new i(t.LIST_ESCAPEES.join("|").split("\\").join("\\\\")),t.PATTERN_SINGLE_QUOTING=new i("[\\s'\":{}[\\],&*#?]|^[-?|<>=!%@`]"),t.requiresDoubleQuoting=function(e){return this.PATTERN_CHARACTERS_TO_ESCAPE.test(e)},t.escapeWithDoubleQuotes=function(e){var t;return t=this.PATTERN_MAPPING_ESCAPEES.replace(e,function(e){return function(t){return e.MAPPING_ESCAPEES_TO_ESCAPED[t]}}(this)),'"'+t+'"'},t.requiresSingleQuoting=function(e){return this.PATTERN_SINGLE_QUOTING.test(e)},t.escapeWithSingleQuotes=function(e){return"'"+e.replace(/'/g,"''")+"'"},t}(),e.exports=n},11665:function(e){var t;t=function(){function e(e,t){var a,n,i,s,l,r,o,u,c;null==t&&(t=""),i="",l=e.length,r=null,n=0,s=0;while(s<l){if(a=e.charAt(s),"\\"===a)i+=e.slice(s,+(s+1)+1||9e9),s++;else if("("===a)if(s<l-2)if(u=e.slice(s,+(s+2)+1||9e9),"(?:"===u)s+=2,i+=u;else if("(?<"===u){n++,s+=2,o="";while(s+1<l){if(c=e.charAt(s+1),">"===c){i+="(",s++,o.length>0&&(null==r&&(r={}),r[o]=n);break}o+=c,s++}}else i+=a,n++;else i+=a;else i+=a;s++}this.rawRegex=e,this.cleanedRegex=i,this.regex=new RegExp(this.cleanedRegex,"g"+t.replace("g","")),this.mapping=r}return e.prototype.regex=null,e.prototype.rawRegex=null,e.prototype.cleanedRegex=null,e.prototype.mapping=null,e.prototype.exec=function(e){var t,a,n,i;if(this.regex.lastIndex=0,a=this.regex.exec(e),null==a)return null;if(null!=this.mapping)for(n in i=this.mapping,i)t=i[n],a[n]=a[t];return a},e.prototype.test=function(e){return this.regex.lastIndex=0,this.regex.test(e)},e.prototype.replace=function(e,t){return this.regex.lastIndex=0,e.replace(this.regex,t)},e.prototype.replaceAll=function(e,t,a){var n;null==a&&(a=0),this.regex.lastIndex=0,n=0;while(this.regex.test(e)&&(0===a||n<a))this.regex.lastIndex=0,e=e.replace(this.regex,t),n++;return[e,n]},e}(),e.exports=t}}]);