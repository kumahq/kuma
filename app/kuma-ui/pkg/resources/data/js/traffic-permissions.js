(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["traffic-permissions"],{"1d3a":function(t,e,n){"use strict";n.d(e,"a",(function(){return u}));n("b0c0"),n("96cf");var a=n("c964"),i=n("d0ff"),s=n("bc1e");function r(t){return Object(i["a"])(t).sort((function(t,e){return t.name>e.name||t.name===e.name&&t.mesh>e.mesh?1:-1}))}var o=function(t){return 0!==t.total&&t.items&&t.items.length>0?r(t.items):[]};function l(t){var e=t.getSingleEntity,n=t.getAllEntities,a=t.getAllEntitiesFromMesh,i=t.mesh,s=t.query,r=t.size,o=t.offset,l={size:r,offset:o};return"all"===i?n(l):s&&s.length&&"all"!==i?e(i,s,l):a(i)}function u(t){return c.apply(this,arguments)}function c(){return c=Object(a["a"])(regeneratorRuntime.mark((function t(e){var n,a,i,r,u,c,f,m;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return n=e.getSingleEntity,a=e.getAllEntities,i=e.getAllEntitiesFromMesh,r=e.mesh,u=e.query,c=e.size,f=e.offset,t.next=3,l({getSingleEntity:n,getAllEntities:a,getAllEntitiesFromMesh:i,mesh:r,query:u,size:c,offset:f});case 3:if(m=t.sent,m){t.next=6;break}return t.abrupt("return",{data:[],next:null});case 6:return t.abrupt("return",{data:m.items?o(m):[m],next:m.next&&Object(s["d"])(m.next)});case 7:case"end":return t.stop()}}),t)}))),c.apply(this,arguments)}},3648:function(t,e,n){},"42f1":function(t,e,n){"use strict";n.r(e);var a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"traffic-permissions"},[t.securityWarning?n("div",{staticClass:"alert-wrapper"},[n("KAlert",{attrs:{appearance:"warning"}},[n("template",{slot:"alertMessage"},[n("div",{staticClass:"alert-content"},[n("p",[n("strong",[t._v("All traffic is allowed:")]),t._v(" All service traffic is enabled on this Mesh by default because Mutual TLS is not enabled. Traffic Permissions are currently being ignored by the "),n("strong",[t._v(t._s(t.$route.params.mesh))]),t._v(" Mesh because Mutual TLS is not enabled. You can still create and edit Traffic Permissions, but they will go into effect only when Mutual TLS is enabled on the Mesh. ")])])])],2)],1):t._e(),n("FrameSkeleton",[n("DataOverview",{attrs:{"page-size":t.pageSize,"has-error":t.hasError,"is-loading":t.isLoading,"empty-state":t.empty_state,"display-data-table":!0,"table-data":t.tableData,"table-data-is-empty":t.tableDataIsEmpty,"table-data-function-text":"View","table-data-row":"name"},on:{tableAction:t.tableAction,reloadData:t.loadData}},[n("template",{slot:"additionalControls"},[this.$route.query.ns?n("KButton",{staticClass:"back-button",attrs:{appearance:"primary",size:"small",to:{name:"traffic-permissions"}}},[n("span",{staticClass:"custom-control-icon"},[t._v(" ← ")]),t._v(" View All ")]):t._e()],1),n("template",{slot:"pagination"},[n("Pagination",{attrs:{"has-previous":t.previous.length>0,"has-next":t.hasNext},on:{next:t.goToNextPage,previous:t.goToPreviousPage}})],1)],2),!1===t.isEmpty?n("Tabs",{attrs:{"has-error":t.hasError,"is-loading":t.isLoading,tabs:t.tabs,"initial-tab-override":"overview"}},[n("template",{slot:"tabHeader"},[n("div",[n("h3",[t._v(t._s(t.tabGroupTitle))])]),n("div",[n("EntityURLControl",{attrs:{url:t.shareUrl}})],1)]),n("template",{slot:"overview"},[n("LabelList",{attrs:{"has-error":t.entityHasError,"is-loading":t.entityIsLoading,"is-empty":t.entityIsEmpty}},[n("div",[n("ul",t._l(t.entity,(function(e,a){return n("li",{key:a},[n("h4",[t._v(t._s(a))]),n("p",[t._v(" "+t._s(e)+" ")])])})),0)])])],1),n("template",{slot:"yaml"},[n("YamlView",{attrs:{title:t.entityOverviewTitle,"has-error":t.entityHasError,"is-loading":t.entityIsLoading,"is-empty":t.entityIsEmpty,content:t.rawEntity}})],1)],2):t._e()],1)],1)},i=[],s=(n("99af"),n("b0c0"),n("d3b7"),n("96cf"),n("c964")),r=n("f3f3"),o=n("2f62"),l=n("0f82"),u=n("1d3a"),c=n("bc1e"),f=n("6663"),m=n("1d10"),p=n("1799"),y=n("2778"),h=n("251b"),d=n("ff9d"),g=n("0ada"),v=n("c6ec"),b={name:"TrafficPermissions",metaInfo:{title:"Traffic Permissions"},components:{EntityURLControl:f["a"],FrameSkeleton:m["a"],Pagination:p["a"],DataOverview:y["a"],Tabs:h["a"],YamlView:d["a"],LabelList:g["a"]},data:function(){return{isLoading:!0,isEmpty:!1,hasError:!1,entityIsLoading:!0,entityIsEmpty:!1,entityHasError:!1,tableDataIsEmpty:!1,empty_state:{title:"No Data",message:"There are no Traffic Permissions present."},tableData:{headers:[{key:"actions",hideLabel:!0},{label:"Name",key:"name"},{label:"Mesh",key:"mesh"},{label:"Type",key:"type"}],data:[]},tabs:[{hash:"#overview",title:"Overview"},{hash:"#yaml",title:"YAML"}],entity:[],rawEntity:null,firstEntity:null,pageSize:v["b"],pageOffset:null,next:null,hasNext:!1,previous:[],securityWarning:!1}},computed:Object(r["a"])(Object(r["a"])({},Object(o["c"])({environment:"config/getEnvironment"})),{},{tabGroupTitle:function(){var t=this.entity;return t?"Traffic Permission: ".concat(t.name):null},entityOverviewTitle:function(){var t=this.entity;return t?"Entity Overview for ".concat(t.name):null},shareUrl:function(){var t=this,e="".concat(window.location.origin,"#"),n=this.entity,a=function(){return t.$route.query.ns?t.$route.fullPath:"".concat(e).concat(t.$route.fullPath,"?ns=").concat(n.name)};return a()}}),watch:{$route:function(t,e){this.init()}},beforeMount:function(){this.init()},methods:{init:function(){this.loadData(),this.mtlsWarning()},goToPreviousPage:function(){this.pageOffset=this.previous.pop(),this.next=null,this.loadData()},goToNextPage:function(){this.previous.push(this.pageOffset),this.pageOffset=this.next,this.next=null,this.loadData()},tableAction:function(t){var e=t;this.getEntity(e)},loadData:function(){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function e(){var n,a,i,s,r,o,f;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.isLoading=!0,n=t.$route.query.ns||null,a=t.$route.params.mesh||null,e.prev=3,e.next=6,Object(u["a"])({getSingleEntity:l["a"].getTrafficPermission.bind(l["a"]),getAllEntities:l["a"].getAllTrafficPermissions.bind(l["a"]),getAllEntitiesFromMesh:l["a"].getAllTrafficPermissionsFromMesh.bind(l["a"]),mesh:a,query:n,size:t.pageSize,offset:t.pageOffset});case 6:i=e.sent,s=i.data,r=i.next,t.next=r,t.hasNext=!!r,s.length?(t.tableData.data=s,t.tableDataIsEmpty=!1,t.isEmpty=!1,o=["type","name","mesh"],f=s[0],t.entity=Object(c["e"])(f,o),t.rawEntity=Object(c["j"])(f)):(t.tableData.data=[],t.tableDataIsEmpty=!0,t.isEmpty=!0,t.entityIsEmpty=!0),e.next=19;break;case 14:e.prev=14,e.t0=e["catch"](3),t.hasError=!0,t.isEmpty=!0,console.error(e.t0);case 19:return e.prev=19,t.isLoading=!1,t.entityIsLoading=!1,e.finish(19);case 23:case"end":return e.stop()}}),e,null,[[3,14,19,23]])})))()},getEntity:function(t){var e=this;this.entityIsLoading=!0,this.entityIsEmpty=!1;var n=this.$route.params.mesh;if(t){var a="all"===n?t.mesh:n;return l["a"].getTrafficPermission(a,t.name).then((function(t){if(t){var n=["type","name","mesh"];e.entity=Object(c["e"])(t,n),e.rawEntity=Object(c["j"])(t)}else e.entity=null,e.entityIsEmpty=!0})).catch((function(t){e.entityHasError=!0,console.error(t)})).finally((function(){setTimeout((function(){e.entityIsLoading=!1}),"500")}))}setTimeout((function(){e.entityIsEmpty=!0,e.entityIsLoading=!1}),"500")},mtlsWarning:function(){var t=this,e=this.$route.params.mesh,n="all"!==e&&e;if(n)return l["a"].getMesh(n).then((function(e){var n=function(){var n,a,i=t.environment.toLowerCase(),s=function(){return"universal"===i?!!e.mtls&&e.mtls:"kubernetes"===i&&(!!e.spec.mtls&&e.spec.mtls)};return Boolean((null===(n=s())||void 0===n||null===(a=n.enabledBackend)||void 0===a?void 0:a.length)>0)};n()?t.securityWarning=!1:t.securityWarning=!0}));this.securityWarning=!1}}},E=b,w=(n("f410"),n("2877")),x=Object(w["a"])(E,a,i,!1,null,"e40a0f72",null);e["default"]=x.exports},6663:function(t,e,n){"use strict";var a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"entity-url-control"},[t.shouldDisplay?n("KClipboardProvider",{scopedSlots:t._u([{key:"default",fn:function(e){var a=e.copyToClipboard;return[n("KPop",{attrs:{placement:"bottom"}},[n("KButton",{attrs:{appearance:"secondary",size:"small"},on:{click:function(){a(t.url)}}},[n("KIcon",{attrs:{slot:"icon",icon:"externalLink"},slot:"icon"}),t._v(" "+t._s(t.copyButtonText)+" ")],1),n("div",{attrs:{slot:"content"},slot:"content"},[n("p",[t._v(t._s(t.confirmationText))])])],1)]}}],null,!1,1603401634)}):t._e()],1)},i=[],s=n("a026"),r=s["default"].extend({name:"EntityURLControl",props:{url:{type:String,required:!0},copyButtonText:{type:String,default:"Copy URL"},confirmationText:{type:String,default:"URL copied to clipboard!"}},computed:{shouldDisplay:function(){var t=this.$route.params.mesh||null;return!(!t||"all"===t)}}}),o=r,l=n("2877"),u=Object(l["a"])(o,a,i,!1,null,null,null);e["a"]=u.exports},f410:function(t,e,n){"use strict";n("3648")}}]);