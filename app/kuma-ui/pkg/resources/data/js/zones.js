(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["zones"],{"3f31":function(t,e,n){"use strict";var a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("KEmptyState",{scopedSlots:t._u([{key:"title",fn:function(){return[n("KIcon",{staticClass:"kong-icon--centered",attrs:{icon:"dangerCircle",size:"42"}}),t._v(" "+t._s(t.productName)+" is running in Standalone mode. ")]},proxy:!0},{key:"message",fn:function(){return[n("p",[t._v(" To access this page, you must be running in "),n("strong",[t._v("Multi-Zone")]),t._v(" mode. ")])]},proxy:!0},{key:"cta",fn:function(){return[n("KButton",{attrs:{to:"https://kuma.io/docs/"+t.version+"/documentation/deployments/",target:"_blank",appearance:"primary"}},[t._v(" Learn More ")])]},proxy:!0}])})},r=[],i=n("f3f3"),s=n("2f62"),o=n("c6ec"),c={name:"MultizoneInfo",data:function(){return{productName:o["i"]}},computed:Object(i["a"])({},Object(s["c"])({version:"config/getVersion"}))},u=c,l=n("2877"),p=Object(l["a"])(u,a,r,!1,null,null,null);e["a"]=p.exports},c153:function(t,e,n){"use strict";n.r(e);var a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"zones"},[!1===t.multicluster?n("MultizoneInfo"):n("FrameSkeleton",[n("DataOverview",{attrs:{"page-size":t.pageSize,"has-error":t.hasError,"is-loading":t.isLoading,"empty-state":t.empty_state,"table-data":t.tableData,"table-data-is-empty":t.tableDataIsEmpty,"show-warnings":t.tableData.data.some((function(t){return t.withWarnings})),next:t.next},on:{tableAction:t.tableAction,loadData:function(e){return t.loadData(e)}},scopedSlots:t._u([{key:"additionalControls",fn:function(){return[t.$route.query.ns?n("KButton",{staticClass:"back-button",attrs:{appearance:"primary",size:"small",to:{name:"zones"}}},[n("span",{staticClass:"custom-control-icon"},[t._v(" ← ")]),t._v(" View All ")]):t._e()]},proxy:!0}])}),!1===t.isEmpty?n("Tabs",{attrs:{"has-error":t.hasError,"is-loading":t.isLoading,tabs:t.filterTabs(),"initial-tab-override":"overview"},scopedSlots:t._u([{key:"tabHeader",fn:function(){return[n("div",[n("h3",[t._v(" Zone: "+t._s(t.entity.name))])]),n("div",[n("EntityURLControl",{attrs:{name:t.entity.name}})],1)]},proxy:!0},{key:"overview",fn:function(){return[n("LabelList",{attrs:{"has-error":t.entityHasError,"is-loading":t.entityIsLoading,"is-empty":t.entityIsEmpty}},[n("div",[n("ul",t._l(t.entity,(function(e,a){return n("li",{key:a},[e?n("h4",[t._v(" "+t._s(a)+" ")]):t._e(),"status"===a?n("p",[n("KBadge",{attrs:{appearance:"Offline"===e?"danger":"success"}},[t._v(" "+t._s(e)+" ")])],1):n("p",[t._v(" "+t._s(e)+" ")])])})),0)])])]},proxy:!0},{key:"insights",fn:function(){return[n("KCard",{attrs:{"border-variant":"noBorder"},scopedSlots:t._u([{key:"body",fn:function(){return[n("Accordion",{attrs:{"initially-open":0}},t._l(t.subscriptionsReversed,(function(e,a){return n("AccordionItem",{key:a,scopedSlots:t._u([{key:"accordion-header",fn:function(){return[n("SubscriptionHeader",{attrs:{details:e}})]},proxy:!0},{key:"accordion-content",fn:function(){return[n("SubscriptionDetails",{attrs:{details:e}})]},proxy:!0}],null,!0)})})),1)]},proxy:!0}],null,!1,758213667)})]},proxy:!0},{key:"config",fn:function(){return[t.codeOutput?n("KCard",{attrs:{"border-variant":"noBorder"},scopedSlots:t._u([{key:"body",fn:function(){return[n("Prism",{attrs:{language:"json",code:t.codeOutput}})]},proxy:!0},{key:"actions",fn:function(){return[t.codeOutput?n("KClipboardProvider",{scopedSlots:t._u([{key:"default",fn:function(e){var a=e.copyToClipboard;return[n("KPop",{attrs:{placement:"bottom"},scopedSlots:t._u([{key:"content",fn:function(){return[n("div",[n("p",[t._v("Entity copied to clipboard!")])])]},proxy:!0}],null,!0)},[n("KButton",{attrs:{appearance:"primary"},on:{click:function(){a(t.codeOutput)}}},[t._v(" Copy config to clipboard ")])],1)]}}],null,!1,2834674346)}):t._e()]},proxy:!0}],null,!1,245008237)}):t._e()]},proxy:!0},{key:"warnings",fn:function(){return[n("Warnings",{attrs:{warnings:t.warnings}})]},proxy:!0}],null,!1,2351138538)}):t._e()],1)],1)},r=[],i=(n("4de4"),n("4160"),n("a630"),n("d81d"),n("b0c0"),n("d3b7"),n("6062"),n("3ca3"),n("159b"),n("ddb0"),n("d0af")),s=(n("96cf"),n("c964")),o=n("f3f3"),c=n("2f62"),u=n("bc1e"),l=n("9b02"),p=n.n(l),d=n("2ccf"),y=n.n(d),f=n("0f82"),g=n("1d3a"),b=n("dbf3"),m=n("1d10"),h=n("2778"),v=n("251b"),k=n("520d"),w=n("3ddf"),_=n("6663"),E=n("0ada"),I=n("63b5"),O=n("c6ec"),x=n("0b6d"),S=n("c8b4"),C=n("3f31"),z={name:"Zones",components:{Accordion:k["a"],AccordionItem:w["a"],FrameSkeleton:m["a"],DataOverview:h["a"],Tabs:v["a"],LabelList:E["a"],Warnings:I["a"],Prism:y.a,SubscriptionDetails:x["a"],SubscriptionHeader:S["a"],MultizoneInfo:C["a"],EntityURLControl:_["a"]},metaInfo:{title:"Zones"},data:function(){return{isLoading:!0,isEmpty:!1,hasError:!1,entityIsLoading:!0,entityIsEmpty:!1,entityHasError:!1,tableDataIsEmpty:!1,empty_state:{title:"No Data",message:"There are no Zones present."},tableData:{headers:[{key:"actions",hideLabel:!0},{label:"Status",key:"status"},{label:"Name",key:"name"},{label:"Zone CP Version",key:"zoneCpVersion"},{label:"Backend",key:"backend"},{label:"Ingress",key:"hasIngress"},{key:"warnings",hideLabel:!0}],data:[]},tabs:[{hash:"#overview",title:"Overview"},{hash:"#insights",title:"Zone Insights"},{hash:"#config",title:"Config"},{hash:"#warnings",title:"Warnings"}],entity:{},pageSize:O["g"],next:null,warnings:[],subscriptionsReversed:[],codeOutput:null,zonesWithIngress:new Set}},computed:Object(o["a"])({},Object(c["c"])({multicluster:"config/getMulticlusterStatus",globalCpVersion:"config/getVersion"})),watch:{$route:function(){this.init()}},beforeMount:function(){this.init()},methods:{init:function(){this.multicluster&&this.loadData()},filterTabs:function(){return this.warnings.length?this.tabs:this.tabs.filter((function(t){return"#warnings"!==t.hash}))},tableAction:function(t){var e=t;this.getEntity(e)},parseData:function(t){var e=t.zoneInsight,n=void 0===e?{}:e,a=t.name,r="-",i="";return n.subscriptions&&n.subscriptions.length&&n.subscriptions.forEach((function(t,e){t.version&&t.version.kumaCp&&(r=t.version.kumaCp.version,t.config&&(i=JSON.parse(t.config).store.type))})),Object(o["a"])(Object(o["a"])({},t),{},{status:Object(b["m"])(n).status,zoneCpVersion:r,backend:i,hasIngress:this.zonesWithIngress.has(a)?"Yes":"No",withWarnings:r!==this.globalCpVersion})},calculateZonesWithIngress:function(t){var e=new Set;t.forEach((function(t){var n=t.name;e.add(n)})),this.zonesWithIngress=e},loadData:function(){var t=arguments,e=this;return Object(s["a"])(regeneratorRuntime.mark((function n(){var a,r,s,o,c,l,p,d;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return a=t.length>0&&void 0!==t[0]?t[0]:"0",e.isLoading=!0,e.isEmpty=!1,r=e.$route.query.ns||null,n.prev=4,n.next=7,Promise.all([Object(g["a"])({getSingleEntity:f["a"].getZoneOverview.bind(f["a"]),getAllEntities:f["a"].getAllZoneOverviews.bind(f["a"]),size:e.pageSize,offset:a,query:r}),Object(u["c"])({callEndpoint:f["a"].getAllZoneIngressOverviews.bind(f["a"])})]);case 7:s=n.sent,o=Object(i["a"])(s,2),c=o[0],l=c.data,p=c.next,d=o[1].items,e.next=p,l.length?(e.calculateZonesWithIngress(d),e.tableData.data=l.map(e.parseData),e.tableDataIsEmpty=!1,e.isEmpty=!1,e.getEntity({name:l[0].name})):(e.tableData.data=[],e.tableDataIsEmpty=!0,e.isEmpty=!0,e.entityIsEmpty=!0),n.next=22;break;case 17:n.prev=17,n.t0=n["catch"](4),e.hasError=!0,e.isEmpty=!0,console.error(n.t0);case 22:return n.prev=22,e.isLoading=!1,n.finish(22);case 25:case"end":return n.stop()}}),n,null,[[4,17,22,25]])})))()},getEntity:function(t){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function n(){var a,r,i,s,c,l,d,y,g;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(e.entityIsLoading=!0,e.entityIsEmpty=!0,a=["type","name"],r=setTimeout((function(){e.entityIsEmpty=!0,e.entityIsLoading=!1}),"500"),!t){n.next=26;break}return e.entityIsEmpty=!1,e.warnings=[],n.prev=7,n.next=10,f["a"].getZoneOverview({name:t.name});case 10:i=n.sent,s=p()(i,"zoneInsight.subscriptions",[]),e.entity=Object(o["a"])(Object(o["a"])({},Object(u["d"])(i,a)),{},{"Authentication Type":Object(u["e"])(i)}),e.subscriptionsReversed=Array.from(s).reverse(),s.length&&(c=s[s.length-1].version,l=void 0===c?{}:c,d=l.kumaCp,y=void 0===d?{}:d,g=y.version||"-",g!==e.globalCpVersion&&e.warnings.push({kind:b["e"],payload:{zoneCpVersion:g,globalCpVersion:e.globalCpVersion}}),s[s.length-1].config&&(e.codeOutput=JSON.stringify(JSON.parse(s[s.length-1].config),null,2))),n.next=23;break;case 17:n.prev=17,n.t0=n["catch"](7),console.error(n.t0),e.entity={},e.entityHasError=!0,e.entityIsEmpty=!0;case 23:return n.prev=23,clearTimeout(r),n.finish(23);case 26:e.entityIsLoading=!1;case 27:case"end":return n.stop()}}),n,null,[[7,17,23,26]])})))()}}},D=z,j=n("2877"),L=Object(j["a"])(D,a,r,!1,null,null,null);e["default"]=L.exports}}]);