import{_ as T,r as C,o as d,p as v,w as g,l as s,a as x,e as o,d as w,k as X,q as b,t as a,m as n,c as f,J as m,K as q,n as j,b as z}from"./index-yoi81zLz.js";import{T as J}from"./TagList-6Hx9J9sm.js";const W=["B","kB","MB","GB","TB","PB","EB","ZB","YB"],H=["B","KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"],Q=["b","kbit","Mbit","Gbit","Tbit","Pbit","Ebit","Zbit","Ybit"],R=["b","kibit","Mibit","Gibit","Tibit","Pibit","Eibit","Zibit","Yibit"],Z=(r,t,e)=>{let u=r;return typeof t=="string"||Array.isArray(t)?u=r.toLocaleString(t,e):(t===!0||e!==void 0)&&(u=r.toLocaleString(void 0,e)),u};function k(r,t){if(!Number.isFinite(r))throw new TypeError(`Expected a finite number, got ${typeof r}: ${r}`);t={bits:!1,binary:!1,space:!0,...t};const e=t.bits?t.binary?R:Q:t.binary?H:W,u=t.space?" ":"";if(t.signed&&r===0)return` 0${u}${e[0]}`;const _=r<0,i=_?"-":t.signed?"+":"";_&&(r=-r);let c;if(t.minimumFractionDigits!==void 0&&(c={minimumFractionDigits:t.minimumFractionDigits}),t.maximumFractionDigits!==void 0&&(c={maximumFractionDigits:t.maximumFractionDigits,...c}),r<1){const B=Z(r,t.locale,c);return i+B+u+e[0]}const p=Math.min(Math.floor(t.binary?Math.log(r)/Math.log(1024):Math.log10(r)/3),e.length-1);r/=(t.binary?1024:1e3)**p,c||(r=r.toPrecision(3));const y=Z(Number(r),t.locale,c),$=e[p];return i+y+u+$}const h={},tt={class:"card"},et={class:"title"},it={class:"body"};function st(r,t){const e=C("KCard");return d(),v(e,{class:"data-card"},{default:g(()=>[s("dl",null,[s("div",tt,[s("dt",et,[x(r.$slots,"title",{},void 0,!0)]),t[0]||(t[0]=o()),s("dd",it,[x(r.$slots,"default",{},void 0,!0)])])])]),_:3})}const A=T(h,[["render",st],["__scopeId","data-v-3f9a3cf3"]]),rt={class:"title"},ot={key:0},nt={"data-testid":"grpc-success"},at={"data-testid":"grpc-failure"},dt={"data-testid":"rq-2xx"},lt={"data-testid":"rq-4xx"},ct={"data-testid":"rq-5xx"},ft={"data-testid":"connections-total"},ut={key:0,"data-testid":"bytes-received"},_t={key:1,"data-testid":"bytes-sent"},pt=w({__name:"ConnectionCard",props:{protocol:{},service:{default:""},traffic:{default:void 0},direction:{default:"downstream"}},setup(r){const{t}=X(),e=r,u=_=>{const i=_.target;if(_.isTrusted&&i.nodeName.toLowerCase()!=="a"){const c=i.closest(".service-traffic-card, a");if(c){const p=c.nodeName.toLowerCase()==="a"?c:c.querySelector("[data-action]");p!==null&&"click"in p&&typeof p.click=="function"&&p.click()}}};return(_,i)=>{const c=C("XBadge"),p=C("KSkeletonBox");return d(),v(A,{class:"service-traffic-card",onClick:u},{title:g(()=>[e.service.length>0?(d(),v(J,{key:0,tags:[{label:"kuma.io/service",value:e.service}]},null,8,["tags"])):b("",!0),i[1]||(i[1]=o()),s("div",rt,[e.protocol!==""?(d(),v(c,{key:0,class:"protocol",appearance:e.protocol==="passthrough"?"success":"info"},{default:g(()=>[o(a(n(t)(`data-planes.components.service_traffic_card.protocol.${e.protocol}`,{},{defaultMessage:n(t)(`http.api.value.${e.protocol}`)})),1)]),_:1},8,["appearance"])):b("",!0),i[0]||(i[0]=o()),x(_.$slots,"default",{},void 0,!0)])]),default:g(()=>{var y,$,B,M,E,D,F,K,L,G,Y,P;return[i[22]||(i[22]=o()),e.traffic?(d(),f("dl",ot,[e.protocol==="passthrough"?(d(!0),f(m,{key:0},q([["http","tcp"].reduce((l,S)=>{var V;const U=e.direction;return Object.entries(((V=e.traffic)==null?void 0:V[S])||{}).reduce((I,[N,O])=>[`${U}_cx_tx_bytes_total`,`${U}_cx_rx_bytes_total`].includes(N)?{...I,[N]:O+(I[N]??0)}:I,l)},{})],(l,S)=>(d(),f(m,{key:S},[s("div",null,[s("dt",null,a(n(t)("data-planes.components.service_traffic_card.tx")),1),i[2]||(i[2]=o()),s("dd",null,a(n(k)(l.downstream_cx_rx_bytes_total??0)),1)]),i[4]||(i[4]=o()),s("div",null,[s("dt",null,a(n(t)("data-planes.components.service_traffic_card.rx")),1),i[3]||(i[3]=o()),s("dd",null,a(n(k)(l.downstream_cx_tx_bytes_total??0)),1)])],64))),128)):e.protocol==="grpc"?(d(),f(m,{key:1},[s("div",nt,[s("dt",null,a(n(t)("data-planes.components.service_traffic_card.grpc_success")),1),i[5]||(i[5]=o()),s("dd",null,a(n(t)("common.formats.integer",{value:(y=e.traffic.grpc)==null?void 0:y.success})),1)]),i[7]||(i[7]=o()),s("div",at,[s("dt",null,a(n(t)("data-planes.components.service_traffic_card.grpc_failure")),1),i[6]||(i[6]=o()),s("dd",null,a(n(t)("common.formats.integer",{value:($=e.traffic.grpc)==null?void 0:$.failure})),1)])],64)):e.protocol.startsWith("http")?(d(),f(m,{key:2},[(d(!0),f(m,null,q([((B=e.traffic.http)==null?void 0:B[`${e.direction}_rq_1xx`])??0].filter(l=>l!==0),l=>(d(),f("div",{key:l,"data-testid":"rq-1xx"},[s("dt",null,a(n(t)("data-planes.components.service_traffic_card.1xx")),1),i[8]||(i[8]=o()),s("dd",null,a(n(t)("common.formats.integer",{value:l})),1)]))),128)),i[13]||(i[13]=o()),s("div",dt,[s("dt",null,a(n(t)("data-planes.components.service_traffic_card.2xx")),1),i[9]||(i[9]=o()),s("dd",null,a(n(t)("common.formats.integer",{value:(M=e.traffic.http)==null?void 0:M[`${e.direction}_rq_2xx`]})),1)]),i[14]||(i[14]=o()),(d(!0),f(m,null,q([((E=e.traffic.http)==null?void 0:E[`${e.direction}_rq_3xx`])??0].filter(l=>l!==0),l=>(d(),f("div",{key:l,"data-testid":"rq-3xx"},[s("dt",null,a(n(t)("data-planes.components.service_traffic_card.3xx")),1),i[10]||(i[10]=o()),s("dd",null,a(n(t)("common.formats.integer",{value:l})),1)]))),128)),i[15]||(i[15]=o()),s("div",lt,[s("dt",null,a(n(t)("data-planes.components.service_traffic_card.4xx")),1),i[11]||(i[11]=o()),s("dd",null,a(n(t)("common.formats.integer",{value:(D=e.traffic.http)==null?void 0:D[`${e.direction}_rq_4xx`]})),1)]),i[16]||(i[16]=o()),s("div",ct,[s("dt",null,a(n(t)("data-planes.components.service_traffic_card.5xx")),1),i[12]||(i[12]=o()),s("dd",null,a(n(t)("common.formats.integer",{value:(F=e.traffic.http)==null?void 0:F[`${e.direction}_rq_5xx`]})),1)])],64)):(d(),f(m,{key:3},[s("div",ft,[s("dt",null,a(n(t)("data-planes.components.service_traffic_card.cx")),1),i[17]||(i[17]=o()),s("dd",null,a(n(t)("common.formats.integer",{value:(K=e.traffic.tcp)==null?void 0:K[`${e.direction}_cx_total`]})),1)]),i[20]||(i[20]=o()),typeof((L=e.traffic.tcp)==null?void 0:L[`${e.direction}_cx_tx_bytes_total`])<"u"?(d(),f("div",ut,[s("dt",null,a(n(t)("data-planes.components.service_traffic_card.rx")),1),i[18]||(i[18]=o()),s("dd",null,a(n(k)((G=e.traffic.tcp)==null?void 0:G[`${e.direction}_cx_tx_bytes_total`])),1)])):b("",!0),i[21]||(i[21]=o()),typeof((Y=e.traffic.tcp)==null?void 0:Y[`${e.direction}_cx_rx_bytes_total`])<"u"?(d(),f("div",_t,[s("dt",null,a(n(t)("data-planes.components.service_traffic_card.tx")),1),i[19]||(i[19]=o()),s("dd",null,a(n(k)((P=e.traffic.tcp)==null?void 0:P[`${e.direction}_cx_rx_bytes_total`])),1)])):b("",!0)],64))])):(d(),v(p,{key:1,width:"10"}))]}),_:3})}}}),bt=T(pt,[["__scopeId","data-v-649f9d2a"]]),mt={class:"body"},xt=w({__name:"ConnectionGroup",props:{type:{}},setup(r){const t=r;return(e,u)=>{const _=C("KCard");return d(),v(_,{class:j(["service-traffic-group",`type-${t.type}`])},{default:g(()=>[s("div",mt,[x(e.$slots,"default",{},void 0,!0)])]),_:3},8,["class"])}}}),kt=T(xt,[["__scopeId","data-v-a119a970"]]),vt={class:"service-traffic"},gt={class:"actions"},yt=w({__name:"ConnectionTraffic",setup(r){return(t,e)=>(d(),f("div",vt,[s("div",gt,[x(t.$slots,"actions",{},void 0,!0)]),e[0]||(e[0]=o()),z(A,{class:"header"},{title:g(()=>[x(t.$slots,"title",{},void 0,!0)]),_:3}),e[1]||(e[1]=o()),x(t.$slots,"default",{},void 0,!0)]))}}),Ct=T(yt,[["__scopeId","data-v-e6bd176c"]]);export{Ct as C,kt as a,bt as b};
