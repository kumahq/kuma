import{d as E,r as t,o as n,m as u,w as a,b as r,e as i,l as y,aA as K,c as _,L as h,M as v,T as M,ax as X,A as $,a2 as q,t as l,p as g,E as G,k as H}from"./index-C4A671Or.js";import{S as F}from"./SummaryView-X08ua3le.js";const I=["innerHTML"],O=E({__name:"MeshExternalServiceListView",props:{mesh:{}},setup(w){const x=w;return(P,Z)=>{const b=t("RouteTitle"),f=t("XAction"),C=t("KBadge"),V=t("XActionGroup"),A=t("RouterView"),D=t("DataCollection"),L=t("DataLoader"),R=t("KCard"),S=t("AppView"),B=t("DataSource"),N=t("RouteView");return n(),u(N,{name:"mesh-external-service-list-view",params:{page:1,size:50,mesh:"",service:""}},{default:a(({route:o,t:m,can:T,uri:z,me:p})=>[r(b,{render:!1,title:m("services.routes.mesh-external-service-list-view.title")},null,8,["title"]),i(),r(B,{src:z(y(K),"/zone-cps/:name/egresses",{name:"*"},{page:1,size:100})},{default:a(({data:k})=>[(n(!0),_(h,null,v([[[m("services.mesh-external-service.notifications.mtls-warning"),typeof x.mesh.mtlsBackend>"u"],[m("services.mesh-external-service.notifications.no-zone-egress"),k&&!k.items.find(c=>typeof c.zoneEgressInsight.connectedSubscription<"u")]].filter(([c,s])=>s).map(c=>c[0])],c=>(n(),u(S,{key:typeof c,docs:m("services.mesh-external-service.href.docs")},M({default:a(()=>[i(),r(R,null,{default:a(()=>[r(L,{src:z(y(X),"/meshes/:mesh/mesh-external-services",{mesh:o.params.mesh},{page:o.params.page,size:o.params.size})},{loadable:a(({data:s})=>[r(D,{type:"services",items:(s==null?void 0:s.items)??[void 0],page:o.params.page,"page-size":o.params.size,total:s==null?void 0:s.total,onChange:o.update},{default:a(()=>[r($,{"data-testid":"service-collection",headers:[{...p.get("headers.name"),label:"Name",key:"name"},{...p.get("headers.namespace"),label:"Namespace",key:"namespace"},...T("use zones")?[{...p.get("headers.zone"),label:"Zone",key:"zone"}]:[],{...p.get("headers.port"),label:"Port",key:"port"},{...p.get("headers.actions"),label:"Actions",key:"actions",hideLabel:!0}],items:s==null?void 0:s.items,"is-selected-row":e=>e.name===o.params.service,onResize:p.set},{name:a(({row:e})=>[r(q,{text:e.name},{default:a(()=>[r(f,{"data-action":"",to:{name:"mesh-external-service-summary-view",params:{mesh:e.mesh,service:e.id},query:{page:o.params.page,size:o.params.size}}},{default:a(()=>[i(l(e.name),1)]),_:2},1032,["to"])]),_:2},1032,["text"])]),namespace:a(({row:e})=>[i(l(e.namespace),1)]),zone:a(({row:e})=>[e.labels&&e.labels["kuma.io/origin"]==="zone"&&e.labels["kuma.io/zone"]?(n(),_(h,{key:0},[e.labels["kuma.io/zone"]?(n(),u(f,{key:0,to:{name:"zone-cp-detail-view",params:{zone:e.labels["kuma.io/zone"]}}},{default:a(()=>[i(l(e.labels["kuma.io/zone"]),1)]),_:2},1032,["to"])):g("",!0)],64)):(n(),_(h,{key:1},[i(l(m("common.detail.none")),1)],64))]),port:a(({row:e})=>[e.spec.match?(n(!0),_(h,{key:0},v([e.spec.match],d=>(n(),u(C,{key:d.port,appearance:"info"},{default:a(()=>[i(l(d.port)+"/"+l(d.protocol),1)]),_:2},1024))),128)):g("",!0)]),actions:a(({row:e})=>[r(V,null,{default:a(()=>[r(f,{to:{name:"mesh-external-service-detail-view",params:{mesh:e.mesh,service:e.id}}},{default:a(()=>[i(l(m("common.collection.actions.view")),1)]),_:2},1032,["to"])]),_:2},1024)]),_:2},1032,["headers","items","is-selected-row","onResize"]),i(),s!=null&&s.items&&o.params.service?(n(),u(A,{key:0},{default:a(e=>[r(F,{onClose:d=>o.replace({name:"mesh-external-service-list-view",params:{mesh:o.params.mesh},query:{page:o.params.page,size:o.params.size}})},{default:a(()=>[(n(),u(G(e.Component),{items:s==null?void 0:s.items},null,8,["items"]))]),_:2},1032,["onClose"])]),_:2},1024)):g("",!0)]),_:2},1032,["items","page","page-size","total","onChange"])]),_:2},1032,["src"])]),_:2},1024)]),_:2},[c.length>0?{name:"notifications",fn:a(()=>[H("ul",null,[(n(!0),_(h,null,v(c,s=>(n(),_("li",{key:s,innerHTML:s},null,8,I))),128))])]),key:"0"}:void 0]),1032,["docs"]))),128))]),_:2},1032,["src"])]),_:1})}}});export{O as default};
