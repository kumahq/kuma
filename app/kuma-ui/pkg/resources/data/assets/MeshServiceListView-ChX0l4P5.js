import{d as D,r as n,p as _,o as c,w as s,b as o,e as r,l as y,I as q,m as K,ac as M,q as T,K as G,t as p,c as f,N as z,L as I,y as E,_ as F}from"./index-CYOTm_Oc.js";import{S as Z}from"./SummaryView-DH_KOFMg.js";const $=D({__name:"MeshServiceListView",setup(j){return(H,l)=>{const C=n("RouteTitle"),k=n("XSearch"),d=n("XAction"),b=n("XCopyButton"),X=n("XBadge"),V=n("KumaPort"),h=n("XLayout"),x=n("XActionGroup"),A=n("RouterView"),L=n("DataCollection"),S=n("DataLoader"),B=n("XCard"),N=n("AppView"),P=n("RouteView");return c(),_(P,{name:"mesh-service-list-view",params:{page:1,size:Number,mesh:"",service:"",s:""}},{default:s(({route:a,t:u,can:v,uri:R,me:i})=>[o(C,{render:!1,title:u("services.routes.mesh-service-list-view.title")},null,8,["title"]),l[9]||(l[9]=r()),o(N,{docs:u("services.mesh-service.href.docs")},{default:s(()=>[o(B,null,{default:s(()=>[o(h,null,{default:s(()=>[y("search",null,[y("form",{onSubmit:l[0]||(l[0]=q(()=>{},["prevent"]))},[o(k,{class:"search-field",keys:["name","namespace",...v("use zones")?["zone"]:[],"label"],value:a.params.s,onChange:t=>a.update({s:t})},null,8,["keys","value","onChange"])],32)]),l[8]||(l[8]=r()),o(S,{src:R(K(M),"/meshes/:mesh/mesh-services",{mesh:a.params.mesh},{page:a.params.page,size:a.params.size,search:a.params.s})},{loadable:s(({data:t})=>[o(L,{type:"services",items:(t==null?void 0:t.items)??[void 0],page:a.params.page,"page-size":a.params.size,total:t==null?void 0:t.total,onChange:a.update},{default:s(()=>[o(G,{"data-testid":"service-collection",headers:[{...i.get("headers.name"),label:"Name",key:"name"},{...i.get("headers.namespace"),label:"Namespace",key:"namespace"},...v("use zones")?[{...i.get("headers.zone"),label:"Zone",key:"zone"}]:[],{...i.get("headers.state"),label:"State",key:"state"},{...i.get("headers.status"),label:"DP proxies (connected / healthy / total)",key:"status"},{...i.get("headers.ports"),label:"Ports",key:"ports"},{...i.get("headers.actions"),label:"Actions",key:"actions",hideLabel:!0}],items:t==null?void 0:t.items,"is-selected-row":e=>e.name===a.params.service,onResize:i.set},{name:s(({row:e})=>[o(b,{text:e.name},{default:s(()=>[o(d,{"data-action":"",to:{name:"mesh-service-summary-view",params:{mesh:e.mesh,service:e.id},query:{page:a.params.page,size:a.params.size,s:a.params.s}}},{default:s(()=>[r(p(e.name),1)]),_:2},1032,["to"])]),_:2},1032,["text"])]),namespace:s(({row:e})=>[r(p(e.namespace),1)]),zone:s(({row:e})=>[e.zone?(c(),_(d,{key:0,to:{name:"zone-cp-detail-view",params:{zone:e.zone}}},{default:s(()=>[r(p(e.zone),1)]),_:2},1032,["to"])):(c(),f(z,{key:1},[r(p(u("common.detail.none")),1)],64))]),state:s(({row:e})=>[o(X,{appearance:e.spec.state==="Available"?"success":"danger"},{default:s(()=>[r(p(e.spec.state),1)]),_:2},1032,["appearance"])]),status:s(({row:e})=>{var m,g,w;return[r(p((m=e.status.dataplaneProxies)==null?void 0:m.connected)+" / "+p((g=e.status.dataplaneProxies)==null?void 0:g.healthy)+" / "+p((w=e.status.dataplaneProxies)==null?void 0:w.total),1)]}),ports:s(({row:e})=>[o(h,{type:"separated",truncate:""},{default:s(()=>[(c(!0),f(z,null,I(e.spec.ports,m=>(c(),_(V,{key:m.port,port:{...m,targetPort:void 0}},null,8,["port"]))),128))]),_:2},1024)]),actions:s(({row:e})=>[o(x,null,{default:s(()=>[o(d,{to:{name:"mesh-service-detail-view",params:{mesh:e.mesh,service:e.id}}},{default:s(()=>[r(p(u("common.collection.actions.view")),1)]),_:2},1032,["to"])]),_:2},1024)]),_:2,__:[1,2,3,4,5,6]},1032,["headers","items","is-selected-row","onResize"]),l[7]||(l[7]=r()),t!=null&&t.items&&a.params.service?(c(),_(A,{key:0},{default:s(e=>[o(Z,{onClose:m=>a.replace({name:"mesh-service-list-view",params:{mesh:a.params.mesh},query:{page:a.params.page,size:a.params.size,s:a.params.s}})},{default:s(()=>[(c(),_(E(e.Component),{items:t==null?void 0:t.items},null,8,["items"]))]),_:2},1032,["onClose"])]),_:2},1024)):T("",!0)]),_:2,__:[7]},1032,["items","page","page-size","total","onChange"])]),_:2},1032,["src"])]),_:2,__:[8]},1024)]),_:2},1024)]),_:2},1032,["docs"])]),_:1,__:[9]})}}}),Q=F($,[["__scopeId","data-v-1f94718b"]]);export{Q as default};
