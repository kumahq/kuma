import{d as q,r as l,o as r,p as f,w as e,b as a,Q as A,e as t,t as i,S as F,q as w,c,J as y,m as U,$ as G,K as v,l as J,A as K,F as P}from"./index-Ch1waQC_.js";import{S as Q}from"./SummaryView-CvxHxN3s.js";import{C as E,b as D,a as Z}from"./ConnectionTraffic-BHxcCgZG.js";import"./TagList-Cw8tefL6.js";const H={key:0},se=q({__name:"ZoneEgressDetailView",props:{data:{}},setup(I){const p=I;return(M,s)=>{const x=l("XBadge"),B=l("XCopyButton"),S=l("XAboutCard"),V=l("DataCollection"),C=l("XLayout"),R=l("XInputSwitch"),X=l("XAction"),T=l("XCard"),$=l("DataLoader"),L=l("RouterView"),N=l("AppView"),O=l("RouteView");return r(),f(O,{name:"zone-egress-detail-view",params:{subscription:"",zoneEgress:"",inactive:!1}},{default:e(({t:d,route:m,me:_,uri:j})=>[a(N,null,{default:e(()=>[a(C,{type:"stack"},{default:e(()=>[a(S,{title:d("zone-egresses.routes.item.about.title"),created:p.data.creationTime,modified:p.data.modificationTime},{default:e(()=>[a(A,{layout:"horizontal"},{title:e(()=>[t(i(d("http.api.property.status")),1)]),body:e(()=>[a(F,{status:p.data.state},null,8,["status"])]),_:2},1024),s[3]||(s[3]=t()),p.data.namespace.length>0?(r(),f(A,{key:0,layout:"horizontal"},{title:e(()=>[t(i(d("http.api.property.namespace")),1)]),body:e(()=>[a(x,{appearance:"decorative"},{default:e(()=>[t(i(p.data.namespace),1)]),_:1})]),_:2},1024)):w("",!0),s[4]||(s[4]=t()),a(A,{layout:"horizontal"},{title:e(()=>[t(i(d("http.api.property.address")),1)]),body:e(()=>[p.data.zoneEgress.socketAddress.length>0?(r(),f(B,{key:0,variant:"badge",format:"default",text:p.data.zoneEgress.socketAddress},null,8,["text"])):(r(),c(y,{key:1},[t(i(d("common.detail.none")),1)],64))]),_:2},1024)]),_:2},1032,["title","created","modified"]),s[16]||(s[16]=t()),a($,{src:j(U(G),"/connections/stats/for/zone-egress/:name/:socketAddress",{name:m.params.zoneEgress,socketAddress:p.data.zoneEgress.socketAddress})},{default:e(({data:o,refresh:u})=>[a(T,null,{default:e(()=>[a(C,{type:"columns"},{default:e(()=>[a(E,null,{default:e(()=>[a(C,{type:"stack",size:"small"},{default:e(()=>[a(V,{type:"inbounds",items:Object.entries(o.inbounds)},{default:e(({items:n})=>[(r(!0),c(y,null,v(n,([z,g])=>(r(),f(D,{key:`${z}`,protocol:"",traffic:g},{default:e(()=>[t(`
                        :`+i(z.split("_").at(-1)),1)]),_:2},1032,["traffic"]))),128))]),_:2},1032,["items"])]),_:2},1024)]),_:2},1024),s[9]||(s[9]=t()),a(E,null,{actions:e(()=>[a(R,{modelValue:m.params.inactive,"onUpdate:modelValue":n=>m.params.inactive=n,"data-testid":"dataplane-outbounds-inactive-toggle"},{label:e(()=>s[5]||(s[5]=[t(`
                      Show inactive
                    `)])),_:2},1032,["modelValue","onUpdate:modelValue"]),s[7]||(s[7]=t()),a(X,{action:"refresh",appearance:"primary",onClick:u},{default:e(()=>s[6]||(s[6]=[t(`
                    Refresh
                  `)])),_:2},1032,["onClick"])]),default:e(()=>[s[8]||(s[8]=t()),(r(),c(y,null,v(["upstream"],n=>a(V,{key:n,type:"outbounds",items:Object.entries(o.outbounds)},{default:e(({items:z})=>[a(V,{type:"activeOutbounds",predicate:m.params.inactive?void 0:([g,b])=>{var k,h;return((typeof b.tcp<"u"?(k=b.tcp)==null?void 0:k[`${n}_cx_rx_bytes_total`]:(h=b.http)==null?void 0:h[`${n}_rq_total`])??0)>0},items:z},{default:e(({items:g})=>[g.length>0?(r(),f(Z,{key:0,type:"outbound"},{default:e(()=>[(r(),c(y,null,v([/-([a-f0-9]){16}$/],b=>a(C,{key:b,type:"stack",size:"small"},{default:e(()=>[(r(!0),c(y,null,v(g,([k,h])=>(r(),f(D,{key:`${k}`,"data-testid":"dataplane-outbound",protocol:"",traffic:h,direction:n},{default:e(()=>[t(i(k),1)]),_:2},1032,["traffic","direction"]))),128))]),_:2},1024)),64))]),_:2},1024)):w("",!0)]),_:2},1032,["predicate","items"])]),_:2},1032,["items"])),64))]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1032,["src"]),s[17]||(s[17]=t()),p.data.zoneEgressInsight.subscriptions.length>0?(r(),c("div",H,[J("h2",null,i(d("zone-egresses.routes.item.subscriptions.title")),1),s[14]||(s[14]=t()),a(K,{headers:[{..._.get("headers.instanceId"),label:d("http.api.property.instanceId"),key:"instanceId"},{..._.get("headers.version"),label:d("http.api.property.version"),key:"version"},{..._.get("headers.connected"),label:d("http.api.property.connected"),key:"connected"},{..._.get("headers.disconnected"),label:d("http.api.property.disconnected"),key:"disconnected"},{..._.get("headers.responses"),label:d("http.api.property.responses"),key:"responses"}],"is-selected-row":o=>o.id===m.params.subscription,items:p.data.zoneEgressInsight.subscriptions.map((o,u,n)=>n[n.length-(u+1)]),onResize:_.set},{instanceId:e(({row:o})=>[a(X,{"data-action":"",to:{name:"zone-egress-subscription-summary-view",params:{subscription:o.id}}},{default:e(()=>[t(i(o.controlPlaneInstanceId),1)]),_:2},1032,["to"])]),version:e(({row:o})=>{var u,n;return[t(i(((n=(u=o.version)==null?void 0:u.kumaDp)==null?void 0:n.version)??"-"),1)]}),connected:e(({row:o})=>[t(i(d("common.formats.datetime",{value:Date.parse(o.connectTime??"")})),1)]),disconnected:e(({row:o})=>[o.disconnectTime?(r(),c(y,{key:0},[t(i(d("common.formats.datetime",{value:Date.parse(o.disconnectTime)})),1)],64)):w("",!0)]),responses:e(({row:o})=>{var u;return[(r(!0),c(y,null,v([((u=o.status)==null?void 0:u.total)??{}],n=>(r(),c(y,null,[t(i(n.responsesSent)+"/"+i(n.responsesAcknowledged),1)],64))),256))]}),_:2},1032,["headers","is-selected-row","items","onResize"]),s[15]||(s[15]=t()),a(L,null,{default:e(({Component:o})=>[m.child()?(r(),f(Q,{key:0,width:"670px",onClose:function(){m.replace({name:"zone-egress-detail-view",params:{zoneEgress:m.params.zoneEgress}})}},{default:e(()=>[(r(),f(P(o),{data:p.data.zoneEgressInsight.subscriptions},null,8,["data"]))]),_:2},1032,["onClose"])):w("",!0)]),_:2},1024)])):w("",!0)]),_:2},1024)]),_:2},1024)]),_:1})}}});export{se as default};
