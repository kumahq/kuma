import{d as O,D as T,r as c,o as s,m as g,w as e,b as a,k as C,e as o,l as I,z as W,O as j,c as f,F as y,t as p,p as b,A as J,s as V,P as Q,S as U,E as Y,q as ee}from"./index--1DEc0sn.js";import{S as ne}from"./SummaryView-D30ZTwxO.js";const te=["innerHTML"],oe=["data-testid"],se=["innerHTML"],ae=O({__name:"ZoneListView",setup(ie){const X=T({}),D=T({}),A=v=>{const h="zoneIngress";X.value=v.items.reduce((d,u)=>{var z;const l=(z=u[h])==null?void 0:z.zone;if(typeof l<"u"){typeof d[l]>"u"&&(d[l]={online:[],offline:[]});const w=typeof u[`${h}Insight`].connectedSubscription<"u"?"online":"offline";d[l][w].push(u)}return d},{})},x=v=>{const h="zoneEgress";D.value=v.items.reduce((d,u)=>{var z;const l=(z=u[h])==null?void 0:z.zone;if(typeof l<"u"){typeof d[l]>"u"&&(d[l]={online:[],offline:[]});const w=typeof u[`${h}Insight`].connectedSubscription<"u"?"online":"offline";d[l][w].push(u)}return d},{})};return(v,h)=>{const d=c("RouteTitle"),u=c("DataSource"),l=c("XAction"),z=c("XTeleportTemplate"),w=c("XIcon"),R=c("DataLoader"),$=c("XPrompt"),B=c("DataSink"),E=c("XDisclosure"),M=c("XActionGroup"),N=c("KCard"),Z=c("RouterView"),H=c("AppView"),P=c("RouteView");return s(),g(P,{name:"zone-cp-list-view",params:{page:1,size:50,zone:""}},{default:e(({route:r,t:i,can:k,uri:q,me:_})=>[a(H,{docs:i("zones.href.docs.cta")},{title:e(()=>[C("h1",null,[a(d,{title:i("zone-cps.routes.items.title")},null,8,["title"])])]),default:e(()=>[o(),a(u,{src:q(I(W),"/zone-cps",{},{page:r.params.page,size:r.params.size})},{default:e(({data:m,error:S,refresh:F})=>[a(u,{src:"/zone-ingress-overviews?page=1&size=100",onChange:A}),o(),a(u,{src:"/zone-egress-overviews?page=1&size=100",onChange:x}),o(),C("div",{innerHTML:i("zone-cps.routes.items.intro",{},{defaultMessage:""})},null,8,te),o(),a(N,null,{default:e(()=>[S!==void 0?(s(),g(j,{key:0,error:S},null,8,["error"])):(s(),f(y,{key:1},[k("create zones")&&((m==null?void 0:m.items)??[]).length>0?(s(),g(z,{key:0,to:{name:"zone-cp-list-view-actions"}},{default:e(()=>[a(l,{type:"create",appearance:"primary",to:{name:"zone-create-view"},"data-testid":"create-zone-link"},{default:e(()=>[o(p(i("zones.index.create")),1)]),_:2},1024)]),_:2},1024)):b("",!0),o(),a(J,{class:"zone-cp-collection","data-testid":"zone-cp-collection",headers:[{..._.get("headers.type"),label:"Â ",key:"type"},{..._.get("headers.name"),label:"Name",key:"name"},{..._.get("headers.zoneCpVersion"),label:"Zone Leader CP Version",key:"zoneCpVersion"},{..._.get("headers.ingress"),label:"Ingresses (online / total)",key:"ingress"},{..._.get("headers.egress"),label:"Egresses (online / total)",key:"egress"},{..._.get("headers.state"),label:"Status",key:"state"},{..._.get("headers.warnings"),label:"Warnings",key:"warnings",hideLabel:!0},{..._.get("headers.actions"),label:"Actions",key:"actions",hideLabel:!0}],"page-number":r.params.page,"page-size":r.params.size,total:m==null?void 0:m.total,items:m==null?void 0:m.items,error:S,"empty-state-title":k("create zones")?i("zone-cps.empty_state.title"):void 0,"empty-state-message":k("create zones")?i("zone-cps.empty_state.message"):void 0,"empty-state-cta-to":k("create zones")?{name:"zone-create-view"}:void 0,"empty-state-cta-text":k("create zones")?i("zones.index.create"):void 0,"is-selected-row":n=>n.name===r.params.zone,onChange:r.update,onResize:_.set},{type:e(({row:n})=>[(s(!0),f(y,null,V([["kubernetes","universal"].find(t=>t===n.zoneInsight.environment)??"kubernetes"],t=>(s(),g(w,{key:t,name:t},{default:e(()=>[o(p(i(`common.product.environment.${t}`)),1)]),_:2},1032,["name"]))),128))]),name:e(({row:n})=>[a(l,{"data-action":"",to:{name:"zone-cp-detail-view",params:{zone:n.name},query:{page:r.params.page,size:r.params.size}}},{default:e(()=>[o(p(n.name),1)]),_:2},1032,["to"])]),zoneCpVersion:e(({row:n})=>[o(p(I(Q)(n.zoneInsight,"version.kumaCp.version",i("common.collection.none"))),1)]),ingress:e(({row:n})=>[(s(!0),f(y,null,V([X.value[n.name]||{online:[],offline:[]}],t=>(s(),f(y,null,[o(p(t.online.length)+" / "+p(t.online.length+t.offline.length),1)],64))),256))]),egress:e(({row:n})=>[(s(!0),f(y,null,V([D.value[n.name]||{online:[],offline:[]}],t=>(s(),f(y,null,[o(p(t.online.length)+" / "+p(t.online.length+t.offline.length),1)],64))),256))]),state:e(({row:n})=>[a(U,{status:n.state},null,8,["status"])]),warnings:e(({row:n})=>[n.warnings.length>0?(s(),g(w,{key:0,name:"warning","data-testid":"warning"},{default:e(()=>[C("ul",null,[(s(!0),f(y,null,V(n.warnings,t=>(s(),f("li",{key:t.kind,"data-testid":`warning-${t.kind}`},p(i(`zone-cps.list.${t.kind}`)),9,oe))),128))])]),_:2},1024)):(s(),f(y,{key:1},[o(p(i("common.collection.none")),1)],64))]),actions:e(({row:n})=>[a(M,null,{default:e(()=>[a(E,null,{default:e(({expanded:t,toggle:L})=>[a(l,{to:{name:"zone-cp-detail-view",params:{zone:n.name}}},{default:e(()=>[o(p(i("common.collection.actions.view")),1)]),_:2},1032,["to"]),o(),k("create zones")?(s(),g(l,{key:0,appearance:"danger",onClick:L},{default:e(()=>[o(p(i("common.collection.actions.delete")),1)]),_:2},1032,["onClick"])):b("",!0),o(),a(z,{to:{name:"modal-layer"}},{default:e(()=>[t?(s(),g(B,{key:0,src:`/zone-cps/${n.name}/delete`,onChange:()=>{L(),F()}},{default:e(({submit:G,error:K})=>[a($,{action:i("common.delete_modal.proceed_button"),expected:n.name,"data-testid":"delete-zone-modal",onCancel:L,onSubmit:()=>G({})},{title:e(()=>[o(p(i("common.delete_modal.title",{type:"Zone"})),1)]),default:e(()=>[o(),C("div",{innerHTML:i("common.delete_modal.text",{type:"Zone",name:n.name})},null,8,se),o(),a(R,{class:"mt-4",errors:[K],loader:!1},null,8,["errors"])]),_:2},1032,["action","expected","onCancel","onSubmit"])]),_:2},1032,["src","onChange"])):b("",!0)]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1032,["headers","page-number","page-size","total","items","error","empty-state-title","empty-state-message","empty-state-cta-to","empty-state-cta-text","is-selected-row","onChange","onResize"])],64))]),_:2},1024),o(),r.params.zone?(s(),g(Z,{key:0},{default:e(n=>[a(ne,{onClose:t=>r.replace({name:"zone-cp-list-view",query:{page:r.params.page,size:r.params.size}})},{default:e(()=>[(s(),g(Y(n.Component),{name:r.params.zone,"zone-overview":m==null?void 0:m.items.find(t=>t.name===r.params.zone)},null,8,["name","zone-overview"]))]),_:2},1032,["onClose"])]),_:2},1024)):b("",!0)]),_:2},1032,["src"])]),_:2},1032,["docs"])]),_:1})}}}),ce=ee(ae,[["__scopeId","data-v-f19af224"]]);export{ce as default};
