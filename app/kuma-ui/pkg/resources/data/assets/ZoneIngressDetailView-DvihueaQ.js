import{d as F,r as p,o,p as m,w as e,b as s,Q as I,e as t,t as i,S as U,q as v,c as u,J as y,m as E,a0 as G,K as z,l as J,A as K,F as P}from"./index-Ds8TyCyC.js";import{S as Q}from"./SummaryView-BNDYr_J1.js";import{C as D,b as S,a as Z}from"./ConnectionTraffic-BXMWQmRf.js";import"./TagList-Vv9Lm1XC.js";const H={key:0},ne=F({__name:"ZoneIngressDetailView",props:{data:{}},setup(B){const l=B;return(M,n)=>{const V=p("XBadge"),X=p("XCopyButton"),R=p("XAboutCard"),h=p("DataCollection"),A=p("XLayout"),T=p("XInputSwitch"),x=p("XAction"),L=p("XCard"),$=p("DataLoader"),N=p("RouterView"),O=p("AppView"),j=p("RouteView");return o(),m(j,{name:"zone-ingress-detail-view",params:{subscription:"",zoneIngress:"",inactive:!1}},{default:e(({t:d,me:_,route:f,uri:q})=>[s(O,null,{default:e(()=>[s(R,{title:d("zone-ingresses.routes.item.about.title"),created:l.data.creationTime,modified:l.data.modificationTime},{default:e(()=>[s(I,{layout:"horizontal"},{title:e(()=>[t(i(d("http.api.property.status")),1)]),body:e(()=>[s(U,{status:l.data.state},null,8,["status"])]),_:2},1024),n[4]||(n[4]=t()),l.data.namespace.length>0?(o(),m(I,{key:0,layout:"horizontal"},{title:e(()=>[t(i(d("http.api.property.namespace")),1)]),body:e(()=>[s(V,{appearance:"decorative"},{default:e(()=>[t(i(l.data.namespace),1)]),_:1})]),_:2},1024)):v("",!0),n[5]||(n[5]=t()),s(I,{layout:"horizontal"},{title:e(()=>[t(i(d("http.api.property.address")),1)]),body:e(()=>[l.data.zoneIngress.socketAddress.length>0?(o(),m(X,{key:0,variant:"badge",format:"default",text:l.data.zoneIngress.socketAddress},null,8,["text"])):(o(),u(y,{key:1},[t(i(d("common.detail.none")),1)],64))]),_:2},1024),n[6]||(n[6]=t()),s(I,{layout:"horizontal"},{title:e(()=>[t(i(d("http.api.property.advertisedAddress")),1)]),body:e(()=>[l.data.zoneIngress.advertisedSocketAddress.length>0?(o(),m(V,{key:0,appearance:"decorative"},{default:e(()=>[s(X,{text:l.data.zoneIngress.advertisedSocketAddress},null,8,["text"])]),_:1})):(o(),u(y,{key:1},[t(i(d("common.detail.none")),1)],64))]),_:2},1024)]),_:2},1032,["title","created","modified"]),n[18]||(n[18]=t()),s($,{src:q(E(G),"/connections/stats/for/zone-ingress/:name/:socketAddress",{name:f.params.zoneIngress,socketAddress:l.data.zoneIngress.socketAddress})},{default:e(({data:a,refresh:c})=>[s(L,null,{default:e(()=>[s(A,{type:"columns"},{default:e(()=>[s(D,null,{default:e(()=>[s(A,{type:"stack",size:"small"},{default:e(()=>[s(h,{type:"inbounds",items:Object.entries(a.inbounds)},{default:e(({items:r})=>[(o(!0),u(y,null,z(r,([w,g])=>(o(),m(S,{key:`${w}`,protocol:"",traffic:g},{default:e(()=>[t(`
                      :`+i(w.split("_").at(-1)),1)]),_:2},1032,["traffic"]))),128))]),_:2},1032,["items"])]),_:2},1024)]),_:2},1024),n[11]||(n[11]=t()),s(D,null,{actions:e(()=>[s(T,{modelValue:f.params.inactive,"onUpdate:modelValue":r=>f.params.inactive=r,"data-testid":"dataplane-outbounds-inactive-toggle"},{label:e(()=>n[7]||(n[7]=[t(`
                    Show inactive
                  `)])),_:2},1032,["modelValue","onUpdate:modelValue"]),n[9]||(n[9]=t()),s(x,{action:"refresh",appearance:"primary",onClick:c},{default:e(()=>n[8]||(n[8]=[t(`
                  Refresh
                `)])),_:2},1032,["onClick"])]),default:e(()=>[n[10]||(n[10]=t()),(o(),u(y,null,z(["upstream"],r=>s(h,{key:r,type:"outbounds",items:Object.entries(a.outbounds)},{default:e(({items:w})=>[s(h,{type:"activeOutbounds",predicate:f.params.inactive?void 0:([g,k])=>{var b,C;return((typeof k.tcp<"u"?(b=k.tcp)==null?void 0:b[`${r}_cx_rx_bytes_total`]:(C=k.http)==null?void 0:C[`${r}_rq_total`])??0)>0},items:w},{default:e(({items:g})=>[g.length>0?(o(),m(Z,{key:0,type:"outbound"},{default:e(()=>[(o(),u(y,null,z([/-([a-f0-9]){16}$/],k=>s(A,{key:k,type:"stack",size:"small"},{default:e(()=>[(o(!0),u(y,null,z(g,([b,C])=>(o(),m(S,{key:`${b}`,"data-testid":"dataplane-outbound",protocol:"",traffic:C,direction:r},{default:e(()=>[t(i(b),1)]),_:2},1032,["traffic","direction"]))),128))]),_:2},1024)),64))]),_:2},1024)):v("",!0)]),_:2},1032,["predicate","items"])]),_:2},1032,["items"])),64))]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1032,["src"]),n[19]||(n[19]=t()),l.data.zoneIngressInsight.subscriptions.length>0?(o(),u("div",H,[J("h2",null,i(d("zone-ingresses.routes.item.subscriptions.title")),1),n[16]||(n[16]=t()),s(K,{headers:[{..._.get("headers.instanceId"),label:d("http.api.property.instanceId"),key:"instanceId"},{..._.get("headers.version"),label:d("http.api.property.version"),key:"version"},{..._.get("headers.connected"),label:d("http.api.property.connected"),key:"connected"},{..._.get("headers.disconnected"),label:d("http.api.property.disconnected"),key:"disconnected"},{..._.get("headers.responses"),label:d("http.api.property.responses"),key:"responses"}],"is-selected-row":a=>a.id===f.params.subscription,items:l.data.zoneIngressInsight.subscriptions.map((a,c,r)=>r[r.length-(c+1)]),onResize:_.set},{instanceId:e(({row:a})=>[s(x,{"data-action":"",to:{name:"zone-ingress-subscription-summary-view",params:{subscription:a.id}}},{default:e(()=>[t(i(a.controlPlaneInstanceId),1)]),_:2},1032,["to"])]),version:e(({row:a})=>{var c,r;return[t(i(((r=(c=a.version)==null?void 0:c.kumaDp)==null?void 0:r.version)??"-"),1)]}),connected:e(({row:a})=>[t(i(d("common.formats.datetime",{value:Date.parse(a.connectTime??"")})),1)]),disconnected:e(({row:a})=>[a.disconnectTime?(o(),u(y,{key:0},[t(i(d("common.formats.datetime",{value:Date.parse(a.disconnectTime)})),1)],64)):v("",!0)]),responses:e(({row:a})=>{var c;return[(o(!0),u(y,null,z([((c=a.status)==null?void 0:c.total)??{}],r=>(o(),u(y,null,[t(i(r.responsesSent)+"/"+i(r.responsesAcknowledged),1)],64))),256))]}),_:2},1032,["headers","is-selected-row","items","onResize"]),n[17]||(n[17]=t()),s(N,null,{default:e(({Component:a})=>[f.child()?(o(),m(Q,{key:0,width:"670px",onClose:function(){f.replace({name:"zone-ingress-detail-view",params:{zoneIngress:f.params.zoneIngress}})}},{default:e(()=>[(o(),m(P(a),{data:l.data.zoneIngressInsight.subscriptions},null,8,["data"]))]),_:2},1032,["onClose"])):v("",!0)]),_:2},1024)])):v("",!0)]),_:2},1024)]),_:1})}}});export{ne as default};
