import{d as U,v as A,S as W,p as w,o as a,w as n,b as l,r as i,e as r,q as X,m as v,l as k,I as j,K as H,t as u,c as d,L as h,N as z,T as J,U as O,y as Q,G as Y,_ as ee}from"./index-8QMKyk4n.js";const ne=["data-testid"],oe=U({__name:"ZoneListView",setup(te){const I=A({}),V=A({}),S=W(),R=C=>{const o="zoneIngress";I.value=C.items.reduce((p,c)=>{const m=c[o]?.zone;if(typeof m<"u"){typeof p[m]>"u"&&(p[m]={online:[],offline:[]});const y=typeof c[`${o}Insight`].connectedSubscription<"u"?"online":"offline";p[m][y].push(c)}return p},{})},T=C=>{const o="zoneEgress";V.value=C.items.reduce((p,c)=>{const m=c[o]?.zone;if(typeof m<"u"){typeof p[m]>"u"&&(p[m]={online:[],offline:[]});const y=typeof c[`${o}Insight`].connectedSubscription<"u"?"online":"offline";p[m][y].push(c)}return p},{})};return(C,o)=>{const p=i("RouteTitle"),c=i("DataSource"),m=i("XI18n"),y=i("XTeleportTemplate"),N=i("XSearch"),D=i("XIcon"),L=i("XAction"),$=i("DataCollection"),B=i("DataLoader"),Z=i("XLayout"),E=i("XCard"),G=i("XDrawer"),q=i("RouterView"),x=i("AppView"),F=i("RouteView");return a(),w(F,{name:"zone-cp-list-view",params:{page:1,size:Number,zone:"",s:""}},{default:n(({route:s,t:_,uri:K,me:g})=>[l(c,{src:K(v(Y),"/zone-cps",{},{page:s.params.page,size:s.params.size,search:s.params.s})},{default:n(({data:f,error:M,refresh:P})=>[l(x,{docs:f&&f?.items?.length?_("zones.href.docs.cta"):""},{title:n(()=>[k("h1",null,[l(p,{title:_("zone-cps.routes.items.title")},null,8,["title"])])]),default:n(()=>[o[9]||(o[9]=r()),l(c,{src:"/zone-ingress-overviews?page=1&size=100",onChange:R}),o[10]||(o[10]=r()),l(c,{src:"/zone-egress-overviews?page=1&size=100",onChange:T}),o[11]||(o[11]=r()),f?.items.length?(a(),w(m,{key:0,path:"zone-cps.routes.items.intro","default-path":"common.i18n.ignore-error"})):X("",!0),o[12]||(o[12]=r()),(f?.items??[]).length>0?(a(),w(y,{key:1,to:{name:"zone-cp-list-view-actions"}},{default:n(()=>[l(v(S))]),_:1})):X("",!0),o[13]||(o[13]=r()),l(E,null,{default:n(()=>[l(Z,null,{default:n(()=>[k("search",null,[k("form",{onSubmit:o[0]||(o[0]=j(()=>{},["prevent"]))},[l(N,{class:"search-field",keys:["name"],value:s.params.s,onChange:e=>s.update({page:1,s:e})},null,8,["value","onChange"])],32)]),o[8]||(o[8]=r()),l(B,{data:[f],errors:[M],variant:"list"},{default:n(()=>[l($,{type:"zone-cps",items:f?.items??[void 0],page:s.params.page,"page-size":s.params.size,total:f?.total,onChange:s.update},{default:n(()=>[l(H,{class:"zone-cp-collection","data-testid":"zone-cp-collection",headers:[{...g.get("headers.type"),label:"Â ",key:"type"},{...g.get("headers.name"),label:"Name",key:"name"},{...g.get("headers.zoneCpVersion"),label:"Zone leader CP version",key:"zoneCpVersion"},{...g.get("headers.ingress"),label:"Ingresses (online / total)",key:"ingress"},{...g.get("headers.egress"),label:"Egresses (online / total)",key:"egress"},{...g.get("headers.state"),label:"Status",key:"state"},{...g.get("headers.warnings"),label:"Warnings",key:"warnings",hideLabel:!0},{...g.get("headers.actions"),label:"Actions",key:"actions",hideLabel:!0}],items:f?.items,"is-selected-row":e=>e.name===s.params.zone,onResize:g.set},{type:n(({row:e})=>[(a(!0),d(z,null,h([["kubernetes","universal"].find(t=>t===e.zoneInsight.environment)??"kubernetes"],t=>(a(),w(D,{key:t,name:t},{default:n(()=>[r(u(_(`common.product.environment.${t}`)),1)]),_:2},1032,["name"]))),128))]),name:n(({row:e})=>[l(L,{"data-action":"",to:{name:"zone-cp-detail-view",params:{zone:e.name},query:{page:s.params.page,size:s.params.size,s:s.params.s}}},{default:n(()=>[r(u(e.name),1)]),_:2},1032,["to"])]),zoneCpVersion:n(({row:e})=>[r(u(v(O)(e.zoneInsight,"version.kumaCp.version",_("common.collection.none"))),1)]),ingress:n(({row:e})=>[(a(!0),d(z,null,h([I.value[e.name]||{online:[],offline:[]}],t=>(a(),d(z,null,[r(u(t.online.length)+" / "+u(t.online.length+t.offline.length),1)],64))),256))]),egress:n(({row:e})=>[(a(!0),d(z,null,h([V.value[e.name]||{online:[],offline:[]}],t=>(a(),d(z,null,[r(u(t.online.length)+" / "+u(t.online.length+t.offline.length),1)],64))),256))]),state:n(({row:e})=>[l(J,{status:e.state},null,8,["status"])]),warnings:n(({row:e})=>[(a(!0),d(z,null,h([[{bool:e.zoneInsight.store==="memory",key:"store-memory"},{bool:!e.zoneInsight.version?.kumaCp?.kumaCpGlobalCompatible,key:"global-cp-incompatible"}].filter(({bool:t})=>t)],t=>(a(),d(z,{key:typeof t},[t.length>0?(a(),w(D,{key:0,name:"warning","data-testid":"warning"},{default:n(()=>[k("ul",null,[(a(!0),d(z,null,h(t,({key:b})=>(a(),d("li",{key:b,"data-testid":`warning-${b}`},u(_(`zone-cps.list.warnings.${b}`)),9,ne))),128))])]),_:2},1024)):(a(),d(z,{key:1},[r(u(_("common.collection.none")),1)],64))],64))),128))]),actions:n(({row:e})=>[l(v(S),{item:e,onChange:P},{default:n(()=>[l(L,{to:{name:"zone-cp-detail-view",params:{zone:e.name}}},{default:n(()=>[r(u(_("common.collection.actions.view")),1)]),_:2},1032,["to"])]),_:2},1032,["item","onChange"])]),_:2},1032,["headers","items","is-selected-row","onResize"])]),_:2},1032,["items","page","page-size","total","onChange"])]),_:2},1032,["data","errors"])]),_:2},1024)]),_:2},1024),o[14]||(o[14]=r()),s.params.zone?(a(),w(q,{key:2},{default:n(e=>[l(G,{onClose:t=>s.replace({name:"zone-cp-list-view",query:{page:s.params.page,size:s.params.size,s:s.params.s}})},{default:n(()=>[(a(),w(Q(e.Component),{name:s.params.zone,"zone-overview":f?.items.find(t=>t.name===s.params.zone)},null,8,["name","zone-overview"]))]),_:2},1032,["onClose"])]),_:2},1024)):X("",!0)]),_:2},1032,["docs"])]),_:2},1032,["src"])]),_:1})}}}),ae=ee(oe,[["__scopeId","data-v-d8a65695"]]);export{ae as default};
