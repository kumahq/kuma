import{_ as T,r as C,o as d,p as v,w as g,l as s,a as x,e as n,d as M,k as O,q as B,t as a,m as o,c as f,J as m,K as q,n as j,b as z}from"./index-mqSLLX-U.js";import{T as J}from"./TagList-pqlTI6ui.js";const W=["B","kB","MB","GB","TB","PB","EB","ZB","YB"],H=["B","KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"],Q=["b","kbit","Mbit","Gbit","Tbit","Pbit","Ebit","Zbit","Ybit"],R=["b","kibit","Mibit","Gibit","Tibit","Pibit","Eibit","Zibit","Yibit"],Z=(r,t,e)=>{let u=r;return typeof t=="string"||Array.isArray(t)?u=r.toLocaleString(t,e):(t===!0||e!==void 0)&&(u=r.toLocaleString(void 0,e)),u};function k(r,t){if(!Number.isFinite(r))throw new TypeError(`Expected a finite number, got ${typeof r}: ${r}`);t={bits:!1,binary:!1,space:!0,...t};const e=t.bits?t.binary?R:Q:t.binary?H:W,u=t.space?" ":"";if(t.signed&&r===0)return` 0${u}${e[0]}`;const _=r<0,i=_?"-":t.signed?"+":"";_&&(r=-r);let c;if(t.minimumFractionDigits!==void 0&&(c={minimumFractionDigits:t.minimumFractionDigits}),t.maximumFractionDigits!==void 0&&(c={maximumFractionDigits:t.maximumFractionDigits,...c}),r<1){const b=Z(r,t.locale,c);return i+b+u+e[0]}const p=Math.min(Math.floor(t.binary?Math.log(r)/Math.log(1024):Math.log10(r)/3),e.length-1);r/=(t.binary?1024:1e3)**p,c||(r=r.toPrecision(3));const y=Z(Number(r),t.locale,c),$=e[p];return i+y+u+$}const h={},tt={class:"card"},et={class:"title"},it={class:"body"};function st(r,t){const e=C("XCard");return d(),v(e,{class:"data-card"},{default:g(()=>[s("dl",null,[s("div",tt,[s("dt",et,[x(r.$slots,"title",{},void 0,!0)]),t[0]||(t[0]=n()),s("dd",it,[x(r.$slots,"default",{},void 0,!0)])])])]),_:3})}const A=T(h,[["render",st],["__scopeId","data-v-719ec237"]]),rt={class:"title"},nt={key:0},ot={"data-testid":"grpc-success"},at={"data-testid":"grpc-failure"},dt={"data-testid":"rq-2xx"},lt={"data-testid":"rq-4xx"},ct={"data-testid":"rq-5xx"},ft={"data-testid":"connections-total"},ut={key:0,"data-testid":"bytes-received"},_t={key:1,"data-testid":"bytes-sent"},pt=M({__name:"ConnectionCard",props:{protocol:{},service:{default:""},traffic:{default:void 0},direction:{default:"downstream"}},setup(r){const{t}=O(),e=r,u=_=>{const i=_.target;if(_.isTrusted&&i.nodeName.toLowerCase()!=="a"){const c=i.closest(".service-traffic-card, a");if(c){const p=c.nodeName.toLowerCase()==="a"?c:c.querySelector("[data-action]");p!==null&&"click"in p&&typeof p.click=="function"&&p.click()}}};return(_,i)=>{const c=C("XBadge"),p=C("XProgress");return d(),v(A,{class:"service-traffic-card",onClick:u},{title:g(()=>[e.service.length>0?(d(),v(J,{key:0,tags:[{label:"kuma.io/service",value:e.service}]},null,8,["tags"])):B("",!0),i[1]||(i[1]=n()),s("div",rt,[e.protocol!==""?(d(),v(c,{key:0,class:"protocol",appearance:e.protocol==="passthrough"?"success":"info"},{default:g(()=>[n(a(o(t)(`data-planes.components.service_traffic_card.protocol.${e.protocol}`,{},{defaultMessage:o(t)(`http.api.value.${e.protocol}`)})),1)]),_:1},8,["appearance"])):B("",!0),i[0]||(i[0]=n()),x(_.$slots,"default",{},void 0,!0)])]),default:g(()=>{var y,$,b,w,E,D,F,X,L,P,G,Y;return[i[22]||(i[22]=n()),e.traffic?(d(),f("dl",nt,[e.protocol==="passthrough"?(d(!0),f(m,{key:0},q([["http","tcp"].reduce((l,I)=>{var V;const U=e.direction;return Object.entries(((V=e.traffic)==null?void 0:V[I])||{}).reduce((N,[S,K])=>[`${U}_cx_tx_bytes_total`,`${U}_cx_rx_bytes_total`].includes(S)?{...N,[S]:K+(N[S]??0)}:N,l)},{})],(l,I)=>(d(),f(m,{key:I},[s("div",null,[s("dt",null,a(o(t)("data-planes.components.service_traffic_card.tx")),1),i[2]||(i[2]=n()),s("dd",null,a(o(k)(l.downstream_cx_rx_bytes_total??0)),1)]),i[4]||(i[4]=n()),s("div",null,[s("dt",null,a(o(t)("data-planes.components.service_traffic_card.rx")),1),i[3]||(i[3]=n()),s("dd",null,a(o(k)(l.downstream_cx_tx_bytes_total??0)),1)])],64))),128)):e.protocol==="grpc"?(d(),f(m,{key:1},[s("div",ot,[s("dt",null,a(o(t)("data-planes.components.service_traffic_card.grpc_success")),1),i[5]||(i[5]=n()),s("dd",null,a(o(t)("common.formats.integer",{value:(y=e.traffic.grpc)==null?void 0:y.success})),1)]),i[7]||(i[7]=n()),s("div",at,[s("dt",null,a(o(t)("data-planes.components.service_traffic_card.grpc_failure")),1),i[6]||(i[6]=n()),s("dd",null,a(o(t)("common.formats.integer",{value:($=e.traffic.grpc)==null?void 0:$.failure})),1)])],64)):e.protocol.startsWith("http")?(d(),f(m,{key:2},[(d(!0),f(m,null,q([((b=e.traffic.http)==null?void 0:b[`${e.direction}_rq_1xx`])??0].filter(l=>l!==0),l=>(d(),f("div",{key:l,"data-testid":"rq-1xx"},[s("dt",null,a(o(t)("data-planes.components.service_traffic_card.1xx")),1),i[8]||(i[8]=n()),s("dd",null,a(o(t)("common.formats.integer",{value:l})),1)]))),128)),i[13]||(i[13]=n()),s("div",dt,[s("dt",null,a(o(t)("data-planes.components.service_traffic_card.2xx")),1),i[9]||(i[9]=n()),s("dd",null,a(o(t)("common.formats.integer",{value:(w=e.traffic.http)==null?void 0:w[`${e.direction}_rq_2xx`]})),1)]),i[14]||(i[14]=n()),(d(!0),f(m,null,q([((E=e.traffic.http)==null?void 0:E[`${e.direction}_rq_3xx`])??0].filter(l=>l!==0),l=>(d(),f("div",{key:l,"data-testid":"rq-3xx"},[s("dt",null,a(o(t)("data-planes.components.service_traffic_card.3xx")),1),i[10]||(i[10]=n()),s("dd",null,a(o(t)("common.formats.integer",{value:l})),1)]))),128)),i[15]||(i[15]=n()),s("div",lt,[s("dt",null,a(o(t)("data-planes.components.service_traffic_card.4xx")),1),i[11]||(i[11]=n()),s("dd",null,a(o(t)("common.formats.integer",{value:(D=e.traffic.http)==null?void 0:D[`${e.direction}_rq_4xx`]})),1)]),i[16]||(i[16]=n()),s("div",ct,[s("dt",null,a(o(t)("data-planes.components.service_traffic_card.5xx")),1),i[12]||(i[12]=n()),s("dd",null,a(o(t)("common.formats.integer",{value:(F=e.traffic.http)==null?void 0:F[`${e.direction}_rq_5xx`]})),1)])],64)):(d(),f(m,{key:3},[s("div",ft,[s("dt",null,a(o(t)("data-planes.components.service_traffic_card.cx")),1),i[17]||(i[17]=n()),s("dd",null,a(o(t)("common.formats.integer",{value:(X=e.traffic.tcp)==null?void 0:X[`${e.direction}_cx_total`]})),1)]),i[20]||(i[20]=n()),typeof((L=e.traffic.tcp)==null?void 0:L[`${e.direction}_cx_tx_bytes_total`])<"u"?(d(),f("div",ut,[s("dt",null,a(o(t)("data-planes.components.service_traffic_card.rx")),1),i[18]||(i[18]=n()),s("dd",null,a(o(k)((P=e.traffic.tcp)==null?void 0:P[`${e.direction}_cx_tx_bytes_total`])),1)])):B("",!0),i[21]||(i[21]=n()),typeof((G=e.traffic.tcp)==null?void 0:G[`${e.direction}_cx_rx_bytes_total`])<"u"?(d(),f("div",_t,[s("dt",null,a(o(t)("data-planes.components.service_traffic_card.tx")),1),i[19]||(i[19]=n()),s("dd",null,a(o(k)((Y=e.traffic.tcp)==null?void 0:Y[`${e.direction}_cx_rx_bytes_total`])),1)])):B("",!0)],64))])):(d(),v(p,{key:1,variant:"line"}))]}),_:3})}}}),Bt=T(pt,[["__scopeId","data-v-42ff3b53"]]),mt={class:"body"},xt=M({__name:"ConnectionGroup",props:{type:{}},setup(r){const t=r;return(e,u)=>{const _=C("XCard");return d(),v(_,{class:j(["service-traffic-group",`type-${t.type}`])},{default:g(()=>[s("div",mt,[x(e.$slots,"default",{},void 0,!0)])]),_:3},8,["class"])}}}),kt=T(xt,[["__scopeId","data-v-25c74403"]]),vt={class:"service-traffic"},gt={class:"actions"},yt=M({__name:"ConnectionTraffic",setup(r){return(t,e)=>(d(),f("div",vt,[s("div",gt,[x(t.$slots,"actions",{},void 0,!0)]),e[0]||(e[0]=n()),z(A,{class:"header"},{title:g(()=>[x(t.$slots,"title",{},void 0,!0)]),_:3}),e[1]||(e[1]=n()),x(t.$slots,"default",{},void 0,!0)]))}}),Ct=T(yt,[["__scopeId","data-v-e6bd176c"]]);export{Ct as C,kt as a,Bt as b};
