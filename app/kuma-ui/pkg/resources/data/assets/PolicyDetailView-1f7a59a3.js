import{d as P,k as y,c as k,J as D,l as T,r as C,o as c,a as v,w as a,g as p,M as V,s as b,N as $,e as g,F as A,v as B,h as o,t as w,b as x,f as L}from"./index-e3522cd8.js";import{_ as E}from"./StatusInfo.vue_vue_type_script_setup_true_lang-daac8f31.js";import{n as N,e as F,g as I,A as M,_ as W}from"./RouteView.vue_vue_type_script_setup_true_lang-d8cf0316.js";import{_ as H}from"./ResourceCodeBlock.vue_vue_type_script_setup_true_lang-d3adce94.js";import{T as J}from"./TabsWidget-ab147a2b.js";import{T as K}from"./TextWithCopyButton-f8b6a14b.js";import{_ as O}from"./RouteTitle.vue_vue_type_script_setup_true_lang-5d02b6a3.js";import"./EmptyBlock.vue_vue_type_script_setup_true_lang-b529e8d4.js";import"./ErrorBlock-7a68094f.js";import"./CodeBlock.vue_vue_type_style_index_0_lang-d05fba3a.js";const R=b("h2",null,"Dataplanes",-1),U=P({__name:"PolicyConnections",props:{mesh:{type:String,required:!0},policyPath:{type:String,required:!0},policyName:{type:String,required:!0}},setup(m){const e=m,u=N(),n=y(!1),s=y(!0),i=y(!1),r=y([]),t=y(""),d=k(()=>{const _=t.value.toLowerCase();return r.value.filter(({dataplane:l})=>l.name.toLowerCase().includes(_))});D(()=>e.policyName,function(){f()}),T(function(){f()});async function f(){i.value=!1,s.value=!0;try{const{items:_,total:l}=await u.getPolicyConnections({mesh:e.mesh,policyPath:e.policyPath,policyName:e.policyName});n.value=l>0,r.value=_??[]}catch{i.value=!0}finally{s.value=!1}}return(_,l)=>{const S=C("router-link");return c(),v(E,{"has-error":i.value,"is-loading":s.value,"is-empty":!n.value},{default:a(()=>[R,p(),V(b("input",{id:"dataplane-search","onUpdate:modelValue":l[0]||(l[0]=h=>t.value=h),type:"text",class:"k-input mt-4",placeholder:"Filter by name",required:"","data-testid":"dataplane-search-input"},null,512),[[$,t.value]]),p(),(c(!0),g(A,null,B(d.value,(h,q)=>(c(),g("p",{key:q,class:"mt-2","data-testid":"dataplane-name"},[o(S,{to:{name:"data-plane-detail-view",params:{mesh:h.dataplane.mesh,dataPlane:h.dataplane.name}}},{default:a(()=>[p(w(h.dataplane.name),1)]),_:2},1032,["to"])]))),128))]),_:1},8,["has-error","is-loading","is-empty"])}}}),j={class:"policy-details kcard-border"},z={class:"entity-heading","data-testid":"policy-single-entity"},G=P({__name:"PolicyDetails",props:{mesh:{type:String,required:!0},path:{type:String,required:!0},name:{type:String,required:!0},type:{type:String,required:!0}},setup(m){const e=m,u=N(),n=[{hash:"#overview",title:"Overview"},{hash:"#affected-dpps",title:"Affected DPPs"}],s=k(()=>({name:"policy-detail-view",params:{mesh:e.mesh,policy:e.name,policyPath:e.path}}));async function i(r){const{name:t,mesh:d,path:f}=e;return await u.getSinglePolicyEntity({name:t,mesh:d,path:f},r)}return(r,t)=>{const d=C("router-link");return c(),g("div",j,[o(J,{tabs:n},{tabHeader:a(()=>[b("h1",z,[p(w(e.type)+`:

          `,1),o(K,{text:e.name},{default:a(()=>[o(d,{to:s.value},{default:a(()=>[p(w(e.name),1)]),_:1},8,["to"])]),_:1},8,["text"])])]),overview:a(()=>[o(H,{id:"code-block-policy","resource-fetcher":i,"resource-fetcher-watch-key":e.name,"is-searchable":""},null,8,["resource-fetcher-watch-key"])]),"affected-dpps":a(()=>[o(U,{mesh:e.mesh,"policy-name":e.name,"policy-path":e.path},null,8,["mesh","policy-name","policy-path"])]),_:1})])}}}),ie=P({__name:"PolicyDetailView",props:{mesh:{},policyPath:{},policyName:{}},setup(m){const e=m,u=F(),{t:n}=I(),s=k(()=>u.state.policyTypesByPath[e.policyPath]);return(i,r)=>(c(),v(W,null,{default:a(({route:t})=>[o(O,{title:x(n)("policies.routes.item.title",{name:t.params.policy})},null,8,["title"]),p(),o(M,{breadcrumbs:[{to:{name:"policies-list-view",params:{mesh:t.params.mesh,policyPath:t.params.policyPath}},text:x(n)("policies.routes.item.breadcrumbs")}]},{default:a(()=>[s.value?(c(),v(G,{key:0,name:e.policyName,mesh:e.mesh,path:e.policyPath,type:s.value.name},null,8,["name","mesh","path","type"])):L("",!0)]),_:2},1032,["breadcrumbs"])]),_:1}))}});export{ie as default};
