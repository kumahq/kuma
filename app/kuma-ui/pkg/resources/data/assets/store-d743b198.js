var q=Object.defineProperty;var J=(t,e,s)=>e in t?q(t,e,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[e]=s;var g=(t,e,s)=>(J(t,typeof e!="symbol"?e+"":e,s),s);import{c as Q,u as X}from"./vuex.esm-bundler-df5bd11e.js";import{a as C,D as P}from"./constants-31fdaf55.js";const ee="modulepreload",te=function(t,e){return t.startsWith(".")?new URL(t,e).href:t},R={},l=function(e,s,n){if(!s||s.length===0)return e();const a=document.getElementsByTagName("link");return Promise.all(s.map(i=>{if(i=te(i,n),i in R)return;R[i]=!0;const r=i.endsWith(".css"),o=r?'[rel="stylesheet"]':"";if(!!n)for(let p=a.length-1;p>=0;p--){const f=a[p];if(f.href===i&&(!r||f.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${i}"]${o}`))return;const u=document.createElement("link");if(u.rel=r?"stylesheet":ee,r||(u.as="script",u.crossOrigin=""),u.href=i,document.head.appendChild(u),r)return new Promise((p,f)=>{u.addEventListener("load",p),u.addEventListener("error",()=>f(new Error(`Unable to preload CSS for ${i}`)))})})).then(()=>e())};function k(t,e,s=void 0){if(typeof t!="object"||Array.isArray(t))return s;const n=e.indexOf(".");if(n===-1)return t[e]===void 0?s:t[e];const a=e.substring(0,n),i=e.substring(n+1);return k(t[a],i,s)}const se=new Intl.DateTimeFormat("en-US",{dateStyle:"long"}),ne=new Intl.DateTimeFormat("en-US",{dateStyle:"long",timeStyle:"medium"});function ae(t){const e=new Date(Date.parse(t)),s=Math.floor((Date.now()-e.getTime())/1e3);return s<=1?"just now":s<20?`${s} seconds ago`:s<40?"half a minute ago":s<60?"less than a minute ago":s<=90?"one minute ago":s<=3540?`${Math.round(s/60)} minutes ago`:s<=5400?"1 hour ago":s<=86400?`${Math.round(s/3600)} hours ago`:s<=129600?"1 day ago":s<604800?`${Math.round(s/86400)} days ago`:s<=777600?"1 week ago":se.format(e)}function It(t){const e=new Date(Date.parse(t));return ne.format(e)}function yt(t,e){const s=t&&typeof t=="object"&&t.constructor===Array?Object.assign({},...t):t;return e.reduce((n,a)=>({...n,[a]:s[a]}),{})}function At(t){const{creationTime:e,modificationTime:s,...n}=t;return n}function Ot(t){const e=t.replace(/[^a-zA-Z0-9 -]/g,"").replace(/\s+/g,"-").replace(/-+/g,"-").trim();return t?e:""}async function T(t){try{let e=null,s=0,n=[];for(;;){const a={size:C,offset:s},{total:i,items:r,next:o}=await t(a);if(Array.isArray(r)&&(n=n.concat(r)),e===null&&(e=i),i!==e)throw new Error('Mismatch between "total" values between requests');if(!o)break;s+=C}return{total:e,items:n}}catch(e){throw new Error(`Resource fetching failed: ${e}`)}}function Ct(t){var s;const e=((s=t.zoneInsight)==null?void 0:s.subscriptions)??[];if(e.length>0){const n=e[e.length-1];if(n.config){const a=JSON.parse(n.config);return k(a,"dpServer.auth.type",P)}}return P}function Dt(t){let e=[];t.networking.inbound&&(e=t.networking.inbound.filter(n=>"tags"in n).flatMap(n=>Object.entries(n.tags)).map(([n,a])=>`${n}=${a}`)),t.networking.gateway&&(e=Object.entries(t.networking.gateway.tags).map(([n,a])=>`${n}=${a}`));const s=Array.from(new Set(e));return s.sort((n,a)=>n.localeCompare(a)),s.map(n=>n.split("=")).map(([n,a])=>({label:n,value:a}))}function H(t={subscriptions:[]}){return(t.subscriptions??[]).some(s=>{var n;return((n=s.connectTime)==null?void 0:n.length)&&!s.disconnectTime})?"online":"offline"}function Mt(t,e={subscriptions:[]}){const s=t.networking.inbound??[],n=s.filter(i=>i.health&&!i.health.ready).map(i=>`Inbound on port ${i.port} is not ready (kuma.io/service: ${i.tags["kuma.io/service"]})`);let a;switch(!0){case s.length===0:a="online";break;case n.length===s.length:a="offline";break;case n.length>0:a="partially_degraded";break;default:a=H(e)}return{status:a,reason:n}}function wt(t){if(t===void 0||t.subscriptions.length===0)return null;const e={},s=t.subscriptions[t.subscriptions.length-1];return s.version===void 0?null:(s.version.envoy&&(e.envoy=s.version.envoy.version),s.version.kumaDp&&(e.kumaDp=s.version.kumaDp.version),s.version.dependencies&&Object.entries(s.version.dependencies).forEach(([n,a])=>{e[n]=a}),e)}function Pt(t){if(t.dataplaneInsight===void 0||t.dataplaneInsight.mTLS===void 0)return null;const{mTLS:e}=t.dataplaneInsight,s=new Date(e.certificateExpirationTime),n=new Date(s.getTime()+s.getTimezoneOffset()*6e4);return{certificateExpirationTime:{label:"Expiration Time",value:`${n.toLocaleDateString("en-US")} ${n.getHours()}:${n.getMinutes()}:${n.getSeconds()}`},lastCertificateRegeneration:{label:"Last Generated",value:ae(e.lastCertificateRegeneration)},certificateRegenerations:{label:"Regenerations",value:e.certificateRegenerations}}}function Rt(t){var n,a;return((n=t.kumaDp)==null?void 0:n.kumaCpCompatible)??!0?((a=t.envoy)==null?void 0:a.kumaDpCompatible)??!0?{kind:ie}:{kind:oe,payload:{envoy:t.envoy.version,kumaDp:t.kumaDp.version}}:{kind:re,payload:{kumaDp:t.kumaDp.version}}}const ie="COMPATIBLE",bt="INCOMPATIBLE_ZONE_CP_AND_KUMA_DP_VERSIONS",Lt="INCOMPATIBLE_ZONE_AND_GLOBAL_CPS_VERSIONS",re="INCOMPATIBLE_UNSUPPORTED_KUMA_DP",oe="INCOMPATIBLE_UNSUPPORTED_ENVOY",Nt="INCOMPATIBLE_WRONG_FORMAT";class le extends Error{constructor({title:s=null,message:n,code:a=null,statusCode:i,causes:r=[]}){super(n);g(this,"title");g(this,"code");g(this,"causes");g(this,"statusCode");this.name="ApiError",this.title=s,this.code=a,this.statusCode=i,this.causes=r}toJSON(){return{name:this.name,title:this.title,message:this.message,code:this.code,statusCode:this.statusCode,causes:this.causes}}}async function ce(t,e={}){var u;const s=e,n=s.method??"GET";s.headers=s.headers instanceof Headers?s.headers:new Headers(s.headers),!s.headers.has("content-type")&&["POST","PUT","PATCH"].includes(n)&&s.headers.set("content-type","application/json");let a=t;"params"in e&&(n==="GET"?a+=`?${new URLSearchParams(e.params).toString()}`:(u=s.headers.get("content-type"))!=null&&u.startsWith("application/json")&&(s.body=JSON.stringify(e.params)));let i;try{i=await fetch(a,s)}catch(p){throw ue(p)}const r=i.headers.get("content-type"),h=(r!==null?r.startsWith("application/json"):!1)?await i.json():await i.text();if(i.ok)return{response:i,data:h};throw he(i,h)}function ue(t){const e=t instanceof Error?t.message:"An unknown network error occurred.";return new Error(e)}function he(t,e){let s=null,n="An error has occurred while trying to load this data.",a=null,i=[];return typeof e=="string"&&e.length>0?n=e:e&&(Object.prototype.hasOwnProperty.call(e,"title")&&(s=e.title),Object.prototype.hasOwnProperty.call(e,"details")&&(n=e.details),Object.prototype.hasOwnProperty.call(e,"code")&&(a=e.code),Object.prototype.hasOwnProperty.call(e,"causes")&&Array.isArray(e.causes)&&(i=e.causes)),t.status===403&&(n="You currently donâ€™t have access to this data."),new le({title:s,message:n,code:a,causes:i,statusCode:t.status})}const b=window.location.origin;class pe{constructor(){g(this,"_baseUrl",b)}get baseUrl(){return this._baseUrl}set baseUrl(e){if(e.startsWith("http"))this._baseUrl=x(e);else{const s=me(e);this._baseUrl=[b,s].filter(n=>n!=="").join("/")}}async get(e,s){const n=L(s);n.method="GET";const{data:a}=await this.raw(e,n);return a}async raw(e,s){const n=L(s),a=e.startsWith("http")?e:[this.baseUrl,e].join("/");return ce(a,n)}}function x(t){return t.replace(/\/+$/,"")}function ge(t){return t.replace(/^\/+/,"")}function me(t){return x(ge(t))}function L(t){const e=t??{};if(e.params&&!Array.isArray(e.params)){const s=[];for(const[n,a]of Object.entries(e.params))if(a!==void 0)if(Array.isArray(a))for(const i of a)s.push([n,i]);else s.push([n,a]);e.params=s}return e}var A=new Map,F=new Map,de=new Map,E;(function(t){t[t.Constant=0]="Constant",t[t.Instance=1]="Instance",t[t.Factory=2]="Factory"})(E||(E={}));var m;(function(t){t[t.Container=0]="Container",t[t.Resolution=1]="Resolution",t[t.Singleton=2]="Singleton",t[t.Transient=3]="Transient"})(m||(m={}));var _e=class{constructor(t){this.impl=t,this.type=E.Constant}},Ee=class{constructor(t){this.impl=t,this.type=E.Factory}},ve=t=>t.type===E.Factory,I=class{constructor(t){this.impl=t,this.type=E.Instance}},fe=class extends I{constructor(){super(...arguments),this.scope=m.Container,this.cache=new WeakMap}},Te=class extends I{constructor(){super(...arguments),this.scope=m.Resolution}},Se=class extends I{constructor(t){super(t),this.impl=t,this.scope=m.Singleton}},Ie=class extends I{constructor(){super(...arguments),this.scope=m.Transient}},ye=t=>t.type===E.Instance,Ae=t=>t.scope===m.Container,Oe=t=>t.scope===m.Resolution,Ce=t=>t.scope===m.Singleton,De=t=>Symbol(t),G=t=>{const e=Symbol(t);return{__t:null,__d:t,__s:e,__o:!1,optional:{__t:null,__d:t,__s:e,__o:!0}}},v=class{constructor(){this.parent=null,this.map=new Map}set(t,e,s=v.notag){const n=this.map.get(e.__s);n?n.set(s,t):this.map.set(e.__s,new Map().set(s,t))}find(t,e,s){const n=this.map.get(t.__s);if(n!==void 0){if(s){const a=n.get(s);if(a)return a}if(e)for(let a=0,i=e.length;a<i;a+=1){const r=n.get(e[a]);if(r)return r}return n.get(v.notag)}}resolve(t,e,s,n){const a=this.find(t,s,n);return a===void 0?this.parent?this.parent.resolve(t,e,s,n):null:a instanceof v?(e.vaults.push(a),a.resolve(t,e,s,n)):a}get(t,e,s,n){const a=this.resolve(t,e,s,n);if(a)return a;for(let i=0,r=e.vaults,o=r.length;i<o;i+=1){const h=r[i].resolve(t,e,s,n);if(h)return h}return null}from(t){const e=new v;return e.parent=this.parent,this.map.forEach((s,n)=>{e.map.set(n,t(s))}),e}clone(){return this.from(t=>new Map(t))}},B=v;B.notag=De("NO_TAG");var Me=class{constructor(t,e,s,n){this.vault=t,this.tokens=e,this.getVault=s,this.condition=n}from(t){const{tokens:e}=this;for(let s=0,n=e.length;s<n;s+=1)this.vault.set(this.getVault(t),e[s],this.condition)}},we=class{constructor(t,e,s,n){this.vault=t,this.impl=e,this.token=s,this.condition=n}inContainerScope(){this.set(fe)}inResolutionScope(){this.set(Te)}inSingletonScope(){this.set(Se)}inTransientScope(){this.set(Ie)}set(t){this.vault.set(new t(this.impl),this.token,this.condition)}},Pe=class{constructor(t,e,s){this.vault=t,this.token=e,this.condition=s}toConstant(t){this.vault.set(new _e(t),this.token,this.condition)}toFactory(t,e){this.vault.set(new Ee({creator:t,initializer:e}),this.token,this.condition)}toInstance(t){return new we(this.vault,t,this.token,this.condition)}},D=class{constructor(t,e){this.vault=t,this.condition=e}static vault(t){return t.vault}bind(t){return new Pe(this.vault,t,this.condition)}use(...t){return new Me(this.vault,t,D.vault,this.condition)}},Re=class extends D{when(t){return new D(this.vault,t)}},be=class extends Re{constructor(){super(new B)}},z=class{constructor(t=new Map,e=[]){this.instances=t,this.vaults=e}split(){return new z(this.instances,this.vaults.slice())}},S=class extends be{constructor(){super(),this.snapshot=null}extend(t){return this.vault.parent=t===null?null:t.vault,this}clone(){const t=new S;return t.vault=this.vault.clone(),t}get(t,e){return this.resolveToken(t,e)}resolveTokens(t,e,s,n){return t.map(a=>this.resolveToken(a,s,n,e.split()))}resolveToken(t,e,s,n=new z){const a=this.vault.get(t,n,e,s);if(a)return this.resolveBinding(a,n);if(!t.__o)throw new Error(`No matching bindings found for '${t.__d}' token.`)}resolveBinding(t,e){return ye(t)?Ce(t)?this.resolveCache(t,e,()=>t.cache,s=>{t.cache=s}):Ae(t)?this.resolveCache(t,e,()=>t.cache.get(this.vault),s=>{t.cache.set(this.vault,s)}):Oe(t)?this.resolveCache(t,e,()=>e.instances.get(t),s=>{e.instances.set(t,s)}):this.createInstance(t.impl,e):ve(t)?(...s)=>{const n=this.createInstance(t.impl.creator,e);return n instanceof Promise?n.then(a=>S.resolveInitialization(a,s,t.impl.initializer)):S.resolveInitialization(n,s,t.impl.initializer)}:t.impl}resolveCache(t,e,s,n){const a=s();if(a!==void 0)return a;const i=this.createInstance(t.impl,e);return n(i),i}createInstance(t,e){const s=this.getParameters(t,e),n=A.get(t);if(n!==void 0)return n?t(...s):new t(...s);try{const a=t(...s);return A.set(t,!0),a}catch{const i=new t(...s);return A.set(t,!1),i}}getParameters(t,e){const s=F.get(t);if(s)return this.resolveTokens(s,e,de.get(t),t);if(t.length===0)return[];throw new Error(`Missing required 'injected' registration of '${t.name}'`)}static resolveInitialization(t,e,s){const n=s==null?void 0:s(t,...e);return n instanceof Promise?n.then(()=>t):t}},Le=()=>new S,Ne=(t,...e)=>(F.set(t,e),t);const Ve=(t,e)=>e.get(t),Vt=(t,e=y)=>t.map(s=>()=>Ve(s,e)),y=Le(),K=t=>y.get(t),O=(t,e)=>{const s=G(e.description);return y.bind(s).toInstance(t).inSingletonScope(),s},Ue=(t,e)=>{const s=G(e.description);return y.bind(s).toConstant(t),s},$e={baseGuiPath:"",apiUrl:"/",version:"1.7.0"};class Z{constructor(e){g(this,"env");let s=e;const n=(r,o="")=>this.var(r,(s==null?void 0:s[r])??o),a=this.getConfig(),i=ke(n("KUMA_VERSION",a.version));s={...s,KUMA_UTM_QUERY_PARAMS:`utm_source=${n("KUMA_PRODUCT_NAME")}&utm_medium=${n("KUMA_PRODUCT_NAME")}-GUI`},this.env={...s,KUMA_INSTALL_URL:`${n("KUMA_INSTALL_URL")}?${n("KUMA_UTM_QUERY_PARAMS")}`,KUMA_DOCS_URL:`${n("KUMA_DOCS_URL")}/${i.patch==="0.0.0"?"dev":i.patch.replace(/\.\d+$/,".x")}`,KUMA_VERSION:i.pre,KUMA_API_URL:n("KUMA_API_URL")||a.apiUrl,KUMA_BASE_PATH:n("KUMA_BASE_PATH")||a.baseGuiPath}}var(e,s=""){var n;return((n=this.env)==null?void 0:n[e])??s}getConfig(){const e=document.querySelector("#kuma-config");if(e instanceof HTMLScriptElement)try{return JSON.parse(e.innerText.trim())}catch{}return $e}}function ke(t){const[e,s,...n]=t.split("."),[a,i]=n.join(".").split("-");return{major:e,minor:`${e}.${s}`,patch:`${e}.${s}.${a}`,pre:`${e}.${s}.${a}${i!==void 0?`-${i}`:""}`}}function _(t,e=0){const s=He(t);return s!==void 0?parseInt(s):e}function He(t){const e=Array.isArray(t)?t:[t];return e[e.length-1]??void 0}const xe=t=>[{path:"/404",name:"not-found",alias:"/:pathMatch(.*)*",meta:{title:"Item not found"},component:()=>l(()=>import("./AppNotFoundView-e9e6dbb1.js"),[],import.meta.url)},{path:"/",name:"home",meta:{title:"Overview"},component:()=>l(()=>import("./MainOverviewView-2ab01bcf.js"),["./MeshResources-b0bd4417.css","./MainOverviewView-e4354112.css"],import.meta.url)},{path:"/diagnostics",name:"diagnostics",meta:{title:"Diagnostics"},component:()=>l(()=>import("./DiagnosticsView-589ffe55.js"),["./CodeBlock-7d9027b4.css"],import.meta.url)},{path:"/zones",name:"zones",meta:{title:"Zones"},props:e=>({selectedZoneName:e.query.zone,offset:_(e.query.offset)}),component:()=>l(()=>import("./ZonesView-72c46d10.js"),["./AccordionItem-2e8063db.css","./CodeBlock-7d9027b4.css","./ErrorBlock-8c979915.css","./StatusBadge-43351938.css","./TagList-27d87a7b.css","./DataOverview-cc37ba93.css","./LabelList-82c1e9de.css","./SubscriptionHeader-da67a0ee.css","./TabsWidget-4d82abdb.css"],import.meta.url)},{path:"/zone-ingresses",name:"zoneingresses",meta:{title:"Zone ingresses"},props:e=>({selectedZoneIngressName:e.query.zoneIngress,offset:_(e.query.offset)}),component:()=>l(()=>import("./ZoneIngresses-1c1e8893.js"),["./AccordionItem-2e8063db.css","./ErrorBlock-8c979915.css","./StatusBadge-43351938.css","./TagList-27d87a7b.css","./DataOverview-cc37ba93.css","./CodeBlock-7d9027b4.css","./EnvoyData-55ab94cb.css","./LabelList-82c1e9de.css","./SubscriptionHeader-da67a0ee.css","./TabsWidget-4d82abdb.css"],import.meta.url)},{path:"/zoneegresses",name:"zoneegresses",meta:{title:"Zone egresses"},props:e=>({selectedZoneEgressName:e.query.zoneEgress,offset:_(e.query.offset)}),component:()=>l(()=>import("./ZoneEgresses-2b6a80e0.js"),["./AccordionItem-2e8063db.css","./ErrorBlock-8c979915.css","./StatusBadge-43351938.css","./TagList-27d87a7b.css","./DataOverview-cc37ba93.css","./CodeBlock-7d9027b4.css","./EnvoyData-55ab94cb.css","./LabelList-82c1e9de.css","./SubscriptionHeader-da67a0ee.css","./TabsWidget-4d82abdb.css"],import.meta.url)},{path:"/mesh/:mesh",children:[{path:"",name:"mesh-detail-view",meta:{title:"Mesh overview"},component:()=>l(()=>import("./MeshOverviewView-1b12a500.js"),["./ContentWrapper-fe2d0f8d.css","./MeshResources-b0bd4417.css","./ErrorBlock-8c979915.css","./LabelList-82c1e9de.css","./CodeBlock-7d9027b4.css","./MeshOverviewView-a199dee5.css"],import.meta.url)},{path:"gateways",children:[{path:"",name:"gateway-list-view",meta:{title:"Gateways"},props:e=>({selectedDppName:e.query.gateway,gatewayType:e.query.gatewayType==="all"?"true":e.query.gatewayType,offset:_(e.query.offset),isGatewayView:!0}),component:()=>l(()=>import("./DataPlaneListView-415aed09.js"),["./ContentWrapper-fe2d0f8d.css","./ErrorBlock-8c979915.css","./StatusBadge-43351938.css","./TagList-27d87a7b.css","./DataOverview-cc37ba93.css","./CodeBlock-7d9027b4.css","./DataPlaneList-d74cf059.css","./DataPlaneListView-c9bf2e34.css"],import.meta.url)},{path:":dataPlane",name:"gateway-detail-view",meta:{title:"Gateway",parent:"gateway-list-view",breadcrumbTitleParam:"dataPlane"},component:()=>l(()=>import("./DataPlaneDetailView-3236c5f2.js"),["./AccordionItem-2e8063db.css","./CodeBlock-7d9027b4.css","./TagList-27d87a7b.css","./ErrorBlock-8c979915.css","./EnvoyData-55ab94cb.css","./LabelList-82c1e9de.css","./StatusBadge-43351938.css","./TabsWidget-4d82abdb.css","./SubscriptionHeader-da67a0ee.css","./DataPlaneDetailView-230a138b.css"],import.meta.url)}]},{path:"data-planes",children:[{path:"",name:"data-plane-list-view",meta:{title:"Data plane proxies"},props:e=>({selectedDppName:e.query.dpp,offset:_(e.query.offset)}),component:()=>l(()=>import("./DataPlaneListView-415aed09.js"),["./ContentWrapper-fe2d0f8d.css","./ErrorBlock-8c979915.css","./StatusBadge-43351938.css","./TagList-27d87a7b.css","./DataOverview-cc37ba93.css","./CodeBlock-7d9027b4.css","./DataPlaneList-d74cf059.css","./DataPlaneListView-c9bf2e34.css"],import.meta.url)},{path:":dataPlane",name:"data-plane-detail-view",meta:{title:"Data plane proxy",parent:"data-plane-list-view",breadcrumbTitleParam:"dataPlane"},component:()=>l(()=>import("./DataPlaneDetailView-3236c5f2.js"),["./AccordionItem-2e8063db.css","./CodeBlock-7d9027b4.css","./TagList-27d87a7b.css","./ErrorBlock-8c979915.css","./EnvoyData-55ab94cb.css","./LabelList-82c1e9de.css","./StatusBadge-43351938.css","./TabsWidget-4d82abdb.css","./SubscriptionHeader-da67a0ee.css","./DataPlaneDetailView-230a138b.css"],import.meta.url)}]},{path:"services",children:[{path:"",name:"service-list-view",meta:{title:"Services"},props:e=>({selectedServiceName:e.query.service,offset:_(e.query.offset)}),component:()=>l(()=>import("./ServiceListView-0504819f.js"),["./ContentWrapper-fe2d0f8d.css","./ErrorBlock-8c979915.css","./StatusBadge-43351938.css","./TagList-27d87a7b.css","./DataOverview-cc37ba93.css","./CodeBlock-7d9027b4.css","./ServiceSummary-af890f41.css"],import.meta.url)},{path:":service",name:"service-detail-view",meta:{title:"Internal service",parent:"service-list-view",breadcrumbTitleParam:"service"},props:e=>({selectedDppName:e.query.dpp}),component:()=>l(()=>import("./ServiceDetailView-85d62f13.js"),["./ErrorBlock-8c979915.css","./ContentWrapper-fe2d0f8d.css","./StatusBadge-43351938.css","./TagList-27d87a7b.css","./DataOverview-cc37ba93.css","./CodeBlock-7d9027b4.css","./DataPlaneList-d74cf059.css","./ServiceSummary-af890f41.css"],import.meta.url)}]},{path:"policies",name:"policies",meta:{title:"Policies"},redirect:e=>{let s=t.state.policyTypes.find(n=>t.state.sidebar.insights.mesh.policies[n.name]!==0);return s===void 0&&(s=t.state.policyTypes[0]),{...e,params:{...e.params,policyPath:s.path},name:"policy"}}},{path:"policies/:policyPath",name:"policy",meta:{parent:"policies"},component:()=>l(()=>import("./PolicyView-f5a967e8.js"),["./ErrorBlock-8c979915.css","./StatusBadge-43351938.css","./TagList-27d87a7b.css","./DataOverview-cc37ba93.css","./LabelList-82c1e9de.css","./TabsWidget-4d82abdb.css","./CodeBlock-7d9027b4.css","./PolicyView-143a82ea.css"],import.meta.url),props:e=>{const s=t.state.policyTypesByPath[e.params.policyPath];return e.meta.title=s.name,{policyPath:e.params.policyPath,selectedPolicyName:e.query.policy,offset:_(e.query.offset)}}}]},{path:"/onboarding",redirect:{name:"onboarding-welcome"},component:()=>l(()=>import("./ShellEmpty-bbe8ea02.js"),["./ShellEmpty-6642bce4.css"],import.meta.url),children:[{path:"welcome",name:"onboarding-welcome",meta:{title:"Welcome to Kuma!",onboardingProcess:!0},component:()=>l(()=>import("./WelcomeView-f51e87f7.js"),["./OnboardingNavigation-8e0e24c9.css","./WelcomeView-81c1745d.css"],import.meta.url)},{path:"deployment-types",name:"onboarding-deployment-types",meta:{title:"Deployment Types",onboardingProcess:!0},component:()=>l(()=>import("./DeploymentTypes-eda87d9d.js"),["./OnboardingNavigation-8e0e24c9.css","./OnboardingPage-b97c066f.css","./DeploymentTypes-a5506858.css"],import.meta.url)},{path:"configuration-types",name:"onboarding-configuration-types",meta:{title:"Configuration Types",onboardingProcess:!0},component:()=>l(()=>import("./ConfigurationTypes-2f72beee.js"),["./OnboardingNavigation-8e0e24c9.css","./OnboardingPage-b97c066f.css","./ConfigurationTypes-3e295b7d.css"],import.meta.url)},{path:"multi-zone",name:"onboarding-multi-zone",meta:{title:"Multizone",onboardingProcess:!0},component:()=>l(()=>import("./MultiZoneView-5ff49686.js"),["./LoadingBox-c2da9e95.css","./OnboardingNavigation-8e0e24c9.css","./OnboardingPage-b97c066f.css"],import.meta.url)},{path:"create-mesh",name:"onboarding-create-mesh",meta:{title:"Create the Mesh",onboardingProcess:!0},component:()=>l(()=>import("./CreateMesh-52ef7c88.js"),["./OnboardingNavigation-8e0e24c9.css","./OnboardingPage-b97c066f.css"],import.meta.url)},{path:"add-services",name:"onboarding-add-services",meta:{title:"Add new services",onboardingProcess:!0},component:()=>l(()=>import("./AddNewServices-8e40d03c.js"),["./OnboardingNavigation-8e0e24c9.css","./OnboardingPage-b97c066f.css","./AddNewServices-1b605ca2.css"],import.meta.url)},{path:"add-services-code",name:"onboarding-add-services-code",meta:{title:"Add new services",onboardingProcess:!0},component:()=>l(()=>import("./AddNewServicesCode-5e587278.js"),["./CodeBlock-7d9027b4.css","./LoadingBox-c2da9e95.css","./OnboardingNavigation-8e0e24c9.css","./OnboardingPage-b97c066f.css"],import.meta.url)},{path:"dataplanes-overview",name:"onboarding-dataplanes-overview",meta:{title:"Data plane overview",onboardingProcess:!0},component:()=>l(()=>import("./DataplanesOverview-8bd7c191.js"),["./LoadingBox-c2da9e95.css","./StatusBadge-43351938.css","./OnboardingNavigation-8e0e24c9.css","./OnboardingPage-b97c066f.css","./DataplanesOverview-0c89c176.css"],import.meta.url)},{path:"completed",name:"onboarding-completed",meta:{title:"Completed",onboardingProcess:!0},component:()=>l(()=>import("./CompletedView-ca590809.js"),["./OnboardingNavigation-8e0e24c9.css","./OnboardingPage-b97c066f.css"],import.meta.url)}]},{path:"/wizard",name:"wizard",children:[{path:"mesh",name:"create-mesh",meta:{title:"Create a new mesh",wizardProcess:!0},component:()=>l(()=>import("./Mesh-e3650196.js"),["./CodeBlock-7d9027b4.css","./EntityScanner-4a24290d.css","./ErrorBlock-8c979915.css","./TabsWidget-4d82abdb.css","./Mesh-935daaef.css"],import.meta.url)},{path:"kubernetes-dataplane",name:"kubernetes-dataplane",meta:{title:"Create a new data plane proxy on Kubernetes",wizardProcess:!0},component:()=>l(()=>import("./DataplaneKubernetes-442cb23f.js"),["./CodeBlock-7d9027b4.css","./EntityScanner-4a24290d.css","./EnvironmentSwitcher-edfe74c6.css","./DataplaneKubernetes-64b277e1.css"],import.meta.url)},{path:"universal-dataplane",name:"universal-dataplane",meta:{title:"Create a new data plane proxy on Universal",wizardProcess:!0},component:()=>l(()=>import("./DataplaneUniversal-fbd7174d.js"),["./CodeBlock-7d9027b4.css","./EntityScanner-4a24290d.css","./EnvironmentSwitcher-edfe74c6.css","./DataplaneUniversal-3950a0a5.css"],import.meta.url)}]}],M={EnvVars:Ue({KUMA_PRODUCT_NAME:"Kuma",KUMA_FEEDBACK_URL:"https://github.com/kumahq/kuma/issues/new/choose",KUMA_CHAT_URL:"https://kuma-mesh.slack.com",KUMA_INSTALL_URL:"https://kuma.io/install/latest/",KUMA_VERSION_URL:"https://kuma.io/latest_version/",KUMA_DOCS_URL:"https://kuma.io/docs"},{description:"EnvVars"}),Env:O(Z,{description:"Env"}),env:O(()=>t=>K(M.Env).var(t),{description:"env"}),routes:O(()=>xe(vt),{description:"routes"})};Ne(Z,M.EnvVars);const Fe=K(M.Env);class Ge{constructor(){g(this,"client");this.client=new pe}get baseUrl(){return this.client.baseUrl}setBaseUrl(e){this.client.baseUrl=e}getInfo(){return this.client.get("")}async getStatus(){try{const{response:e}=await this.client.raw("");return e.status===200?"OK":null}catch{return null}}async getLatestVersion(){return this.client.get(Fe.var("KUMA_VERSION_URL"))}getConfig(){return this.client.get("config")}getPolicyTypes(){return this.client.get("policies")}getGlobalInsights(){return this.client.get("global-insights")}getZones(e){return this.client.get("zones",{params:e})}getZone({name:e},s){return this.client.get(`zones/${e}`,{params:s})}getAllZoneOverviews(e){return this.client.get("zones+insights",{params:e})}getZoneOverview({name:e},s){return this.client.get(`zones+insights/${e}`,{params:s})}getZoneIngressData({zoneIngressName:e,dataPath:s},n){return this.client.get(`zoneingresses/${e}/${s}`,{params:n})}getAllZoneIngressOverviews(e){return this.client.get("zoneingresses+insights",{params:e})}getZoneIngressOverview({name:e},s){return this.client.get(`zoneingresses+insights/${e}`,{params:s})}getZoneEgressData({zoneEgressName:e,dataPath:s},n){return this.client.get(`zoneegresses/${e}/${s}`,{params:n})}getAllZoneEgressOverviews(e){return this.client.get("zoneegressoverviews",{params:e})}getZoneEgressOverview({name:e},s){return this.client.get(`zoneegressoverviews/${e}`,{params:s})}getAllMeshes(e){return this.client.get("meshes",{params:e})}getMesh({name:e},s){return this.client.get(`meshes/${e}`,{params:s})}getAllMeshInsights(e){return this.client.get("mesh-insights",{params:e})}getMeshInsights({name:e},s){return this.client.get(`mesh-insights/${e}`,{params:s})}getAllDataplanes(e){return this.client.get("dataplanes",{params:e})}getDataplaneFromMesh({mesh:e,name:s},n){return this.client.get(`meshes/${e}/dataplanes/${s}`,{params:n})}getAllDataplaneOverviews(e){return this.client.get("dataplanes+insights",{params:e})}getAllDataplaneOverviewsFromMesh({mesh:e},s){return this.client.get(`meshes/${e}/dataplanes+insights`,{params:s})}getDataplaneOverviewFromMesh({mesh:e,name:s},n){return this.client.get(`meshes/${e}/dataplanes+insights/${s}`,{params:n})}getSidecarDataplanePolicies({mesh:e,name:s},n){return this.client.get(`meshes/${e}/dataplanes/${s}/policies`,{params:n})}getMeshGatewayDataplane({mesh:e,name:s},n){return this.client.get(`meshes/${e}/dataplanes/${s}/policies`,{params:n})}getDataplaneRules({mesh:e,name:s},n){return this.client.get(`meshes/${e}/dataplanes/${s}/rules`,{params:n})}getDataplaneData({mesh:e,dppName:s,dataPath:n},a){return this.client.get(`meshes/${e}/dataplanes/${s}/${n}`,{params:a})}getAllServiceInsights(e){return this.client.get("service-insights",{params:e})}getAllServiceInsightsFromMesh({mesh:e},s){return this.client.get(`meshes/${e}/service-insights`,{params:s})}getServiceInsight({mesh:e,name:s},n){return this.client.get(`meshes/${e}/service-insights/${s}`,{params:n})}getAllExternalServices(e){return this.client.get("external-services",{params:e})}getAllExternalServicesFromMesh({mesh:e},s){return this.client.get(`meshes/${e}/external-services`,{params:s})}getExternalService({mesh:e,name:s},n){return this.client.get(`meshes/${e}/external-services/${s}`,{params:n})}async getExternalServiceByServiceInsightName(e,s){const{items:n}=await this.getAllExternalServicesFromMesh({mesh:e});return Array.isArray(n)?n.find(i=>i.tags["kuma.io/service"]===s)??null:null}getPolicyConnections({mesh:e,policyType:s,policyName:n},a){return this.client.get(`meshes/${e}/${s}/${n}/dataplanes`,{params:a})}getAllPolicyEntities({path:e},s){return this.client.get(e,{params:s})}getAllPolicyEntitiesFromMesh({mesh:e,path:s},n){return this.client.get(`meshes/${e}/${s}`,{params:n})}getSinglePolicyEntity({mesh:e,path:s,name:n},a){return this.client.get(`meshes/${e}/${s}/${n}`,{params:a})}}const c=new Ge,Be={status:null,tagline:null,version:null,kumaDocsVersion:"latest",clientConfig:null},ze={SET_CONFIG_DATA:(t,e)=>t.clientConfig=e,SET_STATUS:(t,e)=>t.status=e,SET_TAGLINE:(t,e)=>t.tagline=e,SET_VERSION:(t,e)=>t.version=e,SET_KUMA_DOCS_VERSION:(t,e)=>t.kumaDocsVersion=e},Ke={getStatus:t=>t.status,getConfig:t=>t.clientConfig,getEnvironment:t=>{var e;return(e=t.clientConfig)==null?void 0:e.environment},getMode:t=>{var e;return(e=t.clientConfig)==null?void 0:e.mode},getTagline:t=>t.tagline,getVersion:t=>t.version,getKumaDocsVersion:t=>t.kumaDocsVersion,getConfigurationType:t=>{var e,s;return(s=(e=t.clientConfig)==null?void 0:e.store)==null?void 0:s.type},getMulticlusterStatus:(t,e)=>({}).VITE_FAKE_MULTIZONE==="true"?(console.warn("%c âœ¨You are currently faking Multi-Zone mode.","background: black; color: white; display: block; padding: 0.25rem;"),!0):e.getMode==="global"},Ze={bootstrapConfig({dispatch:t}){const e=t("getInfo"),s=t("getConfig");return Promise.all([e,s])},getConfig({commit:t}){return c.getConfig().then(e=>{t("SET_CONFIG_DATA",e)})},getStatus({commit:t}){return c.getStatus().then(e=>{t("SET_STATUS",e)})},getInfo({commit:t}){return c.getInfo().then(e=>{t("SET_TAGLINE",e.tagline),t("SET_VERSION",e.version);let s;const n=e.basedOnKuma??e.version,a=n.indexOf("-preview.");if(a!==-1){const i=n.substring(0,a);s=i==="0.0.0"?"dev":i.replace(/\.\d+$/,".x")}else s=n.replace(/\.\d+$/,".x");t("SET_KUMA_DOCS_VERSION",s)}).catch(e=>{console.error(e)})}},je={namespaced:!0,state:()=>Be,getters:Ke,mutations:ze,actions:Ze},We={isOpen:!1},Ye={OPEN_MODAL:t=>t.isOpen=!0,CLOSE_MODAL:t=>t.isOpen=!1},qe={meshNotificationItemMap(t,e,s){var i;return(((i=s.meshes)==null?void 0:i.items)||[]).reduce((r,o)=>(r[o.name]={hasLogging:Boolean(o.logging),hasMtls:Boolean(o.mtls),hasMetrics:Boolean(o.metrics),hasTracing:Boolean(o.tracing)},r),{})},meshNotificationItemMapWithAction(t,e){const s=e.meshNotificationItemMap;return Object.entries(s).reduce((n,[a,i])=>(Object.values(i).some(o=>!o)&&(n[a]=i),n),{})},singleMeshNotificationItems(t,e,s,n){if(s.selectedMesh===null)return[];const a=e.meshNotificationItemMap[s.selectedMesh],i=Object.entries(n.getMeshInsight.policies).filter(([o,h])=>["MeshAccessLog","MeshTrace"].includes(o)).some(([o,h])=>h.total>0),r=[{name:"Observability, Metrics & Service Map",component:"MetricsNotification",isCompleted:a.hasMetrics},{name:"Logging",component:"LoggingNotification",isCompleted:a.hasLogging||i},{name:"Zero-trust security",component:"MtlsNotification",isCompleted:a.hasMtls},{name:"Tracing",component:"TracingNotification",isCompleted:a.hasTracing}];return r.sort((o,h)=>+o.isCompleted-+h.isCompleted),r},amountOfActions(t,e){return Object.keys(e.meshNotificationItemMapWithAction).length}},Je={openModal({commit:t}){t("OPEN_MODAL")},closeModal({commit:t}){t("CLOSE_MODAL")}},Qe={namespaced:!0,state:()=>We,getters:qe,mutations:Ye,actions:Je};class Xe{constructor(e){g(this,"storageAdapter");this.storageAdapter=e}get(e){let s;try{s=this.storageAdapter.getItem(e)}catch{return null}if(s===null||!(s.startsWith("[")||s.startsWith("{")))return s;try{return JSON.parse(s)}catch{return s}}set(e,s){try{const n=typeof s=="string"?s:JSON.stringify(s);this.storageAdapter.setItem(e,n)}catch{}}has(e){try{return this.storageAdapter.getItem(e)!==null}catch{return!1}}remove(e){try{this.storageAdapter.removeItem(e)}catch{}}}const d=new Xe(window.localStorage),et={isCompleted:d.get("onboardingIsCompleted")==="true",step:d.get("onboardingStep")||"onboarding-welcome",mode:"demo"},tt={SET_STEP:(t,e)=>t.step=e,SET_IS_COMPLETED:(t,e)=>t.isCompleted=e,UPDATE_MODE:(t,e)=>t.mode=e},st={getMode:t=>t.mode,showOnboarding:(t,e,s)=>{const n=s.meshes.items.length===1&&s.meshes.items[0].name==="default";return s.totalDataplaneCount===0&&n}},nt={completeOnboarding({commit:t,dispatch:e}){e("fetchDataplaneTotalCount",null,{root:!0}),e("sidebar/getInsights",null,{root:!0}),t("SET_IS_COMPLETED",!0),d.set("onboardingIsCompleted","true"),d.remove("onboardingStep")},changeStep({commit:t},e){t("SET_STEP",e),d.set("onboardingStep",e)}},at={namespaced:!0,state:()=>et,getters:st,mutations:tt,actions:nt};function N(t){const e=t.items.reduce((s,{dataplanes:n,dataplanesByType:a,policies:i,services:r})=>{var o,h;s.services.internal+=r.internal||0,s.services.external+=r.external||0,s.services.total+=r.total||0,s.dataplanes.total+=n.total||0,s.dataplanes.standard+=((o=a.standard)==null?void 0:o.total)||0,s.dataplanes.gateway+=((h=a.gateway)==null?void 0:h.total)||0;for(const[u,p]of Object.entries(i))s.policies[u]||(s.policies[u]=0),s.policies[u]+=p.total||0;return s},{services:{total:0,internal:0,external:0},dataplanes:{total:0,standard:0,gateway:0},policies:{}});return e.policies.total=Object.values(e.policies).reduce((s,n)=>s+n,0),e}function it(t){return Object.entries(t.resources).reduce((e,[s,n])=>(e[s]||(e[s]=0),e[s]+=n.total||0,e),{})}const rt={insights:{global:{},mesh:{services:{total:0,internal:0,external:0},dataplanes:{total:0,standard:0,gateway:0},policies:{}}}},ot={SET_GLOBAL_INSIGHTS:(t,e)=>t.insights.global=e,SET_MESH_INSIGHTS:(t,e)=>t.insights.mesh=e},lt={},ct={getInsights({dispatch:t}){return Promise.all([t("getGlobalInsights"),t("getMeshInsights")])},async getMeshInsights({commit:t,rootState:e}){if(e.selectedMesh===null)return;let s=null;try{const n=await c.getMeshInsights({name:e.selectedMesh});s=N({items:[n]})}catch{s=N({items:[]})}t("SET_MESH_INSIGHTS",s),t("SET_OVERVIEW_CHART_DATA",{chartName:"policies",data:[{category:"Policy",value:s.policies.total,tooltipDisabled:!0,labelDisabled:!0}]},{root:!0})},async getGlobalInsights({commit:t}){const e=await c.getGlobalInsights(),s=it(e);t("SET_GLOBAL_INSIGHTS",s)}},ut={namespaced:!0,state:()=>rt,getters:lt,mutations:ot,actions:ct},j=(t={},e={})=>{const s=t.online||0,n=e.online||0,a=t.partiallyDegraded||0,i=e.partiallyDegraded||0,r=t.total||0,o=e.total||0;return{online:s+n,partiallyDegraded:a+i,total:r+o}},w=()=>({CircuitBreaker:{total:0},FaultInjection:{total:0},HealthCheck:{total:0},MeshAccessLog:{total:0},MeshGateway:{total:0},MeshGatewayRoute:{total:0},MeshTrace:{total:0},MeshTrafficPermission:{total:0},ProxyTemplate:{total:0},RateLimit:{total:0},Retry:{total:0},Timeout:{total:0},TrafficLog:{total:0},TrafficPermission:{total:0},TrafficRoute:{total:0},TrafficTrace:{total:0},VirtualOutbound:{total:0}}),ht=(t=w(),e={})=>Object.entries(e).reduce((s,[n,a])=>{const i=s[n]?s[n].total:0;return{...s,[n]:{total:i+a.total}}},t),V=(t={},e={})=>Object.entries(e).reduce((s,[n,a])=>({...s,[n]:j(s[n],a)}),t),pt=(t={},e={})=>({kumaDp:V(t.kumaDp,e.kumaDp),envoy:V(t.envoy,e.envoy)});function W(){return{meshesTotal:0,dataplanes:{online:0,partiallyDegraded:0,total:0},policies:w(),dpVersions:{kumaDp:{},envoy:{}}}}function gt(t={}){return Y([t])}function Y(t=[]){return t.reduce((e,s)=>({meshesTotal:t.length,dataplanes:j(e.dataplanes,s.dataplanes),policies:ht(e.policies,s.policies),dpVersions:pt(e.dpVersions,s.dpVersions)}),{meshesTotal:0,dataplanes:{online:0,partiallyDegraded:0,total:0},policies:w(),dpVersions:{kumaDp:{},envoy:{}}})}const U="Online",$="Offline",mt="Partially degraded",dt={menu:null,globalLoading:!0,pageTitle:"",meshes:{total:0,items:[],next:null},selectedMesh:"default",totalDataplaneCount:0,version:"",itemQueryNamespace:"item",totalClusters:0,serviceSummary:{total:0,internal:{total:0,online:0,offline:0,partiallyDegraded:0},external:{total:0}},overviewCharts:{dataplanes:{data:[]},meshes:{data:[]},services:{data:[]},policies:{data:[]},zones:{data:[]},zonesCPVersions:{data:[]},kumaDPVersions:{data:[]},envoyVersions:{data:[]}},meshInsight:W(),meshInsightsFetching:!1,serviceInsightsFetching:!1,externalServicesFetching:!1,zonesInsightsFetching:!1,policyTypes:[],policyTypesByPath:{},policyTypesByName:{}},_t={modules:{sidebar:ut,config:je,notifications:Qe,onboarding:at},state:()=>dt,getters:{globalLoading:t=>t.globalLoading,getMeshList:t=>t.meshes,getItemQueryNamespace:t=>t.itemQueryNamespace,getMeshInsight:t=>t.meshInsight,getMeshInsightsFetching:t=>t.meshInsightsFetching,getServiceInsightsFetching:t=>t.serviceInsightsFetching,getExternalServicesFetching:t=>t.externalServicesFetching,getResourceFetching:({meshInsightsFetching:t,serviceInsightsFetching:e,externalServicesFetching:s})=>t||e||s,getServiceResourcesFetching:({serviceInsightsFetching:t,externalServicesFetching:e})=>t||e,getChart:({overviewCharts:t})=>e=>t[e],getZonesInsightsFetching:({zonesInsightsFetching:t})=>t},mutations:{SET_GLOBAL_LOADING:(t,{globalLoading:e})=>t.globalLoading=e,SET_PAGE_TITLE:(t,e)=>t.pageTitle=e,SET_MESHES:(t,e)=>t.meshes=e,SET_SELECTED_MESH:(t,e)=>t.selectedMesh=e,SET_TOTAL_DATAPLANE_COUNT:(t,e)=>t.totalDataplaneCount=e,SET_TOTAL_CLUSTER_COUNT:(t,e)=>t.totalClusters=e,SET_INTERNAL_SERVICE_SUMMARY:(t,{items:e=[]}={})=>{const{serviceSummary:s}=t,n=(u,{status:p="offline"})=>({...u,[p]:u[p]+1}),a={online:0,partially_degraded:0,offline:0},{online:i,offline:r,partially_degraded:o}=e.reduce(n,a),h=i+r+o;s.internal={...s.internal,total:h,online:i,partiallyDegraded:o,offline:r},s.total=s.external.total+h},SET_EXTERNAL_SERVICE_SUMMARY:(t,{total:e=0}={})=>{t.serviceSummary.external.total=e,t.serviceSummary.total=t.serviceSummary.internal.total+e},SET_MESH_INSIGHT:(t,e)=>t.meshInsight=gt(e),SET_MESH_INSIGHT_FROM_ALL_MESHES:(t,e)=>t.meshInsight=Y(e.items),SET_ZONES_INSIGHTS_FETCHING:(t,e)=>t.zonesInsightsFetching=e,SET_MESH_INSIGHTS_FETCHING:(t,e)=>t.meshInsightsFetching=e,SET_SERVICE_INSIGHTS_FETCHING:(t,e)=>t.serviceInsightsFetching=e,SET_EXTERNAL_SERVICES_FETCHING:(t,e)=>t.externalServicesFetching=e,SET_OVERVIEW_CHART_DATA:(t,e)=>{const{chartName:s,data:n}=e;t.overviewCharts[s].data=n},SET_POLICY_TYPES:(t,e)=>{e.sort((s,n)=>s.name.localeCompare(n.name)),t.policyTypes=e},SET_POLICY_TYPES_BY_PATH:(t,e)=>t.policyTypesByPath=e,SET_POLICY_TYPES_BY_NAME:(t,e)=>t.policyTypesByName=e},actions:{async bootstrap({commit:t,dispatch:e,getters:s,state:n}){if(t("SET_GLOBAL_LOADING",{globalLoading:!0}),await e("config/getStatus"),s["config/getStatus"]==="OK")if(await Promise.all([e("fetchMeshList"),e("fetchDataplaneTotalCount"),e("config/bootstrapConfig")]),n.meshes.items.length>0){const a=d.get("selectedMesh");let i;if(a!==null){const r=n.meshes.items.find(o=>o.name===a);r!==void 0&&(i=r)}i===void 0&&(i=n.meshes.items[0]),await e("updateSelectedMesh",i.name),await e("sidebar/getInsights")}else await e("updateSelectedMesh",null);t("SET_GLOBAL_LOADING",{globalLoading:!1})},updatePageTitle({commit:t},e){t("SET_PAGE_TITLE",e)},async fetchMeshList({commit:t}){const e={size:C};try{const s=await c.getAllMeshes(e);Array.isArray(s.items)?s.items.sort((n,a)=>n.name==="default"?-1:a.name==="default"?1:n.name.localeCompare(a.name)):s.items=[],t("SET_MESHES",s)}catch(s){console.error(s)}},updateSelectedMesh({commit:t},e){e!==null?d.set("selectedMesh",e):d.remove("selectedMesh"),t("SET_SELECTED_MESH",e)},fetchTotalClusterCount({commit:t}){return c.getZones().then(e=>{const s=e.total;t("SET_TOTAL_CLUSTER_COUNT",s)})},fetchDataplaneTotalCount({commit:t}){const e={size:1};return c.getAllDataplanes(e).then(s=>{const n=s.total;t("SET_TOTAL_DATAPLANE_COUNT",n)}).catch(s=>{console.error(s)})},async fetchMeshInsights({commit:t,dispatch:e},s){t("SET_MESH_INSIGHTS_FETCHING",!0);try{if(s===void 0){const n=await T(c.getAllMeshInsights.bind(c)),a=[];n.items.length>0&&a.push({category:"Mesh",value:n.items.length,tooltipDisabled:!0,labelDisabled:!0}),t("SET_OVERVIEW_CHART_DATA",{chartName:"meshes",data:a}),t("SET_MESH_INSIGHT_FROM_ALL_MESHES",n)}else t("SET_MESH_INSIGHT",await c.getMeshInsights({name:s}))}catch{t("SET_OVERVIEW_CHART_DATA",{chartName:"meshes",data:[]}),t("SET_MESH_INSIGHT",W())}finally{e("setChartsFromMeshInsights")}t("SET_MESH_INSIGHTS_FETCHING",!1)},async fetchServiceInsights({commit:t},e){t("SET_SERVICE_INSIGHTS_FETCHING",!0);try{const s=e===void 0?c.getAllServiceInsights.bind(c):c.getAllServiceInsightsFromMesh.bind(c,{mesh:e});t("SET_INTERNAL_SERVICE_SUMMARY",await T(s))}catch{t("SET_INTERNAL_SERVICE_SUMMARY")}t("SET_SERVICE_INSIGHTS_FETCHING",!1)},async fetchExternalServices({commit:t},e){t("SET_EXTERNAL_SERVICES_FETCHING",!0);try{const s=e===void 0?c.getAllExternalServices.bind(c):c.getAllExternalServicesFromMesh.bind(c,{mesh:e});t("SET_EXTERNAL_SERVICE_SUMMARY",await T(s))}catch{t("SET_EXTERNAL_SERVICE_SUMMARY")}t("SET_EXTERNAL_SERVICES_FETCHING",!1)},async fetchServices({dispatch:t},e){const s=t("fetchExternalServices",e),n=t("fetchServiceInsights",e);await Promise.all([n,s]),await t("setOverviewServicesChartData")},async fetchZonesInsights({commit:t,dispatch:e,getters:s},n=!1){t("SET_ZONES_INSIGHTS_FETCHING",!0);try{if(n){const a=await T(c.getAllZoneOverviews.bind(c));e("setOverviewZonesChartData",a),e("setOverviewZonesCPVersionsChartData",a)}else{const a=[{category:"Zone",value:1,tooltipDisabled:!0,labelDisabled:!0}],i=[{category:s["config/getVersion"],value:1,tooltipDisabled:!0}];t("SET_OVERVIEW_CHART_DATA",{chartName:"zones",data:a}),t("SET_OVERVIEW_CHART_DATA",{chartName:"zonesCPVersions",data:i})}}catch{t("SET_OVERVIEW_CHART_DATA",{chartName:"zones",data:[]}),t("SET_OVERVIEW_CHART_DATA",{chartName:"zonesCPVersions",data:[]})}t("SET_ZONES_INSIGHTS_FETCHING",!1)},async fetchPolicyTypes({commit:t}){const{policies:e}=await c.getPolicyTypes(),s=e.reduce((a,i)=>Object.assign(a,{[i.path]:i}),{}),n=e.reduce((a,i)=>Object.assign(a,{[i.name]:i}),{});t("SET_POLICY_TYPES",e),t("SET_POLICY_TYPES_BY_PATH",s),t("SET_POLICY_TYPES_BY_NAME",n)},setChartsFromMeshInsights({dispatch:t}){t("setOverviewDataplanesChartData"),t("setOverviewKumaDPVersionsChartData"),t("setOverviewEnvoyVersionsChartData")},setOverviewZonesChartData({commit:t},{items:e=[]}){const s=e.length;let n=0;e.forEach(i=>{H(i.zoneInsight)==="online"&&n++});const a=[];s&&(a.push({category:U,value:n}),n!==s&&a.push({category:$,value:s-n})),t("SET_OVERVIEW_CHART_DATA",{chartName:"zones",data:a})},setOverviewServicesChartData({state:t,commit:e}){const{internal:s,external:n}=t.serviceSummary,a=[];s.total&&t.selectedMesh!==null&&a.push({category:"Internal",value:s.total,minSizeForLabel:.16,route:{name:"service-list-view",params:{mesh:t.selectedMesh}}}),n.total&&t.selectedMesh!==null&&a.push({category:"External",value:n.total,minSizeForLabel:.16,route:{name:"service-list-view",params:{mesh:t.selectedMesh}}}),e("SET_OVERVIEW_CHART_DATA",{chartName:"services",data:a})},setOverviewDataplanesChartData({state:t,commit:e}){const s=t.meshInsight.dataplanes.total,n=t.meshInsight.dataplanes.online??0,a=t.meshInsight.dataplanes.partiallyDegraded??0,i=[];s&&(i.push({category:U,value:n}),a&&i.push({category:mt,value:a}),n+a!==s&&i.push({category:$,value:s-a-n})),e("SET_OVERVIEW_CHART_DATA",{chartName:"dataplanes",data:i})},setOverviewZonesCPVersionsChartData({commit:t},{items:e}){const s=e.reduce((n,a)=>{const{subscriptions:i}=a.zoneInsight;if(!i.length)return n;const{version:r}=a.zoneInsight.subscriptions.pop(),o=n.find(({category:h})=>{var u;return h===((u=r==null?void 0:r.kumaCp)==null?void 0:u.version)});return o?o.value++:n.push({category:r.kumaCp.version,value:1}),n},[]);t("SET_OVERVIEW_CHART_DATA",{chartName:"zonesCPVersions",data:s})},setOverviewEnvoyVersionsChartData({state:t,commit:e}){const{envoy:s}=t.meshInsight.dpVersions,n=Object.entries(s).map(([a,i])=>({category:a,value:i.total}));e("SET_OVERVIEW_CHART_DATA",{chartName:"envoyVersions",data:n})},setOverviewKumaDPVersionsChartData({state:t,commit:e}){const{kumaDp:s}=t.meshInsight.dpVersions,n=Object.entries(s).map(([a,i])=>({category:a,value:i.total}));e("SET_OVERVIEW_CHART_DATA",{chartName:"kumaDPVersions",data:n})}}},Et=Symbol("store"),vt=Q(_t);function Ut(){return X(Et)}export{le as A,d as C,Lt as I,M as T,l as _,K as a,Et as b,Vt as c,H as d,yt as e,T as f,k as g,Ct as h,ae as i,bt as j,c as k,re as l,oe as m,At as n,Dt as o,Mt as p,wt as q,It as r,vt as s,Rt as t,Ut as u,ie as v,Nt as w,Pt as x,Ot as y};
