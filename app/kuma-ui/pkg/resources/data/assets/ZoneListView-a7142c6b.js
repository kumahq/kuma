import{d as I,j as N,o as s,a as r,w as e,y as A,g as a,b as t,M as B,f as S,Y as O,r as J,h as i,q as h,J as K,A as P,t as p,e as M,F as Z,v as $,E as W,C as D,G as E}from"./index-4513d162.js";import{_ as j}from"./MultizoneInfo.vue_vue_type_script_setup_true_lang-8d850328.js";import{_ as G,A as U}from"./DataSource.vue_vue_type_script_setup_true_lang-cf5e86d7.js";import{F as Y,g as H,n as Q,e as X,A as ee,_ as te,o as oe,f as ne}from"./RouteView.vue_vue_type_script_setup_true_lang-66b620d6.js";import{_ as ae}from"./RouteTitle.vue_vue_type_script_setup_true_lang-6fada8eb.js";import{S as se}from"./StatusBadge-45a87c79.js";const ie=I({__name:"DeleteResourceModal",props:{actionButtonText:{type:String,required:!1,default:"Yes, delete"},confirmationText:{type:String,required:!1,default:""},deleteFunction:{type:Function,required:!0},isVisible:{type:Boolean,required:!0},modalId:{type:String,required:!0},title:{type:String,required:!1,default:"Delete"}},emits:["cancel","delete"],setup(C,{emit:u}){const l=C,n=N(!1);async function w(){n.value=!1;try{await l.deleteFunction(),u("delete")}catch{n.value=!0}}return(f,d)=>(s(),r(t(O),{"action-button-text":l.actionButtonText,"confirmation-text":l.confirmationText,"is-visible":l.isVisible,"modal-id":l.modalId,title:l.title,type:"danger","data-testid":"delete-resource-modal",onCanceled:d[0]||(d[0]=_=>u("cancel")),onProceed:w},{"body-content":e(()=>[A(f.$slots,"body-content"),a(),n.value?(s(),r(t(B),{key:0,class:"mt-4",appearance:"danger","is-dismissible":""},{alertMessage:e(()=>[A(f.$slots,"error")]),_:3})):S("",!0)]),_:3},8,["action-button-text","confirmation-text","is-visible","modal-id","title"]))}}),le=I({__name:"ZoneListView",props:{page:{type:Number,required:!0},size:{type:Number,required:!0}},setup(C){const u=C,l=Y(),{t:n}=H(),w=Q(),f=X(),d=N(!1),_=N("");function L(b){return b.map(y=>{var T;const{name:g}=y,V={name:"zone-cp-detail-view",params:{zone:g}};let c="",v="",k=!0;(((T=y.zoneInsight)==null?void 0:T.subscriptions)??[]).forEach(m=>{if(m.version&&m.version.kumaCp){c=m.version.kumaCp.version;const{kumaCpGlobalCompatible:R=!0}=m.version.kumaCp;k=R,m.config&&(v=JSON.parse(m.config).store.type)}});const z=oe(y.zoneInsight);return{detailViewRoute:V,name:g,status:z,zoneCpVersion:c,storeType:v,warnings:!k}})}async function q(){await w.deleteZone({name:_.value})}function x(){d.value=!d.value}function F(b){x(),_.value=b}return(b,y)=>{const g=J("RouterLink");return s(),r(te,{name:"zone-cp-list-view"},{default:e(({route:V})=>[i(ee,{breadcrumbs:[{to:{name:"zone-cp-list-view"},text:t(n)("zone-cps.routes.items.breadcrumbs")}]},{title:e(()=>[h("h2",null,[i(ae,{title:t(n)("zone-cps.routes.items.title"),render:!0},null,8,["title"])])]),default:e(()=>[a(),t(f).getters["config/getMulticlusterStatus"]===!1?(s(),r(j,{key:0})):(s(),r(G,{key:1,src:`/zone-cps?size=${u.size}&page=${u.page}`},{default:e(({data:c,error:v,refresh:k})=>[i(t(K),null,{body:e(()=>[i(U,{class:"zone-cp-collection","data-testid":"zone-cp-collection",headers:[{label:"Name",key:"name"},{label:"Zone CP Version",key:"zoneCpVersion"},{label:"Storage type",key:"storeType"},{label:"Status",key:"status"},{label:"Warnings",key:"warnings",hideLabel:!0},{label:"Actions",key:"actions",hideLabel:!0}],"page-number":u.page,"page-size":u.size,total:c==null?void 0:c.total,items:c?L(c.items):void 0,error:v,onChange:V.update},P({name:e(({row:o,rowValue:z})=>[i(g,{to:o.detailViewRoute,"data-testid":"detail-view-link"},{default:e(()=>[a(p(z),1)]),_:2},1032,["to"])]),zoneCpVersion:e(({rowValue:o})=>[a(p(o||"—"),1)]),storeType:e(({rowValue:o})=>[a(p(o||"—"),1)]),status:e(({rowValue:o})=>[o?(s(),r(se,{key:0,status:o},null,8,["status"])):(s(),M(Z,{key:1},[a(`
                    —
                  `)],64))]),warnings:e(({rowValue:o})=>[o?(s(),r(t($),{key:0,class:"mr-1",icon:"warning",color:"var(--black-500)","secondary-color":"var(--yellow-300)",size:"20"})):(s(),M(Z,{key:1},[a(`
                     
                  `)],64))]),actions:e(({row:o})=>[i(t(W),{class:"actions-dropdown","data-testid":"actions-dropdown","kpop-attributes":{placement:"bottomEnd",popoverClasses:"mt-5 more-actions-popover"},width:"150"},{default:e(()=>[i(t(D),{class:"non-visual-button",appearance:"secondary",size:"small"},{icon:e(()=>[i(t($),{color:"var(--black-400)",icon:"more",size:"16"})]),_:1})]),items:e(()=>[i(t(E),{item:{to:o.detailViewRoute,label:t(n)("common.collection.actions.view")}},null,8,["item"]),a(),t(l)("KUMA_ZONE_CREATION_FLOW")==="enabled"?(s(),r(t(E),{key:0,"has-divider":"","is-dangerous":"","data-testid":"dropdown-delete-item",onClick:z=>F(o.name)},{default:e(()=>[a(p(t(n)("common.collection.actions.delete")),1)]),_:2},1032,["onClick"])):S("",!0)]),_:2},1024)]),_:2},[t(l)("KUMA_ZONE_CREATION_FLOW")==="enabled"?{name:"toolbar",fn:e(()=>[i(t(D),{appearance:"creation",icon:"plus",to:{name:"zone-create-view"}},{default:e(()=>[a(`
                    Create Zone
                  `)]),_:1})]),key:"0"}:void 0]),1032,["page-number","page-size","total","items","error","onChange"])]),_:2},1024),a(),d.value?(s(),r(ie,{key:0,"confirmation-text":_.value,"delete-function":q,"is-visible":d.value,"modal-id":"delete-zone-modal","action-button-text":t(n)("zones.delete.confirmModal.proceedText"),title:t(n)("zones.delete.confirmModal.title"),onCancel:x,onDelete:()=>{x(),k()}},{"body-content":e(()=>[h("p",null,p(t(n)("zones.delete.confirmModal.text1",{zoneName:_.value})),1),a(),h("p",null,p(t(n)("zones.delete.confirmModal.text2")),1)]),error:e(()=>[a(p(t(n)("zones.delete.confirmModal.errorText")),1)]),_:2},1032,["confirmation-text","is-visible","action-button-text","title","onDelete"])):S("",!0)]),_:2},1032,["src"]))]),_:2},1032,["breadcrumbs"])]),_:1})}}});const fe=ne(le,[["__scopeId","data-v-0a5ac0a0"]]);export{fe as default};
