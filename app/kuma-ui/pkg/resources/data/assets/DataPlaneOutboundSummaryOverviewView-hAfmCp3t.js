import{d as J,r as m,o as t,p,w as a,b as u,c as n,J as c,K as f,Q as M,e as o,t as h,l as d,m as O,a0 as q,q as g,a1 as A,_ as E}from"./index-Ch1waQC_.js";import{A as H,a as K}from"./AccordionList-DPylFu0R.js";import{P as N}from"./PolicyTypeTag-7AJAq-Ze.js";import{R as Q}from"./RuleMatchers-B9o7KTve.js";const Y={key:0,class:"rules"},G={class:"stack-with-borders mt-4"},U={class:"stack-with-borders mt-4"},W={class:"mt-4"},Z={class:"stack-with-borders"},ee={class:"mt-2"},te=J({__name:"DataPlaneOutboundSummaryOverviewView",props:{data:{},routeName:{}},setup(X){const k=X,V=(v,e)=>v.$resourceMeta.name===e.name&&v.$resourceMeta.namespace===e.namespace&&v.$resourceMeta.zone===e.zone&&(e.resourceSectionName===""||v.$resourceMeta.port===e.port);return(v,e)=>{const S=m("XBadge"),D=m("XAction"),C=m("DataCollection"),R=m("XCodeBlock"),z=m("XCard"),x=m("DataLoader"),L=m("DataSource"),j=m("AppView"),F=m("RouteView");return t(),p(F,{params:{mesh:"",dataPlane:"",connection:""},name:k.routeName},{default:a(({t:T,route:P,uri:I})=>[u(j,null,{default:a(()=>[(t(!0),n(c,null,f([P.params.connection.replace(/-([a-f0-9]){16}$/,"")],B=>(t(),n("div",{key:B,class:"stack-with-borders"},[u(M,{layout:"horizontal"},{title:a(()=>e[0]||(e[0]=[o(`
              Protocol
            `)])),body:a(()=>[u(S,{appearance:"info"},{default:a(()=>[o(h(T(`http.api.value.${["grpc","http","tcp"].find(w=>typeof k.data[w]<"u")}`)),1)]),_:2},1024)]),_:2},1024),e[17]||(e[17]=o()),k.data?(t(),n("div",Y,[e[15]||(e[15]=d("h3",null,"Rules",-1)),e[16]||(e[16]=o()),u(L,{src:"/policy-types"},{default:a(({data:w})=>[(t(!0),n(c,null,f([Object.groupBy((w==null?void 0:w.policies)??[],_=>_.name)],_=>(t(),p(x,{key:typeof _,src:I(O(q),"/meshes/:mesh/rules/for/:dataplane",{mesh:P.params.mesh,dataplane:P.params.dataPlane})},{default:a(({data:$})=>[k.data.$resourceMeta.type!==""?(t(),p(C,{key:0,predicate:i=>i.resourceMeta.type==="Mesh"||V(k.data,i),items:$.toResourceRules},{default:a(({items:i})=>[d("div",G,[(t(!0),n(c,null,f(Object.groupBy(i,r=>r.type),(r,y)=>(t(),n("div",{key:y},[u(N,{"policy-type":y},{default:a(()=>[o(h(y),1)]),_:2},1032,["policy-type"]),e[5]||(e[5]=o()),d("div",U,[(t(!0),n(c,null,f(r.length>1?r.filter(s=>V(k.data,s)):r,s=>(t(),n("div",{key:s},[s.origins.length>0?(t(),p(M,{key:0,layout:"horizontal"},{title:a(()=>e[2]||(e[2]=[o(`
                                      Origin Policies
                                    `)])),body:a(()=>[u(C,{predicate:l=>typeof l.resourceMeta<"u",items:s.origins,empty:!1},{default:a(({items:l})=>[d("ul",null,[(t(!0),n(c,null,f(l,b=>(t(),n("li",{key:JSON.stringify(b)},[Object.keys(_).length>0?(t(),p(D,{key:0,to:{name:"policy-detail-view",params:{policyPath:_[y][0].path,mesh:b.resourceMeta.mesh,policy:b.resourceMeta.name}}},{default:a(()=>[o(h(b.resourceMeta.name),1)]),_:2},1032,["to"])):g("",!0)]))),128))])]),_:2},1032,["predicate","items"])]),_:2},1024)):g("",!0),e[4]||(e[4]=o()),u(R,{class:"mt-2",code:O(A).stringify(s.raw),language:"yaml","show-copy-button":!1},null,8,["code"])]))),128))])]))),128))])]),_:2},1032,["predicate","items"])):(t(),p(C,{key:1,predicate:i=>i.ruleType==="to"&&!["MeshHTTPRoute","MeshTCPRoute"].includes(i.type)&&i.matchers.every(r=>r.key==="kuma.io/service"&&(r.not?r.value!==B:r.value===B)),items:$.rules},{default:a(({items:i})=>[d("div",W,[u(H,{"initially-open":0,"multiple-open":"",class:"stack"},{default:a(()=>[(t(!0),n(c,null,f(Object.groupBy(i,r=>r.type),(r,y)=>(t(),p(z,{key:y},{default:a(()=>[u(K,null,{"accordion-header":a(()=>[u(N,{"policy-type":y},{default:a(()=>[o(h(y)+" ("+h(r.length)+`)
                                  `,1)]),_:2},1032,["policy-type"])]),"accordion-content":a(()=>[d("div",Z,[(t(!0),n(c,null,f(r,s=>(t(),n(c,{key:s},[s.matchers.length>0?(t(),p(M,{key:0,layout:"horizontal"},{title:a(()=>e[6]||(e[6]=[o(`
                                          From
                                        `)])),body:a(()=>[d("p",null,[u(Q,{items:s.matchers},null,8,["items"])])]),_:2},1024)):g("",!0),e[12]||(e[12]=o()),s.origins.length>0?(t(),p(M,{key:1,layout:"horizontal"},{title:a(()=>e[8]||(e[8]=[o(`
                                          Origin Policies
                                        `)])),body:a(()=>[d("ul",null,[(t(!0),n(c,null,f(s.origins,l=>(t(),n("li",{key:`${l.mesh}-${l.name}`},[_[l.type]?(t(),p(D,{key:0,to:{name:"policy-detail-view",params:{mesh:l.mesh,policyPath:_[l.type][0].path,policy:l.name}}},{default:a(()=>[o(h(l.name),1)]),_:2},1032,["to"])):(t(),n(c,{key:1},[o(h(l.name),1)],64))]))),128))])]),_:2},1024)):g("",!0),e[13]||(e[13]=o()),d("div",null,[e[10]||(e[10]=d("dt",null,`
                                          Config
                                        `,-1)),e[11]||(e[11]=o()),d("dd",ee,[d("div",null,[u(R,{code:O(A).stringify(s.raw),language:"yaml","show-copy-button":!1},null,8,["code"])])])])],64))),128))])]),_:2},1024)]),_:2},1024))),128))]),_:2},1024)])]),_:2},1032,["predicate","items"]))]),_:2},1032,["src"]))),128))]),_:2},1024)])):g("",!0)]))),128))]),_:2},1024)]),_:1},8,["name"])}}}),se=E(te,[["__scopeId","data-v-5e04b0e7"]]);export{se as default};
