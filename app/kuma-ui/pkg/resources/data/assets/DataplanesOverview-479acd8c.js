import{W as P}from"./kongponents.es-8abed680.js";import{e as S}from"./production-0f1ffdb6.js";import{k as h}from"./kumaApi-de9fdcba.js";import{L as A}from"./LoadingBox-74881ab8.js";import{S as N}from"./StatusBadge-22b77528.js";import{O as T,a as F,b as E}from"./OnboardingPage-8b536a7f.js";import{d as I,r as b,c as w,N as L,a as y,w as t,o as s,e as n,a4 as W,u as o,g as l,t as d,h as u,f as k,F as C}from"./runtime-dom.esm-bundler-a6f4ece5.js";import{_ as H}from"./_plugin-vue_export-helper-c27b6911.js";import"./store-0511bcbf.js";const M={key:0,class:"status-loading-box mb-4"},R={key:1},V={class:"mb-4"},z=I({__name:"DataplanesOverview",setup(U){const x=[{label:"Mesh",key:"mesh"},{label:"Name",key:"name"},{label:"Status",key:"status"}],e=b({total:0,data:[]}),i=b(null),D=w(()=>e.value.data.length>0?"Success":"Waiting for DPPs"),m=w(()=>e.value.data.length>0?"The following data plane proxies (DPPs) are connected to the control plane:":null);L(function(){p()}),f();function p(){i.value!==null&&window.clearTimeout(i.value)}async function f(){let r=!1;const c=[];try{const{items:a}=await h.getAllDataplanes({size:10});if(Array.isArray(a))for(const B of a){const{name:v,mesh:_}=B,O=await h.getDataplaneOverviewFromMesh({mesh:_,name:v}),g=S(O.dataplaneInsight);g==="offline"&&(r=!0),c.push({status:g,name:v,mesh:_})}}catch(a){console.error(a)}e.value.data=c,e.value.total=e.value.data.length,r&&(p(),i.value=window.setTimeout(f,1e3))}return(r,c)=>(s(),y(T,null,{header:t(()=>[n(F,null,W({title:t(()=>[l("p",null,d(o(D)),1)]),_:2},[o(m)!==null?{name:"description",fn:t(()=>[l("p",null,d(o(m)),1)]),key:"0"}:void 0]),1024)]),content:t(()=>[e.value.data.length===0?(s(),u("div",M,[n(A)])):(s(),u("div",R,[l("p",V,[l("b",null,"Found "+d(e.value.data.length)+" DPPs:",1)]),k(),n(o(P),{class:"mb-4",fetcher:()=>e.value,headers:x,"disable-pagination":""},{status:t(({rowValue:a})=>[a?(s(),y(N,{key:0,status:a},null,8,["status"])):(s(),u(C,{key:1},[k(`
              â€”
            `)],64))]),_:1},8,["fetcher"])]))]),navigation:t(()=>[n(E,{"next-step":"onboarding-completed","previous-step":"onboarding-add-services-code","should-allow-next":e.value.data.length>0},null,8,["should-allow-next"])]),_:1}))}});const $=H(z,[["__scopeId","data-v-d8337cda"]]);export{$ as default};
