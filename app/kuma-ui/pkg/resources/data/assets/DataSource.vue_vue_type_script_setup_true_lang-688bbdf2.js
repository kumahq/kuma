import{d as h,D as b,k as p,J as y,o as _,a as k,C as $,v as B,w as C,e as S,A as g,b as v,W as w,B as A,g as z,F as x,s as N}from"./index-d322b456.js";import{f as D,H as E}from"./RouteView.vue_vue_type_script_setup_true_lang-63b6d0ca.js";const L={key:0,class:"app-collection-toolbar"},q=h({__name:"AppCollection",props:{total:{default:0},pageNumber:{},pageSize:{},items:{},error:{}},emits:["change"],setup(d,{emit:i}){const o=d,u=b(),a=p(o.items),s=p(0);y(()=>o.items,()=>{s.value++,a.value=o.items});const r=n=>{const c=n.target.closest("tr");if(c){const t=c.querySelector("a");t!==null&&t.click()}};return(n,c)=>(_(),k(v(w),{class:"app-collection","has-error":typeof o.error<"u","pagination-total-items":o.total,"initial-fetcher-params":{page:o.pageNumber,pageSize:o.pageSize},"fetcher-cache-key":String(s.value),fetcher:({page:t,pageSize:l,query:e})=>(i("change",{page:t,size:l,s:e}),{data:a.value}),"cell-attrs":({headerKey:t})=>({class:`${t}-column`}),"empty-state-icon-size":"96","disable-sorting":"","hide-pagination-when-optional":"","onRow:click":r},$({_:2},[B(Object.keys(v(u)),t=>({name:t,fn:C(({row:l,rowValue:e})=>[t==="toolbar"?(_(),S("div",L,[g(n.$slots,"toolbar",{},void 0,!0)])):g(n.$slots,t,{key:1,row:l,rowValue:e},void 0,!0)])}))]),1032,["has-error","pagination-total-items","initial-fetcher-params","fetcher-cache-key","fetcher","cell-attrs"]))}});const j=D(q,[["__scopeId","data-v-f33076d8"]]),F=N("span",null,null,-1),H=h({__name:"DataSource",props:{src:{type:String,required:!0}},emits:["change","error"],setup(d,{emit:i}){const o=d,u=E(),a=p(void 0),s=p(void 0);let r={};const n=Symbol(""),c=async e=>{if(a.value=void 0,r=t(r),r.src=e,e==="")return;r.controller=new AbortController;const f=u.source(e,n);f.addEventListener("message",m=>{a.value=m.data,s.value=void 0,i("change",a.value)},{signal:r.controller.signal}),f.addEventListener("error",m=>{s.value=m.error,i("error",s.value)},{signal:r.controller.signal})},t=e=>(typeof e.controller<"u"&&e.controller.abort(),typeof e.src<"u"&&u.close(e.src,n),{});y(()=>o.src,e=>c(e),{immediate:!0}),A(()=>{r=t(r)});const l=()=>{c(o.src)};return(e,f)=>(_(),S(x,null,[g(e.$slots,"default",{data:a.value,error:s.value,refresh:l}),z(),F],64))}});export{j as A,H as _};
