import{d as O,a2 as z,L,f as v,r as P,o as n,g as y,w as t,h as i,a7 as S,l as e,m as u,i as p,Y as C,a8 as _,D as s,U as H,a9 as K,aa as F,K as U,k as N,j as r,F as m,G as b,ab as $,q as j}from"./index-ba2f01fe.js";import{_ as G}from"./SubscriptionList.vue_vue_type_script_setup_true_lang-2ed70bf0.js";import{T as R}from"./TagList-5f395bc5.js";import{a as W,d as x,b as Z,c as q,C as X,I as Y}from"./dataplane-0a086c06.js";import"./AccordionList-dba7a625.js";const J=["data-testid","innerHTML"],Q={class:"stack","data-testid":"detail-view-details"},ee={class:"columns",style:{"--columns":"3"}},te={class:"status-with-reason"},ae={class:"columns",style:{"--columns":"5"}},se=["innerHTML"],ne={key:0},le=O({__name:"DataPlaneDetailView",props:{data:{}},setup(B){const o=B,{formatIsoDate:w}=z(),M=L(),D=v(()=>W(o.data.dataplane,o.data.dataplaneInsight)),T=v(()=>x(o.data.dataplane)),V=v(()=>Z(o.data.dataplaneInsight)),E=v(()=>{var d,k;const f=((d=o.data.dataplaneInsight)==null?void 0:d.subscriptions)??[];if(f.length===0)return[];const h=f[f.length-1];if(!("version"in h)||!h.version)return[];const c=h.version,g=[];if(c.kumaDp&&c.envoy){const l=q(c);l.kind!==X&&l.kind!==Y&&g.push(l)}const a=(k=o.data.dataplaneInsight)==null?void 0:k.mTLS;return a&&Date.now()>new Date(a==null?void 0:a.certificateExpirationTime).getTime()&&g.push({kind:"CERT_EXPIRED",payload:{}}),M("use zones")&&x(o.data.dataplane).find(A=>A.label==="kuma.io/zone")&&typeof c.kumaDp.kumaCpCompatible=="boolean"&&!c.kumaDp.kumaCpCompatible&&g.push({kind:"INCOMPATIBLE_ZONE_CP_AND_KUMA_DP_VERSIONS",payload:{kumaDp:c.kumaDp.version}}),g});return(f,h)=>{const c=P("AppView"),g=P("RouteView");return n(),y(g,{name:"data-plane-detail-view"},{default:t(({t:a})=>[i(c,null,S({default:t(()=>{var d,k;return[e(),u("div",Q,[i(p(C),null,{body:t(()=>[u("div",ee,[i(_,null,{title:t(()=>[e(s(a("http.api.property.status")),1)]),body:t(()=>[u("div",te,[i(H,{status:D.value.status},null,8,["status"]),e(),D.value.reason.length>0?(n(),y(p(K),{key:0,label:D.value.reason.join(", "),class:"reason-tooltip"},{default:t(()=>[i(p(F),{size:p(U),"hide-title":""},null,8,["size"])]),_:1},8,["label"])):N("",!0)])]),_:2},1024),e(),i(_,null,{title:t(()=>[e(s(a("http.api.property.tags")),1)]),body:t(()=>[T.value.length>0?(n(),y(R,{key:0,tags:T.value},null,8,["tags"])):(n(),r(m,{key:1},[e(s(a("common.detail.none")),1)],64))]),_:2},1024),e(),i(_,null,{title:t(()=>[e(s(a("http.api.property.dependencies")),1)]),body:t(()=>[V.value!==null?(n(),y(R,{key:0,tags:V.value},null,8,["tags"])):(n(),r(m,{key:1},[e(s(a("common.detail.none")),1)],64))]),_:2},1024)])]),_:2},1024),e(),u("div",null,[u("h2",null,s(a("data-planes.routes.item.mtls.title")),1),e(),(d=o.data.dataplaneInsight)!=null&&d.mTLS?(n(!0),r(m,{key:0},b([o.data.dataplaneInsight.mTLS],l=>(n(),y(p(C),{key:l,class:"mt-4"},{body:t(()=>[u("div",ae,[i(_,null,{title:t(()=>[e(s(a("data-planes.routes.item.mtls.expiration_time.title")),1)]),body:t(()=>[e(s(p(w)(l.certificateExpirationTime)),1)]),_:2},1024),e(),i(_,null,{title:t(()=>[e(s(a("data-planes.routes.item.mtls.generation_time.title")),1)]),body:t(()=>[e(s(p(w)(l.lastCertificateRegeneration)),1)]),_:2},1024),e(),i(_,null,{title:t(()=>[e(s(a("data-planes.routes.item.mtls.regenerations.title")),1)]),body:t(()=>[e(s(a("common.formats.integer",{value:l.certificateRegenerations})),1)]),_:2},1024),e(),i(_,null,{title:t(()=>[e(s(a("data-planes.routes.item.mtls.issued_backend.title")),1)]),body:t(()=>[e(s(l.issuedBackend),1)]),_:2},1024),e(),i(_,null,{title:t(()=>[e(s(a("data-planes.routes.item.mtls.supported_backends.title")),1)]),body:t(()=>[u("ul",null,[(n(!0),r(m,null,b(l.supportedBackends,I=>(n(),r("li",{key:I},s(I),1))),128))])]),_:2},1024)])]),_:2},1024))),128)):(n(),y(p($),{key:1,class:"mt-4",appearance:"warning"},{alertMessage:t(()=>[u("div",{innerHTML:a("data-planes.routes.item.mtls.disabled")},null,8,se)]),_:2},1024))]),e(),(n(!0),r(m,null,b([((k=o.data.dataplaneInsight)==null?void 0:k.subscriptions)??[]],l=>(n(),r(m,{key:l},[l.length>0?(n(),r("div",ne,[u("h2",null,s(a("data-planes.routes.item.subscriptions.title")),1),e(),i(p(C),{class:"mt-4"},{body:t(()=>[i(G,{subscriptions:l},null,8,["subscriptions"])]),_:2},1024)])):N("",!0)],64))),128))])]}),_:2},[E.value.length>0?{name:"notifications",fn:t(()=>[u("ul",null,[(n(!0),r(m,null,b(E.value,d=>(n(),r("li",{key:d.kind,"data-testid":`warning-${d.kind}`,innerHTML:a(`common.warnings.${d.kind}`,d.payload)},null,8,J))),128)),e()])]),key:"0"}:void 0]),1024)]),_:1})}}});const pe=j(le,[["__scopeId","data-v-d0ff1930"]]);export{pe as default};
