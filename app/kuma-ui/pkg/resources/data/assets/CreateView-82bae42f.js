import{d as L,y as f,z as de,V as me,r as b,o as l,l as p,p as t,j as i,w as r,i as g,k as e,aA as G,aB as H,aC as pe,aD as _e,aE as fe,aF as j,n,U as S,g as x,e as J,h as I,H as o,R as ve,a4 as be,aG as U,F as Z,m as y,I as ze,J as he,K as X,aH as ge,t as ke}from"./index-df368167.js";import{_ as E}from"./CodeBlock.vue_vue_type_style_index_0_lang-f2befe53.js";import{g as ye}from"./dataplane-0a086c06.js";const Ee=["data-test-state"],Ce={class:"scanner-content"},$e={class:"mr-1"},Ie=L({__name:"EntityScanner",props:{interval:{type:Number,required:!1,default:1e3},retries:{type:Number,required:!1,default:3600},hasError:{type:Boolean,default:!1},loaderFunction:{type:Function,required:!0},canComplete:{type:Boolean,default:!1}},emits:["hide-siblings"],setup(k,{emit:s}){const a=k,h=f(0),z=f(!1),C=f(!1),u=f(null);de(function(){$()}),me(function(){K()});function $(){z.value=!0,C.value=!1,K(),u.value=window.setInterval(async()=>{h.value++,await a.loaderFunction(),(h.value===a.retries||a.canComplete===!0)&&(K(),z.value=!1,C.value=!0,s("hide-siblings",!0))},a.interval)}function K(){u.value!==null&&window.clearInterval(u.value)}return(d,N)=>{const w=b("KEmptyState");return l(),p("div",{class:"scanner","data-test-state":z.value?"waiting":k.hasError?"error":"success"},[t("div",Ce,[i(w,{"cta-is-hidden":""},{title:r(()=>[t("span",$e,[z.value?(l(),g(e(G),{key:0,color:e(H)},null,8,["color"])):k.hasError?(l(),g(e(pe),{key:1,color:e(_e)},null,8,["color"])):(l(),g(e(fe),{key:2,color:e(j)},null,8,["color"]))]),n(),z.value?S(d.$slots,"loading-title",{key:0}):k.hasError?S(d.$slots,"error-title",{key:1}):S(d.$slots,"complete-title",{key:2})]),message:r(()=>[z.value?S(d.$slots,"loading-content",{key:0}):k.hasError?S(d.$slots,"error-content",{key:1}):S(d.$slots,"complete-content",{key:2})]),_:3})])],8,Ee)}}}),Ke={class:"form-step-title"},we=t("span",{class:"form-step-number"},"1",-1),Ve={class:"instruction-list"},Se={href:"https://helm.sh/docs/intro/install/"},Ne={class:"form-step-title"},Te=t("span",{class:"form-step-number"},"2",-1),qe=t("p",null,"On your local machine, create a namespace in your Kubernetes cluster and pull down the kong Helm repo.",-1),Ze={class:"instruction-list"},Le={class:"form-step-title"},Ae=t("span",{class:"form-step-number"},"3",-1),De={class:"form-step-title"},Be=t("span",{class:"form-step-number"},"4",-1),Re={class:"field-group-label mt-4"},Ue={class:"mt-4"},xe=L({__name:"ZoneCreateKubernetesInstructions",props:{zoneName:{type:String,required:!0},globalKdsAddress:{type:String,required:!0},zoneIngressEnabled:{type:Boolean,required:!0},zoneEgressEnabled:{type:Boolean,required:!0},token:{type:String,required:!0},base64EncodedToken:{type:String,required:!0}},setup(k){const s=k,a=x(),h=J(),z=I(()=>a.t("zones.form.kubernetes.secret.createSecretCommand",{token:s.base64EncodedToken}).trim()),C=I(()=>{const u={zoneName:s.zoneName,globalKdsAddress:s.globalKdsAddress,zoneIngressEnabled:String(s.zoneIngressEnabled),zoneEgressEnabled:String(s.zoneEgressEnabled)};return typeof h.params.virtualControlPlaneId=="string"&&(u.controlPlaneId=h.params.virtualControlPlaneId),a.t("zones.form.kubernetes.connectZone.config",u).trim()});return(u,$)=>(l(),p("div",null,[t("h3",Ke,[we,n(" "+o(e(a).t("zones.form.kubernetes.prerequisites.title")),1)]),n(),t("ul",Ve,[t("li",null,[t("b",null,o(e(a).t("zones.form.kubernetes.prerequisites.step1Label"))+o(s.zoneIngressEnabled?" "+e(a).t("zones.form.kubernetes.prerequisites.step1LabelAddendum"):""),1),n(`:
        `+o(e(a).t("zones.form.kubernetes.prerequisites.step1Description",{productName:e(a).t("common.product.name")})),1)]),n(),t("li",null,[t("b",null,o(e(a).t("zones.form.kubernetes.prerequisites.step2Label")),1),n(`:
        `+o(e(a).t("zones.form.kubernetes.prerequisites.step2Description")),1)]),n(),t("li",null,[t("a",Se,o(e(a).t("zones.form.kubernetes.prerequisites.step3LinkTitle")),1),n(" "+o(e(a).t("zones.form.kubernetes.prerequisites.step3Tail")),1)])]),n(),t("h3",Ne,[Te,n(" "+o(e(a).t("zones.form.kubernetes.helm.title")),1)]),n(),qe,n(),t("ol",Ze,[t("li",null,[t("b",null,o(e(a).t("zones.form.kubernetes.helm.step1Description")),1),n(),i(E,{id:"zone-kubernetes-create-namespace",class:"mt-2",code:e(a).t("zones.form.kubernetes.helm.step1Command"),language:"bash"},null,8,["code"])]),n(),t("li",null,[t("b",null,o(e(a).t("zones.form.kubernetes.helm.step2Description")),1),n(),i(E,{id:"zone-kubernetes-add-charts-repo",class:"mt-2",code:e(a).t("zones.form.kubernetes.helm.step2Command"),language:"bash"},null,8,["code"])]),n(),t("li",null,[t("b",null,o(e(a).t("zones.form.kubernetes.helm.step3Description")),1),n(),i(E,{id:"zone-kubernetes-repo-update",class:"mt-2",code:e(a).t("zones.form.kubernetes.helm.step3Command"),language:"bash"},null,8,["code"])])]),n(),t("h3",Le,[Ae,n(" "+o(e(a).t("zones.form.kubernetes.secret.title")),1)]),n(),t("p",null,o(e(a).t("zones.form.kubernetes.secret.createSecretDescription")),1),n(),i(E,{id:"zone-kubernetes-create-secret",class:"mt-4",code:z.value,language:"bash"},null,8,["code"]),n(),t("h3",De,[Be,n(" "+o(e(a).t("zones.form.kubernetes.connectZone.title")),1)]),n(),t("p",null,o(e(a).t("zones.form.kubernetes.connectZone.configDescription")),1),n(),t("span",Re,o(e(a).t("zones.form.kubernetes.connectZone.configFileName")),1),n(),i(E,{id:"zone-kubernetes-config-code-block","data-testid":"zone-kubernetes-config",code:C.value,language:"yaml"},null,8,["code"]),n(),t("p",Ue,o(e(a).t("zones.form.kubernetes.connectZone.connectDescription")),1),n(),i(E,{id:"zone-kubernetes-command-code-block",class:"mt-4",code:e(a).t("zones.form.kubernetes.connectZone.connectCommand").trim(),language:"bash"},null,8,["code"])]))}}),Oe={class:"form-step-title"},Fe=t("span",{class:"form-step-number"},"1",-1),Pe={class:"form-step-title"},Me=t("span",{class:"form-step-number"},"2",-1),Xe={class:"field-group-label mt-4"},Ge={class:"mt-4"},He=L({__name:"ZoneCreateUniversalInstructions",props:{zoneName:{type:String,required:!0},globalKdsAddress:{type:String,required:!0},token:{type:String,required:!0}},setup(k){const s=k,a=x(),h=J(),z=I(()=>a.t("zones.form.universal.saveToken.saveTokenCommand",{token:s.token}).trim()),C=I(()=>{const u={zoneName:s.zoneName,globalKdsAddress:s.globalKdsAddress};return typeof h.params.virtualControlPlaneId=="string"&&(u.controlPlaneId=h.params.virtualControlPlaneId),a.t("zones.form.universal.connectZone.config",u).trim()});return(u,$)=>(l(),p("div",null,[t("h3",Oe,[Fe,n(" "+o(e(a).t("zones.form.universal.saveToken.title")),1)]),n(),t("p",null,o(e(a).t("zones.form.universal.saveToken.saveTokenDescription")),1),n(),i(E,{id:"zone-kubernetes-token",class:"mt-4",code:z.value,language:"bash"},null,8,["code"]),n(),t("h3",Pe,[Me,n(" "+o(e(a).t("zones.form.universal.connectZone.title")),1)]),n(),t("p",null,o(e(a).t("zones.form.universal.connectZone.configDescription")),1),n(),t("span",Xe,o(e(a).t("zones.form.universal.connectZone.configFileName")),1),n(),i(E,{id:"zone-universal-config-code-block","data-testid":"zone-universal-config",class:"mt-4",code:C.value,language:"yaml"},null,8,["code"]),n(),t("p",Ge,o(e(a).t("zones.form.universal.connectZone.connectDescription")),1),n(),i(E,{id:"zone-universal-connect-command-code-block",class:"mt-4",code:e(a).t("zones.form.universal.connectZone.connectCommand").trim(),language:"bash"},null,8,["code"])]))}}),je={class:"form-wrapper"},Je={key:1},We={key:2},Qe={class:"form"},Ye={class:"form-header"},en={class:"form-title"},nn={class:"text-gradient"},tn={key:0},on={key:0},sn={class:"fact-list"},an={class:"form-section"},rn={class:"form-section__header"},ln={class:"form-section-title"},cn={key:0},un={class:"form-section__content"},dn={class:"form-section","data-testid":"connect-zone-instructions"},mn={class:"form-section__header"},pn={class:"form-section-title"},_n={key:0},fn={class:"form-section__content"},vn={class:"field-group-list"},bn={class:"field-group"},zn={class:"field-group-label"},hn={class:"radio-button-group"},gn={class:"field-group"},kn={class:"field-group-label"},yn={class:"radio-button-group"},En={class:"field-group"},Cn={class:"field-group-label"},$n={class:"radio-button-group"},In={class:"form-section"},Kn={class:"form-section__header"},wn={class:"form-section-title"},Vn={key:0},Sn={class:"form-section__content"},Nn={class:"form-section"},Tn={class:"form-section__header"},qn={class:"form-section-title"},Zn={key:0},Ln={class:"form-section__content"},An={class:"mt-2"},Dn=L({__name:"CreateView",setup(k){const{t:s,tm:a}=x(),h=ve(),z=be(),C=/^(?![-0-9])[a-z0-9-]{1,63}$/,u=f(null),$=f(!1),K=f(!1),d=f(null),N=f(null),w=f(!1),A=f(null),v=f(""),V=f("kubernetes"),D=f(!0),B=f(!0),T=I(()=>u.value!==null&&u.value.token?u.value.token:""),W=I(()=>T.value!==""?window.btoa(T.value):""),Q=I(()=>v.value===""||$.value||u.value!==null),R=I(()=>{if(N.value!==null)return N.value;if(d.value instanceof U){const _=d.value.invalidParameters.find(c=>c.field==="name");if(_!==void 0)return _.reason}return null});async function Y(){$.value=!0,d.value=null;try{if(!O(v.value))return;u.value=await h.createZone({name:v.value})}catch(_){_ instanceof Error?d.value=_:console.error(_)}finally{$.value=!1}}function O(_){const c=C.test(_);return c?N.value=null:N.value=s("zones.create.invalidNameError"),c}async function ee(){w.value=!1,A.value=null;try{const _=await h.getZoneOverview({name:v.value}),c=ye(_.zoneInsight);w.value=c==="online"}catch(_){_ instanceof Error?A.value=_:console.error(_)}}function F(){K.value=!K.value}return(_,c)=>{const ne=b("RouteTitle"),q=b("KButton"),te=b("KAlert"),oe=b("KLabel"),se=b("KInput"),P=b("KRadio"),M=b("KInputSwitch"),ae=b("DataSource"),re=b("KCard"),le=b("KModal"),ie=b("AppView"),ce=b("RouteView");return l(),g(ce,{name:"zone-create-view",attrs:{class:"is-fullscreen"}},{default:r(()=>[i(ie,{fullscreen:!0,breadcrumbs:[]},{title:r(()=>[t("h1",null,[i(ne,{title:e(s)("zones.routes.create.title"),render:!0},null,8,["title"])])]),actions:r(()=>[T.value===""||w.value?(l(),g(q,{key:0,appearance:"outline","data-testid":"exit-button",to:{name:"zone-cp-list-view"}},{default:r(()=>[n(o(e(s)("zones.form.exit")),1)]),_:1})):(l(),g(q,{key:1,appearance:"outline","data-testid":"exit-button",onClick:F},{default:r(()=>[n(o(e(s)("zones.form.exit")),1)]),_:1}))]),default:r(()=>[n(),n(),t("div",je,[d.value!==null?(l(),g(te,{key:0,appearance:"danger",class:"mb-4","dismiss-type":"icon","data-testid":"create-zone-error"},{alertMessage:r(()=>[d.value instanceof e(U)&&[409,500].includes(d.value.status)?(l(),p(Z,{key:0},[t("p",null,o(e(s)(`zones.create.status_error.${d.value.status}.title`,{name:v.value})),1),n(),t("p",null,o(e(s)(`zones.create.status_error.${d.value.status}.description`)),1)],64)):d.value instanceof e(U)?(l(),p("p",Je,o(e(s)("common.error_state.api_error",{status:d.value.status,title:d.value.title})),1)):(l(),p("p",We,o(e(s)("common.error_state.default_error")),1))]),_:1})):y("",!0),n(),i(re,{class:"form-card"},{body:r(()=>[t("div",Qe,[t("div",Ye,[t("div",null,[t("h1",en,[t("span",nn,o(e(s)("zones.form.title")),1)]),n(),e(s)("zones.form.description")!==" "?(l(),p("p",tn,o(e(s)("zones.form.description")),1)):y("",!0)]),n(),e(a)("zones.form.facts").length>0?(l(),p("div",on,[t("ul",sn,[(l(!0),p(Z,null,ze(e(a)("zones.form.facts"),(m,ue)=>(l(),p("li",{key:ue,class:"fact-list__item"},[i(e(he),{color:e(j)},null,8,["color"]),n(" "+o(m),1)]))),128))])])):y("",!0)]),n(),t("div",an,[t("div",rn,[t("h2",ln,o(e(s)("zones.form.section.name.title")),1),n(),e(s)("zones.form.section.name.description")!==" "?(l(),p("p",cn,o(e(s)("zones.form.section.name.description")),1)):y("",!0)]),n(),t("div",un,[t("div",null,[i(oe,{for:"zone-name",required:"","tooltip-attributes":{placement:"right"}},{tooltip:r(()=>[n(o(e(s)("zones.form.name_tooltip")),1)]),default:r(()=>[n(o(e(s)("zones.form.nameLabel"))+" ",1)]),_:1}),n(),i(se,{id:"zone-name",modelValue:v.value,"onUpdate:modelValue":c[0]||(c[0]=m=>v.value=m),type:"text",name:"zone-name","data-testid":"name-input","data-test-error-type":R.value!==null?"invalid-dns-name":void 0,"has-error":R.value!==null,"error-message":R.value??void 0,disabled:u.value!==null,onBlur:c[1]||(c[1]=m=>O(v.value))},null,8,["modelValue","data-test-error-type","has-error","error-message","disabled"])]),n(),i(q,{appearance:"primary",class:"mt-4",disabled:Q.value,"data-testid":"create-zone-button",onClick:Y},{default:r(()=>[$.value?(l(),g(e(G),{key:0,color:e(H),size:e(X)},null,8,["color","size"])):(l(),g(e(ge),{key:1,size:e(X)},null,8,["size"])),n(" "+o(e(s)("zones.form.createZoneButtonLabel")),1)]),_:1},8,["disabled"])])]),n(),u.value!==null?(l(),p(Z,{key:0},[t("div",dn,[t("div",mn,[t("h2",pn,o(e(s)("zones.form.section.configuration.title")),1),n(),e(s)("zones.form.section.configuration.description")!==" "?(l(),p("p",_n,o(e(s)("zones.form.section.configuration.description")),1)):y("",!0)]),n(),t("div",fn,[t("div",vn,[t("div",bn,[t("span",zn,o(e(s)("zones.form.environmentLabel"))+` *
                        `,1),n(),t("div",hn,[i(P,{id:"zone-environment-universal",modelValue:V.value,"onUpdate:modelValue":c[2]||(c[2]=m=>V.value=m),"selected-value":"universal",name:"zone-environment","data-testid":"environment-universal-radio-button"},{default:r(()=>[n(o(e(s)("zones.form.universalLabel")),1)]),_:1},8,["modelValue"]),n(),i(P,{id:"zone-environment-kubernetes",modelValue:V.value,"onUpdate:modelValue":c[3]||(c[3]=m=>V.value=m),"selected-value":"kubernetes",name:"zone-environment","data-testid":"environment-kubernetes-radio-button"},{default:r(()=>[n(o(e(s)("zones.form.kubernetesLabel")),1)]),_:1},8,["modelValue"])])]),n(),V.value==="kubernetes"?(l(),p(Z,{key:0},[t("div",gn,[t("span",kn,o(e(s)("zones.form.zoneIngressLabel"))+` *
                          `,1),n(),t("div",yn,[i(M,{id:"zone-ingress-enabled",modelValue:D.value,"onUpdate:modelValue":c[4]||(c[4]=m=>D.value=m),"data-testid":"ingress-input-switch"},{label:r(()=>[n(o(e(s)("zones.form.zoneIngressEnabledLabel")),1)]),_:1},8,["modelValue"])])]),n(),t("div",En,[t("span",Cn,o(e(s)("zones.form.zoneEgressLabel"))+` *
                          `,1),n(),t("div",$n,[i(M,{id:"zone-egress-enabled",modelValue:B.value,"onUpdate:modelValue":c[5]||(c[5]=m=>B.value=m),"data-testid":"egress-input-switch"},{label:r(()=>[n(o(e(s)("zones.form.zoneEgressEnabledLabel")),1)]),_:1},8,["modelValue"])])])],64)):y("",!0)])])]),n(),t("div",In,[t("div",Kn,[t("h2",wn,o(e(s)("zones.form.section.connect_zone.title")),1),n(),e(s)("zones.form.section.connect_zone.description")!==" "?(l(),p("p",Vn,o(e(s)("zones.form.section.connect_zone.description")),1)):y("",!0)]),n(),t("div",Sn,[i(ae,{src:"/control-plane/addresses"},{default:r(({data:m})=>[typeof m<"u"?(l(),p(Z,{key:0},[V.value==="universal"?(l(),g(He,{key:0,"zone-name":v.value,token:T.value,"global-kds-address":m.kds},null,8,["zone-name","token","global-kds-address"])):(l(),g(xe,{key:1,"zone-name":v.value,"zone-ingress-enabled":D.value,"zone-egress-enabled":B.value,token:T.value,"base64-encoded-token":W.value,"global-kds-address":m.kds},null,8,["zone-name","zone-ingress-enabled","zone-egress-enabled","token","base64-encoded-token","global-kds-address"]))],64)):y("",!0)]),_:1})])]),n(),t("div",Nn,[t("div",Tn,[t("h2",qn,o(e(s)("zones.form.section.scanner.title")),1),n(),e(s)("zones.form.section.scanner.description")!==" "?(l(),p("p",Zn,o(e(s)("zones.form.section.scanner.description")),1)):y("",!0)]),n(),t("div",Ln,[i(Ie,{"loader-function":ee,"has-error":A.value!==null,"can-complete":w.value,"data-testid":"zone-connected-scanner"},{"loading-title":r(()=>[n(o(e(s)("zones.form.scan.waitTitle")),1)]),"complete-title":r(()=>[n(o(e(s)("zones.form.scan.completeTitle")),1)]),"complete-content":r(()=>[t("p",null,o(e(s)("zones.form.scan.completeDescription",{name:v.value})),1),n(),t("p",An,[i(q,{appearance:"primary",to:{name:"zone-cp-detail-view",params:{zone:v.value}}},{default:r(()=>[n(o(e(s)("zones.form.scan.completeButtonLabel",{name:v.value})),1)]),_:1},8,["to"])])]),"error-title":r(()=>[t("h3",null,o(e(s)("zones.form.scan.errorTitle")),1)]),"error-content":r(()=>[t("p",null,o(e(s)("zones.form.scan.errorDescription")),1)]),_:1},8,["has-error","can-complete"])])])],64)):y("",!0)])]),_:1})]),n(),i(le,{"is-visible":K.value,title:e(s)("zones.form.confirm_modal.title"),"data-testid":"confirm-exit-modal",onCanceled:F,onProceed:c[6]||(c[6]=m=>e(z).push({name:"zone-cp-list-view"}))},{"header-content":r(()=>[n(o(e(s)("zones.form.confirm_modal.title")),1)]),"body-content":r(()=>[n(o(e(s)("zones.form.confirm_modal.body")),1)]),"action-buttons":r(()=>[i(q,{appearance:"primary",to:{name:"zone-cp-list-view"},"data-testid":"confirm-exit-button"},{default:r(()=>[n(o(e(s)("zones.form.confirm_modal.action_button")),1)]),_:1})]),_:1},8,["is-visible","title"])]),_:1})]),_:1})}}});const xn=ke(Dn,[["__scopeId","data-v-39ec55ab"]]);export{xn as default};
