import{d as G,H,r as u,o as i,q as y,w as e,b as n,U as h,e as t,t as r,S as M,s as w,c,M as g,p as X,$ as P,N as C,I as U,m as J,B as K,_ as Q}from"./index-BP47cGGe.js";import{S as W}from"./SummaryView-Cb9BKz7Y.js";import{C as T,b as R,a as Y}from"./ConnectionTraffic-F34rr1g0.js";import"./TagList-B7fSNTxL.js";const ee={key:0},te=G({__name:"ZoneIngressDetailView",props:{data:{}},setup($){const d=$,S=H();return(ne,o)=>{const V=u("XBadge"),D=u("XCopyButton"),q=u("XAboutCard"),z=u("XAction"),x=u("DataCollection"),A=u("XLayout"),L=u("XInputSwitch"),N=u("XCard"),O=u("RouterView"),j=u("DataLoader"),Z=u("AppView"),E=u("RouteView");return i(),y(E,{name:"zone-ingress-detail-view",params:{subscription:"",proxy:"",inactive:Boolean}},{default:e(({t:p,me:b,route:l,uri:F})=>[n(Z,null,{default:e(()=>[n(q,{title:p("zone-ingresses.routes.item.about.title"),created:d.data.creationTime,modified:d.data.modificationTime},{default:e(()=>[n(h,{layout:"horizontal"},{title:e(()=>[t(r(p("http.api.property.status")),1)]),body:e(()=>[n(M,{status:d.data.state},null,8,["status"])]),_:2},1024),o[4]||(o[4]=t()),d.data.namespace.length>0?(i(),y(h,{key:0,layout:"horizontal"},{title:e(()=>[t(r(p("http.api.property.namespace")),1)]),body:e(()=>[n(V,{appearance:"decorative"},{default:e(()=>[t(r(d.data.namespace),1)]),_:1})]),_:2},1024)):w("",!0),o[5]||(o[5]=t()),n(h,{layout:"horizontal"},{title:e(()=>[t(r(p("http.api.property.address")),1)]),body:e(()=>[d.data.zoneIngress.socketAddress.length>0?(i(),y(D,{key:0,variant:"badge",format:"default",text:d.data.zoneIngress.socketAddress},null,8,["text"])):(i(),c(g,{key:1},[t(r(p("common.detail.none")),1)],64))]),_:2},1024),o[6]||(o[6]=t()),n(h,{layout:"horizontal"},{title:e(()=>[t(r(p("http.api.property.advertisedAddress")),1)]),body:e(()=>[d.data.zoneIngress.advertisedSocketAddress.length>0?(i(),y(V,{key:0,appearance:"decorative"},{default:e(()=>[n(D,{text:d.data.zoneIngress.advertisedSocketAddress},null,8,["text"])]),_:1})):(i(),c(g,{key:1},[t(r(p("common.detail.none")),1)],64))]),_:2},1024)]),_:2},1032,["title","created","modified"]),o[18]||(o[18]=t()),n(j,{src:F(X(P),"/connections/stats/for/:proxyType/:name/:mesh/:socketAddress",{name:l.params.proxy,mesh:"*",socketAddress:d.data.zoneIngress.socketAddress,proxyType:"zone-ingress"})},{default:e(({data:a,refresh:m})=>[n(N,null,{default:e(()=>[n(A,{type:"columns"},{default:e(()=>[n(T,null,{default:e(()=>[n(A,{type:"stack",size:"small"},{default:e(()=>[n(x,{type:"inbounds",items:Object.entries(a.inbounds)},{default:e(({items:s})=>[(i(!0),c(g,null,C(s,([k,v])=>(i(),y(R,{key:`${k}`,protocol:"",traffic:v},{default:e(()=>[n(z,{"data-action":"",to:{name:(_=>_.includes("bound")?_.replace("-outbound-","-inbound-"):"zone-ingress-connection-inbound-summary-stats-view")(String(X(S).name)),params:{connection:k,proxyType:"ingresses"},query:{inactive:l.params.inactive}}},{default:e(()=>[t(`
                        :`+r(k.split("_").at(-1)),1)]),_:2},1032,["to"])]),_:2},1032,["traffic"]))),128))]),_:2},1032,["items"])]),_:2},1024)]),_:2},1024),o[11]||(o[11]=t()),n(T,null,{actions:e(()=>[n(L,{checked:l.params.inactive,"data-testid":"dataplane-outbounds-inactive-toggle",onChange:s=>l.update({inactive:s})},{label:e(()=>o[7]||(o[7]=[t(`
                    Show inactive
                  `)])),_:2},1032,["checked","onChange"]),o[9]||(o[9]=t()),n(z,{action:"refresh",appearance:"primary",onClick:m},{default:e(()=>o[8]||(o[8]=[t(`
                  Refresh
                `)])),_:2},1032,["onClick"])]),default:e(()=>[o[10]||(o[10]=t()),(i(),c(g,null,C(["upstream"],s=>n(x,{key:s,type:"outbounds",items:Object.entries(a.outbounds)},{default:e(({items:k})=>[n(x,{type:"activeOutbounds",predicate:l.params.inactive?void 0:([v,_])=>{var f,I;return((typeof _.tcp<"u"?(f=_.tcp)==null?void 0:f[`${s}_cx_rx_bytes_total`]:(I=_.http)==null?void 0:I[`${s}_rq_total`])??0)>0},items:k},{default:e(({items:v})=>[v.length>0?(i(),y(Y,{key:0,type:"outbound"},{default:e(()=>[(i(),c(g,null,C([/-([a-f0-9]){16}$/],_=>n(A,{key:_,type:"stack",size:"small"},{default:e(()=>[(i(!0),c(g,null,C(v,([f,I])=>(i(),y(R,{key:`${f}`,"data-testid":"dataplane-outbound",protocol:"",traffic:I,direction:s},{default:e(()=>[n(z,{"data-action":"",to:{name:(B=>B.includes("bound")?B.replace("-inbound-","-outbound-"):"zone-ingress-connection-outbound-summary-stats-view")(String(X(S).name)),params:{connection:f},query:{inactive:l.params.inactive}}},{default:e(()=>[t(r(f),1)]),_:2},1032,["to"])]),_:2},1032,["traffic","direction"]))),128))]),_:2},1024)),64))]),_:2},1024)):w("",!0)]),_:2},1032,["predicate","items"])]),_:2},1032,["items"])),64))]),_:2},1024)]),_:2},1024)]),_:2},1024),o[12]||(o[12]=t()),n(O,null,{default:e(s=>[s.route.name!==l.name?(i(),y(W,{key:0,width:"670px",onClose:function(){l.replace({name:"zone-ingress-detail-view",params:{proxy:l.params.proxy,proxyType:"ingresses"},query:{inactive:l.params.inactive?null:void 0}})}},{default:e(()=>[(i(),y(U(s.Component),{data:l.params.subscription.length>0?d.data.zoneIngressInsight.subscriptions:s.route.name.includes("-inbound-")?[d.data.zoneIngress]:(a==null?void 0:a.outbounds)||{},networking:d.data.zoneIngress.networking},null,8,["data","networking"]))]),_:2},1032,["onClose"])):w("",!0)]),_:2},1024)]),_:2},1032,["src"]),o[19]||(o[19]=t()),d.data.zoneIngressInsight.subscriptions.length>0?(i(),c("div",ee,[J("h2",null,r(p("zone-ingresses.routes.item.subscriptions.title")),1),o[17]||(o[17]=t()),n(K,{headers:[{...b.get("headers.instanceId"),label:p("http.api.property.instanceId"),key:"instanceId"},{...b.get("headers.version"),label:p("http.api.property.version"),key:"version"},{...b.get("headers.connected"),label:p("http.api.property.connected"),key:"connected"},{...b.get("headers.disconnected"),label:p("http.api.property.disconnected"),key:"disconnected"},{...b.get("headers.responses"),label:p("http.api.property.responses"),key:"responses"}],"is-selected-row":a=>a.id===l.params.subscription,items:d.data.zoneIngressInsight.subscriptions.map((a,m,s)=>s[s.length-(m+1)]),onResize:b.set},{instanceId:e(({row:a})=>[n(z,{"data-action":"",to:{name:"zone-ingress-subscription-summary-view",params:{subscription:a.id}}},{default:e(()=>[t(r(a.controlPlaneInstanceId),1)]),_:2},1032,["to"])]),version:e(({row:a})=>{var m,s;return[t(r(((s=(m=a.version)==null?void 0:m.kumaDp)==null?void 0:s.version)??"-"),1)]}),connected:e(({row:a})=>[t(r(p("common.formats.datetime",{value:Date.parse(a.connectTime??"")})),1)]),disconnected:e(({row:a})=>[a.disconnectTime?(i(),c(g,{key:0},[t(r(p("common.formats.datetime",{value:Date.parse(a.disconnectTime)})),1)],64)):w("",!0)]),responses:e(({row:a})=>{var m;return[(i(!0),c(g,null,C([((m=a.status)==null?void 0:m.total)??{}],s=>(i(),c(g,null,[t(r(s.responsesSent)+"/"+r(s.responsesAcknowledged),1)],64))),256))]}),_:2},1032,["headers","is-selected-row","items","onResize"])])):w("",!0)]),_:2},1024)]),_:1})}}}),re=Q(te,[["__scopeId","data-v-f58132be"]]);export{re as default};
