import{d as E,r as d,p as y,o as t,w as o,b as r,c as a,N as i,L as f,e as s,q as v,l as n,t as k,m as C,F as H,a5 as I,Y as L}from"./index-BLmUgYvn.js";import{A as J,a as G}from"./AccordionList-AeNKXL04.js";import{P}from"./PolicyTypeTag-BpFb-98-.js";import{R as K}from"./RuleMatchers-C-KIYKlx.js";const Q={key:0},U={class:"stack-with-borders mt-4"},W={key:0},Z={colspan:"2"},ee={class:"mt-4"},te={key:0},oe={key:1},ne={colspan:"2"},ue=E({__name:"DataPlaneOutboundSummaryOverviewView",props:{data:{},routeName:{}},setup(D){const g=D,N=(w,e)=>w.$resourceMeta.name===e.name&&w.$resourceMeta.namespace===e.namespace&&w.$resourceMeta.zone===e.zone&&(e.resourceSectionName===""||w.$resourceMeta.port===e.port);return(w,e)=>{const x=d("XBadge"),X=d("XTable"),O=d("XAction"),b=d("DataCollection"),R=d("XCodeBlock"),B=d("XLayout"),S=d("XCard"),j=d("DataLoader"),z=d("DataSource"),F=d("AppView"),Y=d("RouteView");return t(),y(Y,{params:{mesh:"",proxy:"",connection:""},name:g.routeName},{default:o(({t:q,route:h,uri:V})=>[r(F,null,{default:o(()=>[(t(!0),a(i,null,f([h.params.connection.replace(/-([a-f0-9]){16}$/,"")],T=>(t(),y(B,{key:T,type:"stack"},{default:o(()=>[r(X,{variant:"kv"},{default:o(()=>[n("tr",null,[e[0]||(e[0]=n("th",{scope:"row"},`
                Protocol
              `,-1)),e[1]||(e[1]=s()),n("td",null,[r(x,{appearance:"info"},{default:o(()=>[s(k(q(`http.api.value.${["grpc","http","tcp"].find($=>typeof g.data[$]<"u")}`)),1)]),_:2},1024)])])]),_:2},1024),e[19]||(e[19]=s()),g.data?(t(),a("div",Q,[e[17]||(e[17]=n("h3",null,"Rules",-1)),e[18]||(e[18]=s()),r(z,{src:V(C(H),"/policy-types",{})},{default:o(({data:$})=>[(t(!0),a(i,null,f([Object.groupBy($?.policyTypes??[],_=>_.name)],_=>(t(),y(j,{key:typeof _,src:V(C(I),"/meshes/:mesh/rules/for/:dataplane",{mesh:h.params.mesh,dataplane:h.params.proxy})},{default:o(({data:A})=>[g.data.$resourceMeta.type!==""?(t(),y(b,{key:0,predicate:m=>m.resourceMeta.type==="Mesh"||N(g.data,m),items:A.toResourceRules},{default:o(({items:m})=>[n("div",U,[(t(!0),a(i,null,f(Object.groupBy(m,l=>l.type),(l,c)=>(t(),a("div",{key:c},[r(P,{"policy-type":c},{default:o(()=>[s(k(c),1)]),_:2},1032,["policy-type"]),e[7]||(e[7]=s()),r(X,{variant:"kv"},{default:o(()=>[(t(!0),a(i,null,f(l.length>1?l.filter(u=>N(g.data,u)):l,u=>(t(),a(i,{key:u},[u.origins.length>0?(t(),a("tr",W,[e[2]||(e[2]=n("th",{scope:"row"},`
                                    Origin policies
                                  `,-1)),e[3]||(e[3]=s()),n("td",null,[r(b,{predicate:p=>typeof p.resourceMeta<"u",items:u.origins,empty:!1},{default:o(({items:p})=>[n("ul",null,[(t(!0),a(i,null,f(p,M=>(t(),a("li",{key:JSON.stringify(M)},[Object.keys(_).length>0?(t(),y(O,{key:0,to:{name:"policy-detail-view",params:{policyPath:_[c][0].path,mesh:M.resourceMeta.mesh,policy:M.resourceMeta.name}}},{default:o(()=>[s(k(M.resourceMeta.name),1)]),_:2},1032,["to"])):v("",!0)]))),128))])]),_:2},1032,["predicate","items"])])])):v("",!0),e[6]||(e[6]=s()),n("tr",null,[n("td",Z,[r(B,{type:"stack",size:"small"},{default:o(()=>[e[4]||(e[4]=n("span",null,"Config",-1)),e[5]||(e[5]=s()),r(R,{code:C(L).stringify(u.raw),language:"yaml","show-copy-button":!1},null,8,["code"])]),_:2},1024)])])],64))),128))]),_:2},1024)]))),128))])]),_:2},1032,["predicate","items"])):(t(),y(b,{key:1,predicate:m=>m.ruleType==="to"&&!["MeshHTTPRoute","MeshTCPRoute"].includes(m.type)&&m.matchers.every(l=>l.key==="kuma.io/service"&&(l.not?l.value!==T:l.value===T)),items:A.rules},{default:o(({items:m})=>[n("div",ee,[r(J,{"initially-open":0,"multiple-open":"",class:"stack"},{default:o(()=>[(t(!0),a(i,null,f(Object.groupBy(m,l=>l.type),(l,c)=>(t(),y(S,{key:c},{default:o(()=>[r(G,null,{"accordion-header":o(()=>[r(P,{"policy-type":c},{default:o(()=>[s(k(c)+" ("+k(l.length)+`)
                                  `,1)]),_:2},1032,["policy-type"])]),"accordion-content":o(()=>[r(X,{variant:"kv"},{default:o(()=>[(t(!0),a(i,null,f(l,u=>(t(),a(i,{key:u},[u.matchers.length>0?(t(),a("tr",te,[e[8]||(e[8]=n("th",{scope:"row"},`
                                          From
                                        `,-1)),e[9]||(e[9]=s()),n("td",null,[n("p",null,[r(K,{items:u.matchers},null,8,["items"])])])])):v("",!0),e[14]||(e[14]=s()),u.origins.length>0?(t(),a("tr",oe,[e[10]||(e[10]=n("th",{scope:"row"},`
                                          Origin policies
                                        `,-1)),e[11]||(e[11]=s()),n("td",null,[n("ul",null,[(t(!0),a(i,null,f(u.origins,p=>(t(),a("li",{key:`${p.mesh}-${p.name}`},[_[p.type]?(t(),y(O,{key:0,to:{name:"policy-detail-view",params:{mesh:p.mesh,policyPath:_[p.type][0].path,policy:p.name}}},{default:o(()=>[s(k(p.name),1)]),_:2},1032,["to"])):(t(),a(i,{key:1},[s(k(p.name),1)],64))]))),128))])])])):v("",!0),e[15]||(e[15]=s()),n("tr",null,[n("td",ne,[r(B,{type:"stack",size:"small"},{default:o(()=>[e[12]||(e[12]=n("span",null,"Config",-1)),e[13]||(e[13]=s()),r(R,{code:C(L).stringify(u.raw),language:"yaml","show-copy-button":!1},null,8,["code"])]),_:2},1024)])])],64))),128))]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:2},1024)])]),_:2},1032,["predicate","items"]))]),_:2},1032,["src"]))),128))]),_:2},1032,["src"])])):v("",!0)]),_:2},1024))),128))]),_:2},1024)]),_:1},8,["name"])}}});export{ue as default};
