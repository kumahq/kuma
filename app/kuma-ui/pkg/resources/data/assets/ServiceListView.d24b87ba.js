import{d as D,u as C,j as n,l as A,K as E,cz as P,c as y,w as b,o as S,a as g,p as z}from"./index.d0c2efa7.js";import{C as L}from"./ContentWrapper.5ba4fb6c.js";import{D as M}from"./DataOverview.c3903863.js";import{S as N}from"./ServiceDetails.9d52bad7.js";import"./EmptyBlock.vue_vue_type_script_setup_true_lang.37c6fb15.js";import"./ErrorBlock.0c813134.js";import"./LoadingBlock.vue_vue_type_script_setup_true_lang.d2d6c4b6.js";import"./EntityTag.0f456bc5.js";import"./EntityURLControl.b14a7a6c.js";import"./YamlView.2cfc9d9d.js";import"./index.58caa11d.js";import"./CodeBlock.22897d3f.js";import"./_commonjsHelpers.f037b798.js";const H=D({__name:"ServiceListView",setup(R){const T=[{label:"Service",key:"name"},{label:"Mesh",key:"mesh"},{label:"Type",key:"serviceType"},{label:"Address",key:"address"},{label:"Status",key:"status"},{label:"DP proxies (online / total)",key:"dpProxiesStatus"}],d=50,x={title:"No Data",message:"There are no service insights present."},m=C(),c=n(!0),r=n(null),h=n(null),t=n(null),o=n({headers:T,data:[]});A(()=>m.params.mesh,function(){m.name==="service-list-view"&&p(0)}),p(0);async function p(e){c.value=!0,r.value=null;const i=m.params.mesh,v=d;try{const{items:a=[],next:u}=await E.getAllServiceInsightsFromMesh({mesh:i},{size:v,offset:e});h.value=u,a.sort((s,l)=>s.name>l.name?1:s.name<l.name?-1:s.mesh.localeCompare(l.mesh)),a.length>0?(f(a[0]),o.value.data=a.map(s=>_(s))):(t.value=null,o.value.data=[])}catch(a){t.value=null,a instanceof Error&&(r.value=a),console.error(r)}finally{c.value=!1}}function _(e){var l;const i={name:e.serviceType==="external"?"external-service-detail-view":"service-insight-detail-view",params:{mesh:e.mesh,service:e.name}},v={name:"mesh-detail-view",params:{mesh:e.mesh}};let a="\u2014";if(e.dataplanes){const{online:w=0,total:k=0}=e.dataplanes;a=`${w} / ${k}`}let u="\u2014";e.status&&(u=P[e.status].title);const s=(l=e.serviceType)!=null?l:"internal";return{...e,serviceType:s,nameRoute:i,meshRoute:v,dpProxiesStatus:a,status:u}}function f(e){t.value=e}return(e,i)=>(S(),y(L,null,{content:b(()=>[g(M,{"page-size":d,error:r.value,"has-error":r.value!==null,"is-loading":c.value,"empty-state":x,"table-data":o.value,"table-data-is-empty":o.value.data.length===0,next:h.value,onTableAction:f,onLoadData:p},null,8,["error","has-error","is-loading","table-data","table-data-is-empty","next"])]),sidebar:b(()=>[t.value!==null?(S(),y(N,{key:0,name:t.value.name,mesh:t.value.mesh,"service-type":t.value.serviceType},null,8,["name","mesh","service-type"])):z("",!0)]),_:1}))}});export{H as default};
