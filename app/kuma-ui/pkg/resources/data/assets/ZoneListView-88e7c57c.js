import{d as D,R as K,t as N,r as S,o as a,g as l,w as t,h as i,A as U,ae as F,m as w,C as M,l as n,p as W,i as s,a2 as q,E as G,a3 as J,D as c,X as P,j as E,F as h,ac as X,$ as j,K as x,a4 as H,Z as V,H as Q,a5 as Y,a6 as A,k as O,_ as ee,aE as te,q as oe}from"./index-c9de75c3.js";import{_ as ne}from"./MultizoneInfo.vue_vue_type_script_setup_true_lang-da325fb8.js";import{_ as ae}from"./DeleteResourceModal.vue_vue_type_script_setup_true_lang-3bd59a58.js";const se=D({__name:"ZoneListView",props:{page:{type:Number,required:!0},size:{type:Number,required:!0}},setup(R){const _=R,L=K(),g=N(!1),Z=N(!1),y=N("");function I(r){return r.map(f=>{var k;const{name:b}=f,z={name:"zone-cp-detail-view",params:{zone:b}};let o="",p="kubernetes",m=!0;(((k=f.zoneInsight)==null?void 0:k.subscriptions)??[]).forEach(e=>{if(e.version&&e.version.kumaCp){o=e.version.kumaCp.version;const{kumaCpGlobalCompatible:C=!0}=e.version.kumaCp;m=C}e.config&&(p=JSON.parse(e.config).environment)});const d=te(f);return{detailViewRoute:z,name:b,status:d,zoneCpVersion:o,type:p,warnings:!m}})}async function T(){await L.deleteZone({name:y.value})}function v(){g.value=!g.value}function $(r){v(),y.value=r}function B(r){Z.value=(r==null?void 0:r.items.length)>0}return(r,f)=>{const b=S("RouterLink");return a(),l(ee,{name:"zone-cp-list-view"},{default:t(({route:z,t:o,can:p,env:m})=>[i(U,null,F({title:t(()=>[w("h1",null,[i(M,{title:o("zone-cps.routes.items.title"),render:!0},null,8,["title"])])]),default:t(()=>[n(),n(),p("use zones")?(a(),l(W,{key:1,src:`/zone-cps?size=${_.size}&page=${_.page}`,onChange:B},{default:t(({data:u,error:d,refresh:k})=>[i(s(q),null,{body:t(()=>[d!==void 0?(a(),l(G,{key:0,error:d},null,8,["error"])):(a(),l(J,{key:1,class:"zone-cp-collection","data-testid":"zone-cp-collection",headers:[{label:"Name",key:"name"},{label:"Zone CP Version",key:"zoneCpVersion"},{label:"Type",key:"type"},{label:"Status",key:"status"},{label:"Warnings",key:"warnings",hideLabel:!0},{label:"Actions",key:"actions",hideLabel:!0}],"page-number":_.page,"page-size":_.size,total:u==null?void 0:u.total,items:u?I(u.items):void 0,error:d,"empty-state-title":m("KUMA_ZONE_CREATION_FLOW")==="enabled"?o("zone-cps.empty_state.title"):void 0,"empty-state-message":m("KUMA_ZONE_CREATION_FLOW")==="enabled"?o("zone-cps.empty_state.message"):void 0,"empty-state-cta-to":m("KUMA_ZONE_CREATION_FLOW")==="enabled"?{name:"zone-create-view"}:void 0,"empty-state-cta-text":m("KUMA_ZONE_CREATION_FLOW")==="enabled"?o("zones.index.create"):void 0,onChange:z.update},{name:t(({row:e,rowValue:C})=>[i(b,{to:e.detailViewRoute,"data-testid":"detail-view-link"},{default:t(()=>[n(c(C),1)]),_:2},1032,["to"])]),zoneCpVersion:t(({rowValue:e})=>[n(c(e||o("common.collection.none")),1)]),type:t(({rowValue:e})=>[n(c(e||o("common.collection.none")),1)]),status:t(({rowValue:e})=>[e?(a(),l(P,{key:0,status:e},null,8,["status"])):(a(),E(h,{key:1},[n(c(o("common.collection.none")),1)],64))]),warnings:t(({rowValue:e})=>[e?(a(),l(s(X),{key:0,label:o("zone-cps.list.version_mismatch")},{default:t(()=>[i(j,{class:"mr-1",size:s(x),"hide-title":""},null,8,["size"])]),_:2},1032,["label"])):(a(),E(h,{key:1},[n(c(o("common.collection.none")),1)],64))]),actions:t(({row:e})=>[i(s(H),{class:"actions-dropdown","data-testid":"actions-dropdown","kpop-attributes":{placement:"bottomEnd",popoverClasses:"mt-5 more-actions-popover"},width:"150"},{default:t(()=>[i(s(V),{class:"non-visual-button",appearance:"secondary",size:"small"},{icon:t(()=>[i(s(Q),{color:s(Y),icon:"more",size:s(x)},null,8,["color","size"])]),_:1})]),items:t(()=>[i(s(A),{item:{to:e.detailViewRoute,label:o("common.collection.actions.view")}},null,8,["item"]),n(),p("create zones")?(a(),l(s(A),{key:0,"has-divider":"","is-dangerous":"","data-testid":"dropdown-delete-item",onClick:C=>$(e.name)},{default:t(()=>[n(c(o("common.collection.actions.delete")),1)]),_:2},1032,["onClick"])):O("",!0)]),_:2},1024)]),_:2},1032,["page-number","page-size","total","items","error","empty-state-title","empty-state-message","empty-state-cta-to","empty-state-cta-text","onChange"]))]),_:2},1024),n(),g.value?(a(),l(ae,{key:0,"confirmation-text":y.value,"delete-function":T,"is-visible":"","action-button-text":o("common.delete_modal.proceed_button"),title:o("common.delete_modal.title",{type:"Zone"}),"data-testid":"delete-zone-modal",onCancel:v,onDelete:()=>{v(),k()}},{"body-content":t(()=>[w("p",null,c(o("common.delete_modal.text1",{type:"Zone",name:y.value})),1),n(),w("p",null,c(o("common.delete_modal.text2")),1)]),_:2},1032,["confirmation-text","action-button-text","title","onDelete"])):O("",!0)]),_:2},1032,["src"])):(a(),l(ne,{key:0}))]),_:2},[p("create zones")&&Z.value?{name:"actions",fn:t(()=>[i(s(V),{appearance:"primary",icon:"plus",to:{name:"zone-create-view"},"data-testid":"create-zone-link"},{default:t(()=>[n(c(o("zones.index.create")),1)]),_:2},1024)]),key:"0"}:void 0]),1024)]),_:1})}}});const re=oe(se,[["__scopeId","data-v-dc2c0760"]]);export{re as default};
