import{d as G,r as c,p as g,o as i,w as e,b as s,e as a,q as w,l as m,c as u,t as o,L as f,M as b,m as A,a0 as O,K as D,R as L,I as Z,Z as j,S as J,y as W,_ as H}from"./index-BANqksT4.js";const Q={key:0},U={key:1},Y=["data-testid"],ee=G({__name:"MeshServiceDetailView",props:{data:{}},setup(N){const d=N;return(te,t)=>{const h=c("XBadge"),z=c("XAction"),B=c("KumaPort"),_=c("XLayout"),$=c("XDl"),I=c("XAboutCard"),S=c("XCopyButton"),R=c("DataCollection"),T=c("DataLoader"),C=c("XCard"),x=c("XIcon"),E=c("XSearch"),P=c("XActionGroup"),M=c("XDrawer"),q=c("RouterView"),K=c("AppView"),F=c("RouteView");return i(),g(F,{name:"mesh-service-detail-view",params:{mesh:"",service:"",page:1,size:Number,s:"",proxy:"",codeSearch:"",codeFilter:!1,codeRegExp:!1}},{default:e(({can:X,route:r,t:l,uri:V,me:y})=>[s(K,null,{default:e(()=>[s(_,{type:"stack"},{default:e(()=>[s(I,{title:l("services.mesh-service.about.title"),created:d.data.creationTime,modified:d.data.modificationTime},{default:e(()=>[s($,{variant:"x-stack"},{default:e(()=>[m("div",null,[m("dt",null,o(l("http.api.property.state")),1),t[1]||(t[1]=a()),m("dd",null,[s(h,{appearance:d.data.spec.state==="Available"?"success":"danger"},{default:e(()=>[a(o(d.data.spec.state),1)]),_:1},8,["appearance"])])]),t[6]||(t[6]=a()),d.data.namespace.length>0?(i(),u("div",Q,[m("dt",null,o(l("http.api.property.namespace")),1),t[2]||(t[2]=a()),m("dd",null,[s(h,{appearance:"decorative"},{default:e(()=>[a(o(d.data.namespace),1)]),_:1})])])):w("",!0),t[7]||(t[7]=a()),X("use zones")&&d.data.zone?(i(),u("div",U,[m("dt",null,o(l("http.api.property.zone")),1),t[3]||(t[3]=a()),m("dd",null,[s(h,{appearance:"decorative"},{default:e(()=>[s(z,{to:{name:"zone-cp-detail-view",params:{zone:d.data.zone}}},{default:e(()=>[a(o(d.data.zone),1)]),_:1},8,["to"])]),_:1})])])):w("",!0),t[8]||(t[8]=a()),m("div",null,[m("dt",null,o(l("http.api.property.ports")),1),t[4]||(t[4]=a()),m("dd",null,[d.data.spec.ports.length?(i(),g(_,{key:0,type:"separated",truncate:""},{default:e(()=>[(i(!0),u(f,null,b(d.data.spec.ports,p=>(i(),g(B,{key:p.port,port:{...p,targetPort:void 0}},null,8,["port"]))),128))]),_:1})):(i(),u(f,{key:1},[a(o(l("common.detail.none")),1)],64))])]),t[9]||(t[9]=a()),m("div",null,[m("dt",null,o(l("http.api.property.selector")),1),t[5]||(t[5]=a()),m("dd",null,[Object.keys(d.data.spec.selector.dataplaneTags).length?(i(),g(_,{key:0,type:"separated",truncate:""},{default:e(()=>[(i(!0),u(f,null,b(d.data.spec.selector.dataplaneTags,(p,n)=>(i(),g(h,{key:`${n}:${p}`,appearance:"info"},{default:e(()=>[a(o(n)+":"+o(p),1)]),_:2},1024))),128))]),_:1})):(i(),u(f,{key:1},[a(o(l("common.detail.none")),1)],64))])])]),_:2},1024)]),_:2},1032,["title","created","modified"]),t[27]||(t[27]=a()),s(C,null,{title:e(()=>[a(o(l("services.detail.hostnames.title")),1)]),default:e(()=>[t[11]||(t[11]=a()),s(T,{src:V(A(O),"/meshes/:mesh/:serviceType/:serviceName/_hostnames",{mesh:r.params.mesh,serviceType:"meshservices",serviceName:r.params.service}),variant:"list"},{default:e(({data:p})=>[s(R,{type:"hostnames",items:p.items},{default:e(()=>[s(D,{type:"hostnames-collection","data-testid":"hostnames-collection",items:p.items,headers:[{...y.get("headers.hostname"),label:l("services.detail.hostnames.hostname"),key:"hostname"},{...y.get("headers.zones"),label:l("services.detail.hostnames.zone"),key:"zones"}],onResize:y.set},{hostname:e(({row:n})=>[m("b",null,[s(S,{text:n.hostname},null,8,["text"])])]),zones:e(({row:n})=>[s(_,{type:"separated"},{default:e(()=>[(i(!0),u(f,null,b(n.zones,(v,k)=>(i(),g(h,{key:k,appearance:"decorative"},{default:e(()=>[s(z,{to:{name:"zone-cp-detail-view",params:{zone:v.name}}},{default:e(()=>[a(o(v.name),1)]),_:2},1032,["to"])]),_:2},1024))),128))]),_:2},1024)]),_:1},8,["items","headers","onResize"])]),_:2},1032,["items"])]),_:2},1032,["src"])]),_:2},1024),t[28]||(t[28]=a()),d.data.spec.identities.length?(i(),g(C,{key:0,"data-testid":"mesh-service-identities"},{title:e(()=>[a(o(l("services.detail.identities.title")),1)]),default:e(()=>[t[13]||(t[13]=a()),s(D,{type:"mesh-identities-collection",items:d.data.spec.identities,headers:[{...y.get("headers.identity"),label:l("services.detail.identities.identity"),key:"identity"},{...y.get("headers.type"),label:l("services.detail.identities.type"),key:"type"}],onResize:y.set},{identity:e(({row:p})=>[m("b",null,[s(S,{text:p.value},null,8,["text"])])]),type:e(({row:p})=>[s(_,{type:"separated"},{default:e(()=>[s(h,{appearance:"decorative"},{default:e(()=>[a(o(p.type),1)]),_:2},1024)]),_:2},1024)]),_:1},8,["items","headers","onResize"])]),_:2},1024)):w("",!0),t[29]||(t[29]=a()),s(C,null,{title:e(()=>[a(o(l("services.detail.dpp-status.title")),1)]),default:e(()=>[t[17]||(t[17]=a()),s(_,{type:"columns",class:"columns-with-borders"},{default:e(()=>[s(L,{total:d.data.status.dataplaneProxies.total,online:d.data.status.dataplaneProxies.connected,"data-testid":"connected-dpps"},{icon:e(()=>[s(x,{name:"connected"})]),title:e(()=>[a(o(l("services.detail.dpp-status.connected")),1)]),_:2},1032,["total","online"]),t[16]||(t[16]=a()),s(L,{total:d.data.status.dataplaneProxies.healthy,"data-testid":"healthy-dpps"},{icon:e(()=>[s(x,{name:"healthy"})]),title:e(()=>[a(o(l("services.detail.dpp-status.healthy")),1)]),_:2},1032,["total"])]),_:2},1024)]),_:2},1024),t[30]||(t[30]=a()),m("div",null,[s(C,{class:"mt-4"},{title:e(()=>[a(o(l("services.detail.data_plane_proxies")),1)]),default:e(()=>[t[25]||(t[25]=a()),m("search",null,[m("form",{class:"search-form",onSubmit:t[0]||(t[0]=Z(()=>{},["prevent"]))},[s(E,{class:"search-field",keys:["name","tag","label"],value:r.params.s,onChange:p=>r.update({page:1,s:p})},null,8,["value","onChange"])],32)]),t[26]||(t[26]=a()),s(T,{src:V(A(j),"/meshes/:mesh/dataplanes/for/mesh-service/:tags",{mesh:r.params.mesh,tags:JSON.stringify({...d.data.spec.selector.dataplaneTags})},{page:r.params.page,size:r.params.size,search:`${r.params.s}${X("use zones")&&d.data.zone.length>0?` zone:${d.data.zone}`:""}`}),variant:"list"},{default:e(({data:p})=>[s(R,{type:"data-planes",items:p.items,page:r.params.page,"page-size":r.params.size,total:p.total,onChange:r.update},{default:e(()=>[s(D,{class:"data-plane-collection","data-testid":"data-plane-collection",headers:[{...y.get("headers.name"),label:"Name",key:"name"},{...y.get("headers.namespace"),label:"Namespace",key:"namespace"},...X("use zones")?[{...y.get("headers.zone"),label:"Zone",key:"zone"}]:[],{...y.get("headers.certificate"),label:"Certificate info",key:"certificate"},{...y.get("headers.status"),label:"Status",key:"status"},{...y.get("headers.warnings"),label:"Warnings",key:"warnings",hideLabel:!0},{...y.get("headers.actions"),label:"Actions",key:"actions",hideLabel:!0}],items:p.items,"is-selected-row":n=>n.name===r.params.proxy,onResize:y.set},{name:e(({row:n})=>[s(z,{class:"name-link",to:{name:"mesh-service-data-plane-summary-view",params:{mesh:n.mesh,proxy:n.id},query:{page:r.params.page,size:r.params.size,s:r.params.s}},"data-action":""},{default:e(()=>[a(o(n.name),1)]),_:2},1032,["to"])]),namespace:e(({row:n})=>[a(o(n.namespace),1)]),zone:e(({row:n})=>[n.zone?(i(),g(z,{key:0,to:{name:"zone-cp-detail-view",params:{zone:n.zone}}},{default:e(()=>[a(o(n.zone),1)]),_:2},1032,["to"])):(i(),u(f,{key:1},[a(o(l("common.collection.none")),1)],64))]),certificate:e(({row:n})=>[n.dataplaneInsight.mTLS?.certificateExpirationTime?(i(),u(f,{key:0},[a(o(l("common.formats.datetime",{value:Date.parse(n.dataplaneInsight.mTLS.certificateExpirationTime)})),1)],64)):(i(),u(f,{key:1},[a(o(l("data-planes.components.data-plane-list.certificate.none")),1)],64))]),status:e(({row:n})=>[s(J,{status:n.status},null,8,["status"])]),warnings:e(({row:n})=>[(i(!0),u(f,null,b([[{bool:n.dataplaneInsight.version?.kumaDp?.kumaCpCompatible===!1||n.dataplaneInsight.version?.envoy?.kumaDpCompatible===!1,key:"dp-cp-incompatible"},{bool:n.isCertExpiresSoon,key:"certificate-expires-soon"},{bool:n.isCertExpired,key:"certificate-expired"}].filter(({bool:v})=>v)],v=>(i(),u(f,{key:typeof v},[v.length>0?(i(),g(x,{key:0,name:"warning","data-testid":"warning"},{default:e(()=>[m("ul",null,[(i(!0),u(f,null,b(v,({key:k})=>(i(),u("li",{key:k,"data-testid":`warning-${k}`},o(l(`data-planes.routes.items.warnings.${k}`)),9,Y))),128))])]),_:2},1024)):(i(),u(f,{key:1},[a(o(l("common.collection.none")),1)],64))],64))),128))]),actions:e(({row:n})=>[s(P,null,{default:e(()=>[s(z,{to:{name:"data-plane-detail-view",params:{proxy:n.id}}},{default:e(()=>[a(o(l("common.collection.actions.view")),1)]),_:2},1032,["to"])]),_:2},1024)]),_:2},1032,["headers","items","is-selected-row","onResize"]),t[24]||(t[24]=a()),r.params.proxy?(i(),g(q,{key:0},{default:e(n=>[s(M,{onClose:v=>r.replace({name:r.name,params:{mesh:r.params.mesh},query:{page:r.params.page,size:r.params.size,s:r.params.s}})},{default:e(()=>[typeof p<"u"?(i(),g(W(n.Component),{key:0,items:p.items},null,8,["items"])):w("",!0)]),_:2},1032,["onClose"])]),_:2},1024)):w("",!0)]),_:2},1032,["items","page","page-size","total","onChange"])]),_:2},1032,["src"])]),_:2},1024)])]),_:2},1024)]),_:2},1024)]),_:1})}}}),se=H(ee,[["__scopeId","data-v-4159f95f"]]);export{se as default};
