import{d as J,p,o as i,w as e,b as t,e as n,r as l,m as f,Q as x,q as D,c as h,L as k,N as y,O as T,t as d,K as U,l as $,R,F as W,M as Z,Y as z,H as q,y as ee,_ as te}from"./index-CHUyLuna.js";import{S as se}from"./SummaryView-B_VTmqHS.js";const ae=J({__name:"MeshDetailView",props:{mesh:{}},setup(P){const u=P;return(j,s)=>{const F=l("RouteTitle"),V=l("XI18n"),M=l("XNotification"),C=l("XAction"),_=l("XBadge"),c=l("XLayout"),O=l("XAboutCard"),Y=l("DataCollection"),S=l("XCard"),B=l("DataSource"),E=l("XSelect"),A=l("XCodeBlock"),L=l("DataLoader"),H=l("RouterView"),K=l("AppView"),Q=l("RouteView");return i(),p(Q,{name:"mesh-detail-view",params:{mesh:"",environment:String}},{default:e(({route:m,t:r,uri:g,me:X})=>[t(F,{title:r("meshes.routes.overview.title"),render:!1},null,8,["title"]),s[18]||(s[18]=n()),t(B,{src:g(f(q),"/mesh-insights/:name",{name:m.params.mesh})},{default:e(({data:v})=>[t(B,{src:g(f(x),"/meshes/:mesh/meshidentities",{mesh:m.params.mesh})},{default:e(({data:w})=>[t(B,{src:g(f(x),"/meshes/:mesh/meshtrusts",{mesh:m.params.mesh})},{default:e(({data:b})=>[t(K,{docs:r("meshes.href.docs"),notifications:!0},{default:e(()=>[t(L,{data:[w,b]},{default:e(()=>[t(M,{notify:!u.mesh.mtlsBackend&&w.items.length===0,uri:`meshes.notifications.mtls-warning:${u.mesh.id}`},{default:e(()=>[t(V,{path:"meshes.notifications.mtls-warning"})]),_:1},8,["notify","uri"]),s[15]||(s[15]=n()),t(M,{notify:j.mesh.meshServices.mode==="Disabled",uri:`meshes.notifications.mesh-service-activation:${m.params.mesh}`,variant:"info"},{default:e(()=>[t(V,{path:"meshes.notifications.mesh-service-activation"})]),_:1},8,["notify","uri"]),s[16]||(s[16]=n()),t(c,{type:"stack"},{default:e(()=>[t(O,{title:r("meshes.routes.item.about.title"),created:u.mesh.creationTime,modified:u.mesh.modificationTime,class:"about-section"},{default:e(()=>[t(c,null,{default:e(()=>[t(c,{type:"separated"},{default:e(()=>[(i(),h(y,null,k(["MeshTrafficPermission","MeshMetric","MeshAccessLog","MeshTrace"],a=>(i(),h(y,{key:a},[(i(!0),h(y,null,k([v?.policies?.[a]??{total:0}],o=>(i(),h(y,{key:typeof o},[t(M,{notify:a==="MeshTrafficPermission"&&u.mesh.mtlsBackend&&o.total===0,uri:`meshes.notifications.mtp-warning:${u.mesh.id}`},{default:e(()=>[t(V,{path:"meshes.notifications.mtp-warning"})]),_:1},8,["notify","uri"]),s[1]||(s[1]=n()),t(T,{layout:"horizontal"},{title:e(()=>[t(C,{to:{name:"policy-list-view",params:{mesh:m.params.mesh,policyPath:`${a.toLowerCase()}s`}}},{default:e(()=>[n(d(a),1)]),_:2},1032,["to"])]),body:e(()=>[t(_,{appearance:o.total>0?"success":"neutral"},{default:e(()=>[n(d(o.total>0?r("meshes.detail.enabled"):r("meshes.detail.disabled")),1)]),_:2},1032,["appearance"])]),_:2},1024)],64))),128))],64))),64)),s[5]||(s[5]=n()),t(T,{layout:"horizontal","data-testid":"mesh-mtls"},{title:e(()=>[n(d(r("http.api.property.mtls")),1)]),body:e(()=>[t(c,{type:"separated"},{default:e(()=>[u.mesh.mtlsBackend?(i(),p(_,{key:0,appearance:"info"},{default:e(()=>[n(d(u.mesh.mtlsBackend.type)+" / "+d(u.mesh.mtlsBackend.name),1)]),_:1})):D("",!0),s[2]||(s[2]=n()),(i(!0),h(y,null,k(w?.items,a=>(i(),p(C,{key:a.name,to:{name:"mesh-identity-summary-view",params:{mid:a.kri}}},{default:e(()=>[t(_,{appearance:"info"},{default:e(()=>[n(`
                                  MeshIdentity / `+d(a.name),1)]),_:2},1024)]),_:2},1032,["to"]))),128)),s[3]||(s[3]=n()),!u.mesh.mtlsBackend&&!w?.items?.length?(i(),p(_,{key:1,appearance:"neutral"},{default:e(()=>[n(d(r("meshes.detail.disabled")),1)]),_:2},1024)):D("",!0)]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1032,["title","created","modified"]),s[12]||(s[12]=n()),b?.items?.length?(i(),p(S,{key:0,"data-testid":"mesh-trusts-listing"},{title:e(()=>[n(d(r("meshes.routes.item.mesh-trusts.title")),1)]),default:e(()=>[s[8]||(s[8]=n()),t(Y,{type:"mesh-trusts",items:b?.items},{default:e(()=>[t(U,{type:"mesh-trusts-collection",items:b?.items,headers:[{...X.get("headers.identity"),label:r("meshes.routes.item.mesh-trusts.name"),key:"name"},{...X.get("headers.type"),label:r("meshes.routes.item.mesh-trusts.trust-domain"),key:"trustDomain"},{...X.get("headers.origin"),label:r("meshes.routes.item.mesh-trusts.origin"),key:"origin"}],onResize:X.set},{name:e(({row:a})=>[t(C,{class:"name-link",title:a.name,to:{name:"mesh-trust-summary-view",params:{mtrust:a.kri},query:{environment:m.params.environment}},"data-action":""},{default:e(()=>[$("b",null,d(a.name),1)]),_:2},1032,["title","to"])]),trustDomain:e(({row:a})=>[t(_,{appearance:"decorative"},{default:e(()=>[n(d(a.spec.trustDomain),1)]),_:2},1024)]),origin:e(({row:a})=>[t(C,{to:{name:"mesh-identity-summary-view",params:{mid:a.spec.origin.kri}},"data-action":""},{default:e(()=>[t(_,{appearance:"decorative"},{default:e(()=>[n(d(a.spec.origin.kri),1)]),_:2},1024)]),_:2},1032,["to"])]),_:2},1032,["items","headers","onResize"])]),_:2},1032,["items"])]),_:2},1024)):D("",!0),s[13]||(s[13]=n()),t(S,null,{default:e(()=>[t(c,{type:"columns",class:"columns-with-borders"},{default:e(()=>[t(R,{total:v?.services.total??0,"data-testid":"services-status"},{title:e(()=>[n(d(r("meshes.detail.services")),1)]),_:2},1032,["total"]),s[9]||(s[9]=n()),t(R,{total:v?.dataplanesByType.standard.total??0,online:v?.dataplanesByType.standard.online??0,"data-testid":"data-plane-proxies-status"},{title:e(()=>[n(d(r("meshes.detail.data_plane_proxies")),1)]),_:2},1032,["total","online"]),s[10]||(s[10]=n()),t(B,{src:g(f(W),"/policy-types",{})},{default:e(({data:a})=>[(i(!0),h(y,null,k([a?.policyTypes.map(o=>o.name)],o=>(i(),p(R,{key:typeof o,total:Object.entries(v?.resources||{}).reduce((N,[G,{total:I}])=>(o||[]).includes(G)?N+I:N,0),"data-testid":"policies-status"},{title:e(()=>[n(d(r("meshes.detail.policies")),1)]),_:2},1032,["total"]))),128))]),_:2},1032,["src"])]),_:2},1024)]),_:2},1024),s[14]||(s[14]=n()),t(S,null,{default:e(()=>[t(c,null,{default:e(()=>[t(c,{type:"separated",justify:"end"},{default:e(()=>[(i(),h(y,null,k([["universal","k8s"]],a=>$("div",{key:typeof a},[t(E,{label:r("meshes.routes.item.format"),selected:m.params.environment,onChange:o=>{m.update({environment:o})},onVnodeBeforeMount:o=>o?.props?.selected&&a.includes(o.props.selected)&&o.props.selected!==m.params.environment&&m.update({environment:o.props.selected})},Z({_:2},[k(a,o=>({name:`${o}-option`,fn:e(()=>[n(d(r(`meshes.routes.item.formats.${o}`)),1)])}))]),1032,["label","selected","onChange","onVnodeBeforeMount"])])),64))]),_:2},1024),s[11]||(s[11]=n()),m.params.environment==="universal"?(i(),p(A,{key:0,"data-testid":"codeblock-yaml-universal",language:"yaml",code:f(z).stringify(u.mesh.config)},null,8,["code"])):(i(),p(L,{key:1,src:g(f(q),"/meshes/:name/as/kubernetes",{name:m.params.mesh})},{default:e(({data:a})=>[t(A,{"data-testid":"codeblock-yaml-k8s",language:"yaml",code:f(z).stringify(a)},null,8,["code"])]),_:1},8,["src"]))]),_:2},1024)]),_:2},1024)]),_:2},1024),s[17]||(s[17]=n()),t(H,null,{default:e(a=>[a.route.name!==m.name?(i(),p(se,{key:0,onClose:o=>m.replace({name:"mesh-detail-view",params:{mesh:m.params.mesh},query:{environment:m.params.environment}})},{default:e(()=>[(i(),p(ee(a.Component),{"mesh-identities":w?.items,"mesh-trusts":b?.items},null,8,["mesh-identities","mesh-trusts"]))]),_:2},1032,["onClose"])):D("",!0)]),_:2},1024)]),_:2},1032,["data"])]),_:2},1032,["docs"])]),_:2},1032,["src"])]),_:2},1032,["src"])]),_:2},1032,["src"])]),_:1})}}}),ie=te(ae,[["__scopeId","data-v-8e67da6d"]]);export{ie as default};
