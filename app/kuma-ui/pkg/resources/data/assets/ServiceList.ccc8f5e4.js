import{d as A,cL as w,L as l,cM as D,o as S,h as k,e as R,b as C,p as M,cy as T,K as i,_ as $}from"./index.f2463021.js";import{D as B}from"./DataOverview.e6547ee7.js";import{_ as F}from"./ServiceDetails.vue_vue_type_script_setup_true_lang.9b468729.js";const N={class:"component-frame"},U=A({__name:"ServiceList",props:{type:{type:String,required:!0},tabHeaders:{type:Array,required:!0}},setup(y){const o=y,E={ServiceInsight:"internal services",ExternalService:"external services"},h=w(),b={title:"No Data",message:`There are no ${E[o.type]} present.`},u=l(!0),n=l(null),_=l(null),s=l(null),c=l({headers:o.tabHeaders,data:[]}),f=50;D(()=>h.params.mesh,function(){m(0)}),m(0);function x(e){return o.type==="ServiceInsight"?i.getAllServiceInsights(e):i.getAllExternalServices(e)}function I(e){return o.type==="ServiceInsight"?i.getAllServiceInsightsFromMesh({mesh:e}):i.getAllExternalServicesFromMesh({mesh:e})}function L(e){const a=e,v={name:e.type==="ServiceInsight"?"service-insight-detail-view":"external-service-detail-view",params:{mesh:e.mesh,service:e.name}};a.nameRoute=v;const t={name:"mesh-child",params:{mesh:e.mesh}};if(a.meshRoute=t,e.type==="ServiceInsight"){const{online:d=0,total:r=0}=e.dataplanes;a.totalOnline=`${d} / ${r}`,a.status=T[e.status].title}else a.address=e.networking.address,a.tlsEnabled=e.networking.tls.enabled?"Enabled":"Disabled";return a}async function m(e){u.value=!0,n.value=null;const a=h.params.mesh||null,v=()=>a==="all"||a===null?x({size:f,offset:e}):I(a);try{const{items:t,next:d}=await v();_.value=d,t.sort((r,p)=>r.name>p.name?1:r.name<p.name?-1:r.mesh.localeCompare(p.mesh)),t.length>0?(g(t[0]),c.value.data=t.map(r=>L(r))):(s.value=null,c.value.data=[])}catch(t){s.value=null,t instanceof Error?n.value=t:console.error(n)}finally{u.value=!1}}function g(e){s.value=e}return(e,a)=>(S(),k("div",N,[R(B,{"page-size":f,error:n.value,"has-error":n.value!==null,"is-loading":u.value,"empty-state":b,"table-data":c.value,"table-data-is-empty":c.value.data.length===0,next:_.value,onTableAction:g,onLoadData:m},null,8,["error","has-error","is-loading","table-data","table-data-is-empty","next"]),s.value!==null?(S(),C(F,{key:0,class:"service-details",type:s.value.type,name:s.value.name,mesh:s.value.mesh},null,8,["type","name","mesh"])):M("",!0)]))}});const K=$(U,[["__scopeId","data-v-f878681a"]]);export{K as S};
