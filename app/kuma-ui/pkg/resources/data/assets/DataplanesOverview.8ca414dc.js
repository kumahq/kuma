import{_ as D,a5 as O,K as u,Z as y,cR as x,c as w,w as i,r as n,o as h,a as r,e as _,f as s,t as b,p as P}from"./index.ff83acd2.js";import{L}from"./LoadingBox.ffa10552.js";import{O as N}from"./OnboardingNavigation.c9f1186c.js";import{O as k,a as C}from"./OnboardingPage.8084b64c.js";const B={name:"DataplanesOverview",components:{OnboardingNavigation:N,OnboardingHeading:k,OnboardingPage:C,LoadingBox:L},metaInfo(){return{title:this.title}},data(){return{productName:O,tableHeaders:[{label:"Mesh",key:"mesh"},{label:"Name",key:"name"},{label:"Status",key:"status"}],tableData:{total:0,data:[]},timeout:null}},computed:{title(){return this.tableData.data.length?"Success":"Waiting for DPPs"},description(){return this.tableData.data.length?"The following data plane proxies (DPPs) are connected to the control plane:":null}},created(){this.getAllDataplanes()},beforeUnmount(){clearTimeout(this.timeout)},methods:{async getAllDataplanes(){let d=!1;const c=[];try{const g=(await u.getAllDataplanes({size:10})).items;for(let t=0;t<g.length;t++){const{name:a,mesh:o}=g[t],{status:l}=await u.getDataplaneOverviewFromMesh({mesh:o,name:a}).then(m=>y(m.dataplaneInsight));l===x&&(d=!0),c.push({status:l,name:a,mesh:o})}}catch(p){console.error(p)}this.tableData.data=c,this.tableData.total=this.tableData.data.length,d&&(this.timeout=setTimeout(()=>{this.getAllDataplanes()},1e3))}}},T={key:0,class:"justify-center flex my-4"},A={key:1},F={class:"flex justify-center mt-10 mb-16 pb-16"},H={class:"w-full sm:w-3/5 p-4"},I={class:"font-bold mb-4"};function K(d,c,p,g,t,a){const o=n("OnboardingHeading"),l=n("LoadingBox"),m=n("KTable"),f=n("OnboardingNavigation"),v=n("OnboardingPage");return h(),w(v,null,{header:i(()=>[r(o,{title:a.title,description:a.description},null,8,["title","description"])]),content:i(()=>[t.tableData.data.length?(h(),_("div",A,[s("div",F,[s("div",H,[s("p",I," Found "+b(t.tableData.data.length)+" DPPs: ",1),r(m,{class:"onboarding-dataplane-table",fetcher:()=>t.tableData,headers:t.tableHeaders,"disable-pagination":"","is-small":""},{status:i(({rowValue:e})=>[s("div",{class:P(["entity-status",{"is-offline":e.toLowerCase()==="offline"||e===!1,"is-online":e.toLowerCase()==="online","is-degraded":e.toLowerCase()==="partially degraded","is-not-available":e.toLowerCase()==="not available"}])},[s("span",null,b(e),1)],2)]),_:1},8,["fetcher","headers"])])])])):(h(),_("div",T,[r(l)]))]),navigation:i(()=>[r(f,{"next-step":"onboarding-completed","previous-step":"onboarding-add-services-code","should-allow-next":t.tableData.data.length>0},null,8,["should-allow-next"])]),_:1})}const j=D(B,[["render",K]]);export{j as default};
