import{d as T,u as A,r as s,c as P,v as S,M as b,o as h,b as x}from"./index-574d45b5.js";import{D as I}from"./DataPlaneList-7a2675da.js";import{u as k}from"./index-58b06467.js";import{Q as c}from"./QueryParameter-70743f73.js";import"./kongponents.es-3b634060.js";import"./ContentWrapper-05eb3317.js";import"./_plugin-vue_export-helper-c27b6911.js";import"./DataOverview-f8ab0be8.js";import"./EmptyBlock.vue_vue_type_script_setup_true_lang-0e5f40af.js";import"./ErrorBlock-c529b0a4.js";import"./LoadingBlock.vue_vue_type_script_setup_true_lang-c65e601c.js";import"./datadogLogEvents-302eea7b.js";import"./TagList-913f985e.js";import"./StatusBadge-08e76456.js";import"./DefinitionListItem-73363cac.js";import"./ResourceCodeBlock.vue_vue_type_script_setup_true_lang-a885226a.js";import"./CodeBlock.vue_vue_type_style_index_0_lang-45c04b00.js";import"./TextWithCopyButton-ac5e81f5.js";import"./StatusInfo.vue_vue_type_script_setup_true_lang-3ac53131.js";import"./toYaml-4e00099e.js";import"./store-e583704e.js";const ee=T({__name:"DataPlaneListView",props:{selectedDppName:{type:String,required:!1,default:null},gatewayType:{type:String,required:!1,default:"true"},offset:{type:Number,required:!1,default:0},isGatewayView:{type:Boolean,required:!1,default:!1}},setup(y){const t=y,v=k(),w={name:{description:"filter by name or parts of a name"},service:{description:"filter by “kuma.io/service” value"},tag:{description:"filter by tags (e.g. “tag: version:2”)"},zone:{description:"filter by “kuma.io/zone” value"}},g={protocol:{description:"filter by “kuma.io/protocol” value"}},_={},i=A(),l=s([]),n=s(!0),f=s(null),p=s(null),d=s(t.offset),D=P(()=>({...w,...t.isGatewayView?_:g}));S(()=>i.params.mesh,function(){i.name!=="data-planes-list-view"&&i.name!=="gateways-list-view"||u(0)});function E(){const a=c.get("filterFields"),r=a!==null?JSON.parse(a):{};u(t.offset,{...r,gateway:t.gatewayType})}E();async function u(a,r={}){d.value=a,c.set("offset",a>0?a:null),c.set("gatewayType",r.gateway==="true"?"all":r.gateway),n.value=!0;const m=i.params.mesh,o=F(r,b,a,t.isGatewayView);try{const{items:e,next:L}=await v.getAllDataplaneOverviewsFromMesh({mesh:m},o);p.value=L,l.value=e??[]}catch(e){e instanceof Error?f.value=e:console.error(e),l.value=[],p.value=null}finally{n.value=!1}}function F(a,r,m,o){const e={...a,size:r,offset:m};return o&&(!("gateway"in e)||e.gateway==="false")?e.gateway="true":o||(e.gateway="false"),e}return(a,r)=>(h(),x(I,{"data-plane-overviews":l.value,"is-loading":n.value,error:f.value,"next-url":p.value,"page-offset":d.value,"selected-dpp-name":t.selectedDppName,"is-gateway-view":t.isGatewayView,"gateway-type":t.gatewayType,"dpp-filter-fields":D.value,onLoadData:u},null,8,["data-plane-overviews","is-loading","error","next-url","page-offset","selected-dpp-name","is-gateway-view","gateway-type","dpp-filter-fields"]))}});export{ee as default};
