import{d as $,p as l,o as c,w as e,b as o,r as p,c as g,e as n,L as I,M as j,N as w,q as z,O as h,T as x,t as d,n as L,K as O,y as E,l as q,m as F,A as G}from"./index-CHUyLuna.js";import{S as K}from"./SummaryView-B_VTmqHS.js";const J=$({__name:"ZoneDetailView",props:{data:{}},setup(X){const i=X;return(M,a)=>{const C=p("XAction"),m=p("XI18n"),V=p("XNotification"),v=p("XBadge"),k=p("XIcon"),f=p("XLayout"),S=p("XAboutCard"),T=p("RouterView"),A=p("XCard"),R=p("AppView"),D=p("DataSource"),B=p("RouteView");return c(),l(B,{name:"zone-cp-detail-view",params:{zone:"",subscription:""}},{default:e(({t:s,uri:N,route:y,me:u})=>[o(D,{src:N(F(G),"/control-plane/outdated/:version",{version:i.data.zoneInsight.version?.kumaCp?.version??"-"})},{default:e(({data:b})=>[o(R,{docs:s("zones.href.docs.cta"),notifications:!0},{default:e(()=>[(c(!0),g(w,null,I([{bool:i.data.zoneInsight.store==="memory",key:"store-memory"},{bool:!i.data.zoneInsight.version?.kumaCp?.kumaCpGlobalCompatible,key:"global-cp-incompatible",params:{zoneCpVersion:i.data.zoneInsight.version?.kumaCp?.version??"-",globalCpVersion:b?.version??""}},{bool:(i.data.zoneInsight.connectedSubscription?.status.total.responsesRejected??0)>0,key:"global-nack-response"}],({bool:t,key:r,params:_})=>(c(),l(V,{key:r,notify:t,"data-testid":`warning-${r}`,uri:`zone-cps.notifications.${r}.${i.data.id}`},{default:e(()=>[o(m,{path:`zone-cps.notifications.${r}`,params:Object.fromEntries(Object.entries(_??{}))},j({_:2},[r==="global-nack-response"?{name:"link",fn:e(()=>[o(C,{"data-action":"",to:{name:"zone-cp-subscription-summary-view",params:{subscription:i.data.zoneInsight.connectedSubscription?.id}}},{default:e(()=>[...a[0]||(a[0]=[n(`
                  zone control plane summary
                `,-1)])]),_:1},8,["to"])]),key:"0"}:void 0]),1032,["path","params"])]),_:2},1032,["notify","data-testid","uri"]))),128)),a[18]||(a[18]=n()),o(f,{"data-testid":"detail-view-details",type:"stack"},{default:e(()=>[o(S,{title:s("zone-cps.detail.about.title"),created:i.data.creationTime,modified:i.data.modificationTime},{default:e(()=>[o(h,{layout:"horizontal"},{title:e(()=>[n(d(s("http.api.property.status")),1)]),body:e(()=>[o(x,{status:i.data.state},null,8,["status"])]),_:2},1024),a[6]||(a[6]=n()),o(h,{layout:"horizontal",class:L({version:!0,outdated:b?.outdated})},{title:e(()=>[n(d(s("zone-cps.routes.item.version")),1)]),body:e(()=>[o(f,{type:"separated"},{default:e(()=>[o(v,{appearance:b?.outdated===!0?"warning":"decorative"},{default:e(()=>[n(d(i.data.zoneInsight.version?.kumaCp?.version??"—"),1)]),_:2},1032,["appearance"]),a[2]||(a[2]=n()),b?.outdated===!0?(c(),l(k,{key:0,name:"info"},{default:e(()=>[o(m,{path:"zone-cps.routes.item.version_warning"})]),_:1})):z("",!0)]),_:2},1024)]),_:2},1032,["class"]),a[7]||(a[7]=n()),o(h,{layout:"horizontal"},{title:e(()=>[n(d(s("http.api.property.type")),1)]),body:e(()=>[o(v,{appearance:"decorative"},{default:e(()=>[n(d(s(`common.product.environment.${i.data.zoneInsight.environment||"unknown"}`)),1)]),_:2},1024)]),_:2},1024),a[8]||(a[8]=n()),o(h,{layout:"horizontal"},{title:e(()=>[n(d(s("zone-cps.routes.item.authentication_type")),1)]),body:e(()=>[o(v,{appearance:"decorative"},{default:e(()=>[n(d(i.data.zoneInsight.authenticationType||s("common.not_applicable")),1)]),_:2},1024)]),_:2},1024)]),_:2},1032,["title","created","modified"]),a[17]||(a[17]=n()),i.data.zoneInsight.subscriptions.length>0?(c(),l(A,{key:0},{title:e(()=>[q("h2",null,d(s("zone-cps.detail.subscriptions.title")),1)]),default:e(()=>[a[15]||(a[15]=n()),o(f,null,{default:e(()=>[o(m,{path:"zone-cps.detail.subscriptions.description"}),a[14]||(a[14]=n()),o(O,{headers:[{...u.get("headers.connection"),label:" ",key:"connection"},{...u.get("headers.zoneInstanceId"),label:s("zone-cps.routes.items.headers.zoneInstanceId"),key:"zoneInstanceId"},{...u.get("headers.version"),label:s("zone-cps.routes.items.headers.version"),key:"version"},{...u.get("headers.connected"),label:s("zone-cps.routes.items.headers.connected"),key:"connected"},{...u.get("headers.disconnected"),label:s("zone-cps.routes.items.headers.disconnected"),key:"disconnected"},{...u.get("headers.responses"),label:s("zone-cps.routes.items.headers.responses"),key:"responses"}],"is-selected-row":t=>t.id===y.params.subscription,items:i.data.zoneInsight.subscriptions.map((t,r,_)=>_[_.length-(r+1)]),onResize:u.set},{connection:e(({row:t})=>[(c(!0),g(w,null,I([t.connectTime&&!t.disconnectTime?"healthy":"unhealthy"],r=>(c(),l(k,{key:`${r}`,name:r},{default:e(()=>[n(d(s(`common.connection.${r}`)),1)]),_:2},1032,["name"]))),128))]),zoneInstanceId:e(({row:t})=>[o(C,{"data-action":"",to:{name:"zone-cp-subscription-summary-view",params:{subscription:t.id}}},{default:e(()=>[n(d(t.zoneInstanceId),1)]),_:2},1032,["to"])]),version:e(({row:t})=>[n(d(t.version?.kumaCp?.version??"-"),1)]),connected:e(({row:t})=>[n(d(s("common.formats.datetime",{value:Date.parse(t.connectTime??"")})),1)]),disconnected:e(({row:t})=>[t.disconnectTime?(c(),g(w,{key:0},[n(d(s("common.formats.datetime",{value:Date.parse(t.disconnectTime)})),1)],64)):z("",!0)]),responses:e(({row:t})=>[(c(!0),g(w,null,I([t.status?.total??{}],r=>(c(),l(f,{key:typeof r,type:"separated"},{default:e(()=>[n(d(r.responsesSent)+"/"+d(r.responsesAcknowledged)+" ",1),!t.disconnectTime&&t.status.total.responsesRejected>0?(c(),l(k,{key:0,name:"warning","data-testid":"warning"},{default:e(()=>[o(m,{path:"zone-cps.routes.items.rows.nacked",params:{nacked:String(t.status.total.responsesRejected)}},null,8,["params"])]),_:2},1024)):z("",!0)]),_:2},1024))),128))]),_:2},1032,["headers","is-selected-row","items","onResize"])]),_:2},1024),a[16]||(a[16]=n()),o(T,null,{default:e(({Component:t})=>[y.child()?(c(),l(K,{key:0,width:"670px",onClose:function(){y.replace({name:"zone-cp-detail-view",params:{zone:y.params.zone}})}},{default:e(()=>[(c(),l(E(t),{data:i.data.zoneInsight.subscriptions},{default:e(()=>[o(m,{path:"zone-cps.routes.item.subscription_intro"})]),_:1},8,["data"]))]),_:2},1032,["onClose"])):z("",!0)]),_:2},1024)]),_:2},1024)):z("",!0)]),_:2},1024)]),_:2},1032,["docs"])]),_:2},1032,["src"])]),_:1})}}});export{J as default};
