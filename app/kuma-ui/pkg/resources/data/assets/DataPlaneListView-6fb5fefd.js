import{d as V,u as A,q as r,c as I,o as S,a as b,w as y,h as u,b as h,g as k,P as G}from"./index-1147aef1.js";import{D as N}from"./DataPlaneList-307037e5.js";import{j as q,k as O,g as B,_ as R}from"./RouteView.vue_vue_type_script_setup_true_lang-ca499fa5.js";import{_ as $}from"./RouteTitle.vue_vue_type_script_setup_true_lang-f1356936.js";import{Q as c}from"./QueryParameter-70743f73.js";import"./kongponents.es-8f2ab58c.js";import"./ContentWrapper-cada506d.js";import"./DataOverview-a61bf90e.js";import"./EmptyBlock.vue_vue_type_script_setup_true_lang-495914c1.js";import"./ErrorBlock-22abd2ad.js";import"./LoadingBlock.vue_vue_type_script_setup_true_lang-c5cb903e.js";import"./TagList-2dbe2543.js";import"./StatusBadge-4afb516e.js";import"./DefinitionListItem-31bd3e1f.js";import"./ResourceCodeBlock.vue_vue_type_script_setup_true_lang-125286c8.js";import"./CodeBlock.vue_vue_type_style_index_0_lang-99eae46c.js";import"./TextWithCopyButton-84dfce1a.js";import"./StatusInfo.vue_vue_type_script_setup_true_lang-19dcf8fc.js";import"./toYaml-4e00099e.js";const le=V({__name:"DataPlaneListView",props:{selectedDppName:{type:String,required:!1,default:null},gatewayType:{type:String,required:!1,default:"true"},offset:{type:Number,required:!1,default:0},isGatewayView:{type:Boolean,required:!1,default:!1}},setup(w){const a=w,g=q(),{t:v}=O(),_={name:{description:"filter by name or parts of a name"},service:{description:"filter by “kuma.io/service” value"},tag:{description:"filter by tags (e.g. “tag: version:2”)"},zone:{description:"filter by “kuma.io/zone” value"}},D={protocol:{description:"filter by “kuma.io/protocol” value"}},E={},F=A(),l=r([]),o=r(!0),f=r(null),n=r(null),m=r(a.offset),L=I(()=>({..._,...a.isGatewayView?E:D}));function T(){const t=c.get("filterFields"),s=t!==null?JSON.parse(t):{};d(a.offset,{...s,gateway:a.gatewayType})}T();async function d(t,s={}){m.value=t,c.set("offset",t>0?t:null),c.set("gatewayType",s.gateway==="true"?"all":s.gateway),o.value=!0;const p=F.params.mesh,i=x(s,G,t,a.isGatewayView);try{const{items:e,next:P}=await g.getAllDataplaneOverviewsFromMesh({mesh:p},i);n.value=P,l.value=e??[]}catch(e){e instanceof Error?f.value=e:console.error(e),l.value=[],n.value=null}finally{o.value=!1}}function x(t,s,p,i){const e={...t,size:s,offset:p};return i&&(!("gateway"in e)||e.gateway==="false")?e.gateway="true":i||(e.gateway="false"),e}return(t,s)=>(S(),b(R,{module:a.isGatewayView?"gateways":"data-planes"},{default:y(()=>[u($,{title:h(v)(`${a.isGatewayView?"gateways":"data-planes"}.routes.items.title`)},null,8,["title"]),k(),u(B,null,{default:y(()=>[u(N,{"data-plane-overviews":l.value,"is-loading":o.value,error:f.value,"next-url":n.value,"page-offset":m.value,"selected-dpp-name":a.selectedDppName,"is-gateway-view":a.isGatewayView,"gateway-type":a.gatewayType,"dpp-filter-fields":L.value,onLoadData:d},null,8,["data-plane-overviews","is-loading","error","next-url","page-offset","selected-dpp-name","is-gateway-view","gateway-type","dpp-filter-fields"])]),_:1})]),_:1},8,["module"]))}});export{le as default};
