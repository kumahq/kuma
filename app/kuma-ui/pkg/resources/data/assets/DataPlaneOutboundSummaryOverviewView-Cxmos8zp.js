import{d as E,r as d,p as y,o as t,w as o,b as s,c as a,N as i,L as f,e as r,q as M,l as n,t as k,m as X,F as H,a9 as I,Y as P}from"./index-AyKB-3zh.js";import{A as J,a as G}from"./AccordionList-C_U-yGv-.js";import{P as x}from"./PolicyTypeTag-DcWSilQ7.js";import{R as K}from"./RuleMatchers-CFYHC1rD.js";const Q={key:0},U={class:"stack-with-borders mt-4"},W={key:0},Z={colspan:"2"},ee={class:"mt-4"},te={key:0},oe={key:1},ne={colspan:"2"},ue=E({__name:"DataPlaneOutboundSummaryOverviewView",props:{data:{},routeName:{}},setup(S){const g=S,O=(w,e)=>w.$resourceMeta.name===e.name&&w.$resourceMeta.namespace===e.namespace&&w.$resourceMeta.zone===e.zone&&(e.resourceSectionName===""||w.$resourceMeta.port===e.port);return(w,e)=>{const T=d("XBadge"),b=d("XTable"),R=d("XAction"),B=d("DataCollection"),V=d("XCodeBlock"),h=d("XLayout"),j=d("XCard"),z=d("DataLoader"),F=d("DataSource"),D=d("AppView"),Y=d("RouteView");return t(),y(Y,{params:{mesh:"",proxy:"",connection:""},name:g.routeName},{default:o(({t:q,route:$,uri:A})=>[s(D,null,{default:o(()=>[(t(!0),a(i,null,f([$.params.connection.replace(/-([a-f0-9]){16}$/,"")],N=>(t(),y(h,{key:N,type:"stack"},{default:o(()=>[s(b,{variant:"kv"},{default:o(()=>[n("tr",null,[e[0]||(e[0]=n("th",{scope:"row"},`
                Protocol
              `,-1)),e[1]||(e[1]=r()),n("td",null,[s(T,{appearance:"info"},{default:o(()=>[r(k(q(`http.api.value.${["grpc","http","tcp"].find(v=>typeof g.data[v]<"u")}`)),1)]),_:2},1024)])])]),_:2},1024),e[19]||(e[19]=r()),g.data?(t(),a("div",Q,[e[17]||(e[17]=n("h3",null,"Rules",-1)),e[18]||(e[18]=r()),s(F,{src:A(X(H),"/policy-types",{})},{default:o(({data:v})=>[(t(!0),a(i,null,f([Object.groupBy((v==null?void 0:v.policyTypes)??[],_=>_.name)],_=>(t(),y(z,{key:typeof _,src:A(X(I),"/meshes/:mesh/rules/for/:dataplane",{mesh:$.params.mesh,dataplane:$.params.proxy})},{default:o(({data:L})=>[g.data.$resourceMeta.type!==""?(t(),y(B,{key:0,predicate:m=>m.resourceMeta.type==="Mesh"||O(g.data,m),items:L.toResourceRules},{default:o(({items:m})=>[n("div",U,[(t(!0),a(i,null,f(Object.groupBy(m,l=>l.type),(l,c)=>(t(),a("div",{key:c},[s(x,{"policy-type":c},{default:o(()=>[r(k(c),1)]),_:2},1032,["policy-type"]),e[7]||(e[7]=r()),s(b,{variant:"kv"},{default:o(()=>[(t(!0),a(i,null,f(l.length>1?l.filter(u=>O(g.data,u)):l,u=>(t(),a(i,{key:u},[u.origins.length>0?(t(),a("tr",W,[e[2]||(e[2]=n("th",{scope:"row"},`
                                    Origin policies
                                  `,-1)),e[3]||(e[3]=r()),n("td",null,[s(B,{predicate:p=>typeof p.resourceMeta<"u",items:u.origins,empty:!1},{default:o(({items:p})=>[n("ul",null,[(t(!0),a(i,null,f(p,C=>(t(),a("li",{key:JSON.stringify(C)},[Object.keys(_).length>0?(t(),y(R,{key:0,to:{name:"policy-detail-view",params:{policyPath:_[c][0].path,mesh:C.resourceMeta.mesh,policy:C.resourceMeta.name}}},{default:o(()=>[r(k(C.resourceMeta.name),1)]),_:2},1032,["to"])):M("",!0)]))),128))])]),_:2},1032,["predicate","items"])])])):M("",!0),e[6]||(e[6]=r()),n("tr",null,[n("td",Z,[s(h,{type:"stack",size:"small"},{default:o(()=>[e[4]||(e[4]=n("span",null,"Config",-1)),e[5]||(e[5]=r()),s(V,{code:X(P).stringify(u.raw),language:"yaml","show-copy-button":!1},null,8,["code"])]),_:2},1024)])])],64))),128))]),_:2},1024)]))),128))])]),_:2},1032,["predicate","items"])):(t(),y(B,{key:1,predicate:m=>m.ruleType==="to"&&!["MeshHTTPRoute","MeshTCPRoute"].includes(m.type)&&m.matchers.every(l=>l.key==="kuma.io/service"&&(l.not?l.value!==N:l.value===N)),items:L.rules},{default:o(({items:m})=>[n("div",ee,[s(J,{"initially-open":0,"multiple-open":"",class:"stack"},{default:o(()=>[(t(!0),a(i,null,f(Object.groupBy(m,l=>l.type),(l,c)=>(t(),y(j,{key:c},{default:o(()=>[s(G,null,{"accordion-header":o(()=>[s(x,{"policy-type":c},{default:o(()=>[r(k(c)+" ("+k(l.length)+`)
                                  `,1)]),_:2},1032,["policy-type"])]),"accordion-content":o(()=>[s(b,{variant:"kv"},{default:o(()=>[(t(!0),a(i,null,f(l,u=>(t(),a(i,{key:u},[u.matchers.length>0?(t(),a("tr",te,[e[8]||(e[8]=n("th",{scope:"row"},`
                                          From
                                        `,-1)),e[9]||(e[9]=r()),n("td",null,[n("p",null,[s(K,{items:u.matchers},null,8,["items"])])])])):M("",!0),e[14]||(e[14]=r()),u.origins.length>0?(t(),a("tr",oe,[e[10]||(e[10]=n("th",{scope:"row"},`
                                          Origin policies
                                        `,-1)),e[11]||(e[11]=r()),n("td",null,[n("ul",null,[(t(!0),a(i,null,f(u.origins,p=>(t(),a("li",{key:`${p.mesh}-${p.name}`},[_[p.type]?(t(),y(R,{key:0,to:{name:"policy-detail-view",params:{mesh:p.mesh,policyPath:_[p.type][0].path,policy:p.name}}},{default:o(()=>[r(k(p.name),1)]),_:2},1032,["to"])):(t(),a(i,{key:1},[r(k(p.name),1)],64))]))),128))])])])):M("",!0),e[15]||(e[15]=r()),n("tr",null,[n("td",ne,[s(h,{type:"stack",size:"small"},{default:o(()=>[e[12]||(e[12]=n("span",null,"Config",-1)),e[13]||(e[13]=r()),s(V,{code:X(P).stringify(u.raw),language:"yaml","show-copy-button":!1},null,8,["code"])]),_:2},1024)])])],64))),128))]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:2},1024)])]),_:2},1032,["predicate","items"]))]),_:2},1032,["src"]))),128))]),_:2},1032,["src"])])):M("",!0)]),_:2},1024))),128))]),_:2},1024)]),_:1},8,["name"])}}});export{ue as default};
