import{d as Q,Q as W,r as i,p as w,o as s,w as n,b as a,m as v,G as j,e as r,q as X,l as k,I as H,K as J,t as u,c as d,L as z,M as y,S as O,v as A,T as U,y as Y,_ as ee}from"./index-CpFYS729.js";const ne=["data-testid"],oe=Q({__name:"ZoneListView",setup(te){const I=A({}),V=A({}),S=W(),R=C=>{const o="zoneIngress";I.value=C.items.reduce((p,c)=>{const m=c[o]?.zone;if(typeof m<"u"){typeof p[m]>"u"&&(p[m]={online:[],offline:[]});const h=typeof c[`${o}Insight`].connectedSubscription<"u"?"online":"offline";p[m][h].push(c)}return p},{})},T=C=>{const o="zoneEgress";V.value=C.items.reduce((p,c)=>{const m=c[o]?.zone;if(typeof m<"u"){typeof p[m]>"u"&&(p[m]={online:[],offline:[]});const h=typeof c[`${o}Insight`].connectedSubscription<"u"?"online":"offline";p[m][h].push(c)}return p},{})};return(C,o)=>{const p=i("RouteTitle"),c=i("DataSource"),m=i("XI18n"),h=i("XTeleportTemplate"),N=i("XSearch"),D=i("XIcon"),L=i("XAction"),$=i("DataCollection"),B=i("DataLoader"),Z=i("XLayout"),E=i("XCard"),G=i("XDrawer"),q=i("RouterView"),M=i("AppView"),x=i("RouteView");return s(),w(x,{name:"zone-cp-list-view",params:{page:1,size:Number,zone:"",s:""}},{default:n(({route:l,t:_,uri:F,me:g})=>[a(c,{src:F(v(j),"/zone-cps",{},{page:l.params.page,size:l.params.size,search:l.params.s})},{default:n(({data:f,error:K,refresh:P})=>[a(M,{docs:f&&f?.items?.length?_("zones.href.docs.cta"):""},{title:n(()=>[k("h1",null,[a(p,{title:_("zone-cps.routes.items.title")},null,8,["title"])])]),default:n(()=>[o[9]||(o[9]=r()),a(c,{src:"/zone-ingress-overviews?page=1&size=100",onChange:R}),o[10]||(o[10]=r()),a(c,{src:"/zone-egress-overviews?page=1&size=100",onChange:T}),o[11]||(o[11]=r()),f?.items.length?(s(),w(m,{key:0,path:"zone-cps.routes.items.intro","default-path":"common.i18n.ignore-error"})):X("",!0),o[12]||(o[12]=r()),(f?.items??[]).length>0?(s(),w(h,{key:1,to:{name:"zone-cp-list-view-actions"}},{default:n(()=>[a(v(S))]),_:1})):X("",!0),o[13]||(o[13]=r()),a(E,null,{default:n(()=>[a(Z,null,{default:n(()=>[k("search",null,[k("form",{onSubmit:o[0]||(o[0]=H(()=>{},["prevent"]))},[a(N,{class:"search-field",keys:["name"],value:l.params.s,onChange:e=>l.update({page:1,s:e})},null,8,["value","onChange"])],32)]),o[8]||(o[8]=r()),a(B,{data:[f],errors:[K],variant:"list"},{default:n(()=>[a($,{type:"zone-cps",items:f?.items??[void 0],page:l.params.page,"page-size":l.params.size,total:f?.total,onChange:l.update},{default:n(()=>[a(J,{class:"zone-cp-collection","data-testid":"zone-cp-collection",headers:[{...g.get("headers.type"),label:"Â ",key:"type"},{...g.get("headers.name"),label:"Name",key:"name"},{...g.get("headers.zoneCpVersion"),label:"Zone leader CP version",key:"zoneCpVersion"},{...g.get("headers.ingress"),label:"Ingresses (online / total)",key:"ingress"},{...g.get("headers.egress"),label:"Egresses (online / total)",key:"egress"},{...g.get("headers.state"),label:"Status",key:"state"},{...g.get("headers.warnings"),label:"Warnings",key:"warnings",hideLabel:!0},{...g.get("headers.actions"),label:"Actions",key:"actions",hideLabel:!0}],items:f?.items,"is-selected-row":e=>e.name===l.params.zone,onResize:g.set},{type:n(({row:e})=>[(s(!0),d(z,null,y([["kubernetes","universal"].find(t=>t===e.zoneInsight.environment)??"kubernetes"],t=>(s(),w(D,{key:t,name:t},{default:n(()=>[r(u(_(`common.product.environment.${t}`)),1)]),_:2},1032,["name"]))),128))]),name:n(({row:e})=>[a(L,{"data-action":"",to:{name:"zone-cp-detail-view",params:{zone:e.name}}},{default:n(()=>[r(u(e.name),1)]),_:2},1032,["to"])]),zoneCpVersion:n(({row:e})=>[r(u(v(U)(e.zoneInsight,"version.kumaCp.version",_("common.collection.none"))),1)]),ingress:n(({row:e})=>[(s(!0),d(z,null,y([I.value[e.name]||{online:[],offline:[]}],t=>(s(),d(z,null,[r(u(t.online.length)+" / "+u(t.online.length+t.offline.length),1)],64))),256))]),egress:n(({row:e})=>[(s(!0),d(z,null,y([V.value[e.name]||{online:[],offline:[]}],t=>(s(),d(z,null,[r(u(t.online.length)+" / "+u(t.online.length+t.offline.length),1)],64))),256))]),state:n(({row:e})=>[a(O,{status:e.state},null,8,["status"])]),warnings:n(({row:e})=>[(s(!0),d(z,null,y([[{bool:e.zoneInsight.store==="memory",key:"store-memory"},{bool:!e.zoneInsight.version?.kumaCp?.kumaCpGlobalCompatible,key:"global-cp-incompatible"}].filter(({bool:t})=>t)],t=>(s(),d(z,{key:typeof t},[t.length>0?(s(),w(D,{key:0,name:"warning","data-testid":"warning"},{default:n(()=>[k("ul",null,[(s(!0),d(z,null,y(t,({key:b})=>(s(),d("li",{key:b,"data-testid":`warning-${b}`},u(_(`zone-cps.list.warnings.${b}`)),9,ne))),128))])]),_:2},1024)):(s(),d(z,{key:1},[r(u(_("common.collection.none")),1)],64))],64))),128))]),actions:n(({row:e})=>[a(v(S),{item:e,onChange:P},{default:n(()=>[a(L,{to:{name:"zone-cp-detail-view",params:{zone:e.name}}},{default:n(()=>[r(u(_("common.collection.actions.view")),1)]),_:2},1032,["to"])]),_:2},1032,["item","onChange"])]),_:2},1032,["headers","items","is-selected-row","onResize"])]),_:2},1032,["items","page","page-size","total","onChange"])]),_:2},1032,["data","errors"])]),_:2},1024)]),_:2},1024),o[14]||(o[14]=r()),l.params.zone?(s(),w(q,{key:2},{default:n(e=>[a(G,{onClose:t=>l.replace({name:"zone-cp-list-view",query:{page:l.params.page,size:l.params.size,s:l.params.s}})},{default:n(()=>[(s(),w(Y(e.Component),{name:l.params.zone,"zone-overview":f?.items.find(t=>t.name===l.params.zone)},null,8,["name","zone-overview"]))]),_:2},1032,["onClose"])]),_:2},1024)):X("",!0)]),_:2},1032,["docs"])]),_:2},1032,["src"])]),_:1})}}}),ae=ee(oe,[["__scopeId","data-v-45304fff"]]);export{ae as default};
