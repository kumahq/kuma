import{D,L as O,cm as y,k as u,cq as x,cT as w,o as h,c as k,w as i,a as r,j as b,l as n,t as _,A as L,i as s}from"./index.3a3d021f.js";import{L as P}from"./LoadingBox.f0fe2125.js";import{O as N}from"./OnboardingNavigation.ff0a475f.js";import{O as C,a as T}from"./OnboardingPage.63bc115e.js";const A={name:"DataplanesOverview",components:{OnboardingNavigation:N,OnboardingHeading:C,OnboardingPage:T,LoadingBox:P,KTable:O},metaInfo(){return{title:this.title}},data(){return{productName:y,tableHeaders:[{label:"Mesh",key:"mesh"},{label:"Name",key:"name"},{label:"Status",key:"status"}],tableData:{total:0,data:[]},timeout:null}},computed:{title(){return this.tableData.data.length?"Success":"Waiting for DPPs"},description(){return this.tableData.data.length?"The following data plane proxies (DPPs) are connected to the control plane:":null}},created(){this.getAllDataplanes()},beforeUnmount(){clearTimeout(this.timeout)},methods:{async getAllDataplanes(){let c=!1;const d=[];try{const m=(await u.getAllDataplanes({size:10})).items;for(let t=0;t<m.length;t++){const{name:a,mesh:o}=m[t],{status:l}=await u.getDataplaneOverviewFromMesh({mesh:o,name:a}).then(g=>x(g.dataplaneInsight));l===w&&(c=!0),d.push({status:l,name:a,mesh:o})}}catch(p){console.error(p)}this.tableData.data=d,this.tableData.total=this.tableData.data.length,c&&(this.timeout=setTimeout(()=>{this.getAllDataplanes()},1e3))}}},B={key:0,class:"justify-center flex my-4"},F={key:1},H={class:"flex justify-center mt-10 mb-16 pb-16"},I={class:"w-full sm:w-3/5 p-4"},S={class:"font-bold mb-4"};function j(c,d,p,m,t,a){const o=s("OnboardingHeading"),l=s("LoadingBox"),g=s("KTable"),f=s("OnboardingNavigation"),v=s("OnboardingPage");return h(),k(v,null,{header:i(()=>[r(o,{title:a.title,description:a.description},null,8,["title","description"])]),content:i(()=>[t.tableData.data.length?(h(),b("div",F,[n("div",H,[n("div",I,[n("p",S," Found "+_(t.tableData.data.length)+" DPPs: ",1),r(g,{class:"onboarding-dataplane-table",fetcher:()=>t.tableData,headers:t.tableHeaders,"disable-pagination":"","is-small":""},{status:i(({rowValue:e})=>[n("div",{class:L(["entity-status",{"is-offline":e.toLowerCase()==="offline"||e===!1,"is-online":e.toLowerCase()==="online","is-degraded":e.toLowerCase()==="partially degraded","is-not-available":e.toLowerCase()==="not available"}])},[n("span",null,_(e),1)],2)]),_:1},8,["fetcher","headers"])])])])):(h(),b("div",B,[r(l)]))]),navigation:i(()=>[r(f,{"next-step":"onboarding-completed","previous-step":"onboarding-add-services-code","should-allow-next":t.tableData.data.length>0},null,8,["should-allow-next"])]),_:1})}const R=D(A,[["render",j]]);export{R as default};
