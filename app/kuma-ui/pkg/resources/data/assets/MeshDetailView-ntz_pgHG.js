import{d as W,r as l,p as u,o,w as e,b as t,e as a,m as h,H as $,P as G,q as D,c as y,l as f,L as _,M as k,t as m,K as Z,R as g,N as P,F as ee,Y as q,y as te,_ as se}from"./index-BkRXKYLT.js";const ae={"data-testid":"mesh-mtls"},ne=W({__name:"MeshDetailView",props:{mesh:{}},setup(A){const c=A;return(oe,s)=>{const j=l("RouteTitle"),B=l("XI18n"),R=l("XNotification"),M=l("XAction"),v=l("XBadge"),w=l("XLayout"),z=l("XDl"),E=l("XAboutCard"),F=l("DataCollection"),x=l("XCard"),I=l("XIcon"),S=l("DataSource"),Y=l("XSelect"),L=l("XCodeBlock"),N=l("DataLoader"),H=l("XDrawer"),K=l("RouterView"),O=l("AppView"),J=l("RouteView");return o(),u(J,{name:"mesh-detail-view",params:{mesh:"",environment:String}},{default:e(({route:d,t:i,uri:X,me:V})=>[t(j,{title:i("meshes.routes.overview.title"),render:!1},null,8,["title"]),s[20]||(s[20]=a()),t(S,{src:X(h($),"/mesh-insights/:name",{name:d.params.mesh})},{default:e(({data:p})=>[t(S,{src:X(h(G),"/meshes/:mesh/meshidentities",{mesh:d.params.mesh})},{default:e(({data:b})=>[t(S,{src:X(h(G),"/meshes/:mesh/meshtrusts",{mesh:d.params.mesh})},{default:e(({data:C})=>[t(O,{docs:i("meshes.href.docs"),notifications:!0},{default:e(()=>[t(N,{data:[b,C]},{default:e(()=>[t(R,{notify:!c.mesh.mtlsBackend&&b.items.length===0,uri:`meshes.notifications.mtls-warning:${c.mesh.id}`},{default:e(()=>[t(B,{path:"meshes.notifications.mtls-warning"})]),_:1},8,["notify","uri"]),s[17]||(s[17]=a()),t(R,{notify:A.mesh.meshServices.mode==="Disabled",uri:`meshes.notifications.mesh-service-activation:${d.params.mesh}`,variant:"info"},{default:e(()=>[t(B,{path:"meshes.notifications.mesh-service-activation"})]),_:1},8,["notify","uri"]),s[18]||(s[18]=a()),t(w,{type:"stack"},{default:e(()=>[t(E,{title:i("meshes.routes.item.about.title"),created:c.mesh.creationTime,modified:c.mesh.modificationTime,class:"about-section"},{default:e(()=>[t(z,{variant:"x-stack"},{default:e(()=>[(o(),y(_,null,k(["MeshTrafficPermission","MeshMetric","MeshAccessLog","MeshTrace"],n=>(o(),y(_,{key:n},[(o(!0),y(_,null,k([p?.policies?.[n]??{total:0}],r=>(o(),y(_,{key:typeof r},[t(R,{notify:n==="MeshTrafficPermission"&&c.mesh.mtlsBackend&&r.total===0,uri:`meshes.notifications.mtp-warning:${c.mesh.id}`},{default:e(()=>[t(B,{path:"meshes.notifications.mtp-warning"})]),_:1},8,["notify","uri"]),s[1]||(s[1]=a()),f("div",null,[f("dt",null,[t(M,{to:{name:"policy-list-view",params:{mesh:d.params.mesh,policyPath:`${n.toLowerCase()}s`}}},{default:e(()=>[a(m(n),1)]),_:2},1032,["to"])]),s[0]||(s[0]=a()),f("dd",null,[t(v,{appearance:r.total>0?"success":"neutral"},{default:e(()=>[a(m(r.total>0?i("meshes.detail.enabled"):i("meshes.detail.disabled")),1)]),_:2},1032,["appearance"])])])],64))),128))],64))),64)),s[5]||(s[5]=a()),f("div",ae,[f("dt",null,m(i("http.api.property.mtls")),1),s[4]||(s[4]=a()),f("dd",null,[t(w,{type:"separated"},{default:e(()=>[c.mesh.mtlsBackend?(o(),u(v,{key:0,appearance:"info"},{default:e(()=>[a(m(c.mesh.mtlsBackend.type)+" / "+m(c.mesh.mtlsBackend.name),1)]),_:1})):D("",!0),s[2]||(s[2]=a()),(o(!0),y(_,null,k(b?.items,n=>(o(),u(M,{key:n.name,to:{name:"mesh-identity-summary-view",params:{mid:n.kri}}},{default:e(()=>[t(v,{appearance:"info"},{default:e(()=>[a(`
                                MeshIdentity / `+m(n.name),1)]),_:2},1024)]),_:2},1032,["to"]))),128)),s[3]||(s[3]=a()),!c.mesh.mtlsBackend&&!b?.items?.length?(o(),u(v,{key:1,appearance:"neutral"},{default:e(()=>[a(m(i("meshes.detail.disabled")),1)]),_:2},1024)):D("",!0)]),_:2},1024)])])]),_:2},1024)]),_:2},1032,["title","created","modified"]),s[14]||(s[14]=a()),C?.items?.length?(o(),u(x,{key:0,"data-testid":"mesh-trusts-listing"},{title:e(()=>[a(m(i("meshes.routes.item.mesh-trusts.title")),1)]),default:e(()=>[s[8]||(s[8]=a()),t(F,{type:"mesh-trusts",items:C?.items},{default:e(()=>[t(Z,{type:"mesh-trusts-collection",items:C?.items,headers:[{...V.get("headers.identity"),label:i("meshes.routes.item.mesh-trusts.name"),key:"name"},{...V.get("headers.type"),label:i("meshes.routes.item.mesh-trusts.trust-domain"),key:"trustDomain"},{...V.get("headers.origin"),label:i("meshes.routes.item.mesh-trusts.origin"),key:"origin"}],onResize:V.set},{name:e(({row:n})=>[t(M,{class:"name-link",title:n.name,to:{name:"mesh-trust-summary-view",params:{mtrust:n.kri},query:{environment:d.params.environment}},"data-action":""},{default:e(()=>[f("b",null,m(n.name),1)]),_:2},1032,["title","to"])]),trustDomain:e(({row:n})=>[t(v,{appearance:"decorative"},{default:e(()=>[a(m(n.spec.trustDomain),1)]),_:2},1024)]),origin:e(({row:n})=>[n.spec.origin.kri.length>0?(o(),u(M,{key:0,to:{name:"mesh-identity-summary-view",params:{mid:n.spec.origin.kri}},"data-action":""},{default:e(()=>[t(v,{appearance:"decorative"},{default:e(()=>[a(m(n.spec.origin.kri),1)]),_:2},1024)]),_:2},1032,["to"])):D("",!0)]),_:2},1032,["items","headers","onResize"])]),_:2},1032,["items"])]),_:2},1024)):D("",!0),s[15]||(s[15]=a()),t(x,null,{default:e(()=>[t(w,{type:"columns",class:"columns-with-borders"},{default:e(()=>[c.mesh.meshServices.mode==="Exclusive"?(o(),u(g,{key:0,total:p?.resources.MeshServiceGeneric.total??0,"data-testid":"services-status"},{title:e(()=>[a(m(i("meshes.detail.services")),1)]),_:2},1032,["total"])):c.mesh.meshServices.mode==="Disabled"?(o(),u(g,{key:1,total:p?.services.total??0,"data-testid":"services-status"},{title:e(()=>[a(m(i("meshes.detail.services")),1)]),_:2},1032,["total"])):(o(),u(g,{key:2,total:p?.resources.MeshServiceGeneric.total??0,"data-testid":"mesh-services-status"},P({title:e(()=>[a(m(i("meshes.detail.services")),1)]),_:2},[p?.resources.MeshServiceGeneric.total&&p?.services.total>0?{name:"description",fn:e(()=>[a(m(i("meshes.detail.mesh_services")),1)]),key:"0"}:void 0,p?.resources.MeshServiceGeneric.total&&p?.services.total>0?{name:"body",fn:e(()=>[t(g,{total:p?.services.total??0,"data-testid":"services-status"},{description:e(()=>[a(m(i("meshes.detail.services"))+" ",1),t(I,{name:"info"},{default:e(()=>[t(B,{path:"meshes.detail.infos.services"})]),_:1})]),_:2},1032,["total"])]),key:"1"}:void 0]),1032,["total"])),s[11]||(s[11]=a()),t(g,{total:p?.dataplanesByType.standard.total??0,online:p?.dataplanesByType.standard.online??0,"data-testid":"data-plane-proxies-status"},{title:e(()=>[a(m(i("meshes.detail.data_plane_proxies")),1)]),_:2},1032,["total","online"]),s[12]||(s[12]=a()),t(S,{src:X(h(ee),"/policy-types",{})},{default:e(({data:n})=>[(o(!0),y(_,null,k([n?.policyTypes.map(r=>r.name)],r=>(o(),u(g,{key:typeof r,total:Object.entries(p?.resources||{}).reduce((T,[Q,{total:U}])=>(r||[]).includes(Q)?T+U:T,0),"data-testid":"policies-status"},{title:e(()=>[a(m(i("meshes.detail.policies")),1)]),_:2},1032,["total"]))),128))]),_:2},1032,["src"])]),_:2},1024)]),_:2},1024),s[16]||(s[16]=a()),t(x,null,{default:e(()=>[t(w,null,{default:e(()=>[t(w,{type:"separated",justify:"end"},{default:e(()=>[(o(),y(_,null,k([["universal","k8s"]],n=>f("div",{key:typeof n},[t(Y,{label:i("meshes.routes.item.format"),selected:d.params.environment,onChange:r=>{d.update({environment:r})},onVnodeBeforeMount:r=>r?.props?.selected&&n.includes(r.props.selected)&&r.props.selected!==d.params.environment&&d.update({environment:r.props.selected})},P({_:2},[k(n,r=>({name:`${r}-option`,fn:e(()=>[a(m(i(`meshes.routes.item.formats.${r}`)),1)])}))]),1032,["label","selected","onChange","onVnodeBeforeMount"])])),64))]),_:2},1024),s[13]||(s[13]=a()),d.params.environment==="universal"?(o(),u(L,{key:0,"data-testid":"codeblock-yaml-universal",language:"yaml",code:h(q).stringify(c.mesh.config)},null,8,["code"])):(o(),u(N,{key:1,src:X(h($),"/meshes/:name/as/kubernetes",{name:d.params.mesh})},{default:e(({data:n})=>[t(L,{"data-testid":"codeblock-yaml-k8s",language:"yaml",code:h(q).stringify(n)},null,8,["code"])]),_:1},8,["src"]))]),_:2},1024)]),_:2},1024)]),_:2},1024),s[19]||(s[19]=a()),t(K,null,{default:e(n=>[n.route.name!==d.name?(o(),u(H,{key:0,onClose:r=>d.replace({name:"mesh-detail-view",params:{mesh:d.params.mesh},query:{environment:d.params.environment}})},{default:e(()=>[(o(),u(te(n.Component),{"mesh-identities":b?.items,"mesh-trusts":C?.items},null,8,["mesh-identities","mesh-trusts"]))]),_:2},1032,["onClose"])):D("",!0)]),_:2},1024)]),_:2},1032,["data"])]),_:2},1032,["docs"])]),_:2},1032,["src"])]),_:2},1032,["src"])]),_:2},1032,["src"])]),_:1})}}}),re=se(ne,[["__scopeId","data-v-d4f11820"]]);export{re as default};
