import{d as H,r as d,x as I,p as y,o as t,w as n,b as l,c as a,N as i,L as f,e as s,q as g,l as o,t as k,m as C,F as J,a5 as G,z as T,Y as x}from"./index-DIsQPtUy.js";import{A as K,a as Q}from"./AccordionList-BWJeYYnD.js";import{R as U}from"./RuleMatchers-DPWrcDn3.js";const W={key:0},Z={class:"stack-with-borders mt-4"},ee={key:0},te={colspan:"2"},oe={class:"mt-4"},ne={key:0},ae={key:1},se={colspan:"2"},pe=H({__name:"DataPlaneOutboundSummaryOverviewView",props:{data:{},routeName:{}},setup(z){const v=z,N=(w,e)=>w.$resourceMeta.name===e.name&&w.$resourceMeta.namespace===e.namespace&&w.$resourceMeta.zone===e.zone&&(e.resourceSectionName===""||w.$resourceMeta.port===e.port);return(w,e)=>{const P=d("XBadge"),X=d("XTable"),O=d("XAction"),b=d("DataCollection"),R=d("XCodeBlock"),h=d("XLayout"),S=d("XCard"),j=d("DataLoader"),F=d("DataSource"),Y=d("AppView"),q=d("RouteView"),V=I("icon-start");return t(),y(q,{params:{mesh:"",proxy:"",connection:""},name:v.routeName},{default:n(({t:E,route:B,uri:A})=>[l(Y,null,{default:n(()=>[(t(!0),a(i,null,f([B.params.connection.replace(/-([a-f0-9]){16}$/,"")],$=>(t(),y(h,{key:$,type:"stack"},{default:n(()=>[l(X,{variant:"kv"},{default:n(()=>[o("tr",null,[e[0]||(e[0]=o("th",{scope:"row"},`
                Protocol
              `,-1)),e[1]||(e[1]=s()),o("td",null,[l(P,{appearance:"info"},{default:n(()=>[s(k(E(`http.api.value.${["grpc","http","tcp"].find(D=>typeof v.data[D]<"u")}`)),1)]),_:2},1024)])])]),_:2},1024),e[19]||(e[19]=s()),v.data?(t(),a("div",W,[e[17]||(e[17]=o("h3",null,"Rules",-1)),e[18]||(e[18]=s()),l(F,{src:A(C(J),"/policy-types",{})},{default:n(({data:D})=>[(t(!0),a(i,null,f([Object.groupBy(D?.policyTypes??[],_=>_.name)],_=>(t(),y(j,{key:typeof _,src:A(C(G),"/meshes/:mesh/rules/for/:dataplane",{mesh:B.params.mesh,dataplane:B.params.proxy})},{default:n(({data:L})=>[v.data.$resourceMeta.type!==""?(t(),y(b,{key:0,predicate:m=>m.resourceMeta.type==="Mesh"||N(v.data,m),items:L.toResourceRules},{default:n(({items:m})=>[o("div",Z,[(t(!0),a(i,null,f(Object.groupBy(m,r=>r.type),(r,c)=>(t(),a("div",{key:c},[T((t(),a("span",null,[s(k(c),1)])),[[V,{name:c,size:"60",default:"policy"}]]),e[7]||(e[7]=s()),l(X,{variant:"kv"},{default:n(()=>[(t(!0),a(i,null,f(r.length>1?r.filter(u=>N(v.data,u)):r,u=>(t(),a(i,{key:u},[u.origins.length>0?(t(),a("tr",ee,[e[2]||(e[2]=o("th",{scope:"row"},`
                                    Origin policies
                                  `,-1)),e[3]||(e[3]=s()),o("td",null,[l(b,{predicate:p=>typeof p.resourceMeta<"u",items:u.origins,empty:!1},{default:n(({items:p})=>[o("ul",null,[(t(!0),a(i,null,f(p,M=>(t(),a("li",{key:JSON.stringify(M)},[Object.keys(_).length>0?(t(),y(O,{key:0,to:{name:"policy-detail-view",params:{policyPath:_[c][0].path,mesh:M.resourceMeta.mesh,policy:M.resourceMeta.name}}},{default:n(()=>[s(k(M.resourceMeta.name),1)]),_:2},1032,["to"])):g("",!0)]))),128))])]),_:2},1032,["predicate","items"])])])):g("",!0),e[6]||(e[6]=s()),o("tr",null,[o("td",te,[l(h,{type:"stack",size:"small"},{default:n(()=>[e[4]||(e[4]=o("span",null,"Config",-1)),e[5]||(e[5]=s()),l(R,{code:C(x).stringify(u.raw),language:"yaml","show-copy-button":!1},null,8,["code"])]),_:2},1024)])])],64))),128))]),_:2},1024)]))),128))])]),_:2},1032,["predicate","items"])):(t(),y(b,{key:1,predicate:m=>m.ruleType==="to"&&!["MeshHTTPRoute","MeshTCPRoute"].includes(m.type)&&m.matchers.every(r=>r.key==="kuma.io/service"&&(r.not?r.value!==$:r.value===$)),items:L.rules},{default:n(({items:m})=>[o("div",oe,[l(K,{"initially-open":0,"multiple-open":"",class:"stack"},{default:n(()=>[(t(!0),a(i,null,f(Object.groupBy(m,r=>r.type),(r,c)=>(t(),y(S,{key:c},{default:n(()=>[l(Q,null,{"accordion-header":n(()=>[T((t(),a("span",null,[s(k(c)+" ("+k(r.length)+`)
                                  `,1)])),[[V,{name:c,size:"60",default:"policy"}]])]),"accordion-content":n(()=>[l(X,{variant:"kv"},{default:n(()=>[(t(!0),a(i,null,f(r,u=>(t(),a(i,{key:u},[u.matchers.length>0?(t(),a("tr",ne,[e[8]||(e[8]=o("th",{scope:"row"},`
                                          From
                                        `,-1)),e[9]||(e[9]=s()),o("td",null,[o("p",null,[l(U,{items:u.matchers},null,8,["items"])])])])):g("",!0),e[14]||(e[14]=s()),u.origins.length>0?(t(),a("tr",ae,[e[10]||(e[10]=o("th",{scope:"row"},`
                                          Origin policies
                                        `,-1)),e[11]||(e[11]=s()),o("td",null,[o("ul",null,[(t(!0),a(i,null,f(u.origins,p=>(t(),a("li",{key:`${p.mesh}-${p.name}`},[_[p.type]?(t(),y(O,{key:0,to:{name:"policy-detail-view",params:{mesh:p.mesh,policyPath:_[p.type][0].path,policy:p.name}}},{default:n(()=>[s(k(p.name),1)]),_:2},1032,["to"])):(t(),a(i,{key:1},[s(k(p.name),1)],64))]))),128))])])])):g("",!0),e[15]||(e[15]=s()),o("tr",null,[o("td",se,[l(h,{type:"stack",size:"small"},{default:n(()=>[e[12]||(e[12]=o("span",null,"Config",-1)),e[13]||(e[13]=s()),l(R,{code:C(x).stringify(u.raw),language:"yaml","show-copy-button":!1},null,8,["code"])]),_:2},1024)])])],64))),128))]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:2},1024)])]),_:2},1032,["predicate","items"]))]),_:2},1032,["src"]))),128))]),_:2},1032,["src"])])):g("",!0)]),_:2},1024))),128))]),_:2},1024)]),_:1},8,["name"])}}});export{pe as default};
