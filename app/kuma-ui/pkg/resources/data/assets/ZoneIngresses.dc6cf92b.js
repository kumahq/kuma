import{k as T,c2 as B,c3 as F,O as q,bU as K,c5 as M,c6 as V,c7 as H,ca as R,c9 as D,cd as n,o as r,c as y,i as u,w as s,a as l,b as _,j as w,e as p,bV as v,F as z,bX as S}from"./index.2d238a59.js";import{D as W,p as L}from"./DataOverview.b81dc292.js";import{E as G}from"./EnvoyData.1cf52d3d.js";import{F as P}from"./FrameSkeleton.49890b13.js";import{_ as U}from"./LabelList.vue_vue_type_style_index_0_lang.066e77d8.js";import{M as X}from"./MultizoneInfo.a557c37a.js";import{S as j,a as Q}from"./SubscriptionHeader.0bebbf3c.js";import{T as J}from"./TabsWidget.bc5189ed.js";import"./EmptyBlock.vue_vue_type_script_setup_true_lang.a51bf735.js";import"./ErrorBlock.6d694e33.js";import"./LoadingBlock.vue_vue_type_script_setup_true_lang.ccaabdfd.js";import"./StatusBadge.ce20a7cd.js";import"./TagList.ebca8e2c.js";import"./CodeBlock.vue_vue_type_style_index_0_lang.f5cf526a.js";import"./_commonjsHelpers.f037b798.js";const Y={name:"ZoneIngresses",components:{AccordionItem:B,AccordionList:F,DataOverview:W,EnvoyData:G,FrameSkeleton:P,LabelList:U,MultizoneInfo:X,SubscriptionDetails:j,SubscriptionHeader:Q,TabsWidget:J,KButton:q,KCard:K},props:{selectedZoneIngressName:{type:String,required:!1,default:null},offset:{type:Number,required:!1,default:0}},data(){return{isLoading:!0,isEmpty:!1,error:null,empty_state:{title:"No Data",message:"There are no Zone Ingresses present."},tableData:{headers:[{key:"actions",hideLabel:!0},{label:"Status",key:"status"},{label:"Name",key:"name"}],data:[]},tabs:[{hash:"#overview",title:"Overview"},{hash:"#insights",title:"Zone Ingress Insights"},{hash:"#xds-configuration",title:"XDS Configuration"},{hash:"#envoy-stats",title:"Stats"},{hash:"#envoy-clusters",title:"Clusters"}],entity:{},rawData:[],pageSize:M,next:null,subscriptionsReversed:[],pageOffset:this.offset}},computed:{...V({multicluster:"config/getMulticlusterStatus"})},watch:{$route(){this.isLoading=!0,this.isEmpty=!1,this.error=null,this.init(0)}},beforeMount(){this.init(this.offset)},methods:{init(t){this.multicluster&&this.loadData(t)},tableAction(t){const i=t;this.getEntity(i)},async loadData(t){var o;this.pageOffset=t,L("offset",t>0?t:null),this.isLoading=!0,this.isEmpty=!1;const i=this.$route.query.ns||null,a=this.pageSize;try{const{data:e,next:c}=await this.getZoneIngressOverviews(i,a,t);this.next=c,e.length?(this.isEmpty=!1,this.rawData=e,this.getEntity({name:(o=this.selectedZoneIngressName)!=null?o:e[0].name}),this.tableData.data=e.map(m=>{const{zoneIngressInsight:h={}}=m,f=H(h);return{...m,status:f}})):(this.tableData.data=[],this.isEmpty=!0)}catch(e){e instanceof Error?this.error=e:console.error(e),this.isEmpty=!0}finally{this.isLoading=!1}},getEntity(t){var e,c;const i=["type","name"],a=this.rawData.find(m=>m.name===t.name),o=(c=(e=a==null?void 0:a.zoneIngressInsight)==null?void 0:e.subscriptions)!=null?c:[];this.subscriptionsReversed=Array.from(o).reverse(),this.entity=R(a,i),L("zoneIngress",this.entity.name)},async getZoneIngressOverviews(t,i,a){if(t)return{data:[await D.getZoneIngressOverview({name:t},{size:i,offset:a})],next:null};{const{items:o,next:e}=await D.getAllZoneIngressOverviews({size:i,offset:a});return{data:o!=null?o:[],next:e}}}}},$={class:"zoneingresses"},ee={class:"entity-heading"};function te(t,i,a,o,e,c){const m=n("MultizoneInfo"),h=n("KButton"),f=n("DataOverview"),k=n("LabelList"),E=n("SubscriptionHeader"),A=n("SubscriptionDetails"),O=n("AccordionItem"),x=n("AccordionList"),Z=n("KCard"),b=n("EnvoyData"),C=n("TabsWidget"),N=n("FrameSkeleton");return r(),y("div",$,[t.multicluster===!1?(r(),u(m,{key:0})):(r(),u(N,{key:1},{default:s(()=>{var I;return[l(f,{"selected-entity-name":(I=e.entity)==null?void 0:I.name,"page-size":e.pageSize,"is-loading":e.isLoading,error:e.error,"empty-state":e.empty_state,"table-data":e.tableData,"table-data-is-empty":e.isEmpty,next:e.next,"page-offset":e.pageOffset,onTableAction:c.tableAction,onLoadData:c.loadData},{additionalControls:s(()=>[t.$route.query.ns?(r(),u(h,{key:0,class:"back-button",appearance:"primary",icon:"arrowLeft",to:{name:"zoneingresses"}},{default:s(()=>[_(`
            View all
          `)]),_:1})):w("",!0)]),_:1},8,["selected-entity-name","page-size","is-loading","error","empty-state","table-data","table-data-is-empty","next","page-offset","onTableAction","onLoadData"]),_(),e.isEmpty===!1?(r(),u(C,{key:0,"has-error":e.error!==null,"is-loading":e.isLoading,tabs:e.tabs,"initial-tab-override":"overview"},{tabHeader:s(()=>[p("h1",ee,`
            Zone Ingress: `+v(e.entity.name),1)]),overview:s(()=>[l(k,null,{default:s(()=>[p("div",null,[p("ul",null,[(r(!0),y(z,null,S(e.entity,(d,g)=>(r(),y("li",{key:g},[p("h4",null,v(g),1),_(),p("p",null,v(d),1)]))),128))])])]),_:1})]),insights:s(()=>[l(Z,{"border-variant":"noBorder"},{body:s(()=>[l(x,{"initially-open":0},{default:s(()=>[(r(!0),y(z,null,S(e.subscriptionsReversed,(d,g)=>(r(),u(O,{key:g},{"accordion-header":s(()=>[l(E,{details:d},null,8,["details"])]),"accordion-content":s(()=>[l(A,{details:d,"is-discovery-subscription":""},null,8,["details"])]),_:2},1024))),128))]),_:1})]),_:1})]),"xds-configuration":s(()=>[l(b,{"data-path":"xds","zone-ingress-name":e.entity.name,"query-key":"envoy-data-zone-ingress"},null,8,["zone-ingress-name"])]),"envoy-stats":s(()=>[l(b,{"data-path":"stats","zone-ingress-name":e.entity.name,"query-key":"envoy-data-zone-ingress"},null,8,["zone-ingress-name"])]),"envoy-clusters":s(()=>[l(b,{"data-path":"clusters","zone-ingress-name":e.entity.name,"query-key":"envoy-data-zone-ingress"},null,8,["zone-ingress-name"])]),_:1},8,["has-error","is-loading","tabs"])):w("",!0)]}),_:1}))])}const fe=T(Y,[["render",te]]);export{fe as default};
