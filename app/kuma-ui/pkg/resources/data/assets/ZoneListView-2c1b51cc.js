import{y as O,g as F,m as K,e as U,A as G,o as P,S as W,K as M,p as X,_ as j,z as H,f as J}from"./RouteView.vue_vue_type_script_setup_true_lang-d3d8e82f.js";import{d as $,j as S,o as i,a as c,w as t,z as A,g as a,b as e,M as Y,f as T,X as Q,r as ee,h as s,B as te,q as N,G as oe,t as l,e as E,F as R,L as ne,V as ae,D as L,v as se,H as Z}from"./index-be7916f4.js";import{_ as ie}from"./MultizoneInfo.vue_vue_type_script_setup_true_lang-533f9419.js";import{A as le}from"./AppCollection-14c097cb.js";import{_ as re}from"./RouteTitle.vue_vue_type_script_setup_true_lang-d0d3b813.js";import{_ as ce}from"./WarningIcon.vue_vue_type_script_setup_true_lang-33662e2f.js";const ue=$({__name:"DeleteResourceModal",props:{actionButtonText:{type:String,required:!1,default:"Yes, delete"},confirmationText:{type:String,required:!1,default:""},deleteFunction:{type:Function,required:!0},isVisible:{type:Boolean,required:!0},modalId:{type:String,required:!0},title:{type:String,required:!1,default:"Delete"}},emits:["cancel","delete"],setup(C,{emit:d}){const r=C,o=S(!1);async function x(){o.value=!1;try{await r.deleteFunction(),d("delete")}catch{o.value=!0}}return(p,m)=>(i(),c(e(Q),{"action-button-text":r.actionButtonText,"confirmation-text":r.confirmationText,"is-visible":r.isVisible,"modal-id":r.modalId,title:r.title,type:"danger","data-testid":"delete-resource-modal",onCanceled:m[0]||(m[0]=_=>d("cancel")),onProceed:x},{"body-content":t(()=>[A(p.$slots,"body-content"),a(),o.value?(i(),c(e(Y),{key:0,class:"mt-4",appearance:"danger","is-dismissible":""},{alertMessage:t(()=>[A(p.$slots,"error")]),_:3})):T("",!0)]),_:3},8,["action-button-text","confirmation-text","is-visible","modal-id","title"]))}}),de=$({__name:"ZoneListView",props:{page:{type:Number,required:!0},size:{type:Number,required:!0}},setup(C){const d=C,r=O(),{t:o}=F(),x=K(),p=U(),m=S(!1),_=S("");function I(b){return b.map(g=>{var h;const{name:y}=g,V={name:"zone-cp-detail-view",params:{zone:y}};let u="",v="kubernetes",z=!0;(((h=g.zoneInsight)==null?void 0:h.subscriptions)??[]).forEach(f=>{if(f.version&&f.version.kumaCp){u=f.version.kumaCp.version;const{kumaCpGlobalCompatible:q=!0}=f.version.kumaCp;z=q}f.config&&(v=JSON.parse(f.config).environment)});const k=H(g);return{detailViewRoute:V,name:y,status:k,zoneCpVersion:u,type:v,warnings:!z}})}async function B(){await x.deleteZone({name:_.value})}function w(){m.value=!m.value}function D(b){w(),_.value=b}return(b,g)=>{const y=ee("RouterLink");return i(),c(j,{name:"zone-cp-list-view"},{default:t(({route:V})=>[s(G,null,te({title:t(()=>[N("h1",null,[s(re,{title:e(o)("zone-cps.routes.items.title"),render:!0},null,8,["title"])])]),default:t(()=>[a(),a(),e(p).getters["config/getMulticlusterStatus"]===!1?(i(),c(ie,{key:0})):(i(),c(P,{key:1,src:`/zone-cps?size=${d.size}&page=${d.page}`},{default:t(({data:u,error:v,refresh:z})=>[s(e(oe),null,{body:t(()=>[s(le,{class:"zone-cp-collection","data-testid":"zone-cp-collection",headers:[{label:"Name",key:"name"},{label:"Zone CP Version",key:"zoneCpVersion"},{label:"Type",key:"type"},{label:"Status",key:"status"},{label:"Warnings",key:"warnings",hideLabel:!0},{label:"Actions",key:"actions",hideLabel:!0}],"page-number":d.page,"page-size":d.size,total:u==null?void 0:u.total,items:u?I(u.items):void 0,error:v,onChange:V.update},{name:t(({row:n,rowValue:k})=>[s(y,{to:n.detailViewRoute,"data-testid":"detail-view-link"},{default:t(()=>[a(l(k),1)]),_:2},1032,["to"])]),zoneCpVersion:t(({rowValue:n})=>[a(l(n||e(o)("common.collection.none")),1)]),type:t(({rowValue:n})=>[a(l(n||e(o)("common.collection.none")),1)]),status:t(({rowValue:n})=>[n?(i(),c(W,{key:0,status:n},null,8,["status"])):(i(),E(R,{key:1},[a(l(e(o)("common.collection.none")),1)],64))]),warnings:t(({rowValue:n})=>[n?(i(),c(e(ne),{key:0,label:e(o)("zone-cps.list.version_mismatch")},{default:t(()=>[s(ce,{class:"mr-1",size:e(M),"hide-title":""},null,8,["size"])]),_:1},8,["label"])):(i(),E(R,{key:1},[a(l(e(o)("common.collection.none")),1)],64))]),actions:t(({row:n})=>[s(e(ae),{class:"actions-dropdown","data-testid":"actions-dropdown","kpop-attributes":{placement:"bottomEnd",popoverClasses:"mt-5 more-actions-popover"},width:"150"},{default:t(()=>[s(e(L),{class:"non-visual-button",appearance:"secondary",size:"small"},{icon:t(()=>[s(e(se),{color:e(X),icon:"more",size:e(M)},null,8,["color","size"])]),_:1})]),items:t(()=>[s(e(Z),{item:{to:n.detailViewRoute,label:e(o)("common.collection.actions.view")}},null,8,["item"]),a(),e(r)("KUMA_ZONE_CREATION_FLOW")==="enabled"?(i(),c(e(Z),{key:0,"has-divider":"","is-dangerous":"","data-testid":"dropdown-delete-item",onClick:k=>D(n.name)},{default:t(()=>[a(l(e(o)("common.collection.actions.delete")),1)]),_:2},1032,["onClick"])):T("",!0)]),_:2},1024)]),_:2},1032,["page-number","page-size","total","items","error","onChange"])]),_:2},1024),a(),m.value?(i(),c(ue,{key:0,"confirmation-text":_.value,"delete-function":B,"is-visible":m.value,"modal-id":"delete-zone-modal","action-button-text":e(o)("zones.delete.confirmModal.proceedText"),title:e(o)("zones.delete.confirmModal.title"),onCancel:w,onDelete:()=>{w(),z()}},{"body-content":t(()=>[N("p",null,l(e(o)("zones.delete.confirmModal.text1",{zoneName:_.value})),1),a(),N("p",null,l(e(o)("zones.delete.confirmModal.text2")),1)]),error:t(()=>[a(l(e(o)("zones.delete.confirmModal.errorText")),1)]),_:2},1032,["confirmation-text","is-visible","action-button-text","title","onDelete"])):T("",!0)]),_:2},1032,["src"]))]),_:2},[e(r)("KUMA_ZONE_CREATION_FLOW")==="enabled"&&e(p).getters["config/getMulticlusterStatus"]?{name:"actions",fn:t(()=>[s(e(L),{appearance:"creation",icon:"plus",to:{name:"zone-create-view"},"data-testid":"create-zone-link"},{default:t(()=>[a(l(e(o)("zones.index.create")),1)]),_:1})]),key:"0"}:void 0]),1024)]),_:1})}}});const ye=J(de,[["__scopeId","data-v-ad4ca773"]]);export{ye as default};
