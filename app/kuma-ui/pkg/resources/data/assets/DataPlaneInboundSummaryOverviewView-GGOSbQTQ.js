import{d as E,r as u,p as d,o,w as l,b as s,c as a,e as r,q as k,N as p,L as m,m as g,l as e,t as w,F as O,Y as M}from"./index-CDV8WoYF.js";import{A as G,a as H}from"./AccordionList-BS4HoToC.js";import{P as J}from"./PolicyTypeTag-WnU1CnQL.js";import{T as Q}from"./TagList-CTxVZz_d.js";import{C as U,K as W}from"./kri-CjUta6FR.js";const Z={key:0},D={key:1},h={colspan:"2"},st=E({__name:"DataPlaneInboundSummaryOverviewView",props:{data:{},dataPlaneOverview:{},routeName:{}},setup(K){const i=K;return(tt,t)=>{const c=u("XBadge"),x=u("XCopyButton"),A=u("XTable"),z=u("XAction"),F=u("XCodeBlock"),C=u("XLayout"),I=u("XCard"),R=u("DataLoader"),B=u("DataSource"),T=u("AppView"),Y=u("RouteView");return o(),d(Y,{params:{mesh:"",proxy:"",connection:""},name:i.routeName},{default:l(({t:b,route:N,uri:P})=>[s(T,null,{default:l(()=>[s(C,{type:"stack"},{default:l(()=>[(o(!0),a(p,null,m([i.dataPlaneOverview.dataplane.networking.inbounds.find(n=>n.portName===g(U).fromString(N.params.connection).sectionName&&n.port===i.data.port)],n=>(o(),a(p,{key:typeof n},[n?(o(),d(A,{key:0,variant:"kv"},{default:l(()=>[e("tr",null,[t[0]||(t[0]=e("th",{scope:"row"},`
                Tags
              `,-1)),t[1]||(t[1]=r()),e("td",null,[s(Q,{tags:n.tags,alignment:"right"},null,8,["tags"])])]),t[10]||(t[10]=r()),e("tr",null,[t[2]||(t[2]=e("th",{scope:"row"},`
                Protocol
              `,-1)),t[3]||(t[3]=r()),e("td",null,[s(c,{appearance:"info"},{default:l(()=>[r(w(b(`http.api.value.${n.protocol}`)),1)]),_:2},1024)])]),t[11]||(t[11]=r()),e("tr",null,[t[4]||(t[4]=e("th",{scope:"row"},`
                Address
              `,-1)),t[5]||(t[5]=r()),e("td",null,[s(x,{text:`${n.addressPort}`},null,8,["text"])])]),t[12]||(t[12]=r()),n.serviceAddressPort.length>0?(o(),a("tr",Z,[t[6]||(t[6]=e("th",{scope:"row"},`
                Service address
              `,-1)),t[7]||(t[7]=r()),e("td",null,[s(x,{text:`${n.serviceAddressPort}`},null,8,["text"])])])):k("",!0),t[13]||(t[13]=r()),n.portName.length>0?(o(),a("tr",D,[t[8]||(t[8]=e("th",{scope:"row"},`
                Name
              `,-1)),t[9]||(t[9]=r()),e("td",null,[s(x,{text:`${n.portName}`},null,8,["text"])])])):k("",!0)]),_:2},1024)):k("",!0)],64))),128)),t[22]||(t[22]=r()),i.data?(o(),d(C,{key:0,type:"stack",size:"small"},{default:l(()=>[t[20]||(t[20]=e("h3",null,"Policies",-1)),t[21]||(t[21]=r()),s(B,{src:P(g(O),"/policy-types",{})},{default:l(({data:n,error:j})=>[s(B,{src:P(g(O),"/meshes/:mesh/dataplanes/:name/policies/for/inbound/:kri",{mesh:N.params.mesh,name:N.params.proxy,kri:i.data.kri})},{default:l(({data:v,error:q})=>[s(R,{data:[n,v],errors:[j,q]},{default:l(()=>[(o(!0),a(p,null,m([Object.groupBy((n==null?void 0:n.policyTypes)??[],({name:f})=>f)],f=>(o(),d(G,{key:`${typeof f}`,"initially-open":0,"multiple-open":"",class:"stack","data-testid":"inbound-policies-rules"},{default:l(()=>[(o(!0),a(p,null,m((v==null?void 0:v.policies)||[],({rules:L,kind:y,origins:V})=>(o(),d(I,{key:y},{default:l(()=>[s(H,null,{"accordion-header":l(()=>[s(J,{"policy-type":y},{default:l(()=>[r(w(y)+" ("+w(L.length)+`)
                            `,1)]),_:2},1032,["policy-type"])]),"accordion-content":l(()=>[s(A,{variant:"kv"},{default:l(()=>[(o(!0),a(p,null,m(L,S=>(o(),a(p,{key:S},[V.length>0?(o(),a(p,{key:0},[e("tr",null,[t[14]||(t[14]=e("th",{scope:"row"},`
                                      Origin policies
                                    `,-1)),t[15]||(t[15]=r()),e("td",null,[e("ul",null,[(o(!0),a(p,null,m(V,X=>(o(),a("li",{key:X.kri},[(o(!0),a(p,null,m([g(W).fromString(X.kri)],({mesh:$,name:_})=>(o(),a(p,{key:`${$}-${_}`},[f[y]?(o(),d(z,{key:0,to:{name:"policy-detail-view",params:{mesh:$,policyPath:f[y][0].path,policy:_}}},{default:l(()=>[r(w(X.kri),1)]),_:2},1032,["to"])):(o(),a(p,{key:1},[r(w(X.kri),1)],64))],64))),128))]))),128))])])]),t[18]||(t[18]=r()),e("tr",null,[e("td",h,[s(C,{type:"stack",size:"small"},{default:l(()=>[t[16]||(t[16]=e("span",null,"Config",-1)),t[17]||(t[17]=r()),s(F,{code:g(M).stringify(S.conf),language:"yaml","show-copy-button":!1},null,8,["code"])]),_:2},1024)])])],64)):k("",!0)],64))),128))]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:2},1024))),128))]),_:2},1032,["data","errors"])]),_:2},1032,["src"])]),_:2},1032,["src"])]),_:2},1024)):k("",!0)]),_:2},1024)]),_:2},1024)]),_:1},8,["name"])}}});export{st as default};
