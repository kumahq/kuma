import{L as A}from"./LoadingBox-949fcd95.js";import{O as T,a as V,b as B}from"./OnboardingPage-3d72b218.js";import{d as R,u as S,v as N,m as k,S as P,T as C,a as d,o as s,b as g,w as a,e as l,f as c,c as p,F as x,I as E,t as f,p as b,_ as F}from"./index-ea965263.js";import{S as L}from"./StatusBadge-57f237c0.js";const K={key:0,class:"status-loading-box mb-4"},$={key:1},z={class:"mb-4"},H=R({__name:"OnboardingDataplanesView",setup(I){const h=S(),D=N(),O=[{label:"Mesh",key:"mesh"},{label:"Name",key:"name"},{label:"Status",key:"status"}],e=k({total:0,data:[]}),_=k(null);P(function(){w()}),y();function w(){_.value!==null&&window.clearTimeout(_.value)}async function y(){let i=!1;const v=[];try{const{items:t}=await h.getAllDataplanes({size:10});if(Array.isArray(t)&&t.length>0)for(const m of t){const{name:r,mesh:u}=m,o=C.fromObject(await h.getDataplaneOverviewFromMesh({mesh:u,name:r}),D("use zones"));o.status==="offline"&&(i=!0),v.push({status:o.status,name:r,mesh:u})}else i=!0}catch(t){console.error(t)}e.value.data=v,e.value.total=e.value.data.length,i&&(w(),_.value=window.setTimeout(y,1e3))}return(i,v)=>{const t=d("RouteTitle"),m=d("KTable"),r=d("AppView"),u=d("RouteView");return s(),g(u,{name:"onboarding-dataplanes-view"},{default:a(({t:o})=>[l(t,{title:o("onboarding.routes.dataplanes-overview.title"),render:!1},null,8,["title"]),c(),l(r,null,{default:a(()=>[l(T,null,{header:a(()=>[(s(!0),p(x,null,E([e.value.data.length>0?"success":"waiting"],n=>(s(),g(V,{key:n,"data-testid":`state-${n}`},{title:a(()=>[c(f(o(`onboarding.routes.dataplanes-overview.header.${n}.title`)),1)]),description:a(()=>[b("p",null,f(o(`onboarding.routes.dataplanes-overview.header.${n}.description`)),1)]),_:2},1032,["data-testid"]))),128))]),content:a(()=>[e.value.data.length===0?(s(),p("div",K,[l(A)])):(s(),p("div",$,[b("p",z,[b("b",null,"Found "+f(e.value.data.length)+" DPPs:",1)]),c(),l(m,{class:"mb-4",fetcher:()=>e.value,headers:O,"disable-pagination":""},{status:a(({rowValue:n})=>[n?(s(),g(L,{key:0,status:n},null,8,["status"])):(s(),p(x,{key:1},[c(`
                  â€”
                `)],64))]),_:1},8,["fetcher"])]))]),navigation:a(()=>[l(B,{"next-step":"onboarding-completed-view","previous-step":"onboarding-add-new-services-code-view","should-allow-next":e.value.data.length>0},null,8,["should-allow-next"])]),_:2},1024)]),_:2},1024)]),_:1})}}});const G=F(H,[["__scopeId","data-v-78eb87a1"]]);export{G as default};
