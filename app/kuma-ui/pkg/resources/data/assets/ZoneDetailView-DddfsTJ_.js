import{d as G,p as m,o as c,w as e,b as o,r as l,c as g,e as n,L as C,M as K,N as w,q as y,O as h,T as M,t as d,n as Z,K as H,y as J,l as P,m as Q,A as U}from"./index-AyKB-3zh.js";import{S as W}from"./SummaryView-C8UFcv-V.js";const oe=G({__name:"ZoneDetailView",props:{data:{}},setup(N){const r=N;return(Y,a)=>{const X=l("XAction"),f=l("XI18n"),$=l("XNotification"),k=l("XBadge"),I=l("XIcon"),b=l("XLayout"),j=l("XAboutCard"),x=l("RouterView"),L=l("XCard"),O=l("AppView"),E=l("DataSource"),q=l("RouteView");return c(),m(q,{name:"zone-cp-detail-view",params:{zone:"",subscription:""}},{default:e(({t:i,uri:F,route:_,me:z})=>{var v,V;return[o(E,{src:F(Q(U),"/control-plane/outdated/:version",{version:((V=(v=r.data.zoneInsight.version)==null?void 0:v.kumaCp)==null?void 0:V.version)??"-"})},{default:e(({data:p})=>[o(O,{docs:i("zones.href.docs.cta"),notifications:!0},{default:e(()=>{var S,T,A,R,D;return[(c(!0),g(w,null,C([{bool:r.data.zoneInsight.store==="memory",key:"store-memory"},{bool:!((T=(S=r.data.zoneInsight.version)==null?void 0:S.kumaCp)!=null&&T.kumaCpGlobalCompatible),key:"global-cp-incompatible",params:{zoneCpVersion:((R=(A=r.data.zoneInsight.version)==null?void 0:A.kumaCp)==null?void 0:R.version)??"-",globalCpVersion:(p==null?void 0:p.version)??""}},{bool:(((D=r.data.zoneInsight.connectedSubscription)==null?void 0:D.status.total.responsesRejected)??0)>0,key:"global-nack-response"}],({bool:t,key:s,params:u})=>(c(),m($,{key:s,notify:t,"data-testid":`warning-${s}`,uri:`zone-cps.notifications.${s}.${r.data.id}`},{default:e(()=>[o(f,{path:`zone-cps.notifications.${s}`,params:Object.fromEntries(Object.entries(u??{}))},K({_:2},[s==="global-nack-response"?{name:"link",fn:e(()=>{var B;return[o(X,{"data-action":"",to:{name:"zone-cp-subscription-summary-view",params:{subscription:(B=r.data.zoneInsight.connectedSubscription)==null?void 0:B.id}}},{default:e(()=>[...a[0]||(a[0]=[n(`
                  zone control plane summary
                `,-1)])]),_:1},8,["to"])]}),key:"0"}:void 0]),1032,["path","params"])]),_:2},1032,["notify","data-testid","uri"]))),128)),a[18]||(a[18]=n()),o(b,{"data-testid":"detail-view-details",type:"stack"},{default:e(()=>[o(j,{title:i("zone-cps.detail.about.title"),created:r.data.creationTime,modified:r.data.modificationTime},{default:e(()=>[o(h,{layout:"horizontal"},{title:e(()=>[n(d(i("http.api.property.status")),1)]),body:e(()=>[o(M,{status:r.data.state},null,8,["status"])]),_:2},1024),a[6]||(a[6]=n()),o(h,{layout:"horizontal",class:Z({version:!0,outdated:p==null?void 0:p.outdated})},{title:e(()=>[n(d(i("zone-cps.routes.item.version")),1)]),body:e(()=>[o(b,{type:"separated"},{default:e(()=>[o(k,{appearance:(p==null?void 0:p.outdated)===!0?"warning":"decorative"},{default:e(()=>{var t,s;return[n(d(((s=(t=r.data.zoneInsight.version)==null?void 0:t.kumaCp)==null?void 0:s.version)??"—"),1)]}),_:2},1032,["appearance"]),a[2]||(a[2]=n()),(p==null?void 0:p.outdated)===!0?(c(),m(I,{key:0,name:"info"},{default:e(()=>[o(f,{path:"zone-cps.routes.item.version_warning"})]),_:1})):y("",!0)]),_:2},1024)]),_:2},1032,["class"]),a[7]||(a[7]=n()),o(h,{layout:"horizontal"},{title:e(()=>[n(d(i("http.api.property.type")),1)]),body:e(()=>[o(k,{appearance:"decorative"},{default:e(()=>[n(d(i(`common.product.environment.${r.data.zoneInsight.environment||"unknown"}`)),1)]),_:2},1024)]),_:2},1024),a[8]||(a[8]=n()),o(h,{layout:"horizontal"},{title:e(()=>[n(d(i("zone-cps.routes.item.authentication_type")),1)]),body:e(()=>[o(k,{appearance:"decorative"},{default:e(()=>[n(d(r.data.zoneInsight.authenticationType||i("common.not_applicable")),1)]),_:2},1024)]),_:2},1024)]),_:2},1032,["title","created","modified"]),a[17]||(a[17]=n()),r.data.zoneInsight.subscriptions.length>0?(c(),m(L,{key:0},{title:e(()=>[P("h2",null,d(i("zone-cps.detail.subscriptions.title")),1)]),default:e(()=>[a[15]||(a[15]=n()),o(b,null,{default:e(()=>[o(f,{path:"zone-cps.detail.subscriptions.description"}),a[14]||(a[14]=n()),o(H,{headers:[{...z.get("headers.connection"),label:" ",key:"connection"},{...z.get("headers.zoneInstanceId"),label:i("zone-cps.routes.items.headers.zoneInstanceId"),key:"zoneInstanceId"},{...z.get("headers.version"),label:i("zone-cps.routes.items.headers.version"),key:"version"},{...z.get("headers.connected"),label:i("zone-cps.routes.items.headers.connected"),key:"connected"},{...z.get("headers.disconnected"),label:i("zone-cps.routes.items.headers.disconnected"),key:"disconnected"},{...z.get("headers.responses"),label:i("zone-cps.routes.items.headers.responses"),key:"responses"}],"is-selected-row":t=>t.id===_.params.subscription,items:r.data.zoneInsight.subscriptions.map((t,s,u)=>u[u.length-(s+1)]),onResize:z.set},{connection:e(({row:t})=>[(c(!0),g(w,null,C([t.connectTime&&!t.disconnectTime?"healthy":"unhealthy"],s=>(c(),m(I,{key:`${s}`,name:s},{default:e(()=>[n(d(i(`common.connection.${s}`)),1)]),_:2},1032,["name"]))),128))]),zoneInstanceId:e(({row:t})=>[o(X,{"data-action":"",to:{name:"zone-cp-subscription-summary-view",params:{subscription:t.id}}},{default:e(()=>[n(d(t.zoneInstanceId),1)]),_:2},1032,["to"])]),version:e(({row:t})=>{var s,u;return[n(d(((u=(s=t.version)==null?void 0:s.kumaCp)==null?void 0:u.version)??"-"),1)]}),connected:e(({row:t})=>[n(d(i("common.formats.datetime",{value:Date.parse(t.connectTime??"")})),1)]),disconnected:e(({row:t})=>[t.disconnectTime?(c(),g(w,{key:0},[n(d(i("common.formats.datetime",{value:Date.parse(t.disconnectTime)})),1)],64)):y("",!0)]),responses:e(({row:t})=>{var s;return[(c(!0),g(w,null,C([((s=t.status)==null?void 0:s.total)??{}],u=>(c(),m(b,{key:typeof u,type:"separated"},{default:e(()=>[n(d(u.responsesSent)+"/"+d(u.responsesAcknowledged)+" ",1),!t.disconnectTime&&t.status.total.responsesRejected>0?(c(),m(I,{key:0,name:"warning","data-testid":"warning"},{default:e(()=>[o(f,{path:"zone-cps.routes.items.rows.nacked",params:{nacked:String(t.status.total.responsesRejected)}},null,8,["params"])]),_:2},1024)):y("",!0)]),_:2},1024))),128))]}),_:2},1032,["headers","is-selected-row","items","onResize"])]),_:2},1024),a[16]||(a[16]=n()),o(x,null,{default:e(({Component:t})=>[_.child()?(c(),m(W,{key:0,width:"670px",onClose:function(){_.replace({name:"zone-cp-detail-view",params:{zone:_.params.zone}})}},{default:e(()=>[(c(),m(J(t),{data:r.data.zoneInsight.subscriptions},{default:e(()=>[o(f,{path:"zone-cps.routes.item.subscription_intro"})]),_:2},1032,["data"]))]),_:2},1032,["onClose"])):y("",!0)]),_:2},1024)]),_:2},1024)):y("",!0)]),_:2},1024)]}),_:2},1032,["docs"])]),_:2},1032,["src"])]}),_:1})}}});export{oe as default};
