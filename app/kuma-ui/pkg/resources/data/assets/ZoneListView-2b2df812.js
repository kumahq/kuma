import{d as E,j as $,o as s,a as r,w as t,A as S,g as a,b as e,X as F,f as M,Y as K,c as P,r as W,h as i,q as V,t as X,s as l,e as T,F as A,M as Y,x as q,$ as j,E as G,H as D}from"./index-67d086f6.js";import{_ as H}from"./MultizoneInfo.vue_vue_type_script_setup_true_lang-bace1d3a.js";import{_ as O,A as U}from"./DataSource.vue_vue_type_script_setup_true_lang-7de82cfa.js";import{z as J,g as Q,n as ee,e as te,A as oe,_ as ne,o as ae,f as se}from"./RouteView.vue_vue_type_script_setup_true_lang-79b8501d.js";import{_ as ie}from"./RouteTitle.vue_vue_type_script_setup_true_lang-3c572c51.js";import{S as le}from"./StatusBadge-e7a0ad4b.js";const re=E({__name:"DeleteResourceModal",props:{actionButtonText:{type:String,required:!1,default:"Yes, delete"},confirmationText:{type:String,required:!1,default:""},deleteFunction:{type:Function,required:!0},isVisible:{type:Boolean,required:!0},modalId:{type:String,required:!0},title:{type:String,required:!1,default:"Delete"}},emits:["cancel","delete"],setup(z,{emit:d}){const c=z,o=$(!1);async function C(){o.value=!1;try{await c.deleteFunction(),d("delete")}catch{o.value=!0}}return(p,m)=>(s(),r(e(K),{"action-button-text":c.actionButtonText,"confirmation-text":c.confirmationText,"is-visible":c.isVisible,"modal-id":c.modalId,title:c.title,type:"danger","data-testid":"delete-resource-modal",onCanceled:m[0]||(m[0]=f=>d("cancel")),onProceed:C},{"body-content":t(()=>[S(p.$slots,"body-content"),a(),o.value?(s(),r(e(F),{key:0,class:"mt-4",appearance:"danger","is-dismissible":""},{alertMessage:t(()=>[S(p.$slots,"error")]),_:3})):M("",!0)]),_:3},8,["action-button-text","confirmation-text","is-visible","modal-id","title"]))}}),ce=E({__name:"ZoneListView",props:{page:{type:Number,required:!0},size:{type:Number,required:!0}},setup(z){const d=z,c=J(),{t:o}=Q(),C=ee(),p=te(),m=$(!1),f=$(""),I=P(()=>p.getters["config/getEnvironment"]);function Z(_){return _.map(b=>{var N;const{name:g}=b,w={name:"zone-cp-detail-view",params:{zone:g}};let u="";const h=I.value;let y=!0;(((N=b.zoneInsight)==null?void 0:N.subscriptions)??[]).forEach(k=>{if(k.version&&k.version.kumaCp){u=k.version.kumaCp.version;const{kumaCpGlobalCompatible:R=!0}=k.version.kumaCp;y=R}});const v=ae(b.zoneInsight);return{detailViewRoute:w,name:g,status:v,zoneCpVersion:u,type:h,warnings:!y}})}async function B(){await C.deleteZone({name:f.value})}function x(){m.value=!m.value}function L(_){x(),f.value=_}return(_,b)=>{const g=W("RouterLink");return s(),r(ne,{name:"zone-cp-list-view"},{default:t(({route:w})=>[i(oe,null,{title:t(()=>[V("h2",null,[i(ie,{title:e(o)("zone-cps.routes.items.title"),render:!0},null,8,["title"])])]),default:t(()=>[a(),e(p).getters["config/getMulticlusterStatus"]===!1?(s(),r(H,{key:0})):(s(),r(O,{key:1,src:`/zone-cps?size=${d.size}&page=${d.page}`},{default:t(({data:u,error:h,refresh:y})=>[i(e(X),null,{body:t(()=>[i(U,{class:"zone-cp-collection","data-testid":"zone-cp-collection",headers:[{label:"Name",key:"name"},{label:"Zone CP Version",key:"zoneCpVersion"},{label:"Type",key:"type"},{label:"Status",key:"status"},{label:"Warnings",key:"warnings",hideLabel:!0},{label:"Actions",key:"actions",hideLabel:!0}],"page-number":d.page,"page-size":d.size,total:u==null?void 0:u.total,items:u?Z(u.items):void 0,error:h,onChange:w.update},{name:t(({row:n,rowValue:v})=>[i(g,{to:n.detailViewRoute,"data-testid":"detail-view-link"},{default:t(()=>[a(l(v),1)]),_:2},1032,["to"])]),zoneCpVersion:t(({rowValue:n})=>[a(l(n||e(o)("common.collection.none")),1)]),type:t(({rowValue:n})=>[a(l(n||e(o)("common.collection.none")),1)]),status:t(({rowValue:n})=>[n?(s(),r(le,{key:0,status:n},null,8,["status"])):(s(),T(A,{key:1},[a(l(e(o)("common.collection.none")),1)],64))]),warnings:t(({rowValue:n})=>[n?(s(),r(e(Y),{key:0,label:e(o)("zone-cps.list.version_mismatch")},{default:t(()=>[i(e(q),{class:"mr-1",icon:"warning",color:"var(--black-500)","secondary-color":"var(--yellow-300)",size:"20","hide-title":""})]),_:1},8,["label"])):(s(),T(A,{key:1},[a(l(e(o)("common.collection.none")),1)],64))]),actions:t(({row:n})=>[i(e(j),{class:"actions-dropdown","data-testid":"actions-dropdown","kpop-attributes":{placement:"bottomEnd",popoverClasses:"mt-5 more-actions-popover"},width:"150"},{default:t(()=>[i(e(G),{class:"non-visual-button",appearance:"secondary",size:"small"},{icon:t(()=>[i(e(q),{color:"var(--black-400)",icon:"more",size:"16"})]),_:1})]),items:t(()=>[i(e(D),{item:{to:n.detailViewRoute,label:e(o)("common.collection.actions.view")}},null,8,["item"]),a(),e(c)("KUMA_ZONE_CREATION_FLOW")==="enabled"?(s(),r(e(D),{key:0,"has-divider":"","is-dangerous":"","data-testid":"dropdown-delete-item",onClick:v=>L(n.name)},{default:t(()=>[a(l(e(o)("common.collection.actions.delete")),1)]),_:2},1032,["onClick"])):M("",!0)]),_:2},1024)]),_:2},1032,["page-number","page-size","total","items","error","onChange"])]),_:2},1024),a(),m.value?(s(),r(re,{key:0,"confirmation-text":f.value,"delete-function":B,"is-visible":m.value,"modal-id":"delete-zone-modal","action-button-text":e(o)("zones.delete.confirmModal.proceedText"),title:e(o)("zones.delete.confirmModal.title"),onCancel:x,onDelete:()=>{x(),y()}},{"body-content":t(()=>[V("p",null,l(e(o)("zones.delete.confirmModal.text1",{zoneName:f.value})),1),a(),V("p",null,l(e(o)("zones.delete.confirmModal.text2")),1)]),error:t(()=>[a(l(e(o)("zones.delete.confirmModal.errorText")),1)]),_:2},1032,["confirmation-text","is-visible","action-button-text","title","onDelete"])):M("",!0)]),_:2},1032,["src"]))]),_:2},1024)]),_:1})}}});const be=se(ce,[["__scopeId","data-v-02a8f61a"]]);export{be as default};
