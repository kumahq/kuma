import{_ as R}from"./kongponents.es-9f2d376a.js";import{d as U,u as j,r as o,v as G,y as H,A as K,B as W,j as v,b,e as f,i as m,g as u,w as s,h as I,f as N,E as q,o as i,t as z,F as O,q as B}from"./index-5b34b65e.js";import{_ as X}from"./MultizoneInfo.vue_vue_type_script_setup_true_lang-2890c63d.js";import{A as Y,a as J}from"./AccordionList-afa5eac7.js";import{D as ee}from"./DataOverview-4a430414.js";import{E as w}from"./EnvoyData-e655615a.js";import{_ as te}from"./LabelList.vue_vue_type_style_index_0_lang-11916613.js";import{_ as se,S as ae}from"./SubscriptionHeader.vue_vue_type_script_setup_true_lang-8f436a04.js";import{T as ne}from"./TabsWidget-452618aa.js";import{u as re}from"./store-76151f83.js";import{u as oe}from"./index-c89ad052.js";import{Q as C}from"./QueryParameter-70743f73.js";import"./_plugin-vue_export-helper-c27b6911.js";import"./EmptyBlock.vue_vue_type_script_setup_true_lang-a940747e.js";import"./ErrorBlock-88e8a32d.js";import"./LoadingBlock.vue_vue_type_script_setup_true_lang-e1caaf97.js";import"./datadogLogEvents-302eea7b.js";import"./TagList-a04c9075.js";import"./StatusBadge-df8e2e64.js";import"./CodeBlock.vue_vue_type_style_index_0_lang-72cdad70.js";const ie={class:"zoneingresses"},le={key:1,class:"kcard-stack"},ue={class:"kcard-border"},ce={class:"kcard-border"},me={class:"entity-heading"},Ne=U({__name:"ZoneIngresses",props:{selectedZoneIngressName:{type:String,required:!1,default:null},offset:{type:Number,required:!1,default:0}},setup(L){const p=L,k=oe(),V={title:"No Data",message:"There are no Zone Ingresses present."},F=[{hash:"#overview",title:"Overview"},{hash:"#insights",title:"Zone Ingress Insights"},{hash:"#xds-configuration",title:"XDS Configuration"},{hash:"#envoy-stats",title:"Stats"},{hash:"#envoy-clusters",title:"Clusters"}],y=j(),S=re(),d=o(!0),c=o(!1),g=o(null),h=o({headers:[{label:"Status",key:"status"},{label:"Name",key:"name"}],data:[]}),l=o(null),A=o([]),x=o(null),D=o([]),E=o(p.offset);G(()=>y.params.mesh,function(){y.name==="zoneingresses"&&(d.value=!0,c.value=!1,g.value=null,_(0))}),H(function(){M(p.offset)});function M(t){S.getters["config/getMulticlusterStatus"]&&_(t)}async function _(t){E.value=t,C.set("offset",t>0?t:null),d.value=!0,c.value=!1;const a=y.query.ns||null,r=q;try{const{data:e,next:n}=await $(a,r,t);x.value=n,e.length?(c.value=!1,A.value=e,T({name:p.selectedZoneIngressName??e[0].name}),h.value.data=e.map(Z=>{const{zoneIngressInsight:P={}}=Z,Q=K(P);return{...Z,status:Q}})):(h.value.data=[],c.value=!0)}catch(e){e instanceof Error?g.value=e:console.error(e),c.value=!0}finally{d.value=!1}}function T({name:t}){var e;const a=A.value.find(n=>n.name===t),r=((e=a==null?void 0:a.zoneIngressInsight)==null?void 0:e.subscriptions)??[];D.value=Array.from(r).reverse(),l.value=W(a,["type","name"]),C.set("zoneIngress",t)}async function $(t,a,r){if(t)return{data:[await k.getZoneIngressOverview({name:t},{size:a,offset:r})],next:null};{const{items:e,next:n}=await k.getAllZoneIngressOverviews({size:a,offset:r});return{data:e??[],next:n}}}return(t,a)=>{var r;return i(),v("div",ie,[b(S).getters["config/getMulticlusterStatus"]===!1?(i(),f(X,{key:0})):(i(),v("div",le,[m("div",ue,[u(ee,{"selected-entity-name":(r=l.value)==null?void 0:r.name,"page-size":b(q),"is-loading":d.value,error:g.value,"empty-state":V,"table-data":h.value,"table-data-is-empty":c.value,next:x.value,"page-offset":E.value,onTableAction:T,onLoadData:_},{additionalControls:s(()=>[t.$route.query.ns?(i(),f(b(R),{key:0,class:"back-button",appearance:"primary",icon:"arrowLeft",to:{name:"zoneingresses"}},{default:s(()=>[I(`
              View all
            `)]),_:1})):N("",!0)]),_:1},8,["selected-entity-name","page-size","is-loading","error","table-data","table-data-is-empty","next","page-offset"])]),I(),m("div",ce,[c.value===!1&&l.value!==null?(i(),f(ne,{key:0,"has-error":g.value!==null,"is-loading":d.value,tabs:F},{tabHeader:s(()=>[m("h1",me,`
              Zone Ingress: `+z(l.value.name),1)]),overview:s(()=>[u(te,null,{default:s(()=>[m("div",null,[m("ul",null,[(i(!0),v(O,null,B(l.value,(e,n)=>(i(),v("li",{key:n},[m("h4",null,z(n),1),I(),m("p",null,z(e),1)]))),128))])])]),_:1})]),insights:s(()=>[u(J,{"initially-open":0},{default:s(()=>[(i(!0),v(O,null,B(D.value,(e,n)=>(i(),f(Y,{key:n},{"accordion-header":s(()=>[u(se,{details:e},null,8,["details"])]),"accordion-content":s(()=>[u(ae,{details:e,"is-discovery-subscription":""},null,8,["details"])]),_:2},1024))),128))]),_:1})]),"xds-configuration":s(()=>[u(w,{"data-path":"xds","zone-ingress-name":l.value.name,"query-key":"envoy-data-zone-ingress"},null,8,["zone-ingress-name"])]),"envoy-stats":s(()=>[u(w,{"data-path":"stats","zone-ingress-name":l.value.name,"query-key":"envoy-data-zone-ingress"},null,8,["zone-ingress-name"])]),"envoy-clusters":s(()=>[u(w,{"data-path":"clusters","zone-ingress-name":l.value.name,"query-key":"envoy-data-zone-ingress"},null,8,["zone-ingress-name"])]),_:1},8,["has-error","is-loading"])):N("",!0)])]))])}}});export{Ne as default};
