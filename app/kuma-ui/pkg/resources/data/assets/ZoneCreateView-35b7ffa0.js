import{l as V,b as W,S as N,c as H,u as j,a as L,s as U}from"./kongponents.es-c3c87d30.js";import{d as S,q as p,x as Q,B as G,o as v,e as $,k as t,h as r,w as l,a as C,b as e,g as n,n as E,u as K,c as I,t as o,p as J,m as X,I as F,l as Y,f as B,F as ee}from"./index-915d42a5.js";import{_ as y}from"./CodeBlock.vue_vue_type_style_index_0_lang-97797141.js";import{j as ne,i as A,e as x,g as T,h as te,f as oe,_ as se,z as ae}from"./RouteView.vue_vue_type_script_setup_true_lang-ce7f15c9.js";import{_ as re}from"./RouteTitle.vue_vue_type_script_setup_true_lang-534dcac2.js";import{E as le}from"./ErrorBlock-4e13de22.js";const ie={class:"scanner"},ue={class:"scanner-content"},ce={class:"mb-2"},de=S({__name:"EntityScanner",props:{interval:{type:Number,required:!1,default:1e3},retries:{type:Number,required:!1,default:3600},hasError:{type:Boolean,default:!1},loaderFunction:{type:Function,required:!0},canComplete:{type:Boolean,default:!1}},emits:["hide-siblings"],setup(m,{emit:s}){const i=m,a=p(0),c=p(!1),z=p(!1),k=p(null);Q(function(){u()}),G(function(){f()});function u(){c.value=!0,z.value=!1,f(),k.value=window.setInterval(async()=>{a.value++,await i.loaderFunction(),(a.value===i.retries||i.canComplete===!0)&&(f(),c.value=!1,z.value=!0,s("hide-siblings",!0))},i.interval)}function f(){k.value!==null&&window.clearInterval(k.value)}return(g,b)=>(v(),$("div",ie,[t("div",ue,[r(e(W),{"cta-is-hidden":""},{title:l(()=>[t("div",ce,[c.value?(v(),C(e(V),{key:0,icon:"spinner",color:"var(--grey-300)",size:"42"})):m.hasError?(v(),C(e(V),{key:1,icon:"errorFilled",color:"var(--red-500)",size:"42"})):(v(),C(e(V),{key:2,icon:"circleCheck",color:"var(--green-500)",size:"42"}))]),n(),c.value?E(g.$slots,"loading-title",{key:0}):m.hasError?E(g.$slots,"error-title",{key:1}):E(g.$slots,"complete-title",{key:2})]),message:l(()=>[c.value?E(g.$slots,"loading-content",{key:0}):m.hasError?E(g.$slots,"error-content",{key:1}):E(g.$slots,"complete-content",{key:2})]),_:3})])]))}}),me=m=>(J("data-v-293c555d"),m=m(),X(),m),pe={href:"https://helm.sh/docs/intro/install/"},ve=me(()=>t("p",null,"On your local machine, create a namespace in your Kubernetes cluster and pull down the kong Helm repo.",-1)),fe={class:"k-input-label mt-4"},be={class:"mt-4"},_e=S({__name:"ZoneCreateKubernetesInstructions",props:{zoneName:{type:String,required:!0},zoneIngressEnabled:{type:Boolean,required:!0},zoneEgressEnabled:{type:Boolean,required:!0},token:{type:String,required:!0},base64EncodedToken:{type:String,required:!0}},setup(m){const s=m,i=ne(),a=A(),c=K(),z=x(),k=I(()=>a.t("zones.form.kubernetes.secret.createSecretCommand",{token:s.base64EncodedToken}).trim()),u=I(()=>{const f={zoneName:s.zoneName,globalKdsAddress:z.state.globalKdsAddress,zoneIngressEnabled:String(s.zoneIngressEnabled),zoneEgressEnabled:String(s.zoneEgressEnabled)};return typeof c.params.virtualControlPlaneId=="string"&&(f.controlPlaneId=c.params.virtualControlPlaneId),a.t("zones.form.kubernetes.connectZone.config",f).trim()});return(f,g)=>(v(),$("div",null,[t("h3",null,"1. "+o(e(a).t("zones.form.kubernetes.prerequisites.title")),1),n(),t("ul",null,[t("li",null,[t("b",null,o(e(a).t("zones.form.kubernetes.prerequisites.step1Label"))+o(s.zoneIngressEnabled?" "+e(a).t("zones.form.kubernetes.prerequisites.step1LabelAddendum"):""),1),n(`:
        `+o(e(a).t("zones.form.kubernetes.prerequisites.step1Description",{productName:e(i)("KUMA_PRODUCT_NAME")})),1)]),n(),t("li",null,[t("b",null,o(e(a).t("zones.form.kubernetes.prerequisites.step2Label")),1),n(`:
        `+o(e(a).t("zones.form.kubernetes.prerequisites.step2Description")),1)]),n(),t("li",null,[t("a",pe,o(e(a).t("zones.form.kubernetes.prerequisites.step3LinkTitle")),1),n(" "+o(e(a).t("zones.form.kubernetes.prerequisites.step3Tail")),1)])]),n(),t("h3",null,"2. "+o(e(a).t("zones.form.kubernetes.helm.title")),1),n(),ve,n(),t("ol",null,[t("li",null,[n(o(e(a).t("zones.form.kubernetes.helm.step1Description"))+" ",1),r(y,{id:"zone-kubernetes-create-namespace",class:"mt-4",code:e(a).t("zones.form.kubernetes.helm.step1Command"),language:"bash"},null,8,["code"])]),n(),t("li",null,[n(o(e(a).t("zones.form.kubernetes.helm.step2Description"))+" ",1),r(y,{id:"zone-kubernetes-add-charts-repo",class:"mt-4",code:e(a).t("zones.form.kubernetes.helm.step2Command"),language:"bash"},null,8,["code"])]),n(),t("li",null,[n(o(e(a).t("zones.form.kubernetes.helm.step3Description"))+" ",1),r(y,{id:"zone-kubernetes-repo-update",class:"mt-4",code:e(a).t("zones.form.kubernetes.helm.step3Command"),language:"bash"},null,8,["code"])])]),n(),t("h3",null,"3. "+o(e(a).t("zones.form.kubernetes.secret.title")),1),n(),t("p",null,o(e(a).t("zones.form.kubernetes.secret.createSecretDescription")),1),n(),r(y,{id:"zone-kubernetes-create-secret",class:"mt-4",code:k.value,language:"bash"},null,8,["code"]),n(),t("h3",null,"4. "+o(e(a).t("zones.form.kubernetes.connectZone.title")),1),n(),t("p",null,o(e(a).t("zones.form.kubernetes.connectZone.configDescription")),1),n(),t("span",fe,o(e(a).t("zones.form.kubernetes.connectZone.configFileName")),1),n(),r(y,{id:"zone-kubernetes-config-code-block",code:u.value,language:"yaml"},null,8,["code"]),n(),t("p",be,o(e(a).t("zones.form.kubernetes.connectZone.connectDescription")),1),n(),r(y,{id:"zone-kubernetes-command-code-block",class:"mt-4",code:e(a).t("zones.form.kubernetes.connectZone.connectCommand").trim(),language:"bash"},null,8,["code"])]))}});const ze=T(_e,[["__scopeId","data-v-293c555d"]]),ge={class:"k-input-label mt-4"},ke={class:"mt-4"},he=S({__name:"ZoneCreateUniversalInstructions",props:{zoneName:{type:String,required:!0},token:{type:String,required:!0}},setup(m){const s=m,i=A(),a=K(),c=x(),z=I(()=>i.t("zones.form.universal.saveToken.saveTokenCommand",{token:s.token}).trim()),k=I(()=>{const u={zoneName:s.zoneName,globalKdsAddress:c.state.globalKdsAddress};return typeof a.params.virtualControlPlaneId=="string"&&(u.controlPlaneId=a.params.virtualControlPlaneId),i.t("zones.form.universal.connectZone.config",u).trim()});return(u,f)=>(v(),$("div",null,[t("h3",null,"1. "+o(e(i).t("zones.form.universal.saveToken.title")),1),n(),t("p",null,o(e(i).t("zones.form.universal.saveToken.saveTokenDescription")),1),n(),r(y,{id:"zone-kubernetes-token",class:"mt-4",code:z.value,language:"bash"},null,8,["code"]),n(),t("h3",null,"2. "+o(e(i).t("zones.form.universal.connectZone.title")),1),n(),t("p",null,o(e(i).t("zones.form.universal.connectZone.configDescription")),1),n(),t("span",ge,o(e(i).t("zones.form.universal.connectZone.configFileName")),1),n(),r(y,{id:"zone-universal-config-code-block",class:"mt-4",code:k.value,language:"yaml"},null,8,["code"]),n(),t("p",ke,o(e(i).t("zones.form.universal.connectZone.connectDescription")),1),n(),r(y,{id:"zone-universal-connect-command-code-block",class:"mt-4",code:e(i).t("zones.form.universal.connectZone.connectCommand").trim(),language:"bash"},null,8,["code"])]))}});const ye=T(he,[["__scopeId","data-v-ea760a7e"]]),Ee={class:"app-title-bar"},Ce={class:"title-wrapper"},Ie={class:"title"},we={class:"action-list"},$e=S({__name:"WizardTitleBar",setup(m){return(s,i)=>(v(),$("div",Ee,[t("div",Ce,[r(e(V),{icon:"kong"}),n(),t("span",Ie,[E(s.$slots,"title",{},void 0,!0)])]),n(),t("div",we,[E(s.$slots,"actions",{},void 0,!0)])]))}});const Se=T($e,[["__scopeId","data-v-f0a75c34"]]),Ze={class:"form-content"},Ve={class:"form-wrapper mt-4"},Te={key:1,class:"form-wrapper mt-4","data-testid":"connect-zone-instructions"},qe={class:"k-input-label"},De={class:"radio-button-group"},Ne={class:"k-input-label"},Be={class:"radio-button-group"},Ae={class:"k-input-label"},Le={class:"radio-button-group"},Ue={class:"mt-6"},Fe={class:"mt-2"},Ke=S({__name:"ZoneCreateView",setup(m){const{t:s}=A(),i=te(),a=[400,409,500],c=p(null),z=p(!1),k=p(null),u=p({error:null,title:null,icon:"warning",badgeAppearance:"warning"}),f=p(!1),g=p(null),b=p(""),w=p("kubernetes"),q=p(!0),D=p(!0),Z=I(()=>c.value!==null&&c.value.token?c.value.token:""),P=I(()=>Z.value!==""?window.btoa(Z.value):""),O=I(()=>b.value===""||z.value||c.value!==null||u.value.error instanceof F&&u.value.error.status===409);async function M(){z.value=!0,k.value=null;try{c.value=await i.createZone({name:b.value})}catch(d){d instanceof F&&a.includes(d.status)?u.value={error:d,title:s(`zones.create.statusError.${d.status}.title`,{zoneName:b.value}),description:s(`zones.create.statusError.${d.status}.description`).trim(),icon:d.status===500?"warning":"errorFilled",badgeAppearance:d.status===500?"warning":"danger"}:d instanceof Error?u.value={error:d,title:s("zones.create.generalError.title"),icon:"warning",badgeAppearance:"danger"}:console.error(d)}finally{z.value=!1}}async function R(){f.value=!1,g.value=null;try{const d=await i.getZoneOverview({name:b.value}),_=ae(d.zoneInsight);f.value=_==="online"}catch(d){d instanceof Error?g.value=d:console.error(d)}}return(d,_)=>(v(),C(se,{attrs:{class:"is-fullscreen"}},{default:l(()=>[r(re,{title:e(s)("zones.routes.create.title")},null,8,["title"]),n(),r(oe,{breadcrumbs:[]},{default:l(()=>[r(Se,{class:"mb-6"},{title:l(()=>[n(o(e(s)("zones.routes.create.title")),1)]),actions:l(()=>[r(e(N),{appearance:"outline",to:{name:"zone-cp-list-view"}},{default:l(()=>[n(o(e(s)("zones.form.exit")),1)]),_:1})]),_:1}),n(),t("div",Ze,[t("h1",null,o(e(s)("zones.routes.create.title")),1),n(),t("div",Ve,[t("div",null,[r(e(H),{for:"zone-name"},{default:l(()=>[n(o(e(s)("zones.form.nameLabel"))+` *
            `,1)]),_:1}),n(),r(e(j),{id:"zone-name",modelValue:b.value,"onUpdate:modelValue":_[0]||(_[0]=h=>b.value=h),type:"text",name:"zone-name","data-testid":"name-input",disabled:c.value!==null},null,8,["modelValue","disabled"])]),n(),r(e(N),{appearance:"creation",icon:z.value?"spinner":"plus",disabled:O.value,"data-testid":"create-zone-button",onClick:M},{default:l(()=>[n(o(e(s)("zones.form.createZoneButtonLabel")),1)]),_:1},8,["icon","disabled"])]),n(),u.value.error!==null?(v(),C(le,{key:0,class:"mt-4",error:u.value.error,"badge-appearance":u.value.badgeAppearance,icon:u.value.icon,"data-testid":"create-zone-error"},Y({default:l(()=>[t("p",null,o(u.value.title),1),n()]),_:2},[u.value.description?{name:"message",fn:l(()=>[t("p",null,o(u.value.description),1)]),key:"0"}:void 0]),1032,["error","badge-appearance","icon"])):B("",!0),n(),c.value!==null?(v(),$("div",Te,[t("div",null,[t("span",qe,o(e(s)("zones.form.environmentLabel"))+` *
            `,1),n(),t("div",De,[r(e(L),{id:"zone-environment-universal",modelValue:w.value,"onUpdate:modelValue":_[1]||(_[1]=h=>w.value=h),"selected-value":"universal",name:"zone-environment","data-testid":"environment-universal-radio-button"},{default:l(()=>[n(o(e(s)("zones.form.universalLabel")),1)]),_:1},8,["modelValue"]),n(),r(e(L),{id:"zone-environment-kubernetes",modelValue:w.value,"onUpdate:modelValue":_[2]||(_[2]=h=>w.value=h),"selected-value":"kubernetes",name:"zone-environment","data-testid":"environment-kubernetes-radio-button"},{default:l(()=>[n(o(e(s)("zones.form.kubernetesLabel")),1)]),_:1},8,["modelValue"])])]),n(),w.value==="kubernetes"?(v(),$(ee,{key:0},[t("div",null,[t("span",Ne,o(e(s)("zones.form.zoneIngressLabel"))+` *
              `,1),n(),t("div",Be,[r(e(U),{id:"zone-ingress-enabled",modelValue:q.value,"onUpdate:modelValue":_[3]||(_[3]=h=>q.value=h),"data-testid":"ingress-input-switch"},{label:l(()=>[n(o(e(s)("zones.form.zoneIngressEnabledLabel")),1)]),_:1},8,["modelValue"])])]),n(),t("div",null,[t("span",Ae,o(e(s)("zones.form.zoneEgressLabel"))+` *
              `,1),n(),t("div",Le,[r(e(U),{id:"zone-egress-enabled",modelValue:D.value,"onUpdate:modelValue":_[4]||(_[4]=h=>D.value=h),"data-testid":"egress-input-switch"},{label:l(()=>[n(o(e(s)("zones.form.zoneEgressEnabledLabel")),1)]),_:1},8,["modelValue"])])])],64)):B("",!0),n(),t("h2",Ue,o(e(s)("zones.form.connectZone")),1),n(),w.value==="universal"?(v(),C(ye,{key:1,"zone-name":b.value,token:Z.value},null,8,["zone-name","token"])):(v(),C(ze,{key:2,"zone-name":b.value,"zone-ingress-enabled":q.value,"zone-egress-enabled":D.value,token:Z.value,"base64-encoded-token":P.value},null,8,["zone-name","zone-ingress-enabled","zone-egress-enabled","token","base64-encoded-token"])),n(),r(de,{"loader-function":R,"has-error":g.value!==null,"can-complete":f.value,"data-testid":"zone-connected-scanner"},{"loading-title":l(()=>[n(o(e(s)("zones.form.scan.waitTitle")),1)]),"complete-title":l(()=>[n(o(e(s)("zones.form.scan.completeTitle")),1)]),"complete-content":l(()=>[t("p",null,o(e(s)("zones.form.scan.completeDescription",{name:b.value})),1),n(),t("p",Fe,[r(e(N),{appearance:"primary",to:{name:"zone-cp-detail-view",params:{zone:b.value}}},{default:l(()=>[n(o(e(s)("zones.form.scan.completeButtonLabel",{name:b.value})),1)]),_:1},8,["to"])])]),"error-title":l(()=>[t("h3",null,o(e(s)("zones.form.scan.errorTitle")),1)]),"error-content":l(()=>[t("p",null,o(e(s)("zones.form.scan.errorDescription")),1)]),_:1},8,["has-error","can-complete"])])):B("",!0)])]),_:1})]),_:1}))}});const He=T(Ke,[["__scopeId","data-v-f9288cbc"]]);export{He as default};
