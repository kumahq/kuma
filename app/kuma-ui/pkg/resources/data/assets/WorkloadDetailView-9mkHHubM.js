import{d as K,r as p,p as _,o,w as e,b as i,e as n,m as h,a8 as D,q as w,l as c,c as u,t as s,L as y,M as z,a as Z,I as F,Z as O,K as H,y as J,_ as Q}from"./index-BkRXKYLT.js";const U={key:0},Y={key:1},P=["data-testid"],ee=K({__name:"WorkloadDetailView",props:{data:{}},setup($){const l=$;return(V,t)=>{const S=p("RouteTitle"),v=p("XBadge"),b=p("XAction"),X=p("XLayout"),A=p("XDl"),x=p("DataLoader"),L=p("XAboutCard"),T=p("XSearch"),E=p("XIcon"),I=p("XActionGroup"),R=p("XDrawer"),N=p("RouterView"),B=p("DataCollection"),M=p("XCard"),W=p("AppView"),j=p("RouteView");return o(),_(j,{name:"workload-detail-view",params:{mesh:"",wl:"",page:1,size:Number,proxy:"",s:""}},{default:e(({route:r,t:d,uri:q,me:g,can:G})=>[i(S,{render:!1,title:d("workloads.routes.item.title",{name:h(D).fromString(r.params.wl).name})},null,8,["title"]),t[18]||(t[18]=n()),i(W,null,{default:e(()=>[i(L,{title:d("workloads.routes.item.about.title"),created:typeof l.data<"u"&&!(l.data instanceof Error)?l.data.creationTime:void 0,modified:typeof l.data<"u"&&!(l.data instanceof Error)?l.data.modificationTime:void 0,"data-testid":"about-workload"},{default:e(()=>[i(x,{data:[l.data]},{default:e(()=>[typeof l.data<"u"&&!(l.data instanceof Error)?(o(),_(A,{key:0},{default:e(()=>[c("div",null,[c("dt",null,s(d("http.api.property.status")),1),t[1]||(t[1]=n()),c("dd",null,[i(v,{appearance:d(`common.status.appearance.${l.data.status.state}`,void 0,{defaultMessage:"neutral"})},{default:e(()=>[n(s(d(`http.api.value.${l.data.status.state}`)),1)]),_:2},1032,["appearance"])])]),t[5]||(t[5]=n()),l.data.zone.length?(o(),u("div",U,[c("dt",null,s(d("http.api.property.zone")),1),t[2]||(t[2]=n()),c("dd",null,[l.data.zone?(o(),_(b,{key:0,to:{name:"zone-cp-detail-view",params:{zone:l.data.zone}}},{default:e(()=>[i(v,null,{default:e(()=>[n(s(l.data.zone),1)]),_:1})]),_:1},8,["to"])):w("",!0)])])):w("",!0),t[6]||(t[6]=n()),l.data.namespace.length?(o(),u("div",Y,[c("dt",null,s(d("http.api.property.namespace")),1),t[3]||(t[3]=n()),c("dd",null,[i(v,null,{default:e(()=>[n(s(l.data.namespace),1)]),_:1})])])):w("",!0),t[7]||(t[7]=n()),(o(!0),u(y,null,z([Object.entries(l.data.labels).filter(([f])=>!["display-name","zone","namespace"].find(m=>f.includes(m)))],f=>(o(),u("div",{key:typeof f},[c("dt",null,s(d("workloads.routes.item.about.labels")),1),t[4]||(t[4]=n()),c("dd",null,[i(X,{variant:"x-stack",truncate:""},{default:e(()=>[(o(!0),u(y,null,z(f,([m,a])=>(o(),_(v,{key:m},{default:e(()=>[n(s(m)+": "+s(a),1)]),_:2},1024))),128))]),_:2},1024)])]))),128))]),_:2},1024)):w("",!0)]),_:2},1032,["data"])]),_:2},1032,["title","created","modified"]),t[17]||(t[17]=n()),i(M,null,{default:e(()=>[i(X,{variant:"y-stack"},{default:e(()=>[Z(V.$slots,"title",{},()=>[c("h2",null,s(d("workloads.routes.item.dataplaneProxies.title")),1)],!0),t[15]||(t[15]=n()),c("search",null,[c("form",{class:"search-form",onSubmit:t[0]||(t[0]=F(()=>{},["prevent"]))},[i(T,{class:"search-field",keys:["name","tag","label"],value:r.params.s,onChange:f=>r.update({page:1,s:f})},null,8,["value","onChange"])],32)]),t[16]||(t[16]=n()),(o(!0),u(y,null,z([h(D).fromString(r.params.wl)],f=>(o(),_(x,{key:typeof f,src:q(h(O),"/meshes/:mesh/dataplanes/of/:type",{mesh:r.params.mesh,type:"standard"},{page:r.params.page,size:r.params.size,search:`${r.params.s} kuma.io/workload:${f.name} ${[["namespace",f.namespace],["zone",f.zone]].filter(([,m])=>m.length>0).map(([m,a])=>`${m}:${a}`).join(" ")}`}),variant:"list"},{default:e(({data:m})=>[i(B,{items:m.items,total:m.total,page:r.params.page,"page-size":r.params.size,onChange:r.update},{default:e(()=>[i(H,{class:"data-plane-collection","data-testid":"data-plane-collection",headers:[{...g.get("headers.name"),label:"Name",key:"name"},{...g.get("headers.namespace"),label:"Namespace",key:"namespace"},...G("use zones")?[{...g.get("headers.zone"),label:"Zone",key:"zone"}]:[],{...g.get("headers.certificate"),label:"Certificate info",key:"certificate"},{...g.get("headers.status"),label:"Status",key:"status"},{...g.get("headers.warnings"),label:"Warnings",key:"warnings",hideLabel:!0},{...g.get("headers.actions"),label:"Actions",key:"actions",hideLabel:!0}],items:m.items,onResize:g.set},{name:e(({row:a})=>[i(b,{"data-action":"",class:"name-link",title:a.name,to:{name:"workload-data-plane-summary-view",params:{mesh:a.mesh,proxy:a.id}}},{default:e(()=>[n(s(a.name),1)]),_:2},1032,["title","to"])]),namespace:e(({row:a})=>[n(s(a.namespace),1)]),zone:e(({row:a})=>[a.zone?(o(),_(b,{key:0,to:{name:"zone-cp-detail-view",params:{zone:a.zone}}},{default:e(()=>[n(s(a.zone),1)]),_:2},1032,["to"])):(o(),u(y,{key:1},[n(s(d("common.collection.none")),1)],64))]),certificate:e(({row:a})=>[a.dataplaneInsight.mTLS?.certificateExpirationTime?(o(),u(y,{key:0},[n(s(d("common.formats.datetime",{value:Date.parse(a.dataplaneInsight.mTLS.certificateExpirationTime)})),1)],64)):(o(),u(y,{key:1},[n(s(d("data-planes.components.data-plane-list.certificate.none")),1)],64))]),status:e(({row:a})=>[i(v,{appearance:d(`common.status.appearance.${a.status}`,void 0,{defaultMessage:"neutral"})},{default:e(()=>[n(s(d(`http.api.value.${a.status}`)),1)]),_:2},1032,["appearance"])]),warnings:e(({row:a})=>[(o(!0),u(y,null,z([[{bool:a.dataplaneInsight.version?.kumaDp?.kumaCpCompatible===!1||a.dataplaneInsight.version?.envoy?.kumaDpCompatible===!1,key:"dp-cp-incompatible"},{bool:a.isCertExpiresSoon,key:"certificate-expires-soon"},{bool:a.isCertExpired,key:"certificate-expired"}].filter(({bool:k})=>k)],k=>(o(),u(y,{key:typeof k},[k.length>0?(o(),_(E,{key:0,name:"warning","data-testid":"warning"},{default:e(()=>[c("ul",null,[(o(!0),u(y,null,z(k,({key:C})=>(o(),u("li",{key:C,"data-testid":`warning-${C}`},s(d(`data-planes.routes.items.warnings.${C}`)),9,P))),128))])]),_:2},1024)):(o(),u(y,{key:1},[n(s(d("common.collection.none")),1)],64))],64))),128))]),actions:e(({row:a})=>[i(I,null,{default:e(()=>[i(b,{to:{name:"data-plane-detail-view",params:{proxy:a.id}}},{default:e(()=>[n(s(d("common.collection.actions.view")),1)]),_:2},1032,["to"])]),_:2},1024)]),_:2},1032,["headers","items","onResize"]),t[14]||(t[14]=n()),r.params.proxy?(o(),_(N,{key:0},{default:e(a=>[i(R,{onClose:k=>r.replace({name:r.name,params:{mesh:r.params.mesh},query:{page:r.params.page,size:r.params.size}})},{default:e(()=>[typeof m<"u"?(o(),_(J(a.Component),{key:0,items:m.items},null,8,["items"])):w("",!0)]),_:2},1032,["onClose"])]),_:2},1024)):w("",!0)]),_:2},1032,["items","total","page","page-size","onChange"])]),_:2},1032,["src"]))),128))]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:3})}}}),te=Q(ee,[["__scopeId","data-v-fbda2b0c"]]);export{te as default};
