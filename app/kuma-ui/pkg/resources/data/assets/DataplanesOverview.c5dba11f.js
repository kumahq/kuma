import{E as D,T as y,ck as O,k as h,co as x,cQ as w,i as s,o as m,c as k,w as r,a as c,j as u,l as o,t as b,e as P,B as N}from"./index.c8e7c817.js";import{L as T}from"./LoadingBox.f2351d0f.js";import{O as L}from"./OnboardingNavigation.70265aab.js";import{O as A,a as B}from"./OnboardingPage.3dbc95d5.js";const C={name:"DataplanesOverview",components:{OnboardingNavigation:L,OnboardingHeading:A,OnboardingPage:B,LoadingBox:T,KTable:y},metaInfo(){return{title:this.title}},data(){return{productName:O,tableHeaders:[{label:"Mesh",key:"mesh"},{label:"Name",key:"name"},{label:"Status",key:"status"}],tableData:{total:0,data:[]},timeout:null}},computed:{title(){return this.tableData.data.length?"Success":"Waiting for DPPs"},description(){return this.tableData.data.length?"The following data plane proxies (DPPs) are connected to the control plane:":null}},created(){this.getAllDataplanes()},beforeUnmount(){clearTimeout(this.timeout)},methods:{async getAllDataplanes(){let d=!1;const p=[];try{const{items:t}=await h.getAllDataplanes({size:10});if(Array.isArray(t))for(let i=0;i<t.length;i++){const{name:e,mesh:n}=t[i],{status:l}=await h.getDataplaneOverviewFromMesh({mesh:n,name:e}).then(g=>x(g.dataplaneInsight));l===w&&(d=!0),p.push({status:l,name:e,mesh:n})}}catch(t){console.error(t)}this.tableData.data=p,this.tableData.total=this.tableData.data.length,d&&(this.timeout=setTimeout(()=>{this.getAllDataplanes()},1e3))}}},F={key:0,class:"justify-center flex my-4"},H={key:1},I={class:"flex justify-center mt-10 mb-16 pb-16"},E={class:"w-full sm:w-3/5 p-4"},S={class:"font-bold mb-4"};function j(d,p,t,i,e,n){const l=s("OnboardingHeading"),g=s("LoadingBox"),_=s("KTable"),f=s("OnboardingNavigation"),v=s("OnboardingPage");return m(),k(v,null,{header:r(()=>[c(l,{title:n.title,description:n.description},null,8,["title","description"])]),content:r(()=>[e.tableData.data.length?(m(),u("div",H,[o("div",I,[o("div",E,[o("p",S,`
              Found `+b(e.tableData.data.length)+` DPPs:
            `,1),P(),c(_,{class:"onboarding-dataplane-table",fetcher:()=>e.tableData,headers:e.tableHeaders,"disable-pagination":"","is-small":""},{status:r(({rowValue:a})=>[o("div",{class:N(["entity-status",{"is-offline":a.toLowerCase()==="offline"||a===!1,"is-online":a.toLowerCase()==="online","is-degraded":a.toLowerCase()==="partially degraded","is-not-available":a.toLowerCase()==="not available"}])},[o("span",null,b(a),1)],2)]),_:1},8,["fetcher","headers"])])])])):(m(),u("div",F,[c(g)]))]),navigation:r(()=>[c(f,{"next-step":"onboarding-completed","previous-step":"onboarding-add-services-code","should-allow-next":e.tableData.data.length>0},null,8,["should-allow-next"])]),_:1})}const U=D(C,[["render",j]]);export{U as default};
