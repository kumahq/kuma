import{B as K,g as U,m as W,e as P,A as G,o as X,p as j,S as H,K as V,q as J,_ as Y,F as Q,f as ee}from"./RouteView.vue_vue_type_script_setup_true_lang-d94c572d.js";import{d as L,j as k,o as l,a as c,w as t,A as h,g as a,b as e,N as te,f as T,X as oe,r as ne,h as i,C as ae,q as O,H as se,t as r,e as M,F as Z,M as ie,R as le,E as I,v as re,I as S}from"./index-41a0c275.js";import{_ as ce}from"./MultizoneInfo.vue_vue_type_script_setup_true_lang-ca299228.js";import{_ as ue}from"./RouteTitle.vue_vue_type_script_setup_true_lang-de6059f8.js";import{_ as de}from"./WarningIcon.vue_vue_type_script_setup_true_lang-b25ebef6.js";const me=L({__name:"DeleteResourceModal",props:{actionButtonText:{type:String,required:!1,default:"Yes, delete"},confirmationText:{type:String,required:!1,default:""},deleteFunction:{type:Function,required:!0},isVisible:{type:Boolean,required:!0},modalId:{type:String,required:!0},title:{type:String,required:!1,default:"Delete"}},emits:["cancel","delete"],setup(N,{emit:m}){const s=N,o=k(!1);async function x(){o.value=!1;try{await s.deleteFunction(),m("delete")}catch{o.value=!0}}return(_,p)=>(l(),c(e(oe),{"action-button-text":s.actionButtonText,"confirmation-text":s.confirmationText,"is-visible":s.isVisible,"modal-id":s.modalId,title:s.title,type:"danger","data-testid":"delete-resource-modal",onCanceled:p[0]||(p[0]=E=>m("cancel")),onProceed:x},{"body-content":t(()=>[h(_.$slots,"body-content"),a(),o.value?(l(),c(e(te),{key:0,class:"mt-4",appearance:"danger","is-dismissible":""},{alertMessage:t(()=>[h(_.$slots,"error")]),_:3})):T("",!0)]),_:3},8,["action-button-text","confirmation-text","is-visible","modal-id","title"]))}}),pe=L({__name:"ZoneListView",props:{page:{type:Number,required:!0},size:{type:Number,required:!0}},setup(N){const m=N,s=K(),{t:o}=U(),x=W(),_=P(),p=k(!1),E=k(!1),y=k("");function B(u){return u.map(b=>{var R;const{name:g}=b,A={name:"zone-cp-detail-view",params:{zone:g}};let d="",v="kubernetes",z=!0;(((R=b.zoneInsight)==null?void 0:R.subscriptions)??[]).forEach(f=>{if(f.version&&f.version.kumaCp){d=f.version.kumaCp.version;const{kumaCpGlobalCompatible:D=!0}=f.version.kumaCp;z=D}f.config&&(v=JSON.parse(f.config).environment)});const C=Q(b);return{detailViewRoute:A,name:g,status:C,zoneCpVersion:d,type:v,warnings:!z}})}async function F(){await x.deleteZone({name:y.value})}function w(){p.value=!p.value}function $(u){w(),y.value=u}function q(u){E.value=(u==null?void 0:u.items.length)>0}return(u,b)=>{const g=ne("RouterLink");return l(),c(Y,{name:"zone-cp-list-view"},{default:t(({route:A})=>[i(G,null,ae({title:t(()=>[O("h1",null,[i(ue,{title:e(o)("zone-cps.routes.items.title"),render:!0},null,8,["title"])])]),default:t(()=>[a(),a(),e(_).getters["config/getMulticlusterStatus"]===!1?(l(),c(ce,{key:0})):(l(),c(X,{key:1,src:`/zone-cps?size=${m.size}&page=${m.page}`,onChange:q},{default:t(({data:d,error:v,refresh:z})=>[i(e(se),null,{body:t(()=>[i(j,{class:"zone-cp-collection","data-testid":"zone-cp-collection",headers:[{label:"Name",key:"name"},{label:"Zone CP Version",key:"zoneCpVersion"},{label:"Type",key:"type"},{label:"Status",key:"status"},{label:"Warnings",key:"warnings",hideLabel:!0},{label:"Actions",key:"actions",hideLabel:!0}],"page-number":m.page,"page-size":m.size,total:d==null?void 0:d.total,items:d?B(d.items):void 0,error:v,"empty-state-title":e(s)("KUMA_ZONE_CREATION_FLOW")==="enabled"?e(o)("zone-cps.empty_state.title"):void 0,"empty-state-message":e(s)("KUMA_ZONE_CREATION_FLOW")==="enabled"?e(o)("zone-cps.empty_state.message"):void 0,"empty-state-cta-to":e(s)("KUMA_ZONE_CREATION_FLOW")==="enabled"?{name:"zone-create-view"}:void 0,"empty-state-cta-text":e(s)("KUMA_ZONE_CREATION_FLOW")==="enabled"?e(o)("zones.index.create"):void 0,onChange:A.update},{name:t(({row:n,rowValue:C})=>[i(g,{to:n.detailViewRoute,"data-testid":"detail-view-link"},{default:t(()=>[a(r(C),1)]),_:2},1032,["to"])]),zoneCpVersion:t(({rowValue:n})=>[a(r(n||e(o)("common.collection.none")),1)]),type:t(({rowValue:n})=>[a(r(n||e(o)("common.collection.none")),1)]),status:t(({rowValue:n})=>[n?(l(),c(H,{key:0,status:n},null,8,["status"])):(l(),M(Z,{key:1},[a(r(e(o)("common.collection.none")),1)],64))]),warnings:t(({rowValue:n})=>[n?(l(),c(e(ie),{key:0,label:e(o)("zone-cps.list.version_mismatch")},{default:t(()=>[i(de,{class:"mr-1",size:e(V),"hide-title":""},null,8,["size"])]),_:1},8,["label"])):(l(),M(Z,{key:1},[a(r(e(o)("common.collection.none")),1)],64))]),actions:t(({row:n})=>[i(e(le),{class:"actions-dropdown","data-testid":"actions-dropdown","kpop-attributes":{placement:"bottomEnd",popoverClasses:"mt-5 more-actions-popover"},width:"150"},{default:t(()=>[i(e(I),{class:"non-visual-button",appearance:"secondary",size:"small"},{icon:t(()=>[i(e(re),{color:e(J),icon:"more",size:e(V)},null,8,["color","size"])]),_:1})]),items:t(()=>[i(e(S),{item:{to:n.detailViewRoute,label:e(o)("common.collection.actions.view")}},null,8,["item"]),a(),e(s)("KUMA_ZONE_CREATION_FLOW")==="enabled"?(l(),c(e(S),{key:0,"has-divider":"","is-dangerous":"","data-testid":"dropdown-delete-item",onClick:C=>$(n.name)},{default:t(()=>[a(r(e(o)("common.collection.actions.delete")),1)]),_:2},1032,["onClick"])):T("",!0)]),_:2},1024)]),_:2},1032,["page-number","page-size","total","items","error","empty-state-title","empty-state-message","empty-state-cta-to","empty-state-cta-text","onChange"])]),_:2},1024),a(),p.value?(l(),c(me,{key:0,"confirmation-text":y.value,"delete-function":F,"is-visible":p.value,"modal-id":"delete-zone-modal","action-button-text":e(o)("zones.delete.confirmModal.proceedText"),title:e(o)("zones.delete.confirmModal.title"),onCancel:w,onDelete:()=>{w(),z()}},{"body-content":t(()=>[O("p",null,r(e(o)("zones.delete.confirmModal.text1",{zoneName:y.value})),1),a(),O("p",null,r(e(o)("zones.delete.confirmModal.text2")),1)]),error:t(()=>[a(r(e(o)("zones.delete.confirmModal.errorText")),1)]),_:2},1032,["confirmation-text","is-visible","action-button-text","title","onDelete"])):T("",!0)]),_:2},1032,["src"]))]),_:2},[e(s)("KUMA_ZONE_CREATION_FLOW")==="enabled"&&e(_).getters["config/getMulticlusterStatus"]&&E.value?{name:"actions",fn:t(()=>[i(e(I),{appearance:"primary",icon:"plus",to:{name:"zone-create-view"},"data-testid":"create-zone-link"},{default:t(()=>[a(r(e(o)("zones.index.create")),1)]),_:1})]),key:"0"}:void 0]),1024)]),_:1})}}});const ve=ee(pe,[["__scopeId","data-v-5a585482"]]);export{ve as default};
