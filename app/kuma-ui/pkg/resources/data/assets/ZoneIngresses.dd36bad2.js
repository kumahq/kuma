import{D as O,cl as B,cm as F,e as Z,M as q,P as M,cn as N,k as g,co as K,s as V,o,j as y,c as m,w as s,a as i,b as H,z as v,l,t as _,F as D,n as z,i as a}from"./index.c8163df9.js";import{g as P}from"./tableDataUtils.81ce466c.js";import{D as R,p as W}from"./patchQueryParam.45d18194.js";import{E as G}from"./EnvoyData.2e55bbd9.js";import{F as j}from"./FrameSkeleton.37abf819.js";import{_ as Q}from"./LabelList.vue_vue_type_style_index_0_lang.17654be9.js";import{M as U}from"./MultizoneInfo.82949c74.js";import{S as X,a as J}from"./SubscriptionHeader.64a00821.js";import{T as Y}from"./TabsWidget.33f56719.js";import"./EmptyBlock.vue_vue_type_script_setup_true_lang.045a908b.js";import"./ErrorBlock.5027dcb1.js";import"./LoadingBlock.vue_vue_type_script_setup_true_lang.c066d224.js";import"./TagList.86529845.js";import"./CodeBlock.vue_vue_type_style_index_0_lang.14084b4c.js";import"./_commonjsHelpers.f037b798.js";const $={name:"ZoneIngresses",components:{AccordionItem:B,AccordionList:F,DataOverview:R,EnvoyData:G,FrameSkeleton:j,LabelList:Q,MultizoneInfo:U,SubscriptionDetails:X,SubscriptionHeader:J,TabsWidget:Y,KButton:Z,KCard:q},props:{offset:{type:Number,required:!1,default:0}},data(){return{isLoading:!0,isEmpty:!1,error:null,empty_state:{title:"No Data",message:"There are no Zone Ingresses present."},tableData:{headers:[{key:"actions",hideLabel:!0},{label:"Status",key:"status"},{label:"Name",key:"name"}],data:[]},tabs:[{hash:"#overview",title:"Overview"},{hash:"#insights",title:"Zone Ingress Insights"},{hash:"#xds-configuration",title:"XDS Configuration"},{hash:"#envoy-stats",title:"Stats"},{hash:"#envoy-clusters",title:"Clusters"}],entity:{},rawData:[],pageSize:M,next:null,subscriptionsReversed:[],pageOffset:this.offset}},computed:{...N({multicluster:"config/getMulticlusterStatus"})},watch:{$route(){this.isLoading=!0,this.isEmpty=!1,this.error=null,this.init(0)}},beforeMount(){this.init(this.offset)},methods:{init(n){this.multicluster&&this.loadData(n)},tableAction(n){const c=n;this.getEntity(c)},async loadData(n){this.pageOffset=n,W("offset",n>0?n:null),this.isLoading=!0,this.isEmpty=!1;const c=this.$route.query.ns||null;try{const{data:t,next:u}=await P({getAllEntities:g.getAllZoneIngressOverviews.bind(g),getSingleEntity:g.getZoneIngressOverview.bind(g),size:this.pageSize,offset:n,query:c});this.next=u,t.length?(this.isEmpty=!1,this.rawData=t,this.getEntity({name:t[0].name}),this.tableData.data=t.map(e=>{const{zoneIngressInsight:r={}}=e;return{...e,...K(r)}})):(this.tableData.data=[],this.isEmpty=!0)}catch(t){t instanceof Error?this.error=t:console.error(t),this.isEmpty=!0}finally{this.isLoading=!1}},getEntity(n){var e,r;const c=["type","name"],t=this.rawData.find(h=>h.name===n.name),u=(r=(e=t==null?void 0:t.zoneIngressInsight)==null?void 0:e.subscriptions)!=null?r:[];this.subscriptionsReversed=Array.from(u).reverse(),this.entity=V(t,c)}}},ee={class:"zoneingresses"},te=l("span",{class:"custom-control-icon"}," \u2190 ",-1);function se(n,c,t,u,e,r){const h=a("MultizoneInfo"),E=a("KButton"),S=a("DataOverview"),I=a("LabelList"),k=a("SubscriptionHeader"),L=a("SubscriptionDetails"),w=a("AccordionItem"),A=a("AccordionList"),x=a("KCard"),f=a("EnvoyData"),T=a("TabsWidget"),C=a("FrameSkeleton");return o(),y("div",ee,[n.multicluster===!1?(o(),m(h,{key:0})):(o(),m(C,{key:1},{default:s(()=>{var b;return[i(S,{"selected-entity-name":(b=e.entity)==null?void 0:b.name,"page-size":e.pageSize,"is-loading":e.isLoading,error:e.error,"empty-state":e.empty_state,"table-data":e.tableData,"table-data-is-empty":e.isEmpty,next:e.next,"page-offset":e.pageOffset,onTableAction:r.tableAction,onLoadData:r.loadData},{additionalControls:s(()=>[n.$route.query.ns?(o(),m(E,{key:0,class:"back-button",appearance:"primary",to:{name:"zoneingresses"}},{default:s(()=>[te,H(" View All ")]),_:1})):v("",!0)]),_:1},8,["selected-entity-name","page-size","is-loading","error","empty-state","table-data","table-data-is-empty","next","page-offset","onTableAction","onLoadData"]),e.isEmpty===!1?(o(),m(T,{key:0,"has-error":e.error!==null,"is-loading":e.isLoading,tabs:e.tabs,"initial-tab-override":"overview"},{tabHeader:s(()=>[l("div",null,[l("h3",null," Zone Ingress: "+_(e.entity.name),1)])]),overview:s(()=>[i(I,null,{default:s(()=>[l("div",null,[l("ul",null,[(o(!0),y(D,null,z(e.entity,(p,d)=>(o(),y("li",{key:d},[l("h4",null,_(d),1),l("p",null,_(p),1)]))),128))])])]),_:1})]),insights:s(()=>[i(x,{"border-variant":"noBorder"},{body:s(()=>[i(A,{"initially-open":0},{default:s(()=>[(o(!0),y(D,null,z(e.subscriptionsReversed,(p,d)=>(o(),m(w,{key:d},{"accordion-header":s(()=>[i(k,{details:p},null,8,["details"])]),"accordion-content":s(()=>[i(L,{details:p,"is-discovery-subscription":""},null,8,["details"])]),_:2},1024))),128))]),_:1})]),_:1})]),"xds-configuration":s(()=>[i(f,{"data-path":"xds","zone-ingress-name":e.entity.name,"query-key":"envoy-data-zone-ingress"},null,8,["zone-ingress-name"])]),"envoy-stats":s(()=>[i(f,{"data-path":"stats","zone-ingress-name":e.entity.name,"query-key":"envoy-data-zone-ingress"},null,8,["zone-ingress-name"])]),"envoy-clusters":s(()=>[i(f,{"data-path":"clusters","zone-ingress-name":e.entity.name,"query-key":"envoy-data-zone-ingress"},null,8,["zone-ingress-name"])]),_:1},8,["has-error","is-loading","tabs"])):v("",!0)]}),_:1}))])}const _e=O($,[["render",se]]);export{_e as default};
