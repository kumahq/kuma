import{d as $,r as c,p as _,o as i,w as a,b as p,e as r,l as s,M as A,L as g,t as l,c as m,N as y,a as N,q as B,m as E,Y as F}from"./index-BLmUgYvn.js";const M={scope:"row"},D={scope:"row"},L={scope:"row"},j=$({__name:"SubscriptionSummaryView",props:{data:{},routeName:{}},setup(v){const w=v;return(S,e)=>{const X=c("XSelect"),b=c("XLayout"),k=c("XTable"),C=c("XAlert"),x=c("XI18n"),I=c("DataCollection"),R=c("XCodeBlock"),T=c("AppView"),V=c("RouteView");return i(),_(V,{name:w.routeName,params:{subscription:"",codeSearch:"",codeFilter:!1,codeRegExp:!1,output:String}},{default:a(({route:d,t:o})=>[p(I,{items:w.data,predicate:n=>n.id===d.params.subscription},{item:a(({item:n})=>[p(T,null,{title:a(()=>[s("h2",null,l(n.zoneInstanceId??n.globalInstanceId??n.controlPlaneInstanceId),1)]),default:a(()=>[e[13]||(e[13]=r()),p(b,{type:"stack"},{default:a(()=>[s("header",null,[p(b,{type:"separated",justify:"end"},{default:a(()=>[p(X,{label:o("subscriptions.routes.item.format"),selected:d.params.output,onChange:t=>{d.update({output:t})}},A({_:2},[g(["structured","yaml"],t=>({name:`${t}-option`,fn:a(()=>[r(l(o(`subscriptions.routes.item.formats.${t}`)),1)])}))]),1032,["label","selected","onChange"])]),_:2},1024)]),e[12]||(e[12]=r()),d.params.output==="structured"?(i(),_(b,{key:0,type:"stack","data-testid":"structured-view"},{default:a(()=>[p(k,{variant:"kv"},{default:a(()=>[(i(!0),m(y,null,g([[o("http.api.property.version"),n.version?.kumaCp?.version??"-"],[o("http.api.property.connectTime"),o("common.formats.datetime",{value:Date.parse(n.connectTime??"")})],...n.disconnectTime?[[o("http.api.property.disconnectTime"),o("common.formats.datetime",{value:Date.parse(n.disconnectTime)})]]:[],[o("subscriptions.routes.item.headers.responses"),`${n.status.total.responsesSent}/${n.status.total.responsesAcknowledged}`],...["zoneInstanceId","globalInstanceId","controlPlaneInstanceId"].reduce((t,u)=>(n[u]&&t.push([o(`http.api.property.${u}`),n[u]]),t),[]),[o("http.api.property.id"),n.id]],([t,u])=>(i(),m("tr",{key:t},[s("th",M,l(t),1),e[0]||(e[0]=r()),s("td",null,l(u),1)]))),128))]),_:2},1024),e[11]||(e[11]=r()),p(I,{items:Object.entries(n.status.acknowledgements??{})},{empty:a(()=>[p(C,{variant:"info"},{default:a(()=>[r(l(o("common.detail.subscriptions.no_stats",{id:n.id})),1)]),_:2},1024)]),default:a(({items:t})=>[p(b,{type:"stack"},{default:a(()=>[N(S.$slots,"default"),e[9]||(e[9]=r()),(i(!0),m(y,null,g([t.filter(([u,f])=>f.responsesRejected>0)],u=>(i(),m(y,{key:typeof u},[u.length>0?(i(),m(y,{key:0},[p(C,{variant:n.disconnectTime?"info":"warning"},{default:a(()=>[p(x,{path:"subscriptions.notifications.with-nacks"})]),_:1},8,["variant"]),e[7]||(e[7]=r()),p(k,{variant:"kv"},{default:a(()=>[s("thead",null,[s("tr",null,[s("th",null,l(o("subscriptions.routes.item.headers.type")),1),e[1]||(e[1]=r()),s("th",null,l(o("subscriptions.routes.item.headers.stat")),1)])]),e[3]||(e[3]=r()),s("tbody",null,[(i(!0),m(y,null,g(u,([f,h])=>(i(),m("tr",{key:f},[s("th",D,l(o(`http.api.property.${f}`)),1),e[2]||(e[2]=r()),s("td",null,l(h.responsesRejected),1)]))),128))])]),_:2},1024),e[8]||(e[8]=r()),p(k,{variant:"kv"},{default:a(()=>[s("thead",null,[s("tr",null,[s("th",null,l(o("subscriptions.routes.item.headers.type")),1),e[4]||(e[4]=r()),s("th",null,l(o("subscriptions.routes.item.headers.stat")),1)])]),e[6]||(e[6]=r()),s("tbody",null,[(i(!0),m(y,null,g(t,([f,h])=>(i(),m("tr",{key:f},[s("th",L,l(o(`http.api.property.${f}`)),1),e[5]||(e[5]=r()),s("td",null,l(h.responsesSent)+"/"+l(h.responsesAcknowledged),1)]))),128))])]),_:2},1024)],64)):B("",!0)],64))),128))]),_:2},1024)]),_:2},1032,["items"])]),_:2},1024)):(i(),_(R,{key:1,language:"yaml",code:E(F).stringify(n.$raw),"is-searchable":"",query:d.params.codeSearch,"is-filter-mode":d.params.codeFilter,"is-reg-exp-mode":d.params.codeRegExp,onQueryChange:t=>d.update({codeSearch:t}),onFilterModeChange:t=>d.update({codeFilter:t}),onRegExpModeChange:t=>d.update({codeRegExp:t})},null,8,["code","query","is-filter-mode","is-reg-exp-mode","onQueryChange","onFilterModeChange","onRegExpModeChange"]))]),_:2},1024)]),_:2},1024)]),_:2},1032,["items","predicate"])]),_:3},8,["name"])}}});export{j as default};
