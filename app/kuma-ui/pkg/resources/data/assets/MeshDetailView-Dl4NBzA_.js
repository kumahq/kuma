import{d as Z,p as _,o as i,w as e,b as t,e as n,r,m as h,Q as z,q as L,c as k,L as C,N as w,O as q,t as d,K as T,l as K,R as A,F as I,M as ee,Y as P,H as j,y as te,_ as ae}from"./index-AyKB-3zh.js";import{S as se}from"./SummaryView-C8UFcv-V.js";import{K as ne}from"./kri-CjUta6FR.js";const oe=Z({__name:"MeshDetailView",props:{mesh:{}},setup(F){const c=F;return(O,a)=>{const Y=r("RouteTitle"),M=r("XI18n"),S=r("XNotification"),X=r("XAction"),v=r("XBadge"),g=r("XLayout"),$=r("XAboutCard"),E=r("DataCollection"),R=r("XCard"),D=r("DataSource"),H=r("XSelect"),N=r("XCodeBlock"),x=r("DataLoader"),Q=r("RouterView"),G=r("AppView"),J=r("RouteView");return i(),_(J,{name:"mesh-detail-view",params:{mesh:"",environment:String}},{default:e(({route:l,t:m,uri:b,me:V})=>[t(Y,{title:m("meshes.routes.overview.title"),render:!1},null,8,["title"]),a[18]||(a[18]=n()),t(D,{src:b(h(j),"/mesh-insights/:name",{name:l.params.mesh})},{default:e(({data:p})=>[t(D,{src:b(h(z),"/meshes/:mesh/meshidentities",{mesh:l.params.mesh})},{default:e(({data:f})=>[t(D,{src:b(h(z),"/meshes/:mesh/meshtrusts",{mesh:l.params.mesh})},{default:e(({data:u})=>[t(G,{docs:m("meshes.href.docs"),notifications:!0},{default:e(()=>[t(x,{data:[f,u]},{default:e(()=>[t(S,{notify:!c.mesh.mtlsBackend&&f.items.length===0,uri:`meshes.notifications.mtls-warning:${c.mesh.id}`},{default:e(()=>[t(M,{path:"meshes.notifications.mtls-warning"})]),_:2},1032,["notify","uri"]),a[15]||(a[15]=n()),t(S,{notify:O.mesh.meshServices.mode==="Disabled",uri:`meshes.notifications.mesh-service-activation:${l.params.mesh}`,variant:"info"},{default:e(()=>[t(M,{path:"meshes.notifications.mesh-service-activation"})]),_:2},1032,["notify","uri"]),a[16]||(a[16]=n()),t(g,{type:"stack"},{default:e(()=>{var B;return[t($,{title:m("meshes.routes.item.about.title"),created:c.mesh.creationTime,modified:c.mesh.modificationTime,class:"about-section"},{default:e(()=>[t(g,null,{default:e(()=>[t(g,{type:"separated"},{default:e(()=>[(i(),k(w,null,C(["MeshTrafficPermission","MeshMetric","MeshAccessLog","MeshTrace"],s=>{var o;return i(),k(w,{key:s},[(i(!0),k(w,null,C([((o=p==null?void 0:p.policies)==null?void 0:o[s])??{total:0}],y=>(i(),k(w,{key:typeof y},[t(S,{notify:s==="MeshTrafficPermission"&&c.mesh.mtlsBackend&&y.total===0,uri:`meshes.notifications.mtp-warning:${c.mesh.id}`},{default:e(()=>[t(M,{path:"meshes.notifications.mtp-warning"})]),_:2},1032,["notify","uri"]),a[1]||(a[1]=n()),t(q,{layout:"horizontal"},{title:e(()=>[t(X,{to:{name:"policy-list-view",params:{mesh:l.params.mesh,policyPath:`${s.toLowerCase()}s`}}},{default:e(()=>[n(d(s),1)]),_:2},1032,["to"])]),body:e(()=>[t(v,{appearance:y.total>0?"success":"neutral"},{default:e(()=>[n(d(y.total>0?m("meshes.detail.enabled"):m("meshes.detail.disabled")),1)]),_:2},1032,["appearance"])]),_:2},1024)],64))),128))],64)}),64)),a[5]||(a[5]=n()),t(q,{layout:"horizontal","data-testid":"mesh-mtls"},{title:e(()=>[n(d(m("http.api.property.mtls")),1)]),body:e(()=>[t(g,{type:"separated"},{default:e(()=>{var s;return[c.mesh.mtlsBackend?(i(),_(v,{key:0,appearance:"info"},{default:e(()=>[n(d(c.mesh.mtlsBackend.type)+" / "+d(c.mesh.mtlsBackend.name),1)]),_:1})):L("",!0),a[2]||(a[2]=n()),(i(!0),k(w,null,C(f==null?void 0:f.items,o=>(i(),_(X,{key:o.name,to:{name:"mesh-identity-summary-view",params:{name:o.name.toLocaleLowerCase()}}},{default:e(()=>[t(v,{appearance:"info"},{default:e(()=>[n(`
                                  MeshIdentity / `+d(o.name),1)]),_:2},1024)]),_:2},1032,["to"]))),128)),a[3]||(a[3]=n()),!c.mesh.mtlsBackend&&!((s=f==null?void 0:f.items)!=null&&s.length)?(i(),_(v,{key:1,appearance:"neutral"},{default:e(()=>[n(d(m("meshes.detail.disabled")),1)]),_:2},1024)):L("",!0)]}),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1032,["title","created","modified"]),a[12]||(a[12]=n()),(B=u==null?void 0:u.items)!=null&&B.length?(i(),_(R,{key:0,"data-testid":"mesh-trusts-listing"},{title:e(()=>[n(d(m("meshes.routes.item.mesh-trusts.title")),1)]),default:e(()=>[a[8]||(a[8]=n()),t(E,{type:"mesh-trusts",items:u==null?void 0:u.items},{default:e(()=>[t(T,{type:"mesh-trusts-collection",items:u==null?void 0:u.items,headers:[{...V.get("headers.identity"),label:m("meshes.routes.item.mesh-trusts.name"),key:"name"},{...V.get("headers.type"),label:m("meshes.routes.item.mesh-trusts.trust-domain"),key:"trustDomain"},{...V.get("headers.origin"),label:m("meshes.routes.item.mesh-trusts.origin"),key:"origin"}],onResize:V.set},{name:e(({row:s})=>[t(X,{class:"name-link",title:s.name,to:{name:"mesh-trust-summary-view",params:{name:s.name.toLocaleLowerCase()},query:{environment:l.params.environment}},"data-action":""},{default:e(()=>[K("b",null,d(s.name),1)]),_:2},1032,["title","to"])]),trustDomain:e(({row:s})=>[t(v,{appearance:"decorative"},{default:e(()=>[n(d(s.spec.trustDomain),1)]),_:2},1024)]),origin:e(({row:s})=>[t(X,{to:{name:"mesh-identity-summary-view",params:{name:h(ne).fromString(s.spec.origin.kri).name}},"data-action":""},{default:e(()=>[t(v,{appearance:"decorative"},{default:e(()=>[n(d(s.spec.origin.kri),1)]),_:2},1024)]),_:2},1032,["to"])]),_:2},1032,["items","headers","onResize"])]),_:2},1032,["items"])]),_:2},1024)):L("",!0),a[13]||(a[13]=n()),t(R,null,{default:e(()=>[t(g,{type:"columns",class:"columns-with-borders"},{default:e(()=>[t(A,{total:(p==null?void 0:p.services.total)??0,"data-testid":"services-status"},{title:e(()=>[n(d(m("meshes.detail.services")),1)]),_:2},1032,["total"]),a[9]||(a[9]=n()),t(A,{total:(p==null?void 0:p.dataplanesByType.standard.total)??0,online:(p==null?void 0:p.dataplanesByType.standard.online)??0,"data-testid":"data-plane-proxies-status"},{title:e(()=>[n(d(m("meshes.detail.data_plane_proxies")),1)]),_:2},1032,["total","online"]),a[10]||(a[10]=n()),t(D,{src:b(h(I),"/policy-types",{})},{default:e(({data:s})=>[(i(!0),k(w,null,C([s==null?void 0:s.policyTypes.map(o=>o.name)],o=>(i(),_(A,{key:typeof o,total:Object.entries((p==null?void 0:p.resources)||{}).reduce((y,[U,{total:W}])=>(o||[]).includes(U)?y+W:y,0),"data-testid":"policies-status"},{title:e(()=>[n(d(m("meshes.detail.policies")),1)]),_:2},1032,["total"]))),128))]),_:2},1032,["src"])]),_:2},1024)]),_:2},1024),a[14]||(a[14]=n()),t(R,null,{default:e(()=>[t(g,null,{default:e(()=>[t(g,{type:"separated",justify:"end"},{default:e(()=>[(i(),k(w,null,C([["universal","k8s"]],s=>K("div",{key:typeof s},[t(H,{label:m("meshes.routes.item.format"),selected:l.params.environment,onChange:o=>{l.update({environment:o})},onVnodeBeforeMount:o=>{var y;return((y=o==null?void 0:o.props)==null?void 0:y.selected)&&s.includes(o.props.selected)&&o.props.selected!==l.params.environment&&l.update({environment:o.props.selected})}},ee({_:2},[C(s,o=>({name:`${o}-option`,fn:e(()=>[n(d(m(`meshes.routes.item.formats.${o}`)),1)])}))]),1032,["label","selected","onChange","onVnodeBeforeMount"])])),64))]),_:2},1024),a[11]||(a[11]=n()),l.params.environment==="universal"?(i(),_(N,{key:0,"data-testid":"codeblock-yaml-universal",language:"yaml",code:h(P).stringify(c.mesh.config)},null,8,["code"])):(i(),_(x,{key:1,src:b(h(j),"/meshes/:name/as/kubernetes",{name:l.params.mesh})},{default:e(({data:s})=>[t(N,{"data-testid":"codeblock-yaml-k8s",language:"yaml",code:h(P).stringify(s)},null,8,["code"])]),_:2},1032,["src"]))]),_:2},1024)]),_:2},1024)]}),_:2},1024),a[17]||(a[17]=n()),t(Q,null,{default:e(B=>[B.route.name!==l.name?(i(),_(se,{key:0,onClose:s=>l.replace({name:"mesh-detail-view",params:{mesh:l.params.mesh},query:{environment:l.params.environment}})},{default:e(()=>[(i(),_(te(B.Component),{"mesh-identities":f==null?void 0:f.items,"mesh-trusts":u==null?void 0:u.items},null,8,["mesh-identities","mesh-trusts"]))]),_:2},1032,["onClose"])):L("",!0)]),_:2},1024)]),_:2},1032,["data"])]),_:2},1032,["docs"])]),_:2},1032,["src"])]),_:2},1032,["src"])]),_:2},1032,["src"])]),_:1})}}}),re=ae(oe,[["__scopeId","data-v-24804e50"]]);export{re as default};
