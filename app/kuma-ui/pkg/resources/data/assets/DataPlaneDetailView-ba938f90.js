import{d as O,l as z,z as L,R as C,a as y,o as s,b as f,w as e,e as i,a5 as S,f as t,p as d,a6 as _,t as n,q as D,a7 as H,K as F,v as P,c as r,F as m,D as T,_ as $}from"./index-d70552e2.js";import{S as U}from"./StatusBadge-45879546.js";import{T as B}from"./TagList-21cba238.js";import{_ as W}from"./SubscriptionList.vue_vue_type_script_setup_true_lang-c01901b9.js";import{a as Z,d as K,b as j,c as q,C as G,I as X}from"./dataplane-0a086c06.js";import"./AccordionList-88b610c2.js";const J=["data-testid","innerHTML"],Q={class:"stack","data-testid":"detail-view-details"},Y={class:"columns"},tt={class:"status-with-reason"},et={class:"columns"},at=["innerHTML"],nt={key:0},st=O({__name:"DataPlaneDetailView",props:{data:{}},setup(M){const{formatIsoDate:V}=z(),x=L(),l=M,w=C(()=>Z(l.data.dataplane,l.data.dataplaneInsight)),E=C(()=>K(l.data.dataplane)),R=C(()=>j(l.data.dataplaneInsight)),A=C(()=>{var v,b;const k=((v=l.data.dataplaneInsight)==null?void 0:v.subscriptions)??[];if(k.length===0)return[];const h=k[k.length-1];if(!("version"in h)||!h.version)return[];const u=h.version,p=[];if(u.kumaDp&&u.envoy){const a=q(u);a.kind!==G&&a.kind!==X&&p.push(a)}const g=(b=l.data.dataplaneInsight)==null?void 0:b.mTLS;return g&&Date.now()>new Date(g==null?void 0:g.certificateExpirationTime).getTime()&&p.push({kind:"CERT_EXPIRED",payload:{}}),x("use zones")&&K(l.data.dataplane).find(I=>I.label==="kuma.io/zone")&&typeof u.kumaDp.kumaCpCompatible=="boolean"&&!u.kumaDp.kumaCpCompatible&&p.push({kind:"INCOMPATIBLE_ZONE_CP_AND_KUMA_DP_VERSIONS",payload:{kumaDp:u.kumaDp.version}}),p});return(k,h)=>{const u=y("KTooltip"),p=y("KCard"),g=y("KAlert"),v=y("AppView"),b=y("RouteView");return s(),f(b,{name:"data-plane-detail-view"},{default:e(({t:a})=>[i(v,null,S({default:e(()=>{var c,I;return[t(),d("div",Q,[i(p,null,{body:e(()=>[d("div",Y,[i(_,null,{title:e(()=>[t(n(a("http.api.property.status")),1)]),body:e(()=>[d("div",tt,[i(U,{status:w.value.status},null,8,["status"]),t(),w.value.reason.length>0?(s(),f(u,{key:0,label:w.value.reason.join(", "),class:"reason-tooltip"},{default:e(()=>[i(D(H),{size:D(F),"hide-title":""},null,8,["size"])]),_:1},8,["label"])):P("",!0)])]),_:2},1024),t(),i(_,null,{title:e(()=>[t(n(a("http.api.property.tags")),1)]),body:e(()=>[E.value.length>0?(s(),f(B,{key:0,tags:E.value},null,8,["tags"])):(s(),r(m,{key:1},[t(n(a("common.detail.none")),1)],64))]),_:2},1024),t(),i(_,null,{title:e(()=>[t(n(a("http.api.property.dependencies")),1)]),body:e(()=>[R.value!==null?(s(),f(B,{key:0,tags:R.value},null,8,["tags"])):(s(),r(m,{key:1},[t(n(a("common.detail.none")),1)],64))]),_:2},1024)])]),_:2},1024),t(),d("div",null,[d("h2",null,n(a("data-planes.routes.item.mtls.title")),1),t(),(c=l.data.dataplaneInsight)!=null&&c.mTLS?(s(!0),r(m,{key:0},T([l.data.dataplaneInsight.mTLS],o=>(s(),f(p,{key:o,class:"mt-4"},{body:e(()=>[d("div",et,[i(_,null,{title:e(()=>[t(n(a("data-planes.routes.item.mtls.expiration_time.title")),1)]),body:e(()=>[t(n(D(V)(o.certificateExpirationTime)),1)]),_:2},1024),t(),i(_,null,{title:e(()=>[t(n(a("data-planes.routes.item.mtls.generation_time.title")),1)]),body:e(()=>[t(n(D(V)(o.lastCertificateRegeneration)),1)]),_:2},1024),t(),i(_,null,{title:e(()=>[t(n(a("data-planes.routes.item.mtls.regenerations.title")),1)]),body:e(()=>[t(n(a("common.formats.integer",{value:o.certificateRegenerations})),1)]),_:2},1024),t(),i(_,null,{title:e(()=>[t(n(a("data-planes.routes.item.mtls.issued_backend.title")),1)]),body:e(()=>[t(n(o.issuedBackend),1)]),_:2},1024),t(),i(_,null,{title:e(()=>[t(n(a("data-planes.routes.item.mtls.supported_backends.title")),1)]),body:e(()=>[d("ul",null,[(s(!0),r(m,null,T(o.supportedBackends,N=>(s(),r("li",{key:N},n(N),1))),128))])]),_:2},1024)])]),_:2},1024))),128)):(s(),f(g,{key:1,class:"mt-4",appearance:"warning"},{alertMessage:e(()=>[d("div",{innerHTML:a("data-planes.routes.item.mtls.disabled")},null,8,at)]),_:2},1024))]),t(),(s(!0),r(m,null,T([((I=l.data.dataplaneInsight)==null?void 0:I.subscriptions)??[]],o=>(s(),r(m,{key:o},[o.length>0?(s(),r("div",nt,[d("h2",null,n(a("data-planes.routes.item.subscriptions.title")),1),t(),i(p,{class:"mt-4"},{body:e(()=>[i(W,{subscriptions:o},null,8,["subscriptions"])]),_:2},1024)])):P("",!0)],64))),128))])]}),_:2},[A.value.length>0?{name:"notifications",fn:e(()=>[d("ul",null,[(s(!0),r(m,null,T(A.value,c=>(s(),r("li",{key:c.kind,"data-testid":`warning-${c.kind}`,innerHTML:a(`common.warnings.${c.kind}`,c.payload)},null,8,J))),128)),t()])]),key:"0"}:void 0]),1024)]),_:1})}}});const pt=$(st,[["__scopeId","data-v-d53faf06"]]);export{pt as default};
