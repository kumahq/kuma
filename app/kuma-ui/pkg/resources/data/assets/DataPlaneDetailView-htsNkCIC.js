import{d as nt,a2 as ot,a8 as st,r as m,p,o as i,w as t,b as a,m as R,ap as it,c,e as n,N as b,L as k,q as x,O as y,S as rt,l as C,t as d,M as dt,y as lt,_ as pt}from"./index-DjQ5a8RZ.js";import{S as ut}from"./SummaryView-7GTgdTCD.js";import{T as mt}from"./TagList-CUH2pltQ.js";import{C as F,a as G,b as M}from"./ConnectionTraffic-CcPXoWbx.js";const yt=nt({__name:"DataPlaneDetailView",props:{data:{},mesh:{}},setup(H){const T=ot(),o=H;return st("data-plane-overview",o.data),(_t,e)=>{const g=m("XI18n"),J=m("XNotification"),I=m("XIcon"),X=m("DataCollection"),u=m("XLayout"),z=m("XAction"),v=m("XBadge"),K=m("XCopyButton"),L=m("XAboutCard"),V=m("XEmptyState"),Q=m("XCard"),U=m("RouterView"),W=m("AppView"),Y=m("DataLoader"),Z=m("RouteView");return i(),p(Z,{params:{inactive:Boolean,mesh:"",proxy:"",proxyType:"",subscription:""},name:"data-plane-detail-view"},{default:t(({route:_,t:l,can:B,uri:tt})=>[a(Y,{src:tt(R(it),"/meshes/:mesh/dataplanes/:name/layout",{mesh:_.params.mesh,name:_.params.proxy})},{default:t(({data:D,refresh:at,error:et})=>[a(W,{notifications:!0},{default:t(()=>{var h,N,S,$,E,A,q,O,P,j;return[(i(!0),c(b,null,k([{bool:((N=(h=o.data.dataplaneInsight.version)==null?void 0:h.kumaDp)==null?void 0:N.kumaCpCompatible)===!1,key:"dp-cp-incompatible",params:{kumaDp:((S=o.data.dataplaneInsight.version)==null?void 0:S.kumaDp.version)??""}},{bool:((E=($=o.data.dataplaneInsight.version)==null?void 0:$.envoy)==null?void 0:E.kumaDpCompatible)===!1,key:"envoy-dp-incompatible",params:{envoy:((A=o.data.dataplaneInsight.version)==null?void 0:A.envoy.version)??"",kumaDp:((q=o.data.dataplaneInsight.version)==null?void 0:q.kumaDp.version)??""}},{bool:!!(B("use zones")&&o.data.zone&&((P=(O=o.data.dataplaneInsight.version)==null?void 0:O.kumaDp)==null?void 0:P.kumaCpCompatible)===!1),key:"dp-zone-cp-incompatible",params:{kumaDp:((j=o.data.dataplaneInsight.version)==null?void 0:j.kumaDp.version)??""}},{bool:o.data.isCertExpiresSoon,key:"certificate-expires-soon"},{bool:o.data.isCertExpired,key:"certificate-expired"},{bool:!o.data.dataplaneInsight.mTLS,key:"no-mtls"},{bool:!B("use transparent-proxying",o.data),key:"networking-transparent-proxying",variant:"info"}],({bool:r,key:s,params:f,variant:w})=>(i(),p(J,{key:s,notify:r,"data-testid":`warning-${s}`,uri:`data-planes.notifications.${s}.${o.data.id}`,variant:w},{default:t(()=>[a(g,{path:`data-planes.notifications.${s}`,params:Object.fromEntries(Object.entries(f??{}))},null,8,["path","params"])]),_:2},1032,["notify","data-testid","uri","variant"]))),128)),e[43]||(e[43]=n()),a(u,{type:"stack","data-testid":"dataplane-details"},{default:t(()=>[a(L,{title:l("data-planes.routes.item.about.title"),created:o.data.creationTime,modified:o.data.modificationTime,class:"about-section"},{default:t(()=>[a(u,null,{default:t(()=>[a(u,{type:"separated"},{default:t(()=>[a(y,{layout:"horizontal"},{title:t(()=>[n(d(l("http.api.property.status")),1)]),body:t(()=>[a(u,{type:"separated"},{default:t(()=>[a(rt,{status:o.data.status},null,8,["status"]),e[0]||(e[0]=n()),o.data.dataplaneType==="standard"?(i(),p(X,{key:0,items:o.data.dataplane.networking.inbounds,predicate:r=>r.state!=="Ready",empty:!1},{default:t(({items:r})=>[a(I,{name:"info"},{default:t(()=>[C("ul",null,[(i(!0),c(b,null,k(r,s=>(i(),c("li",{key:`${s.service}:${s.port}`},d(l("data-planes.routes.item.unhealthy_inbound",{service:s.service,port:s.port})),1))),128))])]),_:2},1024)]),_:2},1032,["items","predicate"])):x("",!0)]),_:2,__:[0]},1024)]),_:2,__:[1]},1024),e[7]||(e[7]=n()),B("use zones")&&o.data.zone?(i(),p(y,{key:0,layout:"horizontal"},{title:t(()=>[n(d(l("http.api.property.zone")),1)]),body:t(()=>[a(v,{appearance:"decorative"},{default:t(()=>[a(z,{to:{name:"zone-cp-detail-view",params:{zone:o.data.zone}}},{default:t(()=>[n(d(o.data.zone),1)]),_:1},8,["to"])]),_:1})]),_:2,__:[2]},1024)):x("",!0),e[8]||(e[8]=n()),a(y,{layout:"horizontal"},{title:t(()=>[n(d(l("http.api.property.type")),1)]),body:t(()=>[a(v,{appearance:"decorative"},{default:t(()=>[n(d(l(`data-planes.type.${o.data.dataplaneType}`)),1)]),_:2},1024)]),_:2,__:[3]},1024),e[9]||(e[9]=n()),o.data.namespace.length>0?(i(),p(y,{key:1,layout:"horizontal"},{title:t(()=>[n(d(l("http.api.property.namespace")),1)]),body:t(()=>[a(v,{appearance:"decorative"},{default:t(()=>[n(d(o.data.namespace),1)]),_:1})]),_:2,__:[4]},1024)):x("",!0),e[10]||(e[10]=n()),a(y,{layout:"horizontal"},{title:t(()=>[n(d(l("http.api.property.address")),1)]),body:t(()=>[a(K,{variant:"badge",format:"default",text:`${o.data.dataplane.networking.address}`},null,8,["text"])]),_:2,__:[5]},1024),e[11]||(e[11]=n()),o.data.dataplane.networking.gateway?(i(),p(y,{key:2,layout:"horizontal"},{title:t(()=>[n(d(l("http.api.property.tags")),1)]),body:t(()=>[a(mt,{tags:o.data.dataplane.networking.gateway.tags},null,8,["tags"])]),_:2,__:[6]},1024)):x("",!0)]),_:2,__:[7,8,9,10,11]},1024),e[29]||(e[29]=n()),o.data.dataplaneInsight.mTLS?(i(),p(u,{key:0,"data-testid":"dataplane-mtls",class:"about-subsection",size:"small"},{default:t(()=>[C("h3",null,d(l("data-planes.routes.item.mtls.title")),1),e[21]||(e[21]=n()),a(u,{size:"small"},{default:t(()=>[(i(!0),c(b,null,k([o.data.dataplaneInsight.mTLS],r=>(i(),c(b,{key:r},[a(u,{type:"separated"},{default:t(()=>[a(y,{layout:"horizontal"},{title:t(()=>[a(g,{path:"data-planes.routes.item.mtls.generation_time.title"})]),body:t(()=>[a(v,{appearance:"neutral"},{default:t(()=>[n(d(l("common.formats.datetime",{value:Date.parse(r.lastCertificateRegeneration)})),1)]),_:2},1024)]),_:2,__:[12]},1024),e[14]||(e[14]=n()),a(y,{layout:"horizontal"},{title:t(()=>[a(g,{path:"data-planes.routes.item.mtls.expiration_time.title"})]),body:t(()=>[a(v,{appearance:"neutral"},{default:t(()=>[n(d(l("common.formats.datetime",{value:Date.parse(r.certificateExpirationTime)})),1)]),_:2},1024)]),_:2,__:[13]},1024)]),_:2,__:[14]},1024),e[20]||(e[20]=n()),a(u,{type:"separated"},{default:t(()=>[a(y,{layout:"horizontal"},{title:t(()=>[n(d(l("data-planes.routes.item.mtls.regenerations.title")),1)]),body:t(()=>[a(v,{appearance:"info"},{default:t(()=>[n(d(l("common.formats.integer",{value:r.certificateRegenerations})),1)]),_:2},1024)]),_:2,__:[15]},1024),e[18]||(e[18]=n()),a(y,{layout:"horizontal"},{title:t(()=>[n(d(l("data-planes.routes.item.mtls.issued_backend.title")),1)]),body:t(()=>[a(v,{appearance:"decorative"},{default:t(()=>[n(d(r.issuedBackend),1)]),_:2},1024)]),_:2,__:[16]},1024),e[19]||(e[19]=n()),a(y,{layout:"horizontal"},{title:t(()=>[n(d(l("data-planes.routes.item.mtls.supported_backends.title")),1)]),body:t(()=>[a(u,{type:"separated",truncate:""},{default:t(()=>[(i(!0),c(b,null,k(r.supportedBackends,s=>(i(),p(v,{key:s,appearance:s===r.issuedBackend?"decorative":"info"},{default:t(()=>[n(d(s),1)]),_:2},1032,["appearance"]))),128))]),_:2},1024)]),_:2,__:[17]},1024)]),_:2,__:[18,19]},1024)],64))),128))]),_:2},1024)]),_:2,__:[21]},1024)):x("",!0),e[30]||(e[30]=n()),o.data.dataplaneInsight.subscriptions.length>0?(i(),p(u,{key:1,"data-testid":"about-dataplane-subscriptions",class:"about-subsection"},{default:t(()=>[a(u,{type:"separated"},{default:t(()=>[C("h3",null,d(l("data-planes.routes.item.subscriptions.title")),1),e[22]||(e[22]=n()),a(z,{"data-action":"",appearance:"anchor",to:{name:"data-plane-subscriptions-summary-view",params:{mesh:_.params.mesh,proxy:_.params.proxy},query:{inactive:_.params.inactive}}},{default:t(()=>[n(`
                    (`+d(l("data-planes.routes.item.xds.show-details"))+`)
                  `,1)]),_:2},1032,["to"])]),_:2,__:[22]},1024),e[28]||(e[28]=n()),(i(!0),c(b,null,k([[...o.data.dataplaneInsight.subscriptions].reverse()],r=>(i(),p(u,{key:typeof r,type:"separated"},{default:t(()=>[(i(!0),c(b,null,k([r.find(s=>!s.disconnectTime)??r[0]],s=>(i(),c(b,{key:s.id},[!s.disconnectTime&&s.connectTime?(i(),c(b,{key:0},[a(y,{layout:"horizontal"},{title:t(()=>[a(g,{path:"data-planes.routes.item.xds.connected"})]),body:t(()=>[a(v,{appearance:"neutral"},{default:t(()=>[n(d(l("common.formats.datetime",{value:Date.parse(s.connectTime)})),1)]),_:2},1024)]),_:2,__:[23]},1024),e[26]||(e[26]=n()),a(y,{layout:"horizontal"},{title:t(()=>[a(g,{path:"data-planes.routes.item.xds.instance"})]),body:t(()=>[a(v,{appearance:"info"},{default:t(()=>[n(d(s.controlPlaneInstanceId),1)]),_:2},1024)]),_:2,__:[24]},1024),e[27]||(e[27]=n()),a(y,{layout:"horizontal"},{title:t(()=>[a(g,{path:"data-planes.routes.item.xds.version"})]),body:t(()=>[a(v,{appearance:"info"},{default:t(()=>{var f,w;return[n(d(((w=(f=s.version)==null?void 0:f.kumaDp)==null?void 0:w.version)??l("common.unknown")),1)]}),_:2},1024)]),_:2,__:[25]},1024)],64)):(i(),p(g,{key:1,path:"data-planes.routes.item.xds.disconnected"}))],64))),128))]),_:2},1024))),128))]),_:2,__:[28]},1024)):x("",!0)]),_:2,__:[29,30]},1024)]),_:2},1032,["title","created","modified"]),e[41]||(e[41]=n()),a(Q,{class:"traffic","data-testid":"dataplane-traffic"},{default:t(()=>[a(u,{type:"columns"},{default:t(()=>[a(F,null,{title:t(()=>[a(u,{type:"separated"},{default:t(()=>[a(I,{name:"inbound"}),e[31]||(e[31]=n()),e[32]||(e[32]=C("span",null,"Inbounds",-1))]),_:1,__:[31,32]})]),default:t(()=>[e[34]||(e[34]=n()),(i(!0),c(b,null,k([D.inbounds],r=>(i(),p(G,{key:typeof r,type:"inbound","data-testid":"dataplane-inbounds"},{default:t(()=>[a(X,{type:"inbounds",items:r,predicate:s=>s.port!==49151},dt({default:t(({items:s})=>[a(u,{type:"stack",size:"small"},{default:t(()=>[(i(!0),c(b,null,k(s,f=>(i(),p(M,{key:`${f.kri}`,"data-testid":"dataplane-inbound",protocol:f.protocol,"port-name":f.port.toString()},{default:t(()=>[a(z,{"data-action":"",to:{name:(w=>w.includes("bound")?w.replace("-outbound-","-inbound-"):"data-plane-connection-inbound-summary-overview-view")(String(R(T).name)),params:{connection:f.proxyResourceName},query:{inactive:_.params.inactive}}},{default:t(()=>[n(d(f.proxyResourceName),1)]),_:2},1032,["to"])]),_:2},1032,["protocol","port-name"]))),128))]),_:2},1024)]),_:2},[o.data.dataplaneType==="delegated"?{name:"empty",fn:t(()=>[a(V,null,{default:t(()=>[C("p",null,`
                            This proxy is a delegated gateway therefore `+d(l("common.product.name"))+` does not have any
                            visibility into inbounds for this gateway.
                          `,1)]),_:2},1024)]),key:"0"}:void 0]),1032,["items","predicate"])]),_:2},1024))),128))]),_:2,__:[34]},1024),e[40]||(e[40]=n()),a(F,null,{actions:t(()=>[a(z,{action:"refresh",appearance:"primary",onClick:at},{default:t(()=>e[35]||(e[35]=[n(`
                    Refresh
                  `,-1)])),_:2,__:[35]},1032,["onClick"])]),title:t(()=>[a(u,{type:"separated"},{default:t(()=>[a(I,{name:"outbound"}),e[36]||(e[36]=n()),e[37]||(e[37]=C("span",null,"Outbounds",-1))]),_:1,__:[36,37]})]),default:t(()=>[e[38]||(e[38]=n()),e[39]||(e[39]=n()),typeof et>"u"&&D.outbounds.length>0?(i(),p(X,{key:0,type:"outbounds",items:D.outbounds},{default:t(({items:r})=>[a(G,{type:"outbound","data-testid":"dataplane-outbounds"},{default:t(()=>[a(u,{type:"stack",size:"small"},{default:t(()=>[(i(!0),c(b,null,k(r,s=>(i(),p(M,{key:s.kri,"data-testid":"dataplane-outbound",protocol:s.protocol,"port-name":s.port.toString()},{default:t(()=>[a(z,{"data-action":"",to:{name:(f=>f.includes("bound")?f.replace("-inbound-","-outbound-"):"data-plane-connection-outbound-summary-overview-view")(String(R(T).name)),params:{connection:s.proxyResourceName},query:{inactive:_.params.inactive}}},{default:t(()=>[n(d(s.proxyResourceName),1)]),_:2},1032,["to"])]),_:2},1032,["protocol","port-name"]))),128))]),_:2},1024)]),_:2},1024)]),_:2},1032,["items"])):(i(),p(V,{key:1}))]),_:2,__:[38,39]},1024)]),_:2,__:[40]},1024)]),_:2},1024),e[42]||(e[42]=n()),a(U,null,{default:t(r=>[r.route.name!==_.name?(i(),p(ut,{key:0,width:r.route.name==="data-plane-subscriptions-summary-view"?"900px":"670px",onClose:function(){_.replace({name:"data-plane-detail-view",params:{mesh:_.params.mesh,proxy:_.params.proxy},query:{inactive:_.params.inactive?null:void 0}})}},{default:t(()=>[(i(),p(lt(r.Component),{data:_.params.subscription.length>0?o.data.dataplaneInsight.subscriptions:r.route.name.includes("-inbound-")?D.inbounds:D.outbounds,"data-plane-overview":o.data,networking:o.data.dataplane.networking,subscriptions:o.data.dataplaneInsight.subscriptions},null,8,["data","data-plane-overview","networking","subscriptions"]))]),_:2},1032,["width","onClose"])):x("",!0)]),_:2},1024)]),_:2,__:[41,42]},1024)]}),_:2,__:[43]},1024)]),_:2},1032,["src"])]),_:1})}}}),kt=pt(yt,[["__scopeId","data-v-0385691a"]]);export{kt as default};
