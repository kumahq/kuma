import{l as T,T as C,q as S,j as B,y as E}from"./kongponents.es-995fd5eb.js";import{d as V,o as n,a as p,w as o,h as l,b as e,g as f,u as N,G as A,e as R,j as z,k as m,f as x,P as j,x as $,t as P,F,p as G,m as M}from"./index-5fe06e34.js";import{_ as O}from"./PolicyDetails.vue_vue_type_script_setup_true_lang-bfb06549.js";import{i as U,h as W,A as Z,_ as H,f as J}from"./RouteView.vue_vue_type_script_setup_true_lang-ae2f3329.js";import{_ as k}from"./DataSource.vue_vue_type_script_setup_true_lang-c260c8ef.js";import{_ as K}from"./RouteTitle.vue_vue_type_script_setup_true_lang-3c1cc2cf.js";import{D as Q}from"./DataOverview-82df9a27.js";import{_ as X}from"./TextWithCopyButton-aaf3f087.js";import{E as Y}from"./ErrorBlock-a6c0f23e.js";import"./StatusInfo.vue_vue_type_script_setup_true_lang-0c6c691a.js";import"./ResourceCodeBlock.vue_vue_type_script_setup_true_lang-715d243f.js";import"./CodeBlock.vue_vue_type_style_index_0_lang-be3a91dc.js";import"./TabsWidget-d76df623.js";import"./QueryParameter-70743f73.js";import"./TagList-c84c0a85.js";import"./StatusBadge-e1a1fba1.js";const ee=V({__name:"DocumentationLink",props:{href:{type:String,required:!0}},setup(c){const t=c;return(_,h)=>(n(),p(e(C),{class:"docs-link",appearance:"outline",target:"_blank",to:t.href},{default:o(()=>[l(e(T),{icon:"externalLink",color:"currentColor",size:"16","hide-title":""}),f(`

    Documentation
  `)]),_:1},8,["to"]))}}),ae=c=>(G("data-v-16022f84"),c=c(),M(),c),te={class:"stack"},se={class:"kcard-border"},oe=ae(()=>m("p",null,[m("strong",null,"Warning"),f(` This policy is experimental. If you encountered any problem please open an
                              `),m("a",{href:"https://github.com/kumahq/kuma/issues/new/choose",target:"_blank",rel:"noopener noreferrer"},"issue")],-1)),re=V({__name:"PolicyListView",setup(c){const t=N(),_=A(),{t:h}=U(),D=function(b){b.items.length>0&&!t.query.policy&&_.push({name:"policies-list-view",query:{policy:b.items[0].name}})};return(b,u)=>(n(),p(H,null,{default:o(({route:y})=>[l(k,{src:"/*/policy-types"},{default:o(({data:d,error:v,refresh:I})=>[v?(n(),p(Y,{key:0,error:v},null,8,["error"])):d===void 0?(n(),p(W,{key:1})):d.policies.length===0?(n(),p(X,{key:2})):(n(!0),R(F,{key:3},z([d.policies.find(s=>s.path===y.params.policyPath)??d.policies[0]],s=>(n(),p(k,{key:s.path,src:`/${y.params.mesh}/policy-type/${s.path}?offset=${e(t).query.offset||"0"}`,onChange:D},{default:o(({data:r,error:g,refresh:L})=>[l(K,{title:e(h)("policies.routes.items.title",{name:s.name})},null,8,["title"]),f(),l(Z,null,{default:o(()=>[m("div",{class:$(["relative",s.path])},[m("div",te,[m("div",se,[s.isExperimental?(n(),p(e(S),{key:0,"border-variant":"noBorder",class:"mb-4"},{body:o(()=>[l(e(B),{appearance:"warning"},{alertMessage:o(()=>[oe]),_:1})]),_:1})):x("",!0),f(),l(Q,{"selected-entity-name":e(t).query.policy??void 0,"page-size":e(j),error:g,"is-loading":typeof r>"u"&&typeof g>"u","empty-state":{title:"No Data",message:`There are no ${s.name} policies present.`},"table-data":{headers:[{label:"Name",key:"entity"},{label:"Type",key:"type"}],data:((r==null?void 0:r.items)||[]).map(a=>({entity:a,type:a.type,detailViewRoute:{name:"policy-detail-view",params:{mesh:a.mesh,policyPath:y.params.policyPath,policy:a.name}}}))},"table-data-is-empty":r&&r.items.length===0,next:r==null?void 0:r.next,"page-offset":e(t).query.offset?parseInt(e(t).query.offset):0,onTableAction:u[1]||(u[1]=a=>{e(_).push({name:"policies-list-view",query:{policy:a.name}})}),onRefresh:()=>{L(),I()},onLoadData:u[2]||(u[2]=a=>{e(_).push({name:"policies-list-view",query:{policy:e(t).query.policy,offset:a}})})},{additionalControls:o(()=>[l(k,{src:`/${y.params.mesh}/insights`},{default:o(({data:a})=>[l(e(E),{label:"Policies",items:d.policies.map(i=>({label:i.name,value:i.path,selected:i.path===y.params.policyPath})),"label-attributes":{class:"visually-hidden"},appearance:"select","enable-filtering":!0,onSelected:u[0]||(u[0]=i=>e(_).push({name:"policies-list-view",params:{...e(t).params,policyPath:i.value}}))},{"item-template":o(({item:i})=>{var w,q;return[m("span",{class:$({"policy-type-empty":!((w=a==null?void 0:a.policies[i.label])!=null&&w.total)})},P(i.label)+" ("+P(((q=a==null?void 0:a.policies[i.label])==null?void 0:q.total)||"0")+`)
                              `,3)]}),_:2},1032,["items"])]),_:2},1032,["src"]),f(),l(ee,{href:e(h)("policies.href.docs",{name:s.name}),"data-testid":"policy-documentation-link"},null,8,["href"])]),_:2},1032,["selected-entity-name","page-size","error","is-loading","empty-state","table-data","table-data-is-empty","next","page-offset","onRefresh"])]),f(),e(t).query.policy?(n(),p(O,{key:0,name:e(t).query.policy,mesh:y.params.mesh,path:s.path,type:s.name},null,8,["name","mesh","path","type"])):x("",!0)])],2)]),_:2},1024)]),_:2},1032,["src"]))),128))]),_:2},1024)]),_:1}))}});const we=J(re,[["__scopeId","data-v-16022f84"]]);export{we as default};
