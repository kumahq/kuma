import{d as M,r as m,o as p,m as d,w as e,b as t,a4 as b,e as a,t as l,k as r,p as _,l as N,ay as X,c as y,as as H,A as I,L as w,E as K,q as S}from"./index-DsCWuC-0.js";import{P as q}from"./PolicyTypeTag-BzbzaGYi.js";import{S as E}from"./SummaryView-AIbPWTZ1.js";const $={class:"stack"},F={class:"visually-hidden"},G=["innerHTML"],O={key:0},Z=["innerHTML"],j={key:0},J=M({__name:"PolicyListView",props:{policyTypes:{}},setup(C){const R=C;return(Q,k)=>{const f=m("KBadge"),u=m("XAction"),z=m("KCard"),V=m("XInput"),T=m("XActionGroup"),v=m("DataCollection"),P=m("RouterView"),L=m("DataLoader"),x=m("AppView"),A=m("RouteView");return p(),d(A,{name:"policy-list-view",params:{page:1,size:50,mesh:"",policyPath:"",policy:"",s:""}},{default:e(({route:n,t:o,can:B,uri:D,me:h})=>[t(v,{predicate:i=>typeof i<"u"&&i.path===n.params.policyPath,items:R.policyTypes??[]},{empty:e(()=>[t(b,null,{message:e(()=>[a(l(o("policies.routes.items.empty")),1)]),_:2},1024)]),item:e(({item:i})=>[t(x,null,{default:e(()=>[r("div",$,[t(z,null,{default:e(()=>[r("header",null,[r("div",null,[i.isExperimental?(p(),d(f,{key:0,appearance:"warning"},{default:e(()=>[a(l(o("policies.collection.beta")),1)]),_:2},1024)):_("",!0),a(),i.isInbound?(p(),d(f,{key:1,appearance:"neutral"},{default:e(()=>[a(l(o("policies.collection.inbound")),1)]),_:2},1024)):_("",!0),a(),i.isOutbound?(p(),d(f,{key:2,appearance:"neutral"},{default:e(()=>[a(l(o("policies.collection.outbound")),1)]),_:2},1024)):_("",!0),a(),t(u,{action:"docs",href:o("policies.href.docs",{name:i.name}),"data-testid":"policy-documentation-link"},{default:e(()=>[r("span",F,l(o("common.documentation")),1)]),_:2},1032,["href"])]),a(),r("h3",null,[t(q,{"policy-type":i.name},{default:e(()=>[a(l(o("policies.collection.title",{name:i.name})),1)]),_:2},1032,["policy-type"])])]),a(),r("div",{innerHTML:o(`policies.type.${i.name}.description`,void 0,{defaultMessage:o("policies.collection.description")})},null,8,G)]),_:2},1024),a(),t(z,null,{default:e(()=>[t(L,{src:D(N(X),"/meshes/:mesh/policy-path/:path",{mesh:n.params.mesh,path:n.params.policyPath},{page:n.params.page,size:n.params.size,search:n.params.s})},{loadable:e(({data:c})=>[((c==null?void 0:c.items)??{length:0}).length>0||n.params.s.length>0?(p(),y("search",O,[r("form",{onSubmit:k[0]||(k[0]=H(()=>{},["prevent"]))},[t(V,{placeholder:"Filter by name...",type:"search",appearance:"search",value:n.params.s,debounce:1e3,onChange:s=>n.update({s})},null,8,["value","onChange"])],32)])):_("",!0),a(),t(v,{items:(c==null?void 0:c.items)??[void 0],page:n.params.page,"page-size":n.params.size,total:c==null?void 0:c.total,onChange:n.update},{empty:e(()=>[t(b,null,{title:e(()=>[a(l(o("policies.x-empty-state.title")),1)]),action:e(()=>[t(u,{action:"docs",href:o("policies.href.docs",{name:i.name})},{default:e(()=>[a(l(o("common.documentation")),1)]),_:2},1032,["href"])]),default:e(()=>[a(),r("div",{innerHTML:o("policies.x-empty-state.body",{type:i.name,suffix:n.params.s.length>0?o("common.matchingsearch"):""})},null,8,Z),a()]),_:2},1024)]),default:e(()=>[t(I,{headers:[{...h.get("headers.name"),label:"Name",key:"name"},{...h.get("headers.namespace"),label:"Namespace",key:"namespace"},...B("use zones")&&i.isTargetRefBased?[{...h.get("headers.zone"),label:"Zone",key:"zone"}]:[],...i.isTargetRefBased?[{...h.get("headers.targetRef"),label:"Target ref",key:"targetRef"}]:[],{...h.get("headers.actions"),label:"Actions",key:"actions",hideLabel:!0}],items:c==null?void 0:c.items,"is-selected-row":s=>s.id===n.params.policy,onResize:h.set},{name:e(({row:s})=>[t(u,{"data-action":"",to:{name:"policy-summary-view",params:{mesh:s.mesh,policyPath:i.path,policy:s.id},query:{page:n.params.page,size:n.params.size}}},{default:e(()=>[a(l(s.name),1)]),_:2},1032,["to"])]),namespace:e(({row:s})=>[a(l(s.namespace.length>0?s.namespace:o("common.detail.none")),1)]),targetRef:e(({row:s})=>{var g;return[i.isTargetRefBased&&typeof((g=s.spec)==null?void 0:g.targetRef)<"u"?(p(),d(f,{key:0,appearance:"neutral"},{default:e(()=>[a(l(s.spec.targetRef.kind),1),s.spec.targetRef.name?(p(),y("span",j,[a(":"),r("b",null,l(s.spec.targetRef.name),1)])):_("",!0)]),_:2},1024)):(p(),y(w,{key:1},[a(l(o("common.detail.none")),1)],64))]}),zone:e(({row:s})=>[s.zone?(p(),d(u,{key:0,to:{name:"zone-cp-detail-view",params:{zone:s.zone}}},{default:e(()=>[a(l(s.zone),1)]),_:2},1032,["to"])):(p(),y(w,{key:1},[a(l(o("common.detail.none")),1)],64))]),actions:e(({row:s})=>[t(T,null,{default:e(()=>[t(u,{to:{name:"policy-detail-view",params:{mesh:s.mesh,policyPath:i.path,policy:s.id}}},{default:e(()=>[a(l(o("common.collection.actions.view")),1)]),_:2},1032,["to"])]),_:2},1024)]),_:2},1032,["headers","items","is-selected-row","onResize"])]),_:2},1032,["items","page","page-size","total","onChange"]),a(),n.params.policy?(p(),d(P,{key:1},{default:e(({Component:s})=>[t(E,{onClose:g=>n.replace({name:"policy-list-view",params:{mesh:n.params.mesh,policyPath:n.params.policyPath},query:{page:n.params.page,size:n.params.size}})},{default:e(()=>[typeof c<"u"?(p(),d(K(s),{key:0,items:c.items,"policy-type":i},null,8,["items","policy-type"])):_("",!0)]),_:2},1032,["onClose"])]),_:2},1024)):_("",!0)]),_:2},1032,["src"])]),_:2},1024)])]),_:2},1024)]),_:2},1032,["predicate","items"])]),_:1})}}}),ee=S(J,[["__scopeId","data-v-56ef3a26"]]);export{ee as default};
