import{d as y,D as b,j as p,c as $,I as S,o as _,a as k,C as w,v as A,w as B,e as C,A as f,b as g,a6 as z,W as x,B as L,g as N,F as D,q as E}from"./index-67d086f6.js";import{f as I,H as W}from"./RouteView.vue_vue_type_script_setup_true_lang-79b8501d.js";const q={key:0,class:"app-collection-toolbar"},v=5,O=y({__name:"AppCollection",props:{total:{default:0},pageNumber:{},pageSize:{},items:{},headers:{},error:{}},emits:["change"],setup(m,{emit:i}){const o=m,u=b(),n=p(o.items),l=p(0),a=$(()=>{const s=o.headers.filter(e=>["warnings","actions"].includes(e.key));if(s.length>4)return"initial";const r=100-s.length*v,t=o.headers.length-s.length;return`calc(${r}% / ${t})`});S(()=>o.items,()=>{l.value++,n.value=o.items});const d=s=>{const r=s.target.closest("tr");if(r){const t=r.querySelector("a");t!==null&&t.click()}};return(s,r)=>(_(),k(g(x),{class:"app-collection",style:z(`--column-width: ${a.value}; --special-column-width: ${v}%;`),"has-error":typeof o.error<"u","pagination-total-items":o.total,"initial-fetcher-params":{page:o.pageNumber,pageSize:o.pageSize},headers:o.headers,"fetcher-cache-key":String(l.value),fetcher:({page:t,pageSize:e,query:c})=>(i("change",{page:t,size:e,s:c}),{data:n.value}),"cell-attrs":({headerKey:t})=>({class:`${t}-column`}),"empty-state-icon-size":"96","disable-sorting":"","hide-pagination-when-optional":"","onRow:click":d},w({_:2},[A(Object.keys(g(u)),t=>({name:t,fn:B(({row:e,rowValue:c})=>[t==="toolbar"?(_(),C("div",q,[f(s.$slots,"toolbar",{},void 0,!0)])):f(s.$slots,t,{key:1,row:e,rowValue:c},void 0,!0)])}))]),1032,["style","has-error","pagination-total-items","initial-fetcher-params","headers","fetcher-cache-key","fetcher","cell-attrs"]))}});const P=I(O,[["__scopeId","data-v-dd44896a"]]),j=E("span",{class:"visually-hidden"},null,-1),T=y({__name:"DataSource",props:{src:{type:String,required:!0}},emits:["change","error"],setup(m,{emit:i}){const o=m,u=W(),n=p(void 0),l=p(void 0);let a={};const d=Symbol(""),s=async e=>{if(n.value=void 0,a=r(a),a.src=e,e==="")return;a.controller=new AbortController;const c=u.source(e,d);c.addEventListener("message",h=>{n.value=h.data,l.value=void 0,i("change",n.value)},{signal:a.controller.signal}),c.addEventListener("error",h=>{l.value=h.error,i("error",l.value)},{signal:a.controller.signal})},r=e=>(typeof e.controller<"u"&&e.controller.abort(),typeof e.src<"u"&&u.close(e.src,d),{});S(()=>o.src,e=>s(e),{immediate:!0}),L(()=>{a=r(a)});const t=()=>{s(o.src)};return(e,c)=>(_(),C(D,null,[f(e.$slots,"default",{data:n.value,error:l.value,refresh:t}),N(),j],64))}});export{P as A,T as _};
