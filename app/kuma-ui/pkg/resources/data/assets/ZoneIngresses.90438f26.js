import{D as F,cn as Z,co as q,e as K,Q as M,P as N,cp as O,k as y,cq as R,s as V,o as i,j as g,c as u,w as s,a as o,b as H,z as v,l,t as b,F as D,n as E,i as n}from"./index.3a3d021f.js";import{g as U}from"./tableDataUtils.db5b56fc.js";import{D as W}from"./DataOverview.529ae0fd.js";import{_ as G}from"./EntityURLControl.vue_vue_type_script_setup_true_lang.c0a3cdda.js";import{E as P}from"./EnvoyData.58e75073.js";import{F as j}from"./FrameSkeleton.0eaca3db.js";import{_ as Q}from"./LabelList.vue_vue_type_style_index_0_lang.7ae57614.js";import{M as X}from"./MultizoneInfo.85e59ea2.js";import{S as J,a as Y}from"./SubscriptionHeader.10e71be7.js";import{T as $}from"./TabsWidget.8d50c7e4.js";import"./EmptyBlock.vue_vue_type_script_setup_true_lang.ed08f409.js";import"./ErrorBlock.e950a812.js";import"./LoadingBlock.vue_vue_type_script_setup_true_lang.fa633f42.js";import"./TagList.4e52fad1.js";import"./CodeBlock.vue_vue_type_style_index_0_lang.1ff82bc9.js";import"./_commonjsHelpers.f037b798.js";const ee={name:"ZoneIngresses",components:{AccordionItem:Z,AccordionList:q,DataOverview:W,EntityURLControl:G,EnvoyData:P,FrameSkeleton:j,LabelList:Q,MultizoneInfo:X,SubscriptionDetails:J,SubscriptionHeader:Y,TabsWidget:$,KButton:K,KCard:M},data(){return{isLoading:!0,isEmpty:!1,error:null,empty_state:{title:"No Data",message:"There are no Zone Ingresses present."},tableData:{headers:[{key:"actions",hideLabel:!0},{label:"Status",key:"status"},{label:"Name",key:"name"}],data:[]},tabs:[{hash:"#overview",title:"Overview"},{hash:"#insights",title:"Zone Ingress Insights"},{hash:"#xds-configuration",title:"XDS Configuration"},{hash:"#envoy-stats",title:"Stats"},{hash:"#envoy-clusters",title:"Clusters"}],entity:{},rawData:[],pageSize:N,next:null,subscriptionsReversed:[]}},computed:{...O({multicluster:"config/getMulticlusterStatus"})},watch:{$route(){this.isLoading=!0,this.isEmpty=!1,this.error=null,this.init()}},beforeMount(){this.init()},methods:{init(){this.multicluster&&this.loadData()},tableAction(a){const r=a;this.getEntity(r)},async loadData(a="0"){this.isLoading=!0,this.isEmpty=!1;const r=this.$route.query.ns||null;try{const{data:t,next:p}=await U({getAllEntities:y.getAllZoneIngressOverviews.bind(y),getSingleEntity:y.getZoneIngressOverview.bind(y),size:this.pageSize,offset:a,query:r});this.next=p,t.length?(this.isEmpty=!1,this.rawData=t,this.getEntity({name:t[0].name}),this.tableData.data=t.map(e=>{const{zoneIngressInsight:c={}}=e;return{...e,...R(c)}})):(this.tableData.data=[],this.isEmpty=!0)}catch(t){t instanceof Error?this.error=t:console.error(t),this.isEmpty=!0}finally{this.isLoading=!1}},getEntity(a){var e,c;const r=["type","name"],t=this.rawData.find(h=>h.name===a.name),p=(c=(e=t==null?void 0:t.zoneIngressInsight)==null?void 0:e.subscriptions)!=null?c:[];this.subscriptionsReversed=Array.from(p).reverse(),this.entity=V(t,r)}}},te={class:"zoneingresses"},se=l("span",{class:"custom-control-icon"}," \u2190 ",-1);function ne(a,r,t,p,e,c){const h=n("MultizoneInfo"),z=n("KButton"),L=n("DataOverview"),S=n("EntityURLControl"),I=n("LabelList"),k=n("SubscriptionHeader"),w=n("SubscriptionDetails"),A=n("AccordionItem"),x=n("AccordionList"),C=n("KCard"),_=n("EnvoyData"),T=n("TabsWidget"),B=n("FrameSkeleton");return i(),g("div",te,[a.multicluster===!1?(i(),u(h,{key:0})):(i(),u(B,{key:1},{default:s(()=>{var f;return[o(L,{"selected-entity-name":(f=e.entity)==null?void 0:f.name,"page-size":e.pageSize,"is-loading":e.isLoading,error:e.error,"empty-state":e.empty_state,"table-data":e.tableData,"table-data-is-empty":e.isEmpty,next:e.next,onTableAction:c.tableAction,onLoadData:r[0]||(r[0]=m=>c.loadData(m))},{additionalControls:s(()=>[a.$route.query.ns?(i(),u(z,{key:0,class:"back-button",appearance:"primary",to:{name:"zoneingresses"}},{default:s(()=>[se,H(" View All ")]),_:1})):v("",!0)]),_:1},8,["selected-entity-name","page-size","is-loading","error","empty-state","table-data","table-data-is-empty","next","onTableAction"]),e.isEmpty===!1?(i(),u(T,{key:0,"has-error":e.error!==null,"is-loading":e.isLoading,tabs:e.tabs,"initial-tab-override":"overview"},{tabHeader:s(()=>[l("div",null,[l("h3",null," Zone Ingress: "+b(e.entity.name),1)]),l("div",null,[o(S,{name:e.entity.name},null,8,["name"])])]),overview:s(()=>[o(I,null,{default:s(()=>[l("div",null,[l("ul",null,[(i(!0),g(D,null,E(e.entity,(m,d)=>(i(),g("li",{key:d},[l("h4",null,b(d),1),l("p",null,b(m),1)]))),128))])])]),_:1})]),insights:s(()=>[o(C,{"border-variant":"noBorder"},{body:s(()=>[o(x,{"initially-open":0},{default:s(()=>[(i(!0),g(D,null,E(e.subscriptionsReversed,(m,d)=>(i(),u(A,{key:d},{"accordion-header":s(()=>[o(k,{details:m},null,8,["details"])]),"accordion-content":s(()=>[o(w,{details:m,"is-discovery-subscription":""},null,8,["details"])]),_:2},1024))),128))]),_:1})]),_:1})]),"xds-configuration":s(()=>[o(_,{"data-path":"xds","zone-ingress-name":e.entity.name,"query-key":"envoy-data-zone-ingress"},null,8,["zone-ingress-name"])]),"envoy-stats":s(()=>[o(_,{"data-path":"stats","zone-ingress-name":e.entity.name,"query-key":"envoy-data-zone-ingress"},null,8,["zone-ingress-name"])]),"envoy-clusters":s(()=>[o(_,{"data-path":"clusters","zone-ingress-name":e.entity.name,"query-key":"envoy-data-zone-ingress"},null,8,["zone-ingress-name"])]),_:1},8,["has-error","is-loading","tabs"])):v("",!0)]}),_:1}))])}const ve=F(ee,[["render",ne]]);export{ve as default};
