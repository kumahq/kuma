import{d as E,u as A,r as l,v as N,o as M,j as S,i as z,g as I,e as L,N as b}from"./index-d1b06945.js";import{D as V}from"./DataOverview-4258c299.js";import{b as B,u as q}from"./index-622627a1.js";import{Q as d}from"./QueryParameter-70743f73.js";import"./kongponents.es-3de72d29.js";import"./EmptyBlock.vue_vue_type_script_setup_true_lang-c85a2583.js";import"./ErrorBlock-a429506d.js";import"./_plugin-vue_export-helper-c27b6911.js";import"./LoadingBlock.vue_vue_type_script_setup_true_lang-cb394c2d.js";import"./datadogLogEvents-302eea7b.js";import"./TagList-4d943c1c.js";import"./store-08fe2551.js";import"./StatusBadge-418ed145.js";const O={class:"kcard-stack"},Q={class:"kcard-border"},$=E({__name:"MeshListView",props:{selectedMeshName:{type:[String,null],required:!1,default:null},offset:{type:Number,required:!1,default:0}},setup(_){const r=_,p=B(),f=q(),P={title:p.t("meshes.list.emptyState.title"),message:p.t("meshes.list.emptyState.message")},v=A(),i=l(!0),u=l(null),n=l({headers:[{label:"Name",key:"entity"},{label:"Services",key:"services"},{label:"Data Plane Proxies",key:"dataPlaneProxies"}],data:[]}),o=l(null),y=l(null),h=l(r.offset);N(()=>v.params.mesh,function(){v.name==="mesh-list-view"&&c(0)}),x();function x(){c(r.offset)}async function c(e){var a;h.value=e,d.set("offset",e>0?e:null),i.value=!0,u.value=null;const t=b;try{const{items:s,next:m}=await f.getAllMeshInsights({size:t,offset:e});y.value=m,n.value.data=k(s??[]),await g({name:r.selectedMeshName??((a=n.value.data[0])==null?void 0:a.entity.name)})}catch(s){n.value.data=[],o.value=null,s instanceof Error?u.value=s:console.error(s)}finally{i.value=!1}}function k(e){return e.map(t=>{const{name:a,services:s,dataplanes:m}=t,w={name:"mesh-detail-view",params:{mesh:a}},T=s.total??0,D=m.total??0;return{entity:t,detailViewRoute:w,services:T,dataPlaneProxies:D}})}async function g({name:e}){if(e===void 0){o.value=null,d.set("zone",null);return}try{o.value=await f.getMeshInsights({name:e}),d.set("zone",e)}catch(t){console.error(t)}}return(e,t)=>{var a;return M(),S("div",O,[z("div",Q,[I(V,{"selected-entity-name":(a=o.value)==null?void 0:a.name,"page-size":L(b),"is-loading":i.value,error:u.value,"empty-state":P,"table-data":n.value,"table-data-is-empty":n.value.data.length===0,next:y.value,"page-offset":h.value,onTableAction:g,onLoadData:c},null,8,["selected-entity-name","page-size","is-loading","error","table-data","table-data-is-empty","next","page-offset"])])])}}});export{$ as default};
