import{d as $,r as m,p as _,o as d,w as a,b as i,e as r,l as t,M as A,L as b,t as l,c as f,N as g,a as N,q as B,m as E,Y as F}from"./index-BKQXbpxr.js";const M={scope:"row"},D={scope:"row"},L={scope:"row"},j=$({__name:"SubscriptionSummaryView",props:{data:{},routeName:{}},setup(v){const w=v;return(S,e)=>{const X=m("XSelect"),h=m("XLayout"),k=m("XTable"),C=m("XAlert"),x=m("XI18n"),I=m("DataCollection"),R=m("XCodeBlock"),T=m("AppView"),V=m("RouteView");return d(),_(V,{name:w.routeName,params:{subscription:"",codeSearch:"",codeFilter:!1,codeRegExp:!1,output:String}},{default:a(({route:u,t:s})=>[i(I,{items:w.data,predicate:n=>n.id===u.params.subscription},{item:a(({item:n})=>[i(T,null,{title:a(()=>[t("h2",null,l(n.zoneInstanceId??n.globalInstanceId??n.controlPlaneInstanceId),1)]),default:a(()=>[e[13]||(e[13]=r()),i(h,{type:"stack"},{default:a(()=>[t("header",null,[i(h,{type:"separated",justify:"end"},{default:a(()=>[i(X,{label:s("subscriptions.routes.item.format"),selected:u.params.output,onChange:o=>{u.update({output:o})}},A({_:2},[b(["structured","yaml"],o=>({name:`${o}-option`,fn:a(()=>[r(l(s(`subscriptions.routes.item.formats.${o}`)),1)])}))]),1032,["label","selected","onChange"])]),_:2},1024)]),e[12]||(e[12]=r()),u.params.output==="structured"?(d(),_(h,{key:0,type:"stack","data-testid":"structured-view"},{default:a(()=>[i(k,{variant:"kv"},{default:a(()=>{var o,y;return[t("tbody",null,[(d(!0),f(g,null,b([[s("http.api.property.version"),((y=(o=n.version)==null?void 0:o.kumaCp)==null?void 0:y.version)??"-"],[s("http.api.property.connectTime"),s("common.formats.datetime",{value:Date.parse(n.connectTime??"")})],...n.disconnectTime?[[s("http.api.property.disconnectTime"),s("common.formats.datetime",{value:Date.parse(n.disconnectTime)})]]:[],[s("subscriptions.routes.item.headers.responses"),`${n.status.total.responsesSent}/${n.status.total.responsesAcknowledged}`],...["zoneInstanceId","globalInstanceId","controlPlaneInstanceId"].reduce((p,c)=>(n[c]&&p.push([s(`http.api.property.${c}`),n[c]]),p),[]),[s("http.api.property.id"),n.id]],([p,c])=>(d(),f("tr",{key:p},[t("th",M,l(p),1),e[0]||(e[0]=r()),t("td",null,l(c),1)]))),128))])]}),_:2},1024),e[11]||(e[11]=r()),i(I,{items:Object.entries(n.status.acknowledgements??{})},{empty:a(()=>[i(C,{variant:"info"},{default:a(()=>[r(l(s("common.detail.subscriptions.no_stats",{id:n.id})),1)]),_:2},1024)]),default:a(({items:o})=>[i(h,{type:"stack"},{default:a(()=>[N(S.$slots,"default"),e[9]||(e[9]=r()),(d(!0),f(g,null,b([o.filter(([y,p])=>p.responsesRejected>0)],y=>(d(),f(g,{key:typeof y},[y.length>0?(d(),f(g,{key:0},[i(C,{variant:n.disconnectTime?"info":"warning"},{default:a(()=>[i(x,{path:"subscriptions.notifications.with-nacks"})]),_:2},1032,["variant"]),e[7]||(e[7]=r()),i(k,{variant:"kv"},{default:a(()=>[t("thead",null,[t("tr",null,[t("th",null,l(s("subscriptions.routes.item.headers.type")),1),e[1]||(e[1]=r()),t("th",null,l(s("subscriptions.routes.item.headers.stat")),1)])]),e[3]||(e[3]=r()),t("tbody",null,[(d(!0),f(g,null,b(y,([p,c])=>(d(),f("tr",{key:p},[t("th",D,l(s(`http.api.property.${p}`)),1),e[2]||(e[2]=r()),t("td",null,l(c.responsesRejected),1)]))),128))])]),_:2},1024),e[8]||(e[8]=r()),i(k,{variant:"kv"},{default:a(()=>[t("thead",null,[t("tr",null,[t("th",null,l(s("subscriptions.routes.item.headers.type")),1),e[4]||(e[4]=r()),t("th",null,l(s("subscriptions.routes.item.headers.stat")),1)])]),e[6]||(e[6]=r()),t("tbody",null,[(d(!0),f(g,null,b(o,([p,c])=>(d(),f("tr",{key:p},[t("th",L,l(s(`http.api.property.${p}`)),1),e[5]||(e[5]=r()),t("td",null,l(c.responsesSent)+"/"+l(c.responsesAcknowledged),1)]))),128))])]),_:2},1024)],64)):B("",!0)],64))),128))]),_:2},1024)]),_:2},1032,["items"])]),_:2},1024)):(d(),_(R,{key:1,language:"yaml",code:E(F).stringify(n.$raw),"is-searchable":"",query:u.params.codeSearch,"is-filter-mode":u.params.codeFilter,"is-reg-exp-mode":u.params.codeRegExp,onQueryChange:o=>u.update({codeSearch:o}),onFilterModeChange:o=>u.update({codeFilter:o}),onRegExpModeChange:o=>u.update({codeRegExp:o})},null,8,["code","query","is-filter-mode","is-reg-exp-mode","onQueryChange","onFilterModeChange","onRegExpModeChange"]))]),_:2},1024)]),_:2},1024)]),_:2},1032,["items","predicate"])]),_:3},8,["name"])}}});export{j as default};
