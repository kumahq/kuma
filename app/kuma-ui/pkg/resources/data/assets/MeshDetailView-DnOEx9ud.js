import{d as P,p as d,o as u,w as e,b as t,e as o,r,c as f,L as C,N as _,O as M,t as c,R as B,m as T,F as z,q as F,H as D}from"./index-BQCKYSWR.js";import{_ as I}from"./ResourceCodeBlock.vue_vue_type_script_setup_true_lang-Qj6WnSep.js";const q=P({__name:"MeshDetailView",props:{mesh:{}},setup(L){const l=L;return(N,s)=>{const R=r("RouteTitle"),k=r("XI18n"),w=r("XNotification"),$=r("XAction"),v=r("XBadge"),x=r("XAboutCard"),X=r("DataSource"),V=r("XLayout"),A=r("XCard"),S=r("AppView"),E=r("RouteView");return u(),d(E,{name:"mesh-detail-view",params:{mesh:""}},{default:e(({route:h,t:m,uri:b})=>[t(R,{title:m("meshes.routes.overview.title"),render:!1},null,8,["title"]),s[10]||(s[10]=o()),t(X,{src:b(T(D),"/mesh-insights/:name",{name:h.params.mesh})},{default:e(({data:n})=>[t(S,{docs:m("meshes.href.docs"),notifications:!0},{default:e(()=>[t(w,{notify:!l.mesh.mtlsBackend,uri:`meshes.notifications.mtls-warning:${l.mesh.id}`},{default:e(()=>[t(k,{path:"meshes.notifications.mtls-warning"})]),_:1},8,["notify","uri"]),s[8]||(s[8]=o()),t(w,{notify:N.mesh.meshServices.mode==="Disabled",uri:`meshes.notifications.mesh-service-activation:${h.params.mesh}`,variant:"info"},{default:e(()=>[t(k,{path:"meshes.notifications.mesh-service-activation"})]),_:2},1032,["notify","uri"]),s[9]||(s[9]=o()),t(V,{type:"stack"},{default:e(()=>[t(x,{title:m("meshes.routes.item.about.title"),created:l.mesh.creationTime,modified:l.mesh.modificationTime},{default:e(()=>[(u(),f(_,null,C(["MeshTrafficPermission","MeshMetric","MeshAccessLog","MeshTrace"],i=>{var p;return u(),f(_,{key:i},[(u(!0),f(_,null,C([((p=n==null?void 0:n.policies)==null?void 0:p[i])??{total:0}],a=>(u(),f(_,{key:typeof a},[t(w,{notify:i==="MeshTrafficPermission"&&l.mesh.mtlsBackend&&a.total===0,uri:`meshes.notifications.mtp-warning:${l.mesh.id}`},{default:e(()=>[t(k,{path:"meshes.notifications.mtp-warning"})]),_:2},1032,["notify","uri"]),s[1]||(s[1]=o()),t(M,{layout:"horizontal"},{title:e(()=>[t($,{to:{name:"policy-list-view",params:{mesh:h.params.mesh,policyPath:`${i.toLowerCase()}s`}}},{default:e(()=>[o(c(i),1)]),_:2},1032,["to"])]),body:e(()=>[t(v,{appearance:a.total>0?"success":"neutral"},{default:e(()=>[o(c(a.total>0?m("meshes.detail.enabled"):m("meshes.detail.disabled")),1)]),_:2},1032,["appearance"])]),_:2,__:[0]},1024)],64))),128))],64)}),64)),s[3]||(s[3]=o()),t(M,{layout:"horizontal"},{title:e(()=>[o(c(m("http.api.property.mtls")),1)]),body:e(()=>[l.mesh.mtlsBackend?(u(),d(v,{key:1,appearance:"info"},{default:e(()=>[o(c(l.mesh.mtlsBackend.type)+" / "+c(l.mesh.mtlsBackend.name),1)]),_:1})):(u(),d(v,{key:0,appearance:"neutral"},{default:e(()=>[o(c(m("meshes.detail.disabled")),1)]),_:2},1024))]),_:2,__:[2]},1024)]),_:2,__:[3]},1032,["title","created","modified"]),s[6]||(s[6]=o()),t(A,null,{default:e(()=>[t(V,{type:"columns",class:"columns-with-borders"},{default:e(()=>[t(B,{total:(n==null?void 0:n.services.total)??0,"data-testid":"services-status"},{title:e(()=>[o(c(m("meshes.detail.services")),1)]),_:2},1032,["total"]),s[4]||(s[4]=o()),t(B,{total:(n==null?void 0:n.dataplanesByType.standard.total)??0,online:(n==null?void 0:n.dataplanesByType.standard.online)??0,"data-testid":"data-plane-proxies-status"},{title:e(()=>[o(c(m("meshes.detail.data_plane_proxies")),1)]),_:2},1032,["total","online"]),s[5]||(s[5]=o()),t(X,{src:b(T(z),"/policy-types",{})},{default:e(({data:i})=>[(u(!0),f(_,null,C([i==null?void 0:i.policyTypes.map(p=>p.name)],p=>(u(),d(B,{key:typeof p,total:Object.entries((n==null?void 0:n.resources)||{}).reduce((a,[y,{total:g}])=>(p||[]).includes(y)?a+g:a,0),"data-testid":"policies-status"},{title:e(()=>[o(c(m("meshes.detail.policies")),1)]),_:2},1032,["total"]))),128))]),_:2},1032,["src"])]),_:2,__:[4,5]},1024)]),_:2},1024),s[7]||(s[7]=o()),t(A,null,{default:e(()=>[t(I,{resource:l.mesh.config},{default:e(({copy:i,copying:p})=>[p?(u(),d(X,{key:0,src:b(T(D),"/meshes/:name/as/kubernetes",{name:h.params.mesh},{cacheControl:"no-store"}),onChange:a=>{i(y=>y(a))},onError:a=>{i((y,g)=>g(a))}},null,8,["src","onChange","onError"])):F("",!0)]),_:2},1032,["resource"])]),_:2},1024)]),_:2,__:[6,7]},1024)]),_:2,__:[8,9]},1032,["docs"])]),_:2},1032,["src"])]),_:1,__:[10]})}}});export{q as default};
