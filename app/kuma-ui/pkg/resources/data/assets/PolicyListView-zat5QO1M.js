import{d as $,i as m,o as i,a as p,w as e,j as c,a3 as A,k as t,t as l,b as y,H as k,J as N,g as d,e as u,A as v,K,r as I,_ as E}from"./index-CR6vLkmN.js";import{e as H}from"./kong-icons.es249-CxK2RL5G.js";import{A as M}from"./AppCollection-BHg4kDOS.js";import{P as q}from"./PolicyTypeTag-zU5UuiYZ.js";import{S as O}from"./SummaryView-DpRsdQQI.js";import"./kong-icons.es245-C4Uc2sx6.js";const X={class:"stack"},Z={class:"visually-hidden"},j=["innerHTML"],F={key:0},J=$({__name:"PolicyListView",props:{policyTypes:{}},setup(C){const R=C;return(U,G)=>{const _=m("KBadge"),g=m("XAction"),z=m("KCard"),V=m("RouterLink"),P=m("RouterView"),w=m("DataLoader"),L=m("AppView"),B=m("DataCollection"),D=m("RouteView"),x=m("DataSource");return i(),p(x,{src:"/me"},{default:e(({data:b})=>[b?(i(),p(D,{key:0,name:"policy-list-view",params:{page:1,size:b.pageSize,mesh:"",policyPath:"",policy:""}},{default:e(({route:s,t:n,can:S})=>[c(B,{predicate:f=>typeof f<"u"&&f.path===s.params.policyPath,find:!0,items:R.policyTypes??[void 0]},{empty:e(()=>[c(A,null,{message:e(()=>[t(l(n("policies.routes.items.empty")),1)]),_:2},1024)]),default:e(({items:f})=>[(i(!0),y(k,null,N([f[0]],o=>(i(),p(L,{key:o},{default:e(()=>[d("div",X,[c(z,null,{default:e(()=>[d("header",null,[d("div",null,[o.isExperimental?(i(),p(_,{key:0,appearance:"warning"},{default:e(()=>[t(l(n("policies.collection.beta")),1)]),_:2},1024)):u("",!0),t(),o.isInbound?(i(),p(_,{key:1,appearance:"neutral"},{default:e(()=>[t(l(n("policies.collection.inbound")),1)]),_:2},1024)):u("",!0),t(),o.isOutbound?(i(),p(_,{key:2,appearance:"neutral"},{default:e(()=>[t(l(n("policies.collection.outbound")),1)]),_:2},1024)):u("",!0),t(),c(g,{type:"docs",href:n("policies.href.docs",{name:o.name}),"data-testid":"policy-documentation-link"},{default:e(()=>[d("span",Z,l(n("common.documentation")),1)]),_:2},1032,["href"])]),t(),d("h3",null,[c(q,{"policy-type":o.name},{default:e(()=>[t(l(n("policies.collection.title",{name:o.name})),1)]),_:2},1032,["policy-type"])])]),t(),d("div",{innerHTML:n(`policies.type.${o.name}.description`,void 0,{defaultMessage:n("policies.collection.description")})},null,8,j)]),_:2},1024),t(),c(z,null,{default:e(()=>[c(w,{src:`/meshes/${s.params.mesh}/policy-path/${s.params.policyPath}?page=${s.params.page}&size=${s.params.size}`,loader:!1},{default:e(({data:r})=>[c(M,{class:"policy-collection","data-testid":"policy-collection","empty-state-message":n("common.emptyState.message",{type:`${o.name} policies`}),"empty-state-cta-to":n("policies.href.docs",{name:o.name}),"empty-state-cta-text":n("common.documentation"),headers:[{label:"Name",key:"name"},{label:"Namespace",key:"namespace"},...S("use zones")&&o.isTargetRefBased?[{label:"Zone",key:"zone"}]:[],...o.isTargetRefBased?[{label:"Target ref",key:"targetRef"}]:[],{label:"Details",key:"details",hideLabel:!0}],"page-number":s.params.page,"page-size":s.params.size,total:r==null?void 0:r.total,items:r==null?void 0:r.items,"is-selected-row":a=>a.id===s.params.policy,onChange:s.update},{name:e(({row:a})=>[c(g,{to:{name:"policy-summary-view",params:{mesh:a.mesh,policyPath:o.path,policy:a.id},query:{page:s.params.page,size:s.params.size}}},{default:e(()=>[t(l(a.name),1)]),_:2},1032,["to"])]),namespace:e(({row:a})=>[t(l(a.namespace.length>0?a.namespace:n("common.detail.none")),1)]),targetRef:e(({row:a})=>{var h;return[o.isTargetRefBased&&typeof((h=a.spec)==null?void 0:h.targetRef)<"u"?(i(),p(_,{key:0,appearance:"neutral"},{default:e(()=>[t(l(a.spec.targetRef.kind),1),a.spec.targetRef.name?(i(),y("span",F,[t(":"),d("b",null,l(a.spec.targetRef.name),1)])):u("",!0)]),_:2},1024)):(i(),y(k,{key:1},[t(l(n("common.detail.none")),1)],64))]}),zone:e(({row:a})=>[a.labels&&a.labels["kuma.io/origin"]==="zone"&&a.labels["kuma.io/zone"]?(i(),p(V,{key:0,to:{name:"zone-cp-detail-view",params:{zone:a.labels["kuma.io/zone"]}}},{default:e(()=>[t(l(a.labels["kuma.io/zone"]),1)]),_:2},1032,["to"])):(i(),y(k,{key:1},[t(l(n("common.detail.none")),1)],64))]),details:e(({row:a})=>[c(g,{class:"details-link","data-testid":"details-link",to:{name:"policy-detail-view",params:{mesh:a.mesh,policyPath:o.path,policy:a.id}}},{default:e(()=>[t(l(n("common.collection.details_link"))+" ",1),c(v(H),{decorative:"",size:v(K)},null,8,["size"])]),_:2},1032,["to"])]),_:2},1032,["empty-state-message","empty-state-cta-to","empty-state-cta-text","headers","page-number","page-size","total","items","is-selected-row","onChange"]),t(),s.params.policy?(i(),p(P,{key:0},{default:e(({Component:a})=>[c(O,{onClose:h=>s.replace({name:"policy-list-view",params:{mesh:s.params.mesh,policyPath:s.params.policyPath},query:{page:s.params.page,size:s.params.size}})},{default:e(()=>[typeof r<"u"?(i(),p(I(a),{key:0,items:r.items,"policy-type":o},null,8,["items","policy-type"])):u("",!0)]),_:2},1032,["onClose"])]),_:2},1024)):u("",!0)]),_:2},1032,["src"])]),_:2},1024)])]),_:2},1024))),128))]),_:2},1032,["predicate","items"])]),_:2},1032,["params"])):u("",!0)]),_:1})}}}),te=E(J,[["__scopeId","data-v-114c58b9"]]);export{te as default};
