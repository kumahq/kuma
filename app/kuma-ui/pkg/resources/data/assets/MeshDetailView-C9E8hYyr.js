import{d as W,p as f,o as i,w as e,b as t,e as a,r,m as k,Q as z,q,c as g,L as C,N as w,O as K,t as p,l as R,K as Z,R as A,F as T,M as I,Y as P,H as j,y as ee,_ as te}from"./index-BEsZ2Mcw.js";import{S as se}from"./SummaryView-i_qhwKJD.js";import{K as ae}from"./kri-CjUta6FR.js";const ne=W({__name:"MeshDetailView",props:{mesh:{}},setup(F){const u=F;return(O,s)=>{const Y=r("RouteTitle"),L=r("XI18n"),M=r("XNotification"),B=r("XAction"),v=r("XBadge"),_=r("XLayout"),$=r("XAboutCard"),E=r("DataCollection"),S=r("XCard"),D=r("DataSource"),H=r("XSelect"),N=r("XCodeBlock"),x=r("DataLoader"),Q=r("RouterView"),G=r("AppView"),J=r("RouteView");return i(),f(J,{name:"mesh-detail-view",params:{mesh:"",environment:String}},{default:e(({route:l,t:m,uri:X,me:V})=>[t(Y,{title:m("meshes.routes.overview.title"),render:!1},null,8,["title"]),s[19]||(s[19]=a()),t(D,{src:X(k(j),"/mesh-insights/:name",{name:l.params.mesh})},{default:e(({data:d})=>[t(D,{src:X(k(z),"/meshes/:mesh/meshidentities",{mesh:l.params.mesh})},{default:e(({data:y})=>[t(D,{src:X(k(z),"/meshes/:mesh/meshtrusts",{mesh:l.params.mesh})},{default:e(({data:c})=>[t(G,{docs:m("meshes.href.docs"),notifications:!0},{default:e(()=>[t(x,{data:[y,c]},{default:e(()=>[t(M,{notify:!u.mesh.mtlsBackend,uri:`meshes.notifications.mtls-warning:${u.mesh.id}`},{default:e(()=>[t(L,{path:"meshes.notifications.mtls-warning"})]),_:1},8,["notify","uri"]),s[16]||(s[16]=a()),t(M,{notify:O.mesh.meshServices.mode==="Disabled",uri:`meshes.notifications.mesh-service-activation:${l.params.mesh}`,variant:"info"},{default:e(()=>[t(L,{path:"meshes.notifications.mesh-service-activation"})]),_:2},1032,["notify","uri"]),s[17]||(s[17]=a()),t(_,{type:"stack"},{default:e(()=>[t($,{title:m("meshes.routes.item.about.title"),created:u.mesh.creationTime,modified:u.mesh.modificationTime,class:"about-section"},{default:e(()=>[t(_,null,{default:e(()=>{var o;return[t(_,{type:"separated"},{default:e(()=>[(i(),g(w,null,C(["MeshTrafficPermission","MeshMetric","MeshAccessLog","MeshTrace"],n=>{var h;return i(),g(w,{key:n},[(i(!0),g(w,null,C([((h=d==null?void 0:d.policies)==null?void 0:h[n])??{total:0}],b=>(i(),g(w,{key:typeof b},[t(M,{notify:n==="MeshTrafficPermission"&&u.mesh.mtlsBackend&&b.total===0,uri:`meshes.notifications.mtp-warning:${u.mesh.id}`},{default:e(()=>[t(L,{path:"meshes.notifications.mtp-warning"})]),_:2},1032,["notify","uri"]),s[1]||(s[1]=a()),t(K,{layout:"horizontal"},{title:e(()=>[t(B,{to:{name:"policy-list-view",params:{mesh:l.params.mesh,policyPath:`${n.toLowerCase()}s`}}},{default:e(()=>[a(p(n),1)]),_:2},1032,["to"])]),body:e(()=>[t(v,{appearance:b.total>0?"success":"neutral"},{default:e(()=>[a(p(b.total>0?m("meshes.detail.enabled"):m("meshes.detail.disabled")),1)]),_:2},1032,["appearance"])]),_:2,__:[0]},1024)],64))),128))],64)}),64)),s[3]||(s[3]=a()),t(K,{layout:"horizontal"},{title:e(()=>[a(p(m("http.api.property.mtls")),1)]),body:e(()=>[u.mesh.mtlsBackend?(i(),f(v,{key:1,appearance:"info"},{default:e(()=>[a(p(u.mesh.mtlsBackend.type)+" / "+p(u.mesh.mtlsBackend.name),1)]),_:1})):(i(),f(v,{key:0,appearance:"neutral"},{default:e(()=>[a(p(m("meshes.detail.disabled")),1)]),_:2},1024))]),_:2,__:[2]},1024)]),_:2,__:[3]},1024),s[6]||(s[6]=a()),(o=y==null?void 0:y.items)!=null&&o.length?(i(),f(_,{key:0,"data-testid":"meshidentities-collection",class:"about-subsection"},{default:e(()=>[s[4]||(s[4]=R("h3",null,"MeshIdentities",-1)),s[5]||(s[5]=a()),t(_,{size:"small"},{default:e(()=>[t(_,{type:"separated"},{default:e(()=>[(i(!0),g(w,null,C(y.items,n=>(i(),f(B,{key:n.name,to:{name:"mesh-identity-summary-view",params:{name:n.name.toLocaleLowerCase()}}},{default:e(()=>[t(v,{appearance:"info"},{default:e(()=>[a(p(n.name),1)]),_:2},1024)]),_:2},1032,["to"]))),128))]),_:2},1024)]),_:2},1024)]),_:2,__:[4,5]},1024)):q("",!0)]}),_:2,__:[6]},1024)]),_:2},1032,["title","created","modified"]),s[13]||(s[13]=a()),t(S,{"data-testid":"mesh-trusts-listing"},{title:e(()=>[a(p(m("meshes.routes.item.mesh-trusts.title")),1)]),default:e(()=>[s[9]||(s[9]=a()),t(E,{type:"mesh-trusts",items:(c==null?void 0:c.items)??[]},{default:e(()=>[t(Z,{type:"mesh-trusts-collection",items:(c==null?void 0:c.items)??[],headers:[{...V.get("headers.identity"),label:m("meshes.routes.item.mesh-trusts.name"),key:"name"},{...V.get("headers.type"),label:m("meshes.routes.item.mesh-trusts.trust-domain"),key:"trustDomain"},{...V.get("headers.origin"),label:m("meshes.routes.item.mesh-trusts.origin"),key:"origin"}],onResize:V.set},{name:e(({row:o})=>[t(B,{class:"name-link",title:o.name,to:{name:"mesh-trust-summary-view",params:{name:o.name.toLocaleLowerCase()},query:{environment:l.params.environment}},"data-action":""},{default:e(()=>[R("b",null,p(o.name),1)]),_:2},1032,["title","to"])]),trustDomain:e(({row:o})=>[t(v,{appearance:"decorative"},{default:e(()=>[a(p(o.spec.trustDomain),1)]),_:2},1024)]),origin:e(({row:o})=>[t(B,{to:{name:"mesh-identity-summary-view",params:{name:k(ae).fromString(o.spec.origin.kri).name}},"data-action":""},{default:e(()=>[t(v,{appearance:"decorative"},{default:e(()=>[a(p(o.spec.origin.kri),1)]),_:2},1024)]),_:2},1032,["to"])]),_:2,__:[7,8]},1032,["items","headers","onResize"])]),_:2},1032,["items"])]),_:2,__:[9]},1024),s[14]||(s[14]=a()),t(S,null,{default:e(()=>[t(_,{type:"columns",class:"columns-with-borders"},{default:e(()=>[t(A,{total:(d==null?void 0:d.services.total)??0,"data-testid":"services-status"},{title:e(()=>[a(p(m("meshes.detail.services")),1)]),_:2},1032,["total"]),s[10]||(s[10]=a()),t(A,{total:(d==null?void 0:d.dataplanesByType.standard.total)??0,online:(d==null?void 0:d.dataplanesByType.standard.online)??0,"data-testid":"data-plane-proxies-status"},{title:e(()=>[a(p(m("meshes.detail.data_plane_proxies")),1)]),_:2},1032,["total","online"]),s[11]||(s[11]=a()),t(D,{src:X(k(T),"/policy-types",{})},{default:e(({data:o})=>[(i(!0),g(w,null,C([o==null?void 0:o.policyTypes.map(n=>n.name)],n=>(i(),f(A,{key:typeof n,total:Object.entries((d==null?void 0:d.resources)||{}).reduce((h,[b,{total:U}])=>(n||[]).includes(b)?h+U:h,0),"data-testid":"policies-status"},{title:e(()=>[a(p(m("meshes.detail.policies")),1)]),_:2},1032,["total"]))),128))]),_:2},1032,["src"])]),_:2,__:[10,11]},1024)]),_:2},1024),s[15]||(s[15]=a()),t(S,null,{default:e(()=>[t(_,null,{default:e(()=>[t(_,{type:"separated",justify:"end"},{default:e(()=>[(i(),g(w,null,C([["universal","k8s"]],o=>R("div",{key:typeof o},[t(H,{label:m("meshes.routes.item.format"),selected:l.params.environment,onChange:n=>{l.update({environment:n})},onVnodeBeforeMount:n=>{var h;return((h=n==null?void 0:n.props)==null?void 0:h.selected)&&o.includes(n.props.selected)&&n.props.selected!==l.params.environment&&l.update({environment:n.props.selected})}},I({_:2},[C(o,n=>({name:`${n}-option`,fn:e(()=>[a(p(m(`meshes.routes.item.formats.${n}`)),1)])}))]),1032,["label","selected","onChange","onVnodeBeforeMount"])])),64))]),_:2},1024),s[12]||(s[12]=a()),l.params.environment==="universal"?(i(),f(N,{key:0,"data-testid":"codeblock-yaml-universal",language:"yaml",code:k(P).stringify(u.mesh.config)},null,8,["code"])):(i(),f(x,{key:1,src:X(k(j),"/meshes/:name/as/kubernetes",{name:l.params.mesh})},{default:e(({data:o})=>[t(N,{"data-testid":"codeblock-yaml-k8s",language:"yaml",code:k(P).stringify(o)},null,8,["code"])]),_:2},1032,["src"]))]),_:2,__:[12]},1024)]),_:2},1024)]),_:2,__:[13,14,15]},1024),s[18]||(s[18]=a()),t(Q,null,{default:e(o=>[o.route.name!==l.name?(i(),f(se,{key:0,onClose:n=>l.replace({name:"mesh-detail-view",params:{mesh:l.params.mesh},query:{environment:l.params.environment}})},{default:e(()=>[(i(),f(ee(o.Component),{"mesh-identities":y==null?void 0:y.items,"mesh-trusts":c==null?void 0:c.items},null,8,["mesh-identities","mesh-trusts"]))]),_:2},1032,["onClose"])):q("",!0)]),_:2},1024)]),_:2,__:[16,17,18]},1032,["data"])]),_:2},1032,["docs"])]),_:2},1032,["src"])]),_:2},1032,["src"])]),_:2},1032,["src"])]),_:1,__:[19]})}}}),me=te(ne,[["__scopeId","data-v-d303bf17"]]);export{me as default};
