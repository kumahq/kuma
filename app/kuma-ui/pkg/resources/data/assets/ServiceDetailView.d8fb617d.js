import{d as h,o as t,c as x,e as g,a as k,b as N,i as l,j as O,F as P,cu as q,f as B,bP as s,h as y,c9 as _}from"./index.2d238a59.js";import{_ as E}from"./EmptyBlock.vue_vue_type_script_setup_true_lang.a51bf735.js";import{E as V}from"./ErrorBlock.6d694e33.js";import{_ as $}from"./LoadingBlock.vue_vue_type_script_setup_true_lang.ccaabdfd.js";import{D as b}from"./DataPlaneList.c0af1ec6.js";import{S as L}from"./ServiceSummary.513f1d1e.js";import"./ContentWrapper.6f82fa9b.js";import"./DataOverview.b81dc292.js";import"./StatusBadge.ce20a7cd.js";import"./TagList.ebca8e2c.js";import"./YamlView.vue_vue_type_script_setup_true_lang.196883ed.js";import"./index.58caa11d.js";import"./CodeBlock.vue_vue_type_style_index_0_lang.f5cf526a.js";import"./_commonjsHelpers.f037b798.js";const j={class:"component-frame"},A=h({__name:"ServiceDetails",props:{service:{type:Object,required:!0},externalService:{type:Object,required:!1,default:null},dataPlaneOverviews:{type:Array,required:!1,default:null},selectedDppName:{type:String,required:!1,default:null}},emits:["load-data"],setup(n,{emit:p}){const e=n;function m(a){p("load-data",a)}return(a,i)=>(t(),x(P,null,[g("div",j,[k(L,{service:e.service,"external-service":n.externalService},null,8,["service","external-service"])]),N(),e.dataPlaneOverviews!==null?(t(),l(b,{key:0,class:"mt-4","data-plane-overviews":e.dataPlaneOverviews,"selected-dpp-name":e.selectedDppName,onLoadData:m},null,8,["data-plane-overviews","selected-dpp-name"])):O("",!0)],64))}}),F={class:"service-details"},Y=h({__name:"ServiceDetailView",props:{selectedDppName:{type:String,required:!1,default:null}},setup(n){const p=n,e=q(),m=B(),a=s(null),i=s(null),d=s(null),f=s(!0),c=s(null);y(()=>e.params.mesh,function(){e.name==="service-detail-view"&&o()}),y(()=>e.params.name,function(){e.name==="service-detail-view"&&o()}),m.dispatch("updatePageTitle",e.params.service),o();async function o(){var w;f.value=!0,c.value=null,a.value=null,i.value=null,d.value=null;const u=e.params.mesh,v=e.params.service,D=`kuma.io/service:${v}`,S=!1;try{if(a.value=await _.getServiceInsight({mesh:u,name:v}),a.value.serviceType==="external")i.value=await _.getExternalService({mesh:u,name:v});else{const r=await _.getAllDataplaneOverviewsFromMesh({mesh:u},{gateway:S,tag:D});d.value=(w=r.items)!=null?w:[]}}catch(r){r instanceof Error?c.value=r:console.error(r)}finally{f.value=!1}}return(u,v)=>(t(),x("div",F,[f.value?(t(),l($,{key:0})):c.value!==null?(t(),l(V,{key:1,error:c.value},null,8,["error"])):a.value===null?(t(),l(E,{key:2})):(t(),l(A,{key:3,service:a.value,"data-plane-overviews":d.value,"external-service":i.value,"selected-dpp-name":p.selectedDppName,onLoadData:o},null,8,["service","data-plane-overviews","external-service","selected-dpp-name"]))]))}});export{Y as default};
