import{d as Q,p as c,o,w as e,b as t,e as a,r as m,m as v,Q as G,q as A,c as h,L as g,N as k,O as R,t as p,l as N,R as M,F as J,M as K,Y as x,H as z,y as U,_ as W}from"./index-GFWvH1vH.js";import{S as Z}from"./SummaryView-IpLItP5N.js";const I=Q({__name:"MeshDetailView",props:{mesh:{}},setup(P){const u=P;return(j,s)=>{const q=m("RouteTitle"),X=m("XI18n"),B=m("XNotification"),L=m("XAction"),b=m("XBadge"),f=m("XLayout"),F=m("XAboutCard"),V=m("DataSource"),S=m("XCard"),O=m("XSelect"),D=m("XCodeBlock"),T=m("DataLoader"),Y=m("RouterView"),$=m("AppView"),E=m("RouteView");return o(),c(E,{name:"mesh-detail-view",params:{mesh:"",environment:String}},{default:e(({route:r,t:d,uri:C})=>[t(q,{title:d("meshes.routes.overview.title"),render:!1},null,8,["title"]),s[15]||(s[15]=a()),t(V,{src:C(v(z),"/mesh-insights/:name",{name:r.params.mesh})},{default:e(({data:l})=>[t(V,{src:C(v(G),"/meshes/:mesh/meshidentities",{mesh:r.params.mesh})},{default:e(({data:_})=>[t($,{docs:d("meshes.href.docs"),notifications:!0},{default:e(()=>[t(T,{data:[_]},{default:e(()=>[t(B,{notify:!u.mesh.mtlsBackend,uri:`meshes.notifications.mtls-warning:${u.mesh.id}`},{default:e(()=>[t(X,{path:"meshes.notifications.mtls-warning"})]),_:1},8,["notify","uri"]),s[12]||(s[12]=a()),t(B,{notify:j.mesh.meshServices.mode==="Disabled",uri:`meshes.notifications.mesh-service-activation:${r.params.mesh}`,variant:"info"},{default:e(()=>[t(X,{path:"meshes.notifications.mesh-service-activation"})]),_:2},1032,["notify","uri"]),s[13]||(s[13]=a()),t(f,{type:"stack"},{default:e(()=>[t(F,{title:d("meshes.routes.item.about.title"),created:u.mesh.creationTime,modified:u.mesh.modificationTime,class:"about-section"},{default:e(()=>[t(f,null,{default:e(()=>{var i;return[t(f,{type:"separated"},{default:e(()=>[(o(),h(k,null,g(["MeshTrafficPermission","MeshMetric","MeshAccessLog","MeshTrace"],n=>{var y;return o(),h(k,{key:n},[(o(!0),h(k,null,g([((y=l==null?void 0:l.policies)==null?void 0:y[n])??{total:0}],w=>(o(),h(k,{key:typeof w},[t(B,{notify:n==="MeshTrafficPermission"&&u.mesh.mtlsBackend&&w.total===0,uri:`meshes.notifications.mtp-warning:${u.mesh.id}`},{default:e(()=>[t(X,{path:"meshes.notifications.mtp-warning"})]),_:2},1032,["notify","uri"]),s[1]||(s[1]=a()),t(R,{layout:"horizontal"},{title:e(()=>[t(L,{to:{name:"policy-list-view",params:{mesh:r.params.mesh,policyPath:`${n.toLowerCase()}s`}}},{default:e(()=>[a(p(n),1)]),_:2},1032,["to"])]),body:e(()=>[t(b,{appearance:w.total>0?"success":"neutral"},{default:e(()=>[a(p(w.total>0?d("meshes.detail.enabled"):d("meshes.detail.disabled")),1)]),_:2},1032,["appearance"])]),_:2,__:[0]},1024)],64))),128))],64)}),64)),s[3]||(s[3]=a()),t(R,{layout:"horizontal"},{title:e(()=>[a(p(d("http.api.property.mtls")),1)]),body:e(()=>[u.mesh.mtlsBackend?(o(),c(b,{key:1,appearance:"info"},{default:e(()=>[a(p(u.mesh.mtlsBackend.type)+" / "+p(u.mesh.mtlsBackend.name),1)]),_:1})):(o(),c(b,{key:0,appearance:"neutral"},{default:e(()=>[a(p(d("meshes.detail.disabled")),1)]),_:2},1024))]),_:2,__:[2]},1024)]),_:2,__:[3]},1024),s[6]||(s[6]=a()),(i=_==null?void 0:_.items)!=null&&i.length?(o(),c(f,{key:0,"data-testid":"meshidentities-collection",class:"about-subsection"},{default:e(()=>[s[4]||(s[4]=N("h3",null,"MeshIdentities",-1)),s[5]||(s[5]=a()),t(f,{size:"small"},{default:e(()=>[t(f,{type:"separated"},{default:e(()=>[(o(!0),h(k,null,g(_.items,n=>(o(),c(L,{key:n.name,to:{name:"mesh-identity-summary-view",params:{name:n.name.toLocaleLowerCase()}}},{default:e(()=>[t(b,{appearance:"info"},{default:e(()=>[a(p(n.name),1)]),_:2},1024)]),_:2},1032,["to"]))),128))]),_:2},1024)]),_:2},1024)]),_:2,__:[4,5]},1024)):A("",!0)]}),_:2,__:[6]},1024)]),_:2},1032,["title","created","modified"]),s[10]||(s[10]=a()),t(S,null,{default:e(()=>[t(f,{type:"columns",class:"columns-with-borders"},{default:e(()=>[t(M,{total:(l==null?void 0:l.services.total)??0,"data-testid":"services-status"},{title:e(()=>[a(p(d("meshes.detail.services")),1)]),_:2},1032,["total"]),s[7]||(s[7]=a()),t(M,{total:(l==null?void 0:l.dataplanesByType.standard.total)??0,online:(l==null?void 0:l.dataplanesByType.standard.online)??0,"data-testid":"data-plane-proxies-status"},{title:e(()=>[a(p(d("meshes.detail.data_plane_proxies")),1)]),_:2},1032,["total","online"]),s[8]||(s[8]=a()),t(V,{src:C(v(J),"/policy-types",{})},{default:e(({data:i})=>[(o(!0),h(k,null,g([i==null?void 0:i.policyTypes.map(n=>n.name)],n=>(o(),c(M,{key:typeof n,total:Object.entries((l==null?void 0:l.resources)||{}).reduce((y,[w,{total:H}])=>(n||[]).includes(w)?y+H:y,0),"data-testid":"policies-status"},{title:e(()=>[a(p(d("meshes.detail.policies")),1)]),_:2},1032,["total"]))),128))]),_:2},1032,["src"])]),_:2,__:[7,8]},1024)]),_:2},1024),s[11]||(s[11]=a()),t(S,null,{default:e(()=>[t(f,null,{default:e(()=>[t(f,{type:"separated",justify:"end"},{default:e(()=>[(o(),h(k,null,g([["universal","k8s"]],i=>N("div",{key:typeof i},[t(O,{label:d("meshes.routes.item.format"),selected:r.params.environment,onChange:n=>{r.update({environment:n})},onVnodeBeforeMount:n=>{var y;return((y=n==null?void 0:n.props)==null?void 0:y.selected)&&i.includes(n.props.selected)&&n.props.selected!==r.params.environment&&r.update({environment:n.props.selected})}},K({_:2},[g(i,n=>({name:`${n}-option`,fn:e(()=>[a(p(d(`meshes.routes.item.formats.${n}`)),1)])}))]),1032,["label","selected","onChange","onVnodeBeforeMount"])])),64))]),_:2},1024),s[9]||(s[9]=a()),r.params.environment==="universal"?(o(),c(D,{key:0,"data-testid":"codeblock-yaml-universal",language:"yaml",code:v(x).stringify(u.mesh.config)},null,8,["code"])):(o(),c(T,{key:1,src:C(v(z),"/meshes/:name/as/kubernetes",{name:r.params.mesh})},{default:e(({data:i})=>[t(D,{"data-testid":"codeblock-yaml-k8s",language:"yaml",code:v(x).stringify(i)},null,8,["code"])]),_:2},1032,["src"]))]),_:2,__:[9]},1024)]),_:2},1024)]),_:2,__:[10,11]},1024),s[14]||(s[14]=a()),t(Y,null,{default:e(i=>[i.route.name!==r.name?(o(),c(Z,{key:0,onClose:n=>r.replace({name:"mesh-detail-view",params:{mesh:r.params.mesh},query:{environment:r.params.environment}})},{default:e(()=>[(o(),c(U(i.Component),{"mesh-identities":_==null?void 0:_.items},null,8,["mesh-identities"]))]),_:2},1032,["onClose"])):A("",!0)]),_:2},1024)]),_:2,__:[12,13,14]},1032,["data"])]),_:2},1032,["docs"])]),_:2},1032,["src"])]),_:2},1032,["src"])]),_:1,__:[15]})}}}),se=W(I,[["__scopeId","data-v-0e896e2f"]]);export{se as default};
