import{d as L,u as k,i as l,k as w,o as S,e as D,a as C,c as R,n as T,cC as $,K as c,_ as B}from"./index.8c6a97c0.js";import{D as F}from"./DataOverview.7798887e.js";import{_ as M}from"./ServiceDetails.vue_vue_type_script_setup_true_lang.c95bf443.js";const N={class:"component-frame"},U=L({__name:"ServiceList",props:{type:{type:String,required:!0},tabHeaders:{type:Array,required:!0}},setup(E){const o=E,x={ServiceInsight:"internal services",ExternalService:"external services"},h=k(),y={title:"No Data",message:`There are no ${x[o.type]} present.`},u=l(!0),n=l(null),_=l(null),s=l(null),i=l({headers:o.tabHeaders,data:[]}),g=50;w(()=>h.params.mesh,function(){m(0)}),m(0);function b(e){return o.type==="ServiceInsight"?c.getAllServiceInsights(e):c.getAllExternalServices(e)}function I(e){return o.type==="ServiceInsight"?c.getAllServiceInsightsFromMesh({mesh:e}):c.getAllExternalServicesFromMesh({mesh:e})}function A(e){const a=e,v={name:e.type==="ServiceInsight"?"service-insight-detail-view":"external-service-detail-view",params:{mesh:e.mesh,service:e.name}};a.nameRoute=v;const t={name:"mesh-child",params:{mesh:e.mesh}};if(a.meshRoute=t,e.type==="ServiceInsight"){const{online:d=0,total:r=0}=e.dataplanes;a.totalOnline=`${d} / ${r}`,a.status=$[e.status].title}else a.address=e.networking.address,a.tlsEnabled=e.networking.tls.enabled?"Enabled":"Disabled";return a}async function m(e){u.value=!0,n.value=null;const a=h.params.mesh||null,v=()=>a==="all"||a===null?b({size:g,offset:e}):I(a);try{const{items:t,next:d}=await v();_.value=d,t.sort((r,p)=>r.name>p.name?1:r.name<p.name?-1:r.mesh.localeCompare(p.mesh)),t.length>0?(f(t[0]),i.value.data=t.map(r=>A(r))):(s.value=null,i.value.data=[])}catch(t){s.value=null,t instanceof Error?n.value=t:console.error(n)}finally{u.value=!1}}function f(e){s.value=e}return(e,a)=>(S(),D("div",N,[C(F,{"page-size":g,error:n.value,"has-error":n.value!==null,"is-loading":u.value,"empty-state":y,"table-data":i.value,"table-data-is-empty":i.value.data.length===0,next:_.value,onTableAction:f,onLoadData:m},null,8,["error","has-error","is-loading","table-data","table-data-is-empty","next"]),s.value!==null?(S(),R(M,{key:0,class:"service-details",type:s.value.type,name:s.value.name,mesh:s.value.mesh},null,8,["type","name","mesh"])):T("",!0)]))}});const K=B(U,[["__scopeId","data-v-29441488"]]);export{K as S};
