import{k as N,c1 as T,c2 as B,P as F,bU as q,c4 as K,c6 as V,c9 as H,c8 as D,cc as n,o as l,c as u,a as r,w as s,i as f,b as _,j as b,e as d,bV as v,F as w,cd as z}from"./index-08ba2993.js";import{Q as L}from"./QueryParameter-70743f73.js";import{D as P}from"./DataOverview-1eb5b106.js";import{E as R}from"./EnvoyData-c0f25ff2.js";import{F as W}from"./FrameSkeleton-fa914657.js";import{_ as Q}from"./LabelList.vue_vue_type_style_index_0_lang-0cdd88fc.js";import{S as U,a as j}from"./SubscriptionHeader-4b351f66.js";import{T as G}from"./TabsWidget-7c52524a.js";import"./EmptyBlock.vue_vue_type_script_setup_true_lang-cf69250c.js";import"./ErrorBlock-21576094.js";import"./LoadingBlock.vue_vue_type_script_setup_true_lang-778739a1.js";import"./StatusBadge-c118c8ba.js";import"./TagList-e8e9bfa1.js";import"./CodeBlock.vue_vue_type_style_index_0_lang-e26b650c.js";import"./_commonjsHelpers-87174ba5.js";const M={name:"ZoneEgresses",components:{AccordionItem:T,AccordionList:B,DataOverview:P,EnvoyData:R,FrameSkeleton:W,LabelList:Q,SubscriptionDetails:U,SubscriptionHeader:j,TabsWidget:G,KButton:F,KCard:q},props:{selectedZoneEgressName:{type:String,required:!1,default:null},offset:{type:Number,required:!1,default:0}},data(){return{isLoading:!0,isEmpty:!1,error:null,empty_state:{title:"No Data",message:"There are no Zone Egresses present."},tableData:{headers:[{key:"actions",hideLabel:!0},{label:"Status",key:"status"},{label:"Name",key:"name"}],data:[]},tabs:[{hash:"#overview",title:"Overview"},{hash:"#insights",title:"Zone Egress Insights"},{hash:"#xds-configuration",title:"XDS Configuration"},{hash:"#envoy-stats",title:"Stats"},{hash:"#envoy-clusters",title:"Clusters"}],entity:{},rawData:[],pageSize:K,next:null,subscriptionsReversed:[],pageOffset:this.offset}},watch:{$route(){this.isLoading=!0,this.isEmpty=!1,this.error=null,this.loadData(0)}},beforeMount(){this.loadData(this.offset)},methods:{tableAction(a){const i=a;this.getEntity(i)},async loadData(a){this.pageOffset=a,L.set("offset",a>0?a:null),this.isLoading=!0,this.isEmpty=!1;const i=this.$route.query.ns||null,o=this.pageSize;try{const{data:t,next:e}=await this.getZoneEgressOverviews(i,o,a);this.next=e,t.length?(this.isEmpty=!1,this.rawData=t,this.getEntity({name:this.selectedZoneEgressName??t[0].name}),this.tableData.data=t.map(c=>{const{zoneEgressInsight:g={}}=c,y=V(g);return{...c,status:y}})):(this.tableData.data=[],this.isEmpty=!0)}catch(t){t instanceof Error?this.error=t:console.error(t),this.isEmpty=!0}finally{this.isLoading=!1}},getEntity(a){var e;const i=["type","name"],o=this.rawData.find(c=>c.name===a.name),t=((e=o==null?void 0:o.zoneEgressInsight)==null?void 0:e.subscriptions)??[];this.subscriptionsReversed=Array.from(t).reverse(),this.entity=H(o,i),L.set("zoneEgress",this.entity.name)},async getZoneEgressOverviews(a,i,o){if(a)return{data:[await D.getZoneEgressOverview({name:a},{size:i,offset:o})],next:null};{const{items:t,next:e}=await D.getAllZoneEgressOverviews({size:i,offset:o});return{data:t??[],next:e}}}}},X={class:"zoneegresses"},J={class:"entity-heading"},Y={key:0};function $(a,i,o,t,e,c){const g=n("KButton"),y=n("DataOverview"),S=n("LabelList"),k=n("SubscriptionHeader"),x=n("SubscriptionDetails"),A=n("AccordionItem"),O=n("AccordionList"),Z=n("KCard"),h=n("EnvoyData"),C=n("TabsWidget"),I=n("FrameSkeleton");return l(),u("div",X,[r(I,null,{default:s(()=>{var E;return[r(y,{"selected-entity-name":(E=e.entity)==null?void 0:E.name,"page-size":e.pageSize,"is-loading":e.isLoading,error:e.error,"empty-state":e.empty_state,"table-data":e.tableData,"table-data-is-empty":e.isEmpty,next:e.next,"page-offset":e.pageOffset,onTableAction:c.tableAction,onLoadData:c.loadData},{additionalControls:s(()=>[a.$route.query.ns?(l(),f(g,{key:0,class:"back-button",appearance:"primary",icon:"arrowLeft",to:{name:"zoneegresses"}},{default:s(()=>[_(`
            View all
          `)]),_:1})):b("",!0)]),_:1},8,["selected-entity-name","page-size","is-loading","error","empty-state","table-data","table-data-is-empty","next","page-offset","onTableAction","onLoadData"]),_(),e.isEmpty===!1?(l(),f(C,{key:0,"has-error":e.error!==null,"is-loading":e.isLoading,tabs:e.tabs},{tabHeader:s(()=>[d("h1",J,`
            Zone Egress: `+v(e.entity.name),1)]),overview:s(()=>[r(S,null,{default:s(()=>[d("div",null,[d("ul",null,[(l(!0),u(w,null,z(e.entity,(m,p)=>(l(),u("li",{key:p},[m?(l(),u("h4",Y,v(p),1)):b("",!0),_(),d("p",null,v(m),1)]))),128))])])]),_:1})]),insights:s(()=>[r(Z,{"border-variant":"noBorder"},{body:s(()=>[r(O,{"initially-open":0},{default:s(()=>[(l(!0),u(w,null,z(e.subscriptionsReversed,(m,p)=>(l(),f(A,{key:p},{"accordion-header":s(()=>[r(k,{details:m},null,8,["details"])]),"accordion-content":s(()=>[r(x,{details:m,"is-discovery-subscription":""},null,8,["details"])]),_:2},1024))),128))]),_:1})]),_:1})]),"xds-configuration":s(()=>[r(h,{"data-path":"xds","zone-egress-name":e.entity.name,"query-key":"envoy-data-zone-egress"},null,8,["zone-egress-name"])]),"envoy-stats":s(()=>[r(h,{"data-path":"stats","zone-egress-name":e.entity.name,"query-key":"envoy-data-zone-egress"},null,8,["zone-egress-name"])]),"envoy-clusters":s(()=>[r(h,{"data-path":"clusters","zone-egress-name":e.entity.name,"query-key":"envoy-data-zone-egress"},null,8,["zone-egress-name"])]),_:1},8,["has-error","is-loading","tabs"])):b("",!0)]}),_:1})])}const ye=N(M,[["render",$]]);export{ye as default};
