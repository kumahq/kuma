import{g as C,K as I,f as w,p as x,A as N,o as T,E as S,r as A,s as B,_ as V}from"./RouteView.vue_vue_type_script_setup_true_lang-d3d8e82f.js";import{d as $,r as E,o as n,e as h,h as i,b as e,g as s,q as r,t as l,u as K,w as o,F as L,s as O,n as U,G as z,a as m,Y as b,f as P,V as q,D as F,v as G,H as Y}from"./index-be7916f4.js";import{A as D}from"./AppCollection-14c097cb.js";import{P as H}from"./PolicyTypeTag-6802eac8.js";import{n as X}from"./notEmpty-7f452b20.js";import{_ as Z}from"./RouteTitle.vue_vue_type_script_setup_true_lang-d0d3b813.js";import"./WarningIcon.vue_vue_type_script_setup_true_lang-33662e2f.js";const j=["href"],J={class:"visually-hidden"},M=$({__name:"DocumentationLink",props:{href:{type:String,required:!0}},setup(f){const y=f,{t}=C();return(c,g)=>{const _=E("KIcon");return n(),h("a",{class:"docs-link",href:y.href,target:"_blank"},[i(_,{icon:"book",color:"currentColor",size:e(I),title:e(t)("common.documentation")},null,8,["size","title"]),s(),r("span",J,l(e(t)("common.documentation")),1)],8,j)}}});const Q=w(M,[["__scopeId","data-v-2e1f886d"]]),W={class:"policy-list-content"},ee={class:"policy-count"},te={class:"policy-list"},oe={class:"stack"},se={class:"description"},ie={class:"description-content"},ae={class:"description-actions"},ne={key:0},ce=$({__name:"PolicyList",props:{pageNumber:{},pageSize:{},policyTypes:{},currentPolicyType:{},policyCollection:{},policyError:{},meshInsight:{}},emits:["change"],setup(f,{emit:y}){const t=f,{t:c}=C(),g=K();return(_,d)=>{const k=E("RouterLink");return n(),h("div",W,[i(e(z),{class:"policy-type-list","data-testid":"policy-type-list"},{body:o(()=>[(n(!0),h(L,null,O(t.policyTypes,(p,u)=>{var a,v,R;return n(),h("div",{key:u,class:U(["policy-type-link-wrapper",{"policy-type-link-wrapper--is-active":p.path===t.currentPolicyType.path}])},[i(k,{class:"policy-type-link",to:{name:"policies-list-view",params:{mesh:e(g).params.mesh,policyPath:p.path}},"data-testid":`policy-type-link-${p.name}`},{default:o(()=>[s(l(p.name),1)]),_:2},1032,["to","data-testid"]),s(),r("div",ee,l(((R=(v=(a=t.meshInsight)==null?void 0:a.policies)==null?void 0:v[p.name])==null?void 0:R.total)??0),1)],2)}),128))]),_:1}),s(),r("div",te,[r("div",oe,[i(e(z),null,{body:o(()=>[r("div",se,[r("div",ie,[r("h3",null,[i(H,{"policy-type":t.currentPolicyType.name},{default:o(()=>[s(l(e(c)("policies.collection.title",{name:t.currentPolicyType.name})),1)]),_:1},8,["policy-type"])]),s(),r("p",null,l(e(c)("policies.collection.description")),1)]),s(),r("div",ae,[t.currentPolicyType.isExperimental?(n(),m(e(b),{key:0,appearance:"warning"},{default:o(()=>[s(l(e(c)("policies.collection.beta")),1)]),_:1})):P("",!0),s(),t.currentPolicyType.isInbound?(n(),m(e(b),{key:1,appearance:"neutral"},{default:o(()=>[s(l(e(c)("policies.collection.inbound")),1)]),_:1})):P("",!0),s(),t.currentPolicyType.isOutbound?(n(),m(e(b),{key:2,appearance:"neutral"},{default:o(()=>[s(l(e(c)("policies.collection.outbound")),1)]),_:1})):P("",!0),s(),i(Q,{href:e(c)("policies.href.docs",{name:t.currentPolicyType.name}),"data-testid":"policy-documentation-link"},null,8,["href"])])])]),_:1}),s(),i(e(z),null,{body:o(()=>{var p,u;return[i(D,{class:"policy-collection","data-testid":"policy-collection","empty-state-title":e(c)("common.emptyState.title"),"empty-state-message":e(c)("common.emptyState.message",{type:`${t.currentPolicyType.name} policies`}),headers:[{label:"Name",key:"name"},t.currentPolicyType.isTargetRefBased?{label:"Target ref",key:"targetRef"}:void 0,{label:"Actions",key:"actions",hideLabel:!0}].filter(e(X)),"page-number":t.pageNumber,"page-size":t.pageSize,total:(p=t.policyCollection)==null?void 0:p.total,items:(u=t.policyCollection)==null?void 0:u.items,error:t.policyError,onChange:d[0]||(d[0]=a=>y("change",a))},{name:o(({rowValue:a})=>[i(k,{to:{name:"policy-detail-view",params:{mesh:e(g).params.mesh,policyPath:t.currentPolicyType.path,policy:a}}},{default:o(()=>[s(l(a),1)]),_:2},1032,["to"])]),targetRef:o(({row:a})=>[t.currentPolicyType.isTargetRefBased?(n(),m(e(b),{key:0,appearance:"neutral"},{default:o(()=>[s(l(a.spec.targetRef.kind),1),a.spec.targetRef.name?(n(),h("span",ne,[s(":"),r("b",null,l(a.spec.targetRef.name),1)])):P("",!0)]),_:2},1024)):(n(),h(L,{key:1},[s(l(e(c)("common.detail.none")),1)],64))]),actions:o(({row:a})=>[i(e(q),{class:"actions-dropdown","kpop-attributes":{placement:"bottomEnd",popoverClasses:"mt-5 more-actions-popover"},width:"150"},{default:o(()=>[i(e(F),{class:"non-visual-button",appearance:"secondary",size:"small"},{icon:o(()=>[i(e(G),{color:e(x),icon:"more",size:e(I)},null,8,["color","size"])]),_:1})]),items:o(()=>[i(e(Y),{item:{to:{name:"policy-detail-view",params:{mesh:e(g).params.mesh,policyPath:t.currentPolicyType.path,policy:a.name}},label:e(c)("common.collection.actions.view")}},null,8,["item"])]),_:2},1024)]),_:1},8,["empty-state-title","empty-state-message","headers","page-number","page-size","total","items","error"])]}),_:1})])])])}}});const le=w(ce,[["__scopeId","data-v-e4d7fe01"]]),he=$({__name:"PolicyListView",props:{page:{},size:{}},setup(f){const y=f,{t}=C();return(c,g)=>(n(),m(V,{name:"policies-list-view"},{default:o(({route:_})=>[i(N,null,{title:o(()=>[r("h2",null,[i(Z,{title:e(t)("policies.routes.items.title"),render:!0},null,8,["title"])])]),default:o(()=>[s(),i(T,{src:"/*/policy-types"},{default:o(({data:d,error:k})=>[k?(n(),m(S,{key:0,error:k},null,8,["error"])):d===void 0?(n(),m(A,{key:1})):d.policies.length===0?(n(),m(B,{key:2})):(n(),m(T,{key:3,src:`/meshes/${_.params.mesh}/policy-path/${_.params.policyPath}?page=${y.page}&size=${y.size}`},{default:o(({data:p,error:u})=>[i(T,{src:`/mesh-insights/${_.params.mesh}`},{default:o(({data:a})=>[i(le,{"page-number":y.page,"page-size":y.size,"current-policy-type":d.policies.find(v=>v.path===_.params.policyPath)??d.policies[0],"policy-types":d.policies,"mesh-insight":a,"policy-collection":p,"policy-error":u,onChange:_.update},null,8,["page-number","page-size","current-policy-type","policy-types","mesh-insight","policy-collection","policy-error","onChange"])]),_:2},1032,["src"])]),_:2},1032,["src"]))]),_:2},1024)]),_:2},1024)]),_:1}))}});export{he as default};
