import{M as P}from"./kongponents.es-131ffe48.js";import{d as Q,u as R,r as o,v as U,y as $,A as j,B as G,j as _,i as v,g as i,w as a,b as T,h as E,e as g,f as Z,E as N,o as c,t as q,F as I,q as L}from"./index-834ac640.js";import{A as H,a as K}from"./AccordionList-1e1780b1.js";import{D as W}from"./DataOverview-9d4155bf.js";import{D as X,a as Y}from"./DefinitionListItem-e9b95b5e.js";import{E as b}from"./EnvoyData-d0f245f3.js";import{_ as J,S as ee}from"./SubscriptionHeader.vue_vue_type_script_setup_true_lang-2d02714a.js";import{T as ae}from"./TabsWidget-b8241f4a.js";import{u as te}from"./index-0e952743.js";import{Q as B}from"./QueryParameter-70743f73.js";import"./_plugin-vue_export-helper-c27b6911.js";import"./ErrorBlock-42ddf946.js";import"./LoadingBlock.vue_vue_type_script_setup_true_lang-4325e9aa.js";import"./datadogLogEvents-302eea7b.js";import"./TagList-7389a145.js";import"./store-bb95959d.js";import"./StatusBadge-1d0340ff.js";import"./CodeBlock.vue_vue_type_style_index_0_lang-82e53469.js";import"./StatusInfo.vue_vue_type_script_setup_true_lang-875056ff.js";const se={class:"zoneegresses"},ne={class:"kcard-stack"},re={class:"kcard-border"},oe={class:"kcard-border"},le={class:"entity-heading"},xe=Q({__name:"ZoneEgresses",props:{selectedZoneEgressName:{type:String,required:!1,default:null},offset:{type:Number,required:!1,default:0}},setup(O){const f=O,z=te(),C={title:"No Data",message:"There are no Zone Egresses present."},V=[{hash:"#overview",title:"Overview"},{hash:"#insights",title:"Zone Egress Insights"},{hash:"#xds-configuration",title:"XDS Configuration"},{hash:"#envoy-stats",title:"Stats"},{hash:"#envoy-clusters",title:"Clusters"}],p=R(),m=o(!0),u=o(!1),d=o(null),y=o({headers:[{label:"Status",key:"status"},{label:"Name",key:"name"}],data:[]}),l=o(null),k=o([]),w=o(null),D=o([]),A=o(f.offset);U(()=>p.params.mesh,function(){p.name==="zoneegresses"&&(m.value=!0,u.value=!1,d.value=null,h(0))}),$(function(){h(f.offset)});async function h(t){A.value=t,B.set("offset",t>0?t:null),m.value=!0,u.value=!1;const s=p.query.ns||null,r=N;try{const{data:e,next:n}=await F(s,r,t);w.value=n,e.length?(u.value=!1,k.value=e,x({name:f.selectedZoneEgressName??e[0].name}),y.value.data=e.map(S=>{const M=j(S.zoneEgressInsight??{});return{...S,status:M}})):(y.value.data=[],u.value=!0)}catch(e){e instanceof Error?d.value=e:console.error(e),u.value=!0}finally{m.value=!1}}function x({name:t}){var e;const s=k.value.find(n=>n.name===t),r=((e=s==null?void 0:s.zoneEgressInsight)==null?void 0:e.subscriptions)??[];D.value=Array.from(r).reverse(),l.value=G(s,["type","name"]),B.set("zoneEgress",t)}async function F(t,s,r){if(t)return{data:[await z.getZoneEgressOverview({name:t},{size:s,offset:r})],next:null};{const{items:e,next:n}=await z.getAllZoneEgressOverviews({size:s,offset:r});return{data:e??[],next:n}}}return(t,s)=>{var r;return c(),_("div",se,[v("div",ne,[v("div",re,[i(W,{"selected-entity-name":(r=l.value)==null?void 0:r.name,"page-size":T(N),"is-loading":m.value,error:d.value,"empty-state":C,"table-data":y.value,"table-data-is-empty":u.value,next:w.value,"page-offset":A.value,onTableAction:x,onLoadData:h},{additionalControls:a(()=>[t.$route.query.ns?(c(),g(T(P),{key:0,class:"back-button",appearance:"primary",icon:"arrowLeft",to:{name:"zoneegresses"}},{default:a(()=>[E(`
              View all
            `)]),_:1})):Z("",!0)]),_:1},8,["selected-entity-name","page-size","is-loading","error","table-data","table-data-is-empty","next","page-offset"])]),E(),v("div",oe,[u.value===!1&&l.value!==null?(c(),g(ae,{key:0,"has-error":d.value!==null,"is-loading":m.value,tabs:V},{tabHeader:a(()=>[v("h1",le,`
              Zone Egress: `+q(l.value.name),1)]),overview:a(()=>[i(Y,null,{default:a(()=>[(c(!0),_(I,null,L(l.value,(e,n)=>(c(),g(X,{key:n,term:n},{default:a(()=>[E(q(e),1)]),_:2},1032,["term"]))),128))]),_:1})]),insights:a(()=>[i(K,{"initially-open":0},{default:a(()=>[(c(!0),_(I,null,L(D.value,(e,n)=>(c(),g(H,{key:n},{"accordion-header":a(()=>[i(J,{details:e},null,8,["details"])]),"accordion-content":a(()=>[i(ee,{details:e,"is-discovery-subscription":""},null,8,["details"])]),_:2},1024))),128))]),_:1})]),"xds-configuration":a(()=>[i(b,{"data-path":"xds","zone-egress-name":l.value.name,"query-key":"envoy-data-zone-egress"},null,8,["zone-egress-name"])]),"envoy-stats":a(()=>[i(b,{"data-path":"stats","zone-egress-name":l.value.name,"query-key":"envoy-data-zone-egress"},null,8,["zone-egress-name"])]),"envoy-clusters":a(()=>[i(b,{"data-path":"clusters","zone-egress-name":l.value.name,"query-key":"envoy-data-zone-egress"},null,8,["zone-egress-name"])]),_:1},8,["has-error","is-loading"])):Z("",!0)])])])}}});export{xe as default};
