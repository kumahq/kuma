import{d as y,o as r,i as x,j as S,a as g,b as D,c as i,A as O,F as P,q as B,r as n,f as w,k as f,s as E}from"./index.5ff69d99.js";import{_ as V}from"./EmptyBlock.vue_vue_type_script_setup_true_lang.815effe0.js";import{E as $}from"./ErrorBlock.9183b6a0.js";import{_ as q}from"./LoadingBlock.vue_vue_type_script_setup_true_lang.5eb6ebf0.js";import{D as A}from"./DataPlaneList.3d3afd83.js";import{S as L}from"./ServiceSummary.9316e784.js";import"./ContentWrapper.1c550e69.js";import"./patchQueryParam.9388b199.js";import"./StatusBadge.c8d9a87a.js";import"./TagList.7813b18d.js";import"./YamlView.vue_vue_type_script_setup_true_lang.7ae7a12d.js";import"./index.58caa11d.js";import"./CodeBlock.vue_vue_type_style_index_0_lang.21ca60cf.js";import"./_commonjsHelpers.f037b798.js";const N={class:"component-frame"},b=y({__name:"ServiceDetails",props:{service:{type:Object,required:!0},externalService:{type:Object,required:!1,default:null},dataPlaneOverviews:{type:Array,required:!1,default:null}},emits:["load-data"],setup(p,{emit:e}){const s=p;function a(t){e("load-data",t)}return(t,o)=>(r(),x(P,null,[S("div",N,[g(L,{service:s.service,"external-service":p.externalService},null,8,["service","external-service"])]),D(),s.dataPlaneOverviews!==null?(r(),i(A,{key:0,class:"mt-4","data-plane-overviews":s.dataPlaneOverviews,onLoadData:a},null,8,["data-plane-overviews"])):O("",!0)],64))}}),j={class:"service-details"},X=y({__name:"ServiceDetailView",setup(p){const e=B(),s=E(),a=n(null),t=n(null),o=n(null),d=n(!0),c=n(null);w(()=>e.params.mesh,function(){e.name==="service-detail-view"&&v()}),w(()=>e.params.name,function(){e.name==="service-detail-view"&&v()}),s.dispatch("updatePageTitle",e.params.service),v();async function v(){var _;d.value=!0,c.value=null,a.value=null,t.value=null,o.value=null;const u=e.params.mesh,m=e.params.service,h=`kuma.io/service:${m}`,k=!1;try{if(a.value=await f.getServiceInsight({mesh:u,name:m}),a.value.serviceType==="external")t.value=await f.getExternalService({mesh:u,name:m});else{const l=await f.getAllDataplaneOverviewsFromMesh({mesh:u},{gateway:k,tag:h});o.value=(_=l.items)!=null?_:[]}}catch(l){l instanceof Error?c.value=l:console.error(l)}finally{d.value=!1}}return(u,m)=>(r(),x("div",j,[d.value?(r(),i(q,{key:0})):c.value!==null?(r(),i($,{key:1,error:c.value},null,8,["error"])):a.value===null?(r(),i(V,{key:2})):(r(),i(b,{key:3,service:a.value,"data-plane-overviews":o.value,"external-service":t.value,onLoadData:v},null,8,["service","data-plane-overviews","external-service"]))]))}});export{X as default};
