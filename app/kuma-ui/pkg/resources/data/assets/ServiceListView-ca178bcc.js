import{d as S,r as n,o as a,i as l,w as s,S as $,t as V,j as o,p as L,n as r,E as A,H as c,a1 as N,l as m,F as _,k as b,$ as E,K as q,I as P,q as F,m as C}from"./index-9f06f70e.js";import{A as M}from"./AppCollection-033a3363.js";import{S as j}from"./StatusBadge-1cd457c8.js";import"./EmptyBlock.vue_vue_type_script_setup_true_lang-3a3fb8ea.js";const H=S({__name:"TrayView",emits:["close"],setup(z,{emit:w}){const g=w;return(u,d)=>{const v=n("KSlideout");return a(),l(v,{class:"tray","close-button-alignment":"end","has-overlay":!1,"is-visible":"","data-testid":"tray",onClose:d[0]||(d[0]=f=>g("close"))},{default:s(()=>[$(u.$slots,"default",{},void 0,!0)]),_:3})}}});const O=V(H,[["__scopeId","data-v-4fd23d3e"]]),Q=S({__name:"ServiceListView",setup(z){return(w,g)=>{const u=n("RouteTitle"),d=n("RouterLink"),v=n("KButton"),f=n("KDropdownItem"),K=n("KDropdownMenu"),x=n("KCard"),I=n("RouterView"),T=n("AppView"),k=n("DataSource"),B=n("RouteView");return a(),l(k,{src:"/me"},{default:s(({data:h})=>[h?(a(),l(B,{key:0,name:"service-list-view",params:{page:1,size:h.pageSize,mesh:"",service:""}},{default:s(({route:t,t:p})=>[o(k,{src:`/meshes/${t.params.mesh}/service-insights?page=${t.params.page}&size=${t.params.size}`},{default:s(({data:i,error:y})=>[o(T,null,{title:s(()=>[L("h2",null,[o(u,{title:p("services.routes.items.title"),render:!0},null,8,["title"])])]),default:s(()=>[r(),o(x,null,{body:s(()=>[y!==void 0?(a(),l(A,{key:0,error:y},null,8,["error"])):(a(),l(M,{key:1,class:"service-collection","data-testid":"service-collection","empty-state-message":p("common.emptyState.message",{type:"Services"}),headers:[{label:"Name",key:"name"},{label:"Type",key:"serviceType"},{label:"Address",key:"addressPort"},{label:"DP proxies (online / total)",key:"online"},{label:"Status",key:"status"},{label:"Actions",key:"actions",hideLabel:!0}],"page-number":parseInt(t.params.page),"page-size":parseInt(t.params.size),total:i==null?void 0:i.total,items:i==null?void 0:i.items,error:y,"is-selected-row":e=>e.name===t.params.service,onChange:t.update},{name:s(({row:e})=>[o(d,{to:{name:"service-tray-view",params:{mesh:e.mesh,service:e.name},query:{page:t.params.page,size:t.params.size}}},{default:s(()=>[r(c(e.name),1)]),_:2},1032,["to"])]),serviceType:s(({rowValue:e})=>[r(c(e||"internal"),1)]),addressPort:s(({rowValue:e})=>[e?(a(),l(N,{key:0,text:e},null,8,["text"])):(a(),m(_,{key:1},[r(c(p("common.collection.none")),1)],64))]),online:s(({row:e})=>[e.dataplanes?(a(),m(_,{key:0},[r(c(e.dataplanes.online||0)+" / "+c(e.dataplanes.total||0),1)],64)):(a(),m(_,{key:1},[r(c(p("common.collection.none")),1)],64))]),status:s(({row:e})=>[o(j,{status:e.status||"not_available"},null,8,["status"])]),actions:s(({row:e})=>[o(K,{class:"actions-dropdown","kpop-attributes":{placement:"bottomEnd",popoverClasses:"mt-5 more-actions-popover"},width:"150"},{default:s(()=>[o(v,{class:"non-visual-button",appearance:"secondary",size:"small"},{default:s(()=>[o(b(E),{size:b(q)},null,8,["size"])]),_:1})]),items:s(()=>[o(f,{item:{to:{name:"service-detail-view",params:{service:e.name}},label:p("common.collection.actions.view")},"data-testid":"dropdown-view-details-item"},null,8,["item"])]),_:2},1024)]),_:2},1032,["empty-state-message","headers","page-number","page-size","total","items","error","is-selected-row","onChange"]))]),_:2},1024),r(),(a(!0),m(_,null,P([i==null?void 0:i.items.find(e=>e.name===t.params.service)],(e,D)=>(a(),m(_,{key:D},[e?(a(),l(I,{key:0},{default:s(R=>[o(O,{onClose:U=>t.replace({name:"service-list-view",params:{mesh:t.params.mesh},query:{page:t.params.page,size:t.params.size}})},{default:s(()=>[(a(),l(F(R.Component),{data:e},null,8,["data"]))]),_:2},1032,["onClose"])]),_:2},1024)):C("",!0)],64))),128))]),_:2},1024)]),_:2},1032,["src"])]),_:2},1032,["params"])):C("",!0)]),_:1})}}});const X=V(Q,[["__scopeId","data-v-ee000e69"]]);export{X as default};
