import{a as R,M as U}from"./kongponents.es-3ba46133.js";import{u as G,h as H,i as K,k as N}from"./production-554ae9d4.js";import{_ as W}from"./MultizoneInfo.vue_vue_type_script_setup_true_lang-6f1ae62e.js";import{a as X,A as Y}from"./AccordionList-5d53cdd5.js";import{D as j}from"./DataOverview-1c2773e2.js";import{E as I}from"./EnvoyData-d1dabd66.js";import{F as J}from"./FrameSkeleton-2cb333d2.js";import{_ as ee}from"./LabelList.vue_vue_type_style_index_0_lang-45f41bec.js";import{_ as te,S as ae}from"./SubscriptionHeader.vue_vue_type_script_setup_true_lang-747b6d71.js";import{T as se}from"./TabsWidget-dd282fe5.js";import{u as ne}from"./store-f2021894.js";import{u as re}from"./index-36b3783c.js";import{Q as q}from"./QueryParameter-70743f73.js";import{d as oe,r as o,q as le,a3 as ie,o as l,h as g,u as p,a as d,w as a,e as i,f as z,b as O,g as f,t as w,F as B,l as L}from"./runtime-dom.esm-bundler-9284044f.js";import"./_plugin-vue_export-helper-c27b6911.js";import"./EmptyBlock.vue_vue_type_script_setup_true_lang-1dc4f3b2.js";import"./ErrorBlock-53b18c33.js";import"./LoadingBlock.vue_vue_type_script_setup_true_lang-55aeae37.js";import"./datadogLogEvents-302eea7b.js";import"./TagList-67637749.js";import"./StatusBadge-832cc4dd.js";import"./CodeBlock.vue_vue_type_style_index_0_lang-c7bd4e33.js";const ue={class:"zoneingresses"},ce={class:"entity-heading"},qe=oe({__name:"ZoneIngresses",props:{selectedZoneIngressName:{type:String,required:!1,default:null},offset:{type:Number,required:!1,default:0}},setup(C){const y=C,k=re(),F={title:"No Data",message:"There are no Zone Ingresses present."},M=[{hash:"#overview",title:"Overview"},{hash:"#insights",title:"Zone Ingress Insights"},{hash:"#xds-configuration",title:"XDS Configuration"},{hash:"#envoy-stats",title:"Stats"},{hash:"#envoy-clusters",title:"Clusters"}],h=G(),S=ne(),m=o(!0),c=o(!1),v=o(null),_=o({headers:[{label:"Actions",key:"actions",hideLabel:!0},{label:"Status",key:"status"},{label:"Name",key:"name"}],data:[]}),u=o(null),A=o([]),x=o(null),D=o([]),E=o(y.offset);le(()=>h.params.mesh,function(){h.name==="zoneingresses"&&(m.value=!0,c.value=!1,v.value=null,b(0))}),ie(function(){V(y.offset)});function V(t){S.getters["config/getMulticlusterStatus"]&&b(t)}async function b(t){E.value=t,q.set("offset",t>0?t:null),m.value=!0,c.value=!1;const s=h.query.ns||null,r=N;try{const{data:e,next:n}=await $(s,r,t);x.value=n,e.length?(c.value=!1,A.value=e,T({name:y.selectedZoneIngressName??e[0].name}),_.value.data=e.map(Z=>{const{zoneIngressInsight:P={}}=Z,Q=H(P);return{...Z,status:Q}})):(_.value.data=[],c.value=!0)}catch(e){e instanceof Error?v.value=e:console.error(e),c.value=!0}finally{m.value=!1}}function T({name:t}){var e;const s=A.value.find(n=>n.name===t),r=((e=s==null?void 0:s.zoneIngressInsight)==null?void 0:e.subscriptions)??[];D.value=Array.from(r).reverse(),u.value=K(s,["type","name"]),q.set("zoneIngress",t)}async function $(t,s,r){if(t)return{data:[await k.getZoneIngressOverview({name:t},{size:s,offset:r})],next:null};{const{items:e,next:n}=await k.getAllZoneIngressOverviews({size:s,offset:r});return{data:e??[],next:n}}}return(t,s)=>(l(),g("div",ue,[p(S).getters["config/getMulticlusterStatus"]===!1?(l(),d(W,{key:0})):(l(),d(J,{key:1},{default:a(()=>{var r;return[i(j,{"selected-entity-name":(r=u.value)==null?void 0:r.name,"page-size":p(N),"is-loading":m.value,error:v.value,"empty-state":F,"table-data":_.value,"table-data-is-empty":c.value,next:x.value,"page-offset":E.value,onTableAction:T,onLoadData:b},{additionalControls:a(()=>[t.$route.query.ns?(l(),d(p(R),{key:0,class:"back-button",appearance:"primary",icon:"arrowLeft",to:{name:"zoneingresses"}},{default:a(()=>[z(`
            View all
          `)]),_:1})):O("",!0)]),_:1},8,["selected-entity-name","page-size","is-loading","error","table-data","table-data-is-empty","next","page-offset"]),z(),c.value===!1&&u.value!==null?(l(),d(se,{key:0,"has-error":v.value!==null,"is-loading":m.value,tabs:M},{tabHeader:a(()=>[f("h1",ce,`
            Zone Ingress: `+w(u.value.name),1)]),overview:a(()=>[i(ee,null,{default:a(()=>[f("div",null,[f("ul",null,[(l(!0),g(B,null,L(u.value,(e,n)=>(l(),g("li",{key:n},[f("h4",null,w(n),1),z(),f("p",null,w(e),1)]))),128))])])]),_:1})]),insights:a(()=>[i(p(U),{"border-variant":"noBorder"},{body:a(()=>[i(X,{"initially-open":0},{default:a(()=>[(l(!0),g(B,null,L(D.value,(e,n)=>(l(),d(Y,{key:n},{"accordion-header":a(()=>[i(te,{details:e},null,8,["details"])]),"accordion-content":a(()=>[i(ae,{details:e,"is-discovery-subscription":""},null,8,["details"])]),_:2},1024))),128))]),_:1})]),_:1})]),"xds-configuration":a(()=>[i(I,{"data-path":"xds","zone-ingress-name":u.value.name,"query-key":"envoy-data-zone-ingress"},null,8,["zone-ingress-name"])]),"envoy-stats":a(()=>[i(I,{"data-path":"stats","zone-ingress-name":u.value.name,"query-key":"envoy-data-zone-ingress"},null,8,["zone-ingress-name"])]),"envoy-clusters":a(()=>[i(I,{"data-path":"clusters","zone-ingress-name":u.value.name,"query-key":"envoy-data-zone-ingress"},null,8,["zone-ingress-name"])]),_:1},8,["has-error","is-loading"])):O("",!0)]}),_:1}))]))}});export{qe as default};
