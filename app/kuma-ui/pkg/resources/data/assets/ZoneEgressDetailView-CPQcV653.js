import{d as P,a6 as H,r as p,p as m,o as s,w as e,b as t,e as n,q as C,O as x,T as J,t as i,c as y,N as _,m as I,a7 as M,L as b,y as Q,K as U,l as W,_ as Y}from"./index-DYbR5Se5.js";import{S as ee}from"./SummaryView-DDM3hZF4.js";import{C as D,b as E,a as te}from"./ConnectionTraffic-pHCoZ6f9.js";import"./TagList-CCot3uJL.js";const ne=P({__name:"ZoneEgressDetailView",props:{data:{}},setup(B){const l=B,A=H();return(oe,o)=>{const S=p("XBadge"),R=p("XCopyButton"),$=p("XAboutCard"),z=p("XAction"),h=p("DataCollection"),k=p("XLayout"),L=p("XInputSwitch"),T=p("XCard"),N=p("RouterView"),q=p("DataLoader"),O=p("XI18n"),j=p("XIcon"),Z=p("AppView"),F=p("RouteView");return s(),m(F,{name:"zone-egress-detail-view",params:{inactive:Boolean,subscription:"",proxy:""}},{default:e(({t:d,route:u,me:g,uri:G})=>[t(Z,null,{default:e(()=>[t(k,{type:"stack"},{default:e(()=>[t($,{title:d("zone-egresses.routes.item.about.title"),created:l.data.creationTime,modified:l.data.modificationTime},{default:e(()=>[t(x,{layout:"horizontal"},{title:e(()=>[n(i(d("http.api.property.status")),1)]),body:e(()=>[t(J,{status:l.data.state},null,8,["status"])]),_:2},1024),o[3]||(o[3]=n()),l.data.namespace.length>0?(s(),m(x,{key:0,layout:"horizontal"},{title:e(()=>[n(i(d("http.api.property.namespace")),1)]),body:e(()=>[t(S,{appearance:"decorative"},{default:e(()=>[n(i(l.data.namespace),1)]),_:1})]),_:2},1024)):C("",!0),o[4]||(o[4]=n()),t(x,{layout:"horizontal"},{title:e(()=>[n(i(d("http.api.property.address")),1)]),body:e(()=>[l.data.zoneEgress.socketAddress.length>0?(s(),m(R,{key:0,variant:"badge",format:"default",text:l.data.zoneEgress.socketAddress},null,8,["text"])):(s(),y(_,{key:1},[n(i(d("common.detail.none")),1)],64))]),_:2},1024)]),_:2},1032,["title","created","modified"]),o[18]||(o[18]=n()),t(q,{src:G(I(M),"/connections/stats/for/:proxyType/:name/:mesh/:socketAddress",{name:u.params.proxy,mesh:"*",socketAddress:l.data.zoneEgress.socketAddress,proxyType:"zone-egress"})},{default:e(({data:a,refresh:c})=>[t(T,null,{default:e(()=>[t(k,{type:"columns"},{default:e(()=>[t(D,null,{default:e(()=>[t(k,{type:"stack",size:"small"},{default:e(()=>[t(h,{type:"inbounds",items:Object.entries(a.inbounds)},{default:e(({items:r})=>[(s(!0),y(_,null,b(r,([w,v])=>(s(),m(E,{key:`${w}`,protocol:"",traffic:v},{default:e(()=>[t(z,{"data-action":"",to:{name:(f=>f.includes("bound")?f.replace("-outbound-","-inbound-"):"zone-egress-connection-inbound-summary-stats-view")(String(I(A).name)),params:{connection:w},query:{inactive:u.params.inactive}}},{default:e(()=>[n(`
                          :`+i(w.split("_").at(-1)),1)]),_:2},1032,["to"])]),_:2},1032,["traffic"]))),128))]),_:2},1032,["items"])]),_:2},1024)]),_:2},1024),o[9]||(o[9]=n()),t(D,null,{actions:e(()=>[t(L,{checked:u.params.inactive,"data-testid":"dataplane-outbounds-inactive-toggle",onChange:r=>u.update({inactive:r})},{label:e(()=>[...o[5]||(o[5]=[n(`
                      Show inactive
                    `,-1)])]),_:1},8,["checked","onChange"]),o[7]||(o[7]=n()),t(z,{action:"refresh",appearance:"primary",onClick:c},{default:e(()=>[...o[6]||(o[6]=[n(`
                    Refresh
                  `,-1)])]),_:1},8,["onClick"])]),default:e(()=>[o[8]||(o[8]=n()),(s(),y(_,null,b(["upstream"],r=>t(h,{key:r,type:"outbounds",items:Object.entries(a.outbounds)},{default:e(({items:w})=>[t(h,{type:"activeOutbounds",predicate:u.params.inactive?void 0:([v,f])=>((typeof f.tcp<"u"?f.tcp?.[`${r}_cx_rx_bytes_total`]:f.http?.[`${r}_rq_total`])??0)>0,items:w},{default:e(({items:v})=>[v.length>0?(s(),m(te,{key:0,type:"outbound"},{default:e(()=>[(s(),y(_,null,b([/-([a-f0-9]){16}$/],f=>t(k,{key:f,type:"stack",size:"small"},{default:e(()=>[(s(!0),y(_,null,b(v,([X,K])=>(s(),m(E,{key:`${X}`,"data-testid":"dataplane-outbound",protocol:"",traffic:K,direction:r},{default:e(()=>[t(z,{"data-action":"",to:{name:(V=>V.includes("bound")?V.replace("-inbound-","-outbound-"):"zone-egress-connection-outbound-summary-stats-view")(String(I(A).name)),params:{connection:X},query:{inactive:u.params.inactive}}},{default:e(()=>[n(i(X),1)]),_:2},1032,["to"])]),_:2},1032,["traffic","direction"]))),128))]),_:2},1024)),64))]),_:2},1024)):C("",!0)]),_:2},1032,["predicate","items"])]),_:2},1032,["items"])),64))]),_:2},1024)]),_:2},1024)]),_:2},1024),o[10]||(o[10]=n()),t(N,null,{default:e(r=>[r.route.name!==u.name?(s(),m(ee,{key:0,width:"670px",onClose:function(){u.replace({name:"zone-egress-detail-view",params:{proxyType:"egresses",proxy:u.params.proxy}})}},{default:e(()=>[(s(),m(Q(r.Component),{data:u.params.subscription.length>0?l.data.zoneEgressInsight.subscriptions:r.route.name.includes("-inbound-")?[l.data.zoneEgress]:a?.outbounds||{},networking:l.data.zoneEgress.networking},null,8,["data","networking"]))]),_:2},1032,["onClose"])):C("",!0)]),_:2},1024)]),_:2},1032,["src"]),o[19]||(o[19]=n()),l.data.zoneEgressInsight.subscriptions.length>0?(s(),m(T,{key:0},{title:e(()=>[W("h2",null,i(d("zone-egresses.routes.item.subscriptions.title")),1)]),default:e(()=>[o[17]||(o[17]=n()),t(k,null,{default:e(()=>[t(O,{path:"zone-egresses.routes.item.subscriptions.description"}),o[16]||(o[16]=n()),t(U,{headers:[{...g.get("headers.connection"),label:"Â ",key:"connection"},{...g.get("headers.instanceId"),label:d("http.api.property.instanceId"),key:"instanceId"},{...g.get("headers.version"),label:d("http.api.property.version"),key:"version"},{...g.get("headers.connected"),label:d("http.api.property.connected"),key:"connected"},{...g.get("headers.disconnected"),label:d("http.api.property.disconnected"),key:"disconnected"},{...g.get("headers.responses"),label:d("http.api.property.responses"),key:"responses"}],"is-selected-row":a=>a.id===u.params.subscription,items:l.data.zoneEgressInsight.subscriptions.map((a,c,r)=>r[r.length-(c+1)]),onResize:g.set},{connection:e(({row:a})=>[(s(!0),y(_,null,b([a.connectTime&&!a.disconnectTime?"healthy":"unhealthy"],c=>(s(),m(j,{key:`${c}`,name:c},{default:e(()=>[n(i(d(`common.connection.${c}`)),1)]),_:2},1032,["name"]))),128))]),instanceId:e(({row:a})=>[t(z,{"data-action":"",to:{name:"zone-egress-subscription-summary-view",params:{subscription:a.id}}},{default:e(()=>[n(i(a.controlPlaneInstanceId),1)]),_:2},1032,["to"])]),version:e(({row:a})=>[n(i(a.version?.kumaDp?.version??"-"),1)]),connected:e(({row:a})=>[n(i(d("common.formats.datetime",{value:Date.parse(a.connectTime??"")})),1)]),disconnected:e(({row:a})=>[a.disconnectTime?(s(),y(_,{key:0},[n(i(d("common.formats.datetime",{value:Date.parse(a.disconnectTime)})),1)],64)):C("",!0)]),responses:e(({row:a})=>[(s(!0),y(_,null,b([a.status?.total??{}],c=>(s(),y(_,null,[n(i(c.responsesSent)+"/"+i(c.responsesAcknowledged),1)],64))),256))]),_:2},1032,["headers","is-selected-row","items","onResize"])]),_:2},1024)]),_:2},1024)):C("",!0)]),_:2},1024)]),_:2},1024)]),_:1})}}}),de=Y(ne,[["__scopeId","data-v-dd549aae"]]);export{de as default};
