import{d as K,r as p,p as _,o,w as a,b as l,e as n,m as h,a8 as D,q as v,l as c,c as u,t as s,L as y,M as b,a as Z,I as F,Z as O,K as H,y as J,_ as Q}from"./index-CpFYS729.js";const U={key:0},Y={key:1},P=["data-testid"],ee=K({__name:"WorkloadDetailView",props:{data:{}},setup($){const d=$;return(V,t)=>{const S=p("RouteTitle"),w=p("XBadge"),X=p("XLayout"),A=p("XDl"),x=p("DataLoader"),L=p("XAboutCard"),T=p("XSearch"),z=p("XAction"),E=p("XIcon"),I=p("XActionGroup"),R=p("XDrawer"),N=p("RouterView"),B=p("DataCollection"),M=p("XCard"),W=p("AppView"),j=p("RouteView");return o(),_(j,{name:"workload-detail-view",params:{mesh:"",wl:"",page:1,size:Number,proxy:"",s:""}},{default:a(({route:i,t:r,uri:q,me:g,can:G})=>[l(S,{render:!1,title:r("workloads.routes.item.title",{name:h(D).fromString(i.params.wl).name})},null,8,["title"]),t[18]||(t[18]=n()),l(W,null,{default:a(()=>[l(L,{title:r("workloads.routes.item.about.title"),created:typeof d.data<"u"&&!(d.data instanceof Error)?d.data.creationTime:void 0,modified:typeof d.data<"u"&&!(d.data instanceof Error)?d.data.modificationTime:void 0,"data-testid":"about-workload"},{default:a(()=>[l(x,{data:[d.data]},{default:a(()=>[typeof d.data<"u"&&!(d.data instanceof Error)?(o(),_(A,{key:0},{default:a(()=>[c("div",null,[c("dt",null,s(r("http.api.property.status")),1),t[1]||(t[1]=n()),c("dd",null,[l(w,{appearance:r(`common.status.appearance.${d.data.status.state}`,void 0,{defaultMessage:"neutral"})},{default:a(()=>[n(s(r(`http.api.value.${d.data.status.state}`)),1)]),_:2},1032,["appearance"])])]),t[5]||(t[5]=n()),d.data.zone.length?(o(),u("div",U,[c("dt",null,s(r("http.api.property.zone")),1),t[2]||(t[2]=n()),c("dd",null,[l(w,null,{default:a(()=>[n(s(d.data.zone),1)]),_:1})])])):v("",!0),t[6]||(t[6]=n()),d.data.namespace.length?(o(),u("div",Y,[c("dt",null,s(r("http.api.property.namespace")),1),t[3]||(t[3]=n()),c("dd",null,[l(w,null,{default:a(()=>[n(s(d.data.namespace),1)]),_:1})])])):v("",!0),t[7]||(t[7]=n()),(o(!0),u(y,null,b([Object.entries(d.data.labels).filter(([f])=>!["display-name","zone","namespace"].find(m=>f.includes(m)))],f=>(o(),u("div",{key:typeof f},[c("dt",null,s(r("workloads.routes.item.about.labels")),1),t[4]||(t[4]=n()),c("dd",null,[l(X,{variant:"x-stack",truncate:""},{default:a(()=>[(o(!0),u(y,null,b(f,([m,e])=>(o(),_(w,{key:m},{default:a(()=>[n(s(m)+": "+s(e),1)]),_:2},1024))),128))]),_:2},1024)])]))),128))]),_:2},1024)):v("",!0)]),_:2},1032,["data"])]),_:2},1032,["title","created","modified"]),t[17]||(t[17]=n()),l(M,null,{default:a(()=>[l(X,{variant:"y-stack"},{default:a(()=>[Z(V.$slots,"title",{},()=>[c("h2",null,s(r("workloads.routes.item.dataplaneProxies.title")),1)],!0),t[15]||(t[15]=n()),c("search",null,[c("form",{class:"search-form",onSubmit:t[0]||(t[0]=F(()=>{},["prevent"]))},[l(T,{class:"search-field",keys:["name","tag","label"],value:i.params.s,onChange:f=>i.update({page:1,s:f})},null,8,["value","onChange"])],32)]),t[16]||(t[16]=n()),(o(!0),u(y,null,b([h(D).fromString(i.params.wl)],f=>(o(),_(x,{key:typeof f,src:q(h(O),"/meshes/:mesh/dataplanes/of/:type",{mesh:i.params.mesh,type:"standard"},{page:i.params.page,size:i.params.size,search:`${i.params.s} kuma.io/workload:${f.name} ${[["namespace",f.namespace],["zone",f.zone]].filter(([,m])=>m.length>0).map(([m,e])=>`${m}:${e}`).join(" ")}`}),variant:"list"},{default:a(({data:m})=>[l(B,{items:m.items,total:m.total,page:i.params.page,"page-size":i.params.size,onChange:i.update},{default:a(()=>[l(H,{class:"data-plane-collection","data-testid":"data-plane-collection",headers:[{...g.get("headers.name"),label:"Name",key:"name"},{...g.get("headers.namespace"),label:"Namespace",key:"namespace"},...G("use zones")?[{...g.get("headers.zone"),label:"Zone",key:"zone"}]:[],{...g.get("headers.certificate"),label:"Certificate info",key:"certificate"},{...g.get("headers.status"),label:"Status",key:"status"},{...g.get("headers.warnings"),label:"Warnings",key:"warnings",hideLabel:!0},{...g.get("headers.actions"),label:"Actions",key:"actions",hideLabel:!0}],items:m.items,onResize:g.set},{name:a(({row:e})=>[l(z,{"data-action":"",class:"name-link",title:e.name,to:{name:"workload-data-plane-summary-view",params:{mesh:e.mesh,proxy:e.id}}},{default:a(()=>[n(s(e.name),1)]),_:2},1032,["title","to"])]),namespace:a(({row:e})=>[n(s(e.namespace),1)]),zone:a(({row:e})=>[e.zone?(o(),_(z,{key:0,to:{name:"zone-cp-detail-view",params:{zone:e.zone}}},{default:a(()=>[n(s(e.zone),1)]),_:2},1032,["to"])):(o(),u(y,{key:1},[n(s(r("common.collection.none")),1)],64))]),certificate:a(({row:e})=>[e.dataplaneInsight.mTLS?.certificateExpirationTime?(o(),u(y,{key:0},[n(s(r("common.formats.datetime",{value:Date.parse(e.dataplaneInsight.mTLS.certificateExpirationTime)})),1)],64)):(o(),u(y,{key:1},[n(s(r("data-planes.components.data-plane-list.certificate.none")),1)],64))]),status:a(({row:e})=>[l(w,{appearance:r(`common.status.appearance.${e.status}`,void 0,{defaultMessage:"neutral"})},{default:a(()=>[n(s(r(`http.api.value.${e.status}`)),1)]),_:2},1032,["appearance"])]),warnings:a(({row:e})=>[(o(!0),u(y,null,b([[{bool:e.dataplaneInsight.version?.kumaDp?.kumaCpCompatible===!1||e.dataplaneInsight.version?.envoy?.kumaDpCompatible===!1,key:"dp-cp-incompatible"},{bool:e.isCertExpiresSoon,key:"certificate-expires-soon"},{bool:e.isCertExpired,key:"certificate-expired"}].filter(({bool:k})=>k)],k=>(o(),u(y,{key:typeof k},[k.length>0?(o(),_(E,{key:0,name:"warning","data-testid":"warning"},{default:a(()=>[c("ul",null,[(o(!0),u(y,null,b(k,({key:C})=>(o(),u("li",{key:C,"data-testid":`warning-${C}`},s(r(`data-planes.routes.items.warnings.${C}`)),9,P))),128))])]),_:2},1024)):(o(),u(y,{key:1},[n(s(r("common.collection.none")),1)],64))],64))),128))]),actions:a(({row:e})=>[l(I,null,{default:a(()=>[l(z,{to:{name:"data-plane-detail-view",params:{proxy:e.id}}},{default:a(()=>[n(s(r("common.collection.actions.view")),1)]),_:2},1032,["to"])]),_:2},1024)]),_:2},1032,["headers","items","onResize"]),t[14]||(t[14]=n()),i.params.proxy?(o(),_(N,{key:0},{default:a(e=>[l(R,{onClose:k=>i.replace({name:i.name,params:{mesh:i.params.mesh},query:{page:i.params.page,size:i.params.size}})},{default:a(()=>[typeof m<"u"?(o(),_(J(e.Component),{key:0,items:m.items},null,8,["items"])):v("",!0)]),_:2},1032,["onClose"])]),_:2},1024)):v("",!0)]),_:2},1032,["items","total","page","page-size","onChange"])]),_:2},1032,["src"]))),128))]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:3})}}}),te=Q(ee,[["__scopeId","data-v-7c30038d"]]);export{te as default};
