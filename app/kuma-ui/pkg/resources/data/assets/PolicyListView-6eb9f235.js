import{u as C,D as S,W as B,K as E,e as N}from"./kongponents.es-fed304fd.js";import{d as D,o as n,a as l,w as o,h as p,b as e,g as f,u as T,L as A,e as R,j as z,k as m,f as q,P as F,x as $,t as P,F as W,p as K,m as j}from"./index-f4ec0be6.js";import{_ as G}from"./PolicyDetails.vue_vue_type_script_setup_true_lang-02335f98.js";import{i as M,h as O,A as U,_ as Z,f as H}from"./RouteView.vue_vue_type_script_setup_true_lang-09fd82a0.js";import{_ as k}from"./DataSource.vue_vue_type_script_setup_true_lang-1e42b670.js";import{_ as J}from"./RouteTitle.vue_vue_type_script_setup_true_lang-d39e0ee5.js";import{D as Q}from"./DataOverview-706f2010.js";import{_ as X}from"./TextWithCopyButton-ae3a8132.js";import{E as Y}from"./ErrorBlock-f3ed6714.js";import"./StatusInfo.vue_vue_type_script_setup_true_lang-7a761e1d.js";import"./ResourceCodeBlock.vue_vue_type_script_setup_true_lang-7c8e38a7.js";import"./CodeBlock.vue_vue_type_style_index_0_lang-56242a2b.js";import"./TabsWidget-2ca8d57d.js";import"./QueryParameter-70743f73.js";import"./TagList-0012d9cb.js";import"./StatusBadge-0a8731e8.js";const ee=D({__name:"DocumentationLink",props:{href:{type:String,required:!0}},setup(c){const t=c;return(_,h)=>(n(),l(e(S),{class:"docs-link",appearance:"outline",target:"_blank",to:t.href},{default:o(()=>[p(e(C),{icon:"externalLink",color:"currentColor",size:"16","hide-title":""}),f(`

    Documentation
  `)]),_:1},8,["to"]))}}),ae=c=>(K("data-v-16022f84"),c=c(),j(),c),te={class:"stack"},se={class:"kcard-border"},oe=ae(()=>m("p",null,[m("strong",null,"Warning"),f(` This policy is experimental. If you encountered any problem please open an
                              `),m("a",{href:"https://github.com/kumahq/kuma/issues/new/choose",target:"_blank",rel:"noopener noreferrer"},"issue")],-1)),re=D({__name:"PolicyListView",setup(c){const t=T(),_=A(),{t:h}=M(),L=function(b){b.items.length>0&&!t.query.policy&&_.push({name:"policies-list-view",query:{policy:b.items[0].name}})};return(b,u)=>(n(),l(Z,null,{default:o(({route:y})=>[p(k,{src:"/*/policy-types"},{default:o(({data:d,error:v,refresh:V})=>[v?(n(),l(Y,{key:0,error:v},null,8,["error"])):d===void 0?(n(),l(O,{key:1})):d.policies.length===0?(n(),l(X,{key:2})):(n(!0),R(W,{key:3},z([d.policies.find(s=>s.path===y.params.policyPath)??d.policies[0]],s=>(n(),l(k,{key:s.path,src:`/${y.params.mesh}/policy-type/${s.path}?offset=${e(t).query.offset||"0"}`,onChange:L},{default:o(({data:r,error:g,refresh:I})=>[p(J,{title:e(h)("policies.routes.items.title",{name:s.name})},null,8,["title"]),f(),p(U,null,{default:o(()=>[m("div",{class:$(["relative",s.path])},[m("div",te,[m("div",se,[s.isExperimental?(n(),l(e(B),{key:0,"border-variant":"noBorder",class:"mb-4"},{body:o(()=>[p(e(E),{appearance:"warning"},{alertMessage:o(()=>[oe]),_:1})]),_:1})):q("",!0),f(),p(Q,{"selected-entity-name":e(t).query.policy??void 0,"page-size":e(F),error:g,"is-loading":typeof r>"u"&&typeof g>"u","empty-state":{title:"No Data",message:`There are no ${s.name} policies present.`},"table-data":{headers:[{label:"Name",key:"entity"},{label:"Type",key:"type"}],data:((r==null?void 0:r.items)||[]).map(a=>({entity:a,type:a.type,detailViewRoute:{name:"policy-detail-view",params:{mesh:a.mesh,policyPath:y.params.policyPath,policy:a.name}}}))},"table-data-is-empty":r&&r.items.length===0,next:r==null?void 0:r.next,"page-offset":e(t).query.offset?parseInt(e(t).query.offset):0,onTableAction:u[1]||(u[1]=a=>{e(_).push({name:"policies-list-view",query:{policy:a.name}})}),onRefresh:()=>{I(),V()},onLoadData:u[2]||(u[2]=a=>{e(_).push({name:"policies-list-view",query:{policy:e(t).query.policy,offset:a}})})},{additionalControls:o(()=>[p(k,{src:`/${y.params.mesh}/insights`},{default:o(({data:a})=>[p(e(N),{label:"Policies",items:d.policies.map(i=>({label:i.name,value:i.path,selected:i.path===y.params.policyPath})),"label-attributes":{class:"visually-hidden"},appearance:"select","enable-filtering":!0,onSelected:u[0]||(u[0]=i=>e(_).push({name:"policies-list-view",params:{...e(t).params,policyPath:i.value}}))},{"item-template":o(({item:i})=>{var w,x;return[m("span",{class:$({"policy-type-empty":!((w=a==null?void 0:a.policies[i.label])!=null&&w.total)})},P(i.label)+" ("+P(((x=a==null?void 0:a.policies[i.label])==null?void 0:x.total)||"0")+`)
                              `,3)]}),_:2},1032,["items"])]),_:2},1032,["src"]),f(),p(ee,{href:e(h)("policies.href.docs",{name:s.name}),"data-testid":"policy-documentation-link"},null,8,["href"])]),_:2},1032,["selected-entity-name","page-size","error","is-loading","empty-state","table-data","table-data-is-empty","next","page-offset","onRefresh"])]),f(),e(t).query.policy?(n(),l(G,{key:0,name:e(t).query.policy,mesh:y.params.mesh,path:s.path,type:s.name},null,8,["name","mesh","path","type"])):q("",!0)])],2)]),_:2},1024)]),_:2},1032,["src"]))),128))]),_:2},1024)]),_:1}))}});const we=H(re,[["__scopeId","data-v-16022f84"]]);export{we as default};
