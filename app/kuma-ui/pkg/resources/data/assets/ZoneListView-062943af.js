import{d as B,R as D,t as N,r as K,o as a,g as c,w as e,h as i,A as S,ae as U,m as w,C as F,l as n,p as W,i as s,a2 as q,E as G,a3 as J,D as l,X as P,j as E,F as h,ac as X,$ as j,K as V,a4 as H,Z,H as Q,a5 as Y,a6 as A,k as O,_ as ee,aE as te,q as oe}from"./index-e7632716.js";import{_ as ne}from"./MultizoneInfo.vue_vue_type_script_setup_true_lang-f6f65f32.js";import{_ as ae}from"./DeleteResourceModal.vue_vue_type_script_setup_true_lang-e78e1bbe.js";const se=B({__name:"ZoneListView",props:{page:{type:Number,required:!0},size:{type:Number,required:!0}},setup(R){const _=R,T=D(),f=N(!1),x=N(!1),y=N("");function L(r){return r.map(b=>{var k;const{name:z}=b,g={name:"zone-cp-detail-view",params:{zone:z}};let t="",p="kubernetes",m=!0;(((k=b.zoneInsight)==null?void 0:k.subscriptions)??[]).forEach(o=>{if(o.version&&o.version.kumaCp){t=o.version.kumaCp.version;const{kumaCpGlobalCompatible:v=!0}=o.version.kumaCp;m=v}o.config&&(p=JSON.parse(o.config).environment)});const d=te(b);return{detailViewRoute:g,name:z,status:d,zoneCpVersion:t,type:p,warnings:!m}})}async function I(){await T.deleteZone({name:y.value})}function C(){f.value=!f.value}function M(r){C(),y.value=r}function $(r){x.value=(r==null?void 0:r.items.length)>0}return(r,b)=>{const z=K("RouterLink");return a(),c(ee,{name:"zone-cp-list-view"},{default:e(({route:g,t,can:p,env:m})=>[i(S,null,U({title:e(()=>[w("h1",null,[i(F,{title:t("zone-cps.routes.items.title"),render:!0},null,8,["title"])])]),default:e(()=>[n(),n(),p("use zones")?(a(),c(W,{key:1,src:`/zone-cps?size=${_.size}&page=${_.page}`,onChange:$},{default:e(({data:u,error:d,refresh:k})=>[i(s(q),null,{body:e(()=>[d!==void 0?(a(),c(G,{key:0,error:d},null,8,["error"])):(a(),c(J,{key:1,class:"zone-cp-collection","data-testid":"zone-cp-collection",headers:[{label:"Name",key:"name"},{label:"Zone CP Version",key:"zoneCpVersion"},{label:"Type",key:"type"},{label:"Status",key:"status"},{label:"Warnings",key:"warnings",hideLabel:!0},{label:"Actions",key:"actions",hideLabel:!0}],"page-number":_.page,"page-size":_.size,total:u==null?void 0:u.total,items:u?L(u.items):void 0,error:d,"empty-state-title":m("KUMA_ZONE_CREATION_FLOW")==="enabled"?t("zone-cps.empty_state.title"):void 0,"empty-state-message":m("KUMA_ZONE_CREATION_FLOW")==="enabled"?t("zone-cps.empty_state.message"):void 0,"empty-state-cta-to":m("KUMA_ZONE_CREATION_FLOW")==="enabled"?{name:"zone-create-view"}:void 0,"empty-state-cta-text":m("KUMA_ZONE_CREATION_FLOW")==="enabled"?t("zones.index.create"):void 0,onChange:g.update},{name:e(({row:o,rowValue:v})=>[i(z,{to:o.detailViewRoute,"data-testid":"detail-view-link"},{default:e(()=>[n(l(v),1)]),_:2},1032,["to"])]),zoneCpVersion:e(({rowValue:o})=>[n(l(o||t("common.collection.none")),1)]),type:e(({rowValue:o})=>[n(l(o||t("common.collection.none")),1)]),status:e(({rowValue:o})=>[o?(a(),c(P,{key:0,status:o},null,8,["status"])):(a(),E(h,{key:1},[n(l(t("common.collection.none")),1)],64))]),warnings:e(({rowValue:o})=>[o?(a(),c(s(X),{key:0,label:t("zone-cps.list.version_mismatch")},{default:e(()=>[i(j,{class:"mr-1",size:s(V),"hide-title":""},null,8,["size"])]),_:2},1032,["label"])):(a(),E(h,{key:1},[n(l(t("common.collection.none")),1)],64))]),actions:e(({row:o})=>[i(s(H),{class:"actions-dropdown","data-testid":"actions-dropdown","kpop-attributes":{placement:"bottomEnd",popoverClasses:"mt-5 more-actions-popover"},width:"150"},{default:e(()=>[i(s(Z),{class:"non-visual-button",appearance:"secondary",size:"small"},{icon:e(()=>[i(s(Q),{color:s(Y),icon:"more",size:s(V)},null,8,["color","size"])]),_:1})]),items:e(()=>[i(s(A),{item:{to:o.detailViewRoute,label:t("common.collection.actions.view")}},null,8,["item"]),n(),p("create zones")?(a(),c(s(A),{key:0,"has-divider":"","is-dangerous":"","data-testid":"dropdown-delete-item",onClick:v=>M(o.name)},{default:e(()=>[n(l(t("common.collection.actions.delete")),1)]),_:2},1032,["onClick"])):O("",!0)]),_:2},1024)]),_:2},1032,["page-number","page-size","total","items","error","empty-state-title","empty-state-message","empty-state-cta-to","empty-state-cta-text","onChange"]))]),_:2},1024),n(),f.value?(a(),c(ae,{key:0,"confirmation-text":y.value,"delete-function":I,"is-visible":f.value,"modal-id":"delete-zone-modal","action-button-text":t("zones.delete.confirmModal.proceedText"),title:t("zones.delete.confirmModal.title"),onCancel:C,onDelete:()=>{C(),k()}},{"body-content":e(()=>[w("p",null,l(t("zones.delete.confirmModal.text1",{zoneName:y.value})),1),n(),w("p",null,l(t("zones.delete.confirmModal.text2")),1)]),error:e(()=>[n(l(t("zones.delete.confirmModal.errorText")),1)]),_:2},1032,["confirmation-text","is-visible","action-button-text","title","onDelete"])):O("",!0)]),_:2},1032,["src"])):(a(),c(ne,{key:0}))]),_:2},[p("create zones")&&x.value?{name:"actions",fn:e(()=>[i(s(Z),{appearance:"primary",icon:"plus",to:{name:"zone-create-view"},"data-testid":"create-zone-link"},{default:e(()=>[n(l(t("zones.index.create")),1)]),_:2},1024)]),key:"0"}:void 0]),1024)]),_:1})}}});const re=oe(se,[["__scopeId","data-v-d0cdd1d2"]]);export{re as default};
