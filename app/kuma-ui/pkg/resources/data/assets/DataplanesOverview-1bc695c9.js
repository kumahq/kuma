import{d as P,B as b,c as w,L as S,o as n,a as y,w as a,h as s,b as x,g as u,x as N,i as o,t as c,e as d,A as T,F}from"./index-5e3b827e.js";import{L as I}from"./LoadingBox-b1149d7b.js";import{O as E,a as L,b as V}from"./OnboardingPage-039b5f89.js";import{l as C,h as H,A as M,S as R,_ as $,f as z}from"./RouteView.vue_vue_type_script_setup_true_lang-1f1cfc32.js";import{_ as K}from"./RouteTitle.vue_vue_type_script_setup_true_lang-d7eeef45.js";import{e as U}from"./dataplane-e7ae9fed.js";import"./WarningIcon.vue_vue_type_script_setup_true_lang-80c02e96.js";const W={key:0,class:"status-loading-box mb-4"},j={key:1},q={class:"mb-4"},G=P({__name:"DataplanesOverview",setup(J){const p=C(),{t:k}=H(),D=[{label:"Mesh",key:"mesh"},{label:"Name",key:"name"},{label:"Status",key:"status"}],e=b({total:0,data:[]}),l=b(null),A=w(()=>e.value.data.length>0?"Success":"Waiting for DPPs"),m=w(()=>e.value.data.length>0?"The following data plane proxies (DPPs) are connected to the control plane:":null);S(function(){_()}),f();function _(){l.value!==null&&window.clearTimeout(l.value)}async function f(){let i=!1;const r=[];try{const{items:t}=await p.getAllDataplanes({size:10});if(Array.isArray(t))for(const B of t){const{name:v,mesh:g}=B,O=await p.getDataplaneOverviewFromMesh({mesh:g,name:v}),h=U(O.dataplaneInsight);h==="offline"&&(i=!0),r.push({status:h,name:v,mesh:g})}}catch(t){console.error(t)}e.value.data=r,e.value.total=e.value.data.length,i&&(_(),l.value=window.setTimeout(f,1e3))}return(i,r)=>(n(),y($,null,{default:a(()=>[s(K,{title:x(k)("onboarding.routes.dataplanes-overview.title")},null,8,["title"]),u(),s(M,null,{default:a(()=>[s(E,null,{header:a(()=>[s(L,null,N({title:a(()=>[o("p",null,c(A.value),1)]),_:2},[m.value!==null?{name:"description",fn:a(()=>[o("p",null,c(m.value),1)]),key:"0"}:void 0]),1024)]),content:a(()=>[e.value.data.length===0?(n(),d("div",W,[s(I)])):(n(),d("div",j,[o("p",q,[o("b",null,"Found "+c(e.value.data.length)+" DPPs:",1)]),u(),s(x(T),{class:"mb-4",fetcher:()=>e.value,headers:D,"disable-pagination":""},{status:a(({rowValue:t})=>[t?(n(),y(R,{key:0,status:t},null,8,["status"])):(n(),d(F,{key:1},[u(`
                  â€”
                `)],64))]),_:1},8,["fetcher"])]))]),navigation:a(()=>[s(V,{"next-step":"onboarding-completed","previous-step":"onboarding-add-services-code","should-allow-next":e.value.data.length>0},null,8,["should-allow-next"])]),_:1})]),_:1})]),_:1}))}});const se=z(G,[["__scopeId","data-v-4588fbe4"]]);export{se as default};
