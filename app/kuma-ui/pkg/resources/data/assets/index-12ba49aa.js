import{ak as m}from"./index-0447e8bf.js";function d(a){var i;const t=((i=a.dataplaneInsight)==null?void 0:i.subscriptions)??[];return t.length===0?void 0:t[t.length-1].status.lastUpdateTime}function b(a){var n;const t=m((n=a.dataplaneInsight)==null?void 0:n.subscriptions);if(a.dataplane.networking.gateway)return{status:t?"online":"offline",reason:[]};const s=a.dataplane.networking.inbound??[],i=s.filter(e=>e.health&&!e.health.ready).map(e=>`Inbound on port ${e.port} is not ready (kuma.io/service: ${e.tags["kuma.io/service"]})`);let o;switch(!0){case i.length===s.length:o="offline";break;case i.length>0:o="partially_degraded";break;default:o=t?"online":"offline"}return{status:o,reason:i}}function g(a){let t=[];const s="=",{gateway:i,inbound:o}=a.dataplane.networking;o&&(t=o.flatMap(e=>Object.entries(e.tags)).map(([e,r])=>`${e}${s}${r}`)),i&&(t=Object.entries(i.tags).map(([e,r])=>`${e}${s}${r}`));const n=Array.from(new Set(t));return n.sort((e,r)=>e.localeCompare(r)),n.map(e=>{const[r,p]=e.split(s);return{label:r,value:p}})}function k(a){var s;const t=(s=a.dataplaneInsight)==null?void 0:s.mTLS;return t===void 0?!1:Date.now()>new Date(t.certificateExpirationTime).getTime()}function C(a,t){var e,r,p;const s=((e=a.dataplaneInsight)==null?void 0:e.subscriptions)??[];if(s.length===0)return[];const i=s[s.length-1];if(!("version"in i)||!i.version)return[];const o=[],n=i.version;return n.kumaDp&&n.envoy&&((((r=n.kumaDp)==null?void 0:r.kumaCpCompatible)??!0)||o.push({kind:"INCOMPATIBLE_UNSUPPORTED_KUMA_DP",payload:{kumaDp:n.kumaDp.version}}),(((p=n.envoy)==null?void 0:p.kumaDpCompatible)??!0)||o.push({kind:"INCOMPATIBLE_UNSUPPORTED_ENVOY",payload:{envoy:n.envoy.version,kumaDp:n.kumaDp.version}})),t&&g(a).find(c=>c.label==="kuma.io/zone")&&typeof n.kumaDp.kumaCpCompatible=="boolean"&&!n.kumaDp.kumaCpCompatible&&o.push({kind:"INCOMPATIBLE_ZONE_CP_AND_KUMA_DP_VERSIONS",payload:{kumaDp:n.kumaDp.version}}),o}function h(a){const{gateway:t}=a.dataplane.networking;return t?t.type?t.type.toLowerCase():"delegated":"standard"}export{d as a,C as b,k as c,h as d,g as e,b as g};
