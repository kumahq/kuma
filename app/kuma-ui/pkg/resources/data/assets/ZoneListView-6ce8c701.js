import{d as O,N as F,t as x,r as _,o as n,g as l,w as e,h as c,a9 as G,m as h,l as s,i,a6 as J,E as M,Y as P,C as r,S as j,j as S,F as I,a5 as q,V as W,K as T,am as X,U as D,a2 as Y,Z as H,an as E,k as Z,ax as Q,q as ee}from"./index-a63a3d32.js";import{_ as te}from"./MultizoneInfo.vue_vue_type_script_setup_true_lang-251c3a79.js";import{_ as oe}from"./DeleteResourceModal.vue_vue_type_script_setup_true_lang-077de7bf.js";const ae=O({__name:"ZoneListView",setup(ne){const L=F(),v=x(!1),R=x(!1),y=x("");function B(m){return m.map(f=>{var t;const{name:z}=f,C={name:"zone-cp-detail-view",params:{zone:z}};let d="",b="kubernetes",k=!0;(((t=f.zoneInsight)==null?void 0:t.subscriptions)??[]).forEach(o=>{if(o.version&&o.version.kumaCp){d=o.version.kumaCp.version;const{kumaCpGlobalCompatible:u=!0}=o.version.kumaCp;k=u}o.config&&(b=JSON.parse(o.config).environment)});const p=Q(f);return{detailViewRoute:C,name:z,status:p,zoneCpVersion:d,type:b,warnings:!k}})}async function A(){await L.deleteZone({name:y.value})}function g(){v.value=!v.value}function $(m){g(),y.value=m}function K(m){R.value=(m==null?void 0:m.items.length)>0}return(m,f)=>{const z=_("RouteTitle"),C=_("RouterLink"),d=_("DataSource"),b=_("AppView"),k=_("RouteView");return n(),l(d,{src:"/me"},{default:e(({data:w})=>[w?(n(),l(k,{key:0,name:"zone-cp-list-view",params:{page:1,size:w.pageSize}},{default:e(({route:p,t,can:o})=>[c(b,null,G({title:e(()=>[h("h1",null,[c(z,{title:t("zone-cps.routes.items.title"),render:!0},null,8,["title"])])]),default:e(()=>[s(),s(),o("use zones")?(n(),l(d,{key:1,src:`/zone-cps?page=${p.params.page}&size=${p.params.size}`,onChange:K},{default:e(({data:u,error:V,refresh:U})=>[c(i(J),null,{body:e(()=>[V!==void 0?(n(),l(M,{key:0,error:V},null,8,["error"])):(n(),l(P,{key:1,class:"zone-cp-collection","data-testid":"zone-cp-collection",headers:[{label:"Name",key:"name"},{label:"Zone CP Version",key:"zoneCpVersion"},{label:"Type",key:"type"},{label:"Status",key:"status"},{label:"Warnings",key:"warnings",hideLabel:!0},{label:"Actions",key:"actions",hideLabel:!0}],"page-number":parseInt(p.params.page),"page-size":parseInt(p.params.size),total:u==null?void 0:u.total,items:u?B(u.items):void 0,error:V,"empty-state-title":o("create zones")?t("zone-cps.empty_state.title"):void 0,"empty-state-message":o("create zones")?t("zone-cps.empty_state.message"):void 0,"empty-state-cta-to":o("create zones")?{name:"zone-create-view"}:void 0,"empty-state-cta-text":o("create zones")?t("zones.index.create"):void 0,onChange:p.update},{name:e(({row:a,rowValue:N})=>[c(C,{to:a.detailViewRoute,"data-testid":"detail-view-link"},{default:e(()=>[s(r(N),1)]),_:2},1032,["to"])]),zoneCpVersion:e(({rowValue:a})=>[s(r(a||t("common.collection.none")),1)]),type:e(({rowValue:a})=>[s(r(a||t("common.collection.none")),1)]),status:e(({rowValue:a})=>[a?(n(),l(j,{key:0,status:a},null,8,["status"])):(n(),S(I,{key:1},[s(r(t("common.collection.none")),1)],64))]),warnings:e(({rowValue:a})=>[a?(n(),l(i(q),{key:0,label:t("zone-cps.list.version_mismatch")},{default:e(()=>[c(W,{class:"mr-1",size:i(T),"hide-title":""},null,8,["size"])]),_:2},1032,["label"])):(n(),S(I,{key:1},[s(r(t("common.collection.none")),1)],64))]),actions:e(({row:a})=>[c(i(X),{class:"actions-dropdown","data-testid":"actions-dropdown","kpop-attributes":{placement:"bottomEnd",popoverClasses:"mt-5 more-actions-popover"},width:"150"},{default:e(()=>[c(i(D),{class:"non-visual-button",appearance:"secondary",size:"small"},{icon:e(()=>[c(i(Y),{color:i(H),icon:"more",size:i(T)},null,8,["color","size"])]),_:1})]),items:e(()=>[c(i(E),{item:{to:a.detailViewRoute,label:t("common.collection.actions.view")}},null,8,["item"]),s(),o("create zones")?(n(),l(i(E),{key:0,"has-divider":"","is-dangerous":"","data-testid":"dropdown-delete-item",onClick:N=>$(a.name)},{default:e(()=>[s(r(t("common.collection.actions.delete")),1)]),_:2},1032,["onClick"])):Z("",!0)]),_:2},1024)]),_:2},1032,["page-number","page-size","total","items","error","empty-state-title","empty-state-message","empty-state-cta-to","empty-state-cta-text","onChange"]))]),_:2},1024),s(),v.value?(n(),l(oe,{key:0,"confirmation-text":y.value,"delete-function":A,"is-visible":"","action-button-text":t("common.delete_modal.proceed_button"),title:t("common.delete_modal.title",{type:"Zone"}),"data-testid":"delete-zone-modal",onCancel:g,onDelete:()=>{g(),U()}},{"body-content":e(()=>[h("p",null,r(t("common.delete_modal.text1",{type:"Zone",name:y.value})),1),s(),h("p",null,r(t("common.delete_modal.text2")),1)]),_:2},1032,["confirmation-text","action-button-text","title","onDelete"])):Z("",!0)]),_:2},1032,["src"])):(n(),l(te,{key:0}))]),_:2},[o("create zones")&&R.value?{name:"actions",fn:e(()=>[c(i(D),{appearance:"primary",icon:"plus",to:{name:"zone-create-view"},"data-testid":"create-zone-link"},{default:e(()=>[s(r(t("zones.index.create")),1)]),_:2},1024)]),key:"0"}:void 0]),1024)]),_:2},1032,["params"])):Z("",!0)]),_:1})}}});const ce=ee(ae,[["__scopeId","data-v-ac6e5b3b"]]);export{ce as default};
