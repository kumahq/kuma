import{d as Y,r as m,p,o as t,w as o,b as u,c as n,N as c,L as _,e as a,q as g,O as M,t as h,l as d,m as C,F as q,V as E,Y as X,_ as H}from"./index-Dz3cVcgh.js";import{A as J,a as G}from"./AccordionList-ClSOsZI4.js";import{P as x}from"./PolicyTypeTag-f03tZGqF.js";import{R as K}from"./RuleMatchers-D7W4RryG.js";const Q={key:0,class:"rules"},U={class:"stack-with-borders mt-4"},W={class:"stack-with-borders mt-4"},Z={class:"mt-4"},ee={class:"stack-with-borders"},te={class:"mt-2"},oe=Y({__name:"DataPlaneOutboundSummaryOverviewView",props:{data:{},routeName:{}},setup(S){const k=S,V=(v,e)=>v.$resourceMeta.name===e.name&&v.$resourceMeta.namespace===e.namespace&&v.$resourceMeta.zone===e.zone&&(e.resourceSectionName===""||v.$resourceMeta.port===e.port);return(v,e)=>{const z=m("XBadge"),$=m("XAction"),O=m("DataCollection"),N=m("XCodeBlock"),L=m("XCard"),D=m("DataLoader"),j=m("DataSource"),F=m("AppView"),T=m("RouteView");return t(),p(T,{params:{mesh:"",proxy:"",connection:""},name:k.routeName},{default:o(({t:I,route:B,uri:R})=>[u(F,null,{default:o(()=>[(t(!0),n(c,null,_([B.params.connection.replace(/-([a-f0-9]){16}$/,"")],P=>(t(),n("div",{key:P,class:"stack-with-borders"},[u(M,{layout:"horizontal"},{title:o(()=>e[0]||(e[0]=[a(`
              Protocol
            `)])),body:o(()=>[u(z,{appearance:"info"},{default:o(()=>[a(h(I(`http.api.value.${["grpc","http","tcp"].find(w=>typeof k.data[w]<"u")}`)),1)]),_:2},1024)]),_:2,__:[1]},1024),e[17]||(e[17]=a()),k.data?(t(),n("div",Q,[e[15]||(e[15]=d("h3",null,"Rules",-1)),e[16]||(e[16]=a()),u(j,{src:R(C(q),"/policy-types",{})},{default:o(({data:w})=>[(t(!0),n(c,null,_([Object.groupBy((w==null?void 0:w.policyTypes)??[],f=>f.name)],f=>(t(),p(D,{key:typeof f,src:R(C(E),"/meshes/:mesh/rules/for/:dataplane",{mesh:B.params.mesh,dataplane:B.params.proxy})},{default:o(({data:A})=>[k.data.$resourceMeta.type!==""?(t(),p(O,{key:0,predicate:i=>i.resourceMeta.type==="Mesh"||V(k.data,i),items:A.toResourceRules},{default:o(({items:i})=>[d("div",U,[(t(!0),n(c,null,_(Object.groupBy(i,s=>s.type),(s,y)=>(t(),n("div",{key:y},[u(x,{"policy-type":y},{default:o(()=>[a(h(y),1)]),_:2},1032,["policy-type"]),e[5]||(e[5]=a()),d("div",W,[(t(!0),n(c,null,_(s.length>1?s.filter(r=>V(k.data,r)):s,r=>(t(),n("div",{key:r},[r.origins.length>0?(t(),p(M,{key:0,layout:"horizontal"},{title:o(()=>e[2]||(e[2]=[a(`
                                      Origin Policies
                                    `)])),body:o(()=>[u(O,{predicate:l=>typeof l.resourceMeta<"u",items:r.origins,empty:!1},{default:o(({items:l})=>[d("ul",null,[(t(!0),n(c,null,_(l,b=>(t(),n("li",{key:JSON.stringify(b)},[Object.keys(f).length>0?(t(),p($,{key:0,to:{name:"policy-detail-view",params:{policyPath:f[y][0].path,mesh:b.resourceMeta.mesh,policy:b.resourceMeta.name}}},{default:o(()=>[a(h(b.resourceMeta.name),1)]),_:2},1032,["to"])):g("",!0)]))),128))])]),_:2},1032,["predicate","items"])]),_:2,__:[3]},1024)):g("",!0),e[4]||(e[4]=a()),u(N,{class:"mt-2",code:C(X).stringify(r.raw),language:"yaml","show-copy-button":!1},null,8,["code"])]))),128))])]))),128))])]),_:2},1032,["predicate","items"])):(t(),p(O,{key:1,predicate:i=>i.ruleType==="to"&&!["MeshHTTPRoute","MeshTCPRoute"].includes(i.type)&&i.matchers.every(s=>s.key==="kuma.io/service"&&(s.not?s.value!==P:s.value===P)),items:A.rules},{default:o(({items:i})=>[d("div",Z,[u(J,{"initially-open":0,"multiple-open":"",class:"stack"},{default:o(()=>[(t(!0),n(c,null,_(Object.groupBy(i,s=>s.type),(s,y)=>(t(),p(L,{key:y},{default:o(()=>[u(G,null,{"accordion-header":o(()=>[u(x,{"policy-type":y},{default:o(()=>[a(h(y)+" ("+h(s.length)+`)
                                  `,1)]),_:2},1032,["policy-type"])]),"accordion-content":o(()=>[d("div",ee,[(t(!0),n(c,null,_(s,r=>(t(),n(c,{key:r},[r.matchers.length>0?(t(),p(M,{key:0,layout:"horizontal"},{title:o(()=>e[6]||(e[6]=[a(`
                                          From
                                        `)])),body:o(()=>[d("p",null,[u(K,{items:r.matchers},null,8,["items"])])]),_:2,__:[7]},1024)):g("",!0),e[12]||(e[12]=a()),r.origins.length>0?(t(),p(M,{key:1,layout:"horizontal"},{title:o(()=>e[8]||(e[8]=[a(`
                                          Origin Policies
                                        `)])),body:o(()=>[d("ul",null,[(t(!0),n(c,null,_(r.origins,l=>(t(),n("li",{key:`${l.mesh}-${l.name}`},[f[l.type]?(t(),p($,{key:0,to:{name:"policy-detail-view",params:{mesh:l.mesh,policyPath:f[l.type][0].path,policy:l.name}}},{default:o(()=>[a(h(l.name),1)]),_:2},1032,["to"])):(t(),n(c,{key:1},[a(h(l.name),1)],64))]))),128))])]),_:2,__:[9]},1024)):g("",!0),e[13]||(e[13]=a()),d("div",null,[e[10]||(e[10]=d("dt",null,`
                                          Config
                                        `,-1)),e[11]||(e[11]=a()),d("dd",te,[d("div",null,[u(N,{code:C(X).stringify(r.raw),language:"yaml","show-copy-button":!1},null,8,["code"])])])])],64))),128))])]),_:2,__:[14]},1024)]),_:2},1024))),128))]),_:2},1024)])]),_:2},1032,["predicate","items"]))]),_:2},1032,["src"]))),128))]),_:2},1032,["src"])])):g("",!0)]))),128))]),_:2},1024)]),_:1},8,["name"])}}}),le=H(oe,[["__scopeId","data-v-4149f8fa"]]);export{le as default};
