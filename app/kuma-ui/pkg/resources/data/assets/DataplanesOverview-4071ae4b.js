import{d as D,R as A,t as w,V as O,o as n,g as c,w as s,h as o,C as B,l as i,j as r,G as N,D as p,m as _,F as y,i as F,W as P,X as S,A as T,_ as $,q as E}from"./index-06cdf67b.js";import{L as I}from"./LoadingBox-aa1cc5a1.js";import{O as L,a as V,b as C}from"./OnboardingPage-37a4ac12.js";import{g as R}from"./dataplane-a974028d.js";const H={key:0,class:"status-loading-box mb-4"},M={key:1},W={class:"mb-4"},j=D({__name:"DataplanesOverview",setup(q){const v=A(),k=[{label:"Mesh",key:"mesh"},{label:"Name",key:"name"},{label:"Status",key:"status"}],t=w({total:0,data:[]}),u=w(null);O(function(){g()}),m();function g(){u.value!==null&&window.clearTimeout(u.value)}async function m(){let l=!1;const d=[];try{const{items:e}=await v.getAllDataplanes({size:10});if(Array.isArray(e)&&e.length>0)for(const a of e){const{name:f,mesh:h}=a,x=await v.getDataplaneOverviewFromMesh({mesh:h,name:f}),b=R(x.dataplaneInsight);b==="offline"&&(l=!0),d.push({status:b,name:f,mesh:h})}else l=!0}catch(e){console.error(e)}t.value.data=d,t.value.total=t.value.data.length,l&&(g(),u.value=window.setTimeout(m,1e3))}return(l,d)=>(n(),c($,null,{default:s(({t:e})=>[o(B,{title:e("onboarding.routes.dataplanes-overview.title")},null,8,["title"]),i(),o(T,null,{default:s(()=>[o(L,null,{header:s(()=>[(n(!0),r(y,null,N([t.value.data.length>0?"success":"waiting"],a=>(n(),c(V,{key:a,"data-testid":`state-${a}`},{title:s(()=>[i(p(e(`onboarding.routes.dataplanes-overview.header.${a}.title`)),1)]),description:s(()=>[_("p",null,p(e(`onboarding.routes.dataplanes-overview.header.${a}.description`)),1)]),_:2},1032,["data-testid"]))),128))]),content:s(()=>[t.value.data.length===0?(n(),r("div",H,[o(I)])):(n(),r("div",M,[_("p",W,[_("b",null,"Found "+p(t.value.data.length)+" DPPs:",1)]),i(),o(F(P),{class:"mb-4",fetcher:()=>t.value,headers:k,"disable-pagination":""},{status:s(({rowValue:a})=>[a?(n(),c(S,{key:0,status:a},null,8,["status"])):(n(),r(y,{key:1},[i(`
                  â€”
                `)],64))]),_:1},8,["fetcher"])]))]),navigation:s(()=>[o(C,{"next-step":"onboarding-completed","previous-step":"onboarding-add-services-code","should-allow-next":t.value.data.length>0},null,8,["should-allow-next"])]),_:2},1024)]),_:2},1024)]),_:1}))}});const X=E(j,[["__scopeId","data-v-ab366e45"]]);export{X as default};
