import{d as P,p as d,o as u,w as e,b as t,e as o,r,c as f,J as C,L as h,M as A,t as c,R as B,m as T,F as z,q as F,H as D}from"./index-Dq_FLkmZ.js";import{_ as I}from"./ResourceCodeBlock.vue_vue_type_script_setup_true_lang-4cuY95fl.js";const H=P({__name:"MeshDetailView",props:{mesh:{}},setup(L){const l=L;return(R,s)=>{const $=r("RouteTitle"),k=r("XI18n"),w=r("XNotification"),x=r("XAction"),v=r("XBadge"),N=r("XAboutCard"),X=r("DataSource"),M=r("XLayout"),V=r("XCard"),S=r("AppView"),E=r("RouteView");return u(),d(E,{name:"mesh-detail-view",params:{mesh:""}},{default:e(({route:_,t:m,uri:b})=>[t($,{title:m("meshes.routes.overview.title"),render:!1},null,8,["title"]),s[10]||(s[10]=o()),t(X,{src:b(T(D),"/mesh-insights/:name",{name:_.params.mesh})},{default:e(({data:n})=>[t(S,{docs:m("meshes.href.docs"),notifications:!0},{default:e(()=>[t(w,{notify:!l.mesh.mtlsBackend,uri:`meshes.notifications.mtls-warning:${l.mesh.id}`},{default:e(()=>[t(k,{path:"meshes.notifications.mtls-warning"})]),_:1},8,["notify","uri"]),s[8]||(s[8]=o()),t(w,{notify:R.mesh.meshServices.mode==="Disabled",uri:`meshes.notifications.mesh-service-activation:${_.params.mesh}`,variant:"info"},{default:e(()=>[t(k,{path:"meshes.notifications.mesh-service-activation"})]),_:2},1032,["notify","uri"]),s[9]||(s[9]=o()),t(M,{type:"stack"},{default:e(()=>[t(N,{title:m("meshes.routes.item.about.title"),created:l.mesh.creationTime,modified:l.mesh.modificationTime},{default:e(()=>[(u(),f(h,null,C(["MeshTrafficPermission","MeshMetric","MeshAccessLog","MeshTrace"],i=>{var p;return u(),f(h,{key:i},[(u(!0),f(h,null,C([((p=n==null?void 0:n.policies)==null?void 0:p[i])??{total:0}],a=>(u(),f(h,{key:typeof a},[t(w,{notify:i==="MeshTrafficPermission"&&l.mesh.mtlsBackend&&a.total===0,uri:`meshes.notifications.mtp-warning:${l.mesh.id}`},{default:e(()=>[t(k,{path:"meshes.notifications.mtp-warning"})]),_:2},1032,["notify","uri"]),s[1]||(s[1]=o()),t(A,{layout:"horizontal"},{title:e(()=>[t(x,{to:{name:"policy-list-view",params:{mesh:_.params.mesh,policyPath:`${i.toLowerCase()}s`}}},{default:e(()=>[o(c(i),1)]),_:2},1032,["to"])]),body:e(()=>[t(v,{appearance:a.total>0?"success":"neutral"},{default:e(()=>[o(c(a.total>0?m("meshes.detail.enabled"):m("meshes.detail.disabled")),1)]),_:2},1032,["appearance"])]),_:2},1024)],64))),128))],64)}),64)),s[3]||(s[3]=o()),t(A,{layout:"horizontal"},{title:e(()=>[o(c(m("http.api.property.mtls")),1)]),body:e(()=>[l.mesh.mtlsBackend?(u(),d(v,{key:1,appearance:"info"},{default:e(()=>[o(c(l.mesh.mtlsBackend.type)+" / "+c(l.mesh.mtlsBackend.name),1)]),_:1})):(u(),d(v,{key:0,appearance:"neutral"},{default:e(()=>[o(c(m("meshes.detail.disabled")),1)]),_:2},1024))]),_:2},1024)]),_:2},1032,["title","created","modified"]),s[6]||(s[6]=o()),t(V,null,{default:e(()=>[t(M,{type:"columns",class:"columns-with-borders"},{default:e(()=>[t(B,{total:(n==null?void 0:n.services.total)??0,"data-testid":"services-status"},{title:e(()=>[o(c(m("meshes.detail.services")),1)]),_:2},1032,["total"]),s[4]||(s[4]=o()),t(B,{total:(n==null?void 0:n.dataplanesByType.standard.total)??0,online:(n==null?void 0:n.dataplanesByType.standard.online)??0,"data-testid":"data-plane-proxies-status"},{title:e(()=>[o(c(m("meshes.detail.data_plane_proxies")),1)]),_:2},1032,["total","online"]),s[5]||(s[5]=o()),t(X,{src:b(T(z),"/policy-types",{})},{default:e(({data:i})=>[(u(!0),f(h,null,C([i==null?void 0:i.policyTypes.map(p=>p.name)],p=>(u(),d(B,{key:typeof p,total:Object.entries((n==null?void 0:n.resources)||{}).reduce((a,[y,{total:g}])=>(p||[]).includes(y)?a+g:a,0),"data-testid":"policies-status"},{title:e(()=>[o(c(m("meshes.detail.policies")),1)]),_:2},1032,["total"]))),128))]),_:2},1032,["src"])]),_:2},1024)]),_:2},1024),s[7]||(s[7]=o()),t(V,null,{default:e(()=>[t(I,{resource:l.mesh.config},{default:e(({copy:i,copying:p})=>[p?(u(),d(X,{key:0,src:b(T(D),"/meshes/:name/as/kubernetes",{name:_.params.mesh},{cacheControl:"no-store"}),onChange:a=>{i(y=>y(a))},onError:a=>{i((y,g)=>g(a))}},null,8,["src","onChange","onError"])):F("",!0)]),_:2},1032,["resource"])]),_:2},1024)]),_:2},1024)]),_:2},1032,["docs"])]),_:2},1032,["src"])]),_:1})}}});export{H as default};
