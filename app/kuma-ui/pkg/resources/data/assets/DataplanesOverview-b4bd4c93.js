import{d as B,R as S,L as N,t as b,f as w,V as T,o as n,g as y,w as a,h as s,i as D,C as F,l as r,X as I,m as l,D as c,j as d,W as E,Y as L,F as V,A as C,_ as R,q as W}from"./index-7e0b84ab.js";import{L as H}from"./LoadingBox-0f15ddec.js";import{O as M,a as $,b as j}from"./OnboardingPage-7bc57c59.js";import{g as q}from"./dataplane-30467516.js";const z={key:0,class:"status-loading-box mb-4"},K={key:1},U={class:"mb-4"},X=B({__name:"DataplanesOverview",setup(Y){const p=S(),{t:k}=N(),x=[{label:"Mesh",key:"mesh"},{label:"Name",key:"name"},{label:"Status",key:"status"}],e=b({total:0,data:[]}),o=b(null),A=w(()=>e.value.data.length>0?"Success":"Waiting for DPPs"),m=w(()=>e.value.data.length>0?"The following data plane proxies (DPPs) are connected to the control plane:":null);T(function(){_()}),v();function _(){o.value!==null&&window.clearTimeout(o.value)}async function v(){let i=!1;const u=[];try{const{items:t}=await p.getAllDataplanes({size:10});if(Array.isArray(t))for(const O of t){const{name:f,mesh:g}=O,P=await p.getDataplaneOverviewFromMesh({mesh:g,name:f}),h=q(P.dataplaneInsight);h==="offline"&&(i=!0),u.push({status:h,name:f,mesh:g})}}catch(t){console.error(t)}e.value.data=u,e.value.total=e.value.data.length,i&&(_(),o.value=window.setTimeout(v,1e3))}return(i,u)=>(n(),y(R,null,{default:a(()=>[s(F,{title:D(k)("onboarding.routes.dataplanes-overview.title")},null,8,["title"]),r(),s(C,null,{default:a(()=>[s(M,null,{header:a(()=>[s($,null,I({title:a(()=>[l("p",null,c(A.value),1)]),_:2},[m.value!==null?{name:"description",fn:a(()=>[l("p",null,c(m.value),1)]),key:"0"}:void 0]),1024)]),content:a(()=>[e.value.data.length===0?(n(),d("div",z,[s(H)])):(n(),d("div",K,[l("p",U,[l("b",null,"Found "+c(e.value.data.length)+" DPPs:",1)]),r(),s(D(E),{class:"mb-4",fetcher:()=>e.value,headers:x,"disable-pagination":""},{status:a(({rowValue:t})=>[t?(n(),y(L,{key:0,status:t},null,8,["status"])):(n(),d(V,{key:1},[r(`
                  â€”
                `)],64))]),_:1},8,["fetcher"])]))]),navigation:a(()=>[s(j,{"next-step":"onboarding-completed","previous-step":"onboarding-add-services-code","should-allow-next":e.value.data.length>0},null,8,["should-allow-next"])]),_:1})]),_:1})]),_:1}))}});const ee=W(X,[["__scopeId","data-v-4588fbe4"]]);export{ee as default};
