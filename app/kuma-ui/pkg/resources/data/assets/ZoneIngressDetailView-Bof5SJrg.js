import{d as M,Q as P,r as l,p as m,o as i,w as e,b as n,e as t,q as I,M as x,S as Q,t as r,c as y,L as _,m as A,T as H,J as k,y as K,B as U,l as W,_ as Y}from"./index-Dq_FLkmZ.js";import{S as ee}from"./SummaryView-DXK1cYh7.js";import{C as R,b as $,a as te}from"./ConnectionTraffic-uW8Svxil.js";import"./TagList-Ct_aBoky.js";const ne=M({__name:"ZoneIngressDetailView",props:{data:{}},setup(L){const p=L,T=P();return(oe,o)=>{const S=l("XBadge"),V=l("XCopyButton"),q=l("XAboutCard"),z=l("XAction"),X=l("DataCollection"),C=l("XLayout"),N=l("XInputSwitch"),D=l("XCard"),O=l("RouterView"),j=l("DataLoader"),Z=l("XI18n"),E=l("XIcon"),F=l("AppView"),G=l("RouteView");return i(),m(G,{name:"zone-ingress-detail-view",params:{subscription:"",proxy:"",inactive:Boolean}},{default:e(({t:d,me:f,route:c,uri:J})=>[n(F,null,{default:e(()=>[n(q,{title:d("zone-ingresses.routes.item.about.title"),created:p.data.creationTime,modified:p.data.modificationTime},{default:e(()=>[n(x,{layout:"horizontal"},{title:e(()=>[t(r(d("http.api.property.status")),1)]),body:e(()=>[n(Q,{status:p.data.state},null,8,["status"])]),_:2},1024),o[4]||(o[4]=t()),p.data.namespace.length>0?(i(),m(x,{key:0,layout:"horizontal"},{title:e(()=>[t(r(d("http.api.property.namespace")),1)]),body:e(()=>[n(S,{appearance:"decorative"},{default:e(()=>[t(r(p.data.namespace),1)]),_:1})]),_:2},1024)):I("",!0),o[5]||(o[5]=t()),n(x,{layout:"horizontal"},{title:e(()=>[t(r(d("http.api.property.address")),1)]),body:e(()=>[p.data.zoneIngress.socketAddress.length>0?(i(),m(V,{key:0,variant:"badge",format:"default",text:p.data.zoneIngress.socketAddress},null,8,["text"])):(i(),y(_,{key:1},[t(r(d("common.detail.none")),1)],64))]),_:2},1024),o[6]||(o[6]=t()),n(x,{layout:"horizontal"},{title:e(()=>[t(r(d("http.api.property.advertisedAddress")),1)]),body:e(()=>[p.data.zoneIngress.advertisedSocketAddress.length>0?(i(),m(S,{key:0,appearance:"decorative"},{default:e(()=>[n(V,{text:p.data.zoneIngress.advertisedSocketAddress},null,8,["text"])]),_:1})):(i(),y(_,{key:1},[t(r(d("common.detail.none")),1)],64))]),_:2},1024)]),_:2},1032,["title","created","modified"]),o[20]||(o[20]=t()),n(j,{src:J(A(H),"/connections/stats/for/:proxyType/:name/:mesh/:socketAddress",{name:c.params.proxy,mesh:"*",socketAddress:p.data.zoneIngress.socketAddress,proxyType:"zone-ingress"})},{default:e(({data:s,refresh:u})=>[n(D,null,{default:e(()=>[n(C,{type:"columns"},{default:e(()=>[n(R,null,{default:e(()=>[n(C,{type:"stack",size:"small"},{default:e(()=>[n(X,{type:"inbounds",items:Object.entries(s.inbounds)},{default:e(({items:a})=>[(i(!0),y(_,null,k(a,([v,w])=>(i(),m($,{key:`${v}`,protocol:"",traffic:w},{default:e(()=>[n(z,{"data-action":"",to:{name:(g=>g.includes("bound")?g.replace("-outbound-","-inbound-"):"zone-ingress-connection-inbound-summary-stats-view")(String(A(T).name)),params:{connection:v,proxyType:"ingresses"},query:{inactive:c.params.inactive}}},{default:e(()=>[t(`
                        :`+r(v.split("_").at(-1)),1)]),_:2},1032,["to"])]),_:2},1032,["traffic"]))),128))]),_:2},1032,["items"])]),_:2},1024)]),_:2},1024),o[11]||(o[11]=t()),n(R,null,{actions:e(()=>[n(N,{checked:c.params.inactive,"data-testid":"dataplane-outbounds-inactive-toggle",onChange:a=>c.update({inactive:a})},{label:e(()=>o[7]||(o[7]=[t(`
                    Show inactive
                  `)])),_:2},1032,["checked","onChange"]),o[9]||(o[9]=t()),n(z,{action:"refresh",appearance:"primary",onClick:u},{default:e(()=>o[8]||(o[8]=[t(`
                  Refresh
                `)])),_:2},1032,["onClick"])]),default:e(()=>[o[10]||(o[10]=t()),(i(),y(_,null,k(["upstream"],a=>n(X,{key:a,type:"outbounds",items:Object.entries(s.outbounds)},{default:e(({items:v})=>[n(X,{type:"activeOutbounds",predicate:c.params.inactive?void 0:([w,g])=>{var b,h;return((typeof g.tcp<"u"?(b=g.tcp)==null?void 0:b[`${a}_cx_rx_bytes_total`]:(h=g.http)==null?void 0:h[`${a}_rq_total`])??0)>0},items:v},{default:e(({items:w})=>[w.length>0?(i(),m(te,{key:0,type:"outbound"},{default:e(()=>[(i(),y(_,null,k([/-([a-f0-9]){16}$/],g=>n(C,{key:g,type:"stack",size:"small"},{default:e(()=>[(i(!0),y(_,null,k(w,([b,h])=>(i(),m($,{key:`${b}`,"data-testid":"dataplane-outbound",protocol:"",traffic:h,direction:a},{default:e(()=>[n(z,{"data-action":"",to:{name:(B=>B.includes("bound")?B.replace("-inbound-","-outbound-"):"zone-ingress-connection-outbound-summary-stats-view")(String(A(T).name)),params:{connection:b},query:{inactive:c.params.inactive}}},{default:e(()=>[t(r(b),1)]),_:2},1032,["to"])]),_:2},1032,["traffic","direction"]))),128))]),_:2},1024)),64))]),_:2},1024)):I("",!0)]),_:2},1032,["predicate","items"])]),_:2},1032,["items"])),64))]),_:2},1024)]),_:2},1024)]),_:2},1024),o[12]||(o[12]=t()),n(O,null,{default:e(a=>[a.route.name!==c.name?(i(),m(ee,{key:0,width:"670px",onClose:function(){c.replace({name:"zone-ingress-detail-view",params:{proxy:c.params.proxy,proxyType:"ingresses"},query:{inactive:c.params.inactive?null:void 0}})}},{default:e(()=>[(i(),m(K(a.Component),{data:c.params.subscription.length>0?p.data.zoneIngressInsight.subscriptions:a.route.name.includes("-inbound-")?[p.data.zoneIngress]:(s==null?void 0:s.outbounds)||{},networking:p.data.zoneIngress.networking},null,8,["data","networking"]))]),_:2},1032,["onClose"])):I("",!0)]),_:2},1024)]),_:2},1032,["src"]),o[21]||(o[21]=t()),p.data.zoneIngressInsight.subscriptions.length>0?(i(),m(D,{key:0},{title:e(()=>[W("h2",null,r(d("zone-ingresses.routes.item.subscriptions.title")),1)]),default:e(()=>[o[19]||(o[19]=t()),n(C,null,{default:e(()=>[n(Z,{path:"zone-ingresses.routes.item.subscriptions.description"}),o[18]||(o[18]=t()),n(U,{headers:[{...f.get("headers.connection"),label:"Â ",key:"connection"},{...f.get("headers.instanceId"),label:d("http.api.property.instanceId"),key:"instanceId"},{...f.get("headers.version"),label:d("http.api.property.version"),key:"version"},{...f.get("headers.connected"),label:d("http.api.property.connected"),key:"connected"},{...f.get("headers.disconnected"),label:d("http.api.property.disconnected"),key:"disconnected"},{...f.get("headers.responses"),label:d("http.api.property.responses"),key:"responses"}],"is-selected-row":s=>s.id===c.params.subscription,items:p.data.zoneIngressInsight.subscriptions.map((s,u,a)=>a[a.length-(u+1)]),onResize:f.set},{connection:e(({row:s})=>[(i(!0),y(_,null,k([s.connectTime&&!s.disconnectTime?"healthy":"unhealthy"],u=>(i(),m(E,{key:`${u}`,name:u},{default:e(()=>[t(r(d(`common.connection.${u}`)),1)]),_:2},1032,["name"]))),128))]),instanceId:e(({row:s})=>[n(z,{"data-action":"",to:{name:"zone-ingress-subscription-summary-view",params:{subscription:s.id}}},{default:e(()=>[t(r(s.controlPlaneInstanceId),1)]),_:2},1032,["to"])]),version:e(({row:s})=>{var u,a;return[t(r(((a=(u=s.version)==null?void 0:u.kumaDp)==null?void 0:a.version)??"-"),1)]}),connected:e(({row:s})=>[t(r(d("common.formats.datetime",{value:Date.parse(s.connectTime??"")})),1)]),disconnected:e(({row:s})=>[s.disconnectTime?(i(),y(_,{key:0},[t(r(d("common.formats.datetime",{value:Date.parse(s.disconnectTime)})),1)],64)):I("",!0)]),responses:e(({row:s})=>{var u;return[(i(!0),y(_,null,k([((u=s.status)==null?void 0:u.total)??{}],a=>(i(),y(_,null,[t(r(a.responsesSent)+"/"+r(a.responsesAcknowledged),1)],64))),256))]}),_:2},1032,["headers","is-selected-row","items","onResize"])]),_:2},1024)]),_:2},1024)):I("",!0)]),_:2},1024)]),_:1})}}}),de=Y(ne,[["__scopeId","data-v-d99f5a88"]]);export{de as default};
