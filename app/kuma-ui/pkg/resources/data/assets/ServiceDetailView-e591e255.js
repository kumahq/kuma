import{d as w,o as i,e as f,h as r,w as e,q as b,g as a,t as m,b as l,a as n,f as A,G as $,F as N,B as F,s as K,N as L}from"./index-60badd09.js";import{m as R,g as T,D as v,S as W,R as G,A as J,o as k,p as P,E as V,q as O,_ as j,f as H}from"./RouteView.vue_vue_type_script_setup_true_lang-6fb74096.js";import{_ as M}from"./ResourceCodeBlock.vue_vue_type_script_setup_true_lang-1a212f9d.js";import{T as Q}from"./TagList-088f49dc.js";import{T as S}from"./TextWithCopyButton-3cdb3902.js";import{_ as U}from"./RouteTitle.vue_vue_type_script_setup_true_lang-b3c34ac7.js";import{D as X,K as Y}from"./KFilterBar-26aa2a90.js";import{T as Z}from"./TabsWidget-2158c452.js";import"./CodeBlock.vue_vue_type_style_index_0_lang-4c8074cf.js";import"./CopyButton-96f085b9.js";import"./AppCollection-f8cdbac5.js";import"./dataplane-30467516.js";import"./notEmpty-7f452b20.js";const D={class:"stack"},ee={class:"columns",style:{"--columns":"3"}},te=w({__name:"ExternalServiceDetails",props:{serviceInsight:{},externalService:{}},setup(h){const t=h,o=R(),{t:_}=T();async function y(u){const{mesh:s,name:d}=t.externalService;return await o.getExternalService({mesh:s,name:d},u)}return(u,s)=>(i(),f("div",D,[r(l($),null,{body:e(()=>[b("div",ee,[r(v,null,{title:e(()=>[a(m(l(_)("http.api.property.name")),1)]),body:e(()=>[r(S,{text:t.serviceInsight.name},null,8,["text"])]),_:1}),a(),r(v,null,{title:e(()=>[a(m(l(_)("http.api.property.address")),1)]),body:e(()=>[a(m(t.externalService.networking.address),1)]),_:1}),a(),t.externalService.tags!==null?(i(),n(v,{key:0},{title:e(()=>[a(m(l(_)("http.api.property.tags")),1)]),body:e(()=>[r(Q,{tags:t.externalService.tags},null,8,["tags"])]),_:1})):A("",!0)])]),_:1}),a(),r(M,{id:"code-block-service",resource:t.externalService,"resource-fetcher":y,"is-searchable":""},null,8,["resource"])]))}}),se={class:"stack"},re={class:"columns",style:{"--columns":"4"}},ie=w({__name:"ServiceInsightDetails",props:{serviceInsight:{}},setup(h){const t=h,{t:o}=T();return(_,y)=>(i(),f("div",se,[r(l($),null,{body:e(()=>{var u,s;return[b("div",re,[r(v,null,{title:e(()=>[a(m(l(o)("http.api.property.status")),1)]),body:e(()=>[r(W,{status:t.serviceInsight.status??"not_available"},null,8,["status"])]),_:1}),a(),r(v,null,{title:e(()=>[a(m(l(o)("http.api.property.name")),1)]),body:e(()=>[r(S,{text:t.serviceInsight.name},null,8,["text"])]),_:1}),a(),r(v,null,{title:e(()=>[a(m(l(o)("http.api.property.address")),1)]),body:e(()=>[t.serviceInsight.addressPort?(i(),n(S,{key:0,text:t.serviceInsight.addressPort},null,8,["text"])):(i(),f(N,{key:1},[a(m(l(o)("common.detail.none")),1)],64))]),_:1}),a(),r(G,{online:((u=t.serviceInsight.dataplanes)==null?void 0:u.online)??0,total:((s=t.serviceInsight.dataplanes)==null?void 0:s.total)??0},{title:e(()=>[a(m(l(o)("http.api.property.dataPlaneProxies")),1)]),_:1},8,["online","total"])])]}),_:1})]))}}),ae=w({__name:"ServiceDetailView",props:{page:{},size:{},search:{},query:{},gatewayType:{},mesh:{},service:{}},setup(h){const t=h,{t:o}=T();function _(y){const u=[{hash:"#overview",title:o("services.routes.item.tabs.overview")}];return y.serviceType!=="external"&&u.push({hash:"#dataPlaneProxies",title:o("services.routes.item.tabs.data_plane_proxies")}),u}return(y,u)=>(i(),n(j,{name:"service-detail-view","data-testid":"service-detail-view"},{default:e(({route:s})=>[r(J,{breadcrumbs:[{to:{name:"mesh-detail-view",params:{mesh:s.params.mesh}},text:s.params.mesh},{to:{name:"services-list-view",params:{mesh:s.params.mesh}},text:l(o)("services.routes.item.breadcrumbs")}]},{title:e(()=>[b("h1",null,[r(U,{title:l(o)("services.routes.item.title",{name:s.params.service}),render:!0},null,8,["title"])])]),default:e(()=>[a(),r(k,{src:`/meshes/${s.params.mesh}/service-insights/${s.params.service}`},{default:e(({data:d,error:I})=>[d===void 0?(i(),n(P,{key:0})):I?(i(),n(V,{key:1,error:I},null,8,["error"])):(i(),n(Z,{key:2,tabs:_(d)},F({overview:e(()=>[d.serviceType==="external"?(i(),n(k,{key:0,src:`/meshes/${s.params.mesh}/external-services/for/${s.params.service}?size=1000`},{default:e(({data:c,error:g})=>[c===void 0?(i(),n(P,{key:0})):g?(i(),n(V,{key:1,error:g},null,8,["error"])):c===null?(i(),n(O,{key:2,"data-testid":"no-matching-external-service"},{title:e(()=>[b("p",null,m(l(o)("services.detail.no_matching_external_service",{name:t.service})),1)]),_:1})):(i(),n(te,{key:3,"service-insight":d,"external-service":c},null,8,["service-insight","external-service"]))]),_:2},1032,["src"])):(i(),n(ie,{key:1,"service-insight":d},null,8,["service-insight"]))]),_:2},[d.serviceType!=="external"?{name:"dataPlaneProxies",fn:e(()=>[r(k,{src:`/meshes/${s.params.mesh}/dataplanes/for/${s.params.service}/of/${t.gatewayType}?page=${t.page}&size=${t.size}&search=${t.search}`},{default:e(({data:c,error:g})=>{var z,B,q,C;return[(i(!0),f(N,null,K([typeof((C=(q=(B=(z=c==null?void 0:c.items)==null?void 0:z[0])==null?void 0:B.dataplane)==null?void 0:q.networking)==null?void 0:C.gateway)>"u"],x=>(i(),n(l($),{key:x},{body:e(()=>[r(X,{"data-testid":"data-plane-collection",class:"data-plane-collection","page-number":t.page,"page-size":t.size,total:c==null?void 0:c.total,items:c==null?void 0:c.items,error:g,gateways:x,onChange:({page:p,size:E})=>{s.update({page:String(p),size:String(E)})}},{toolbar:e(()=>[r(Y,{class:"data-plane-proxy-filter",placeholder:"tag: 'kuma.io/protocol: http'",query:t.query,fields:{name:{description:"filter by name or parts of a name"},protocol:{description:"filter by “kuma.io/protocol” value"},tag:{description:"filter by tags (e.g. “tag: version:2”)"},zone:{description:"filter by “kuma.io/zone” value"}},onFieldsChange:p=>s.update({query:p.query,s:p.query.length>0?JSON.stringify(p.fields):""})},null,8,["placeholder","query","fields","onFieldsChange"]),a(),x?(i(),n(l(L),{key:0,label:"Type","overlay-label":!0,items:[{label:"All",value:"all"},{label:"Builtin",value:"builtin"},{label:"Delegated",value:"delegated"}].map(p=>({...p,selected:p.value===t.gatewayType})),appearance:"select",onSelected:p=>s.update({gatewayType:String(p.value)})},{"item-template":e(({item:p})=>[a(m(p.label),1)]),_:2},1032,["items","onSelected"])):A("",!0)]),_:2},1032,["page-number","page-size","total","items","error","gateways","onChange"])]),_:2},1024))),128))]}),_:2},1032,["src"])]),key:"0"}:void 0]),1032,["tabs"]))]),_:2},1032,["src"])]),_:2},1032,["breadcrumbs"])]),_:1}))}});const fe=H(ae,[["__scopeId","data-v-41de2fb0"]]);export{fe as default};
