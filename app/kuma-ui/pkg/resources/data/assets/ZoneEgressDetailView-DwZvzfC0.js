import{d as H,a2 as J,r,p as c,o as s,w as t,b as o,e as n,q as z,l as a,c as y,t as i,T as K,L as _,M as v,m as D,a3 as Q,y as U,_ as W}from"./index-BI7Ox0LO.js";import{C as T,b as B,a as Y}from"./ConnectionTraffic-CQS6rqo-.js";import"./TagList-BZLeI2Ir.js";const h={key:0},ee=H({__name:"ZoneEgressDetailView",props:{data:{}},setup(I){const d=I,V=J();return(te,e)=>{const w=r("XBadge"),S=r("XCopyButton"),A=r("XDl"),C=r("XAction"),g=r("XLayout"),L=r("XI18n"),R=r("XAboutCard"),x=r("DataCollection"),q=r("XInputSwitch"),$=r("XCard"),N=r("XDrawer"),O=r("RouterView"),j=r("DataLoader"),Z=r("AppView"),F=r("RouteView");return s(),c(F,{name:"zone-egress-detail-view",params:{inactive:Boolean,subscription:"",proxy:""}},{default:t(({t:l,route:u,uri:G})=>[o(Z,null,{default:t(()=>[o(g,{type:"stack"},{default:t(()=>[o(R,{title:l("zone-egresses.routes.item.about.title"),created:d.data.creationTime,modified:d.data.modificationTime,class:"about-section"},{default:t(()=>[o(g,null,{default:t(()=>[o(A,{variant:"x-stack"},{default:t(()=>[a("div",null,[a("dt",null,i(l("http.api.property.status")),1),e[0]||(e[0]=n()),a("dd",null,[o(K,{status:d.data.state},null,8,["status"])])]),e[3]||(e[3]=n()),d.data.namespace.length>0?(s(),y("div",h,[a("dt",null,i(l("http.api.property.namespace")),1),e[1]||(e[1]=n()),a("dd",null,[o(w,{appearance:"decorative"},{default:t(()=>[n(i(d.data.namespace),1)]),_:1})])])):z("",!0),e[4]||(e[4]=n()),a("div",null,[a("dt",null,i(l("http.api.property.address")),1),e[2]||(e[2]=n()),a("dd",null,[d.data.zoneEgress.socketAddress.length>0?(s(),c(S,{key:0,variant:"badge",format:"default",text:d.data.zoneEgress.socketAddress},null,8,["text"])):(s(),y(_,{key:1},[n(i(l("common.detail.none")),1)],64))])])]),_:2},1024),e[12]||(e[12]=n()),d.data.zoneEgressInsight.subscriptions.length>0?(s(),c(g,{key:0,"data-testid":"about-zone-egress-subscriptions",class:"about-subsection"},{default:t(()=>[o(g,{type:"separated"},{default:t(()=>[a("h3",null,i(l("zone-egresses.routes.item.subscriptions.title")),1),e[5]||(e[5]=n()),o(C,{"data-action":"",appearance:"anchor",to:{name:"zone-egress-subscriptions-list-view",params:{proxy:u.params.proxy},query:{inactive:u.params.inactive}}},{default:t(()=>[n(`
                  (`+i(l("zone-egresses.routes.item.subscriptions.show-details"))+`)
                `,1)]),_:2},1032,["to"])]),_:2},1024),e[11]||(e[11]=n()),(s(!0),y(_,null,v([d.data.zoneEgressInsight.connectedSubscription],m=>(s(),y(_,{key:typeof m},[!m?.disconnectTime&&m?.connectTime?(s(),c(A,{key:0,variant:"x-stack"},{default:t(()=>[a("div",null,[a("dt",null,i(l("zone-egresses.routes.item.subscriptions.connected")),1),e[6]||(e[6]=n()),a("dd",null,[o(w,{appearance:"neutral"},{default:t(()=>[n(i(l("common.formats.datetime",{value:Date.parse(m.connectTime)})),1)]),_:2},1024)])]),e[9]||(e[9]=n()),a("div",null,[a("dt",null,i(l("zone-egresses.routes.item.subscriptions.instance")),1),e[7]||(e[7]=n()),a("dd",null,[o(w,{appearance:"info"},{default:t(()=>[n(i(m.controlPlaneInstanceId),1)]),_:2},1024)])]),e[10]||(e[10]=n()),a("div",null,[a("dt",null,i(l("zone-egresses.routes.item.subscriptions.version")),1),e[8]||(e[8]=n()),a("dd",null,[o(w,{appearance:"info"},{default:t(()=>[n(i(m.version?.kumaDp?.version??l("common.unknown")),1)]),_:2},1024)])])]),_:2},1024)):(s(),c(L,{key:1,path:"zone-egresses.routes.item.subscriptions.disconnected"}))],64))),128))]),_:2},1024)):z("",!0)]),_:2},1024)]),_:2},1032,["title","created","modified"]),e[19]||(e[19]=n()),o(j,{src:G(D(Q),"/connections/stats/for/:proxyType/:name/:mesh/:socketAddress",{name:u.params.proxy,mesh:"*",socketAddress:d.data.zoneEgress.socketAddress,proxyType:"zone-egress"})},{default:t(({data:m,refresh:M})=>[o($,null,{default:t(()=>[o(g,{type:"columns"},{default:t(()=>[o(T,null,{default:t(()=>[o(g,{type:"stack",size:"small"},{default:t(()=>[o(x,{type:"inbounds",items:Object.entries(m.inbounds)},{default:t(({items:p})=>[(s(!0),y(_,null,v(p,([b,k])=>(s(),c(B,{key:`${b}`,protocol:"",traffic:k},{default:t(()=>[o(C,{"data-action":"",to:{name:(f=>f.includes("bound")?f.replace("-outbound-","-inbound-"):"zone-egress-connection-inbound-summary-stats-view")(String(D(V).name)),params:{connection:b},query:{inactive:u.params.inactive}}},{default:t(()=>[n(`
                          :`+i(b.split("_").at(-1)),1)]),_:2},1032,["to"])]),_:2},1032,["traffic"]))),128))]),_:2},1032,["items"])]),_:2},1024)]),_:2},1024),e[17]||(e[17]=n()),o(T,null,{actions:t(()=>[o(q,{checked:u.params.inactive,"data-testid":"dataplane-outbounds-inactive-toggle",onChange:p=>u.update({inactive:p})},{label:t(()=>[...e[13]||(e[13]=[n(`
                      Show inactive
                    `,-1)])]),_:1},8,["checked","onChange"]),e[15]||(e[15]=n()),o(C,{action:"refresh",appearance:"primary",onClick:M},{default:t(()=>[...e[14]||(e[14]=[n(`
                    Refresh
                  `,-1)])]),_:1},8,["onClick"])]),default:t(()=>[e[16]||(e[16]=n()),(s(),y(_,null,v(["upstream"],p=>o(x,{key:p,type:"outbounds",items:Object.entries(m.outbounds)},{default:t(({items:b})=>[o(x,{type:"activeOutbounds",predicate:u.params.inactive?void 0:([k,f])=>((typeof f.tcp<"u"?f.tcp?.[`${p}_cx_rx_bytes_total`]:f.http?.[`${p}_rq_total`])??0)>0,items:b},{default:t(({items:k})=>[k.length>0?(s(),c(Y,{key:0,type:"outbound"},{default:t(()=>[(s(),y(_,null,v([/-([a-f0-9]){16}$/],f=>o(g,{key:typeof f,type:"stack",size:"small"},{default:t(()=>[(s(!0),y(_,null,v(k,([X,P])=>(s(),c(B,{key:`${X}`,"data-testid":"dataplane-outbound",protocol:"",traffic:P,direction:p},{default:t(()=>[o(C,{"data-action":"",to:{name:(E=>E.includes("bound")?E.replace("-inbound-","-outbound-"):"zone-egress-connection-outbound-summary-stats-view")(String(D(V).name)),params:{connection:X},query:{inactive:u.params.inactive}}},{default:t(()=>[n(i(X),1)]),_:2},1032,["to"])]),_:2},1032,["traffic","direction"]))),128))]),_:2},1024)),64))]),_:2},1024)):z("",!0)]),_:2},1032,["predicate","items"])]),_:2},1032,["items"])),64))]),_:2},1024)]),_:2},1024)]),_:2},1024),e[18]||(e[18]=n()),o(O,null,{default:t(p=>[p.route.name!==u.name?(s(),c(N,{key:0,width:"670px",onClose:function(){u.replace({name:"zone-egress-detail-view",params:{proxyType:"egresses",proxy:u.params.proxy}})}},{default:t(()=>[(s(),c(U(p.Component),{data:u.params.subscription.length>0?d.data.zoneEgressInsight.subscriptions:p.route.name.includes("-inbound-")?[d.data.zoneEgress]:m?.outbounds||{},networking:d.data.zoneEgress.networking},null,8,["data","networking"]))]),_:2},1032,["onClose"])):z("",!0)]),_:2},1024)]),_:2},1032,["src"])]),_:2},1024)]),_:2},1024)]),_:1})}}}),ae=W(ee,[["__scopeId","data-v-8c8a32f9"]]);export{ae as default};
