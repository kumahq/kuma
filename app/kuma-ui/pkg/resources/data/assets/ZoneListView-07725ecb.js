import{d as D,k as $,o as a,a as l,w as t,A as T,g as s,b as e,X as F,f as N,V as K,c as P,r as W,h as i,s as h,j as X,t as m,e as A,F as M,Y,x as E,$ as j,E as G,H as Z}from"./index-2a9ba339.js";import{_ as H}from"./MultizoneInfo.vue_vue_type_script_setup_true_lang-cca930bf.js";import{_ as O,A as U}from"./DataSource.vue_vue_type_script_setup_true_lang-c18fdd22.js";import{E as J,g as Q,n as ee,e as te,A as oe,_ as ne,o as se,f as ae}from"./RouteView.vue_vue_type_script_setup_true_lang-5d6806ed.js";import{_ as ie}from"./RouteTitle.vue_vue_type_script_setup_true_lang-4859e7c4.js";import{S as le}from"./StatusBadge-4403951c.js";const re=D({__name:"DeleteResourceModal",props:{actionButtonText:{type:String,required:!1,default:"Yes, delete"},confirmationText:{type:String,required:!1,default:""},deleteFunction:{type:Function,required:!0},isVisible:{type:Boolean,required:!0},modalId:{type:String,required:!0},title:{type:String,required:!1,default:"Delete"}},emits:["cancel","delete"],setup(z,{emit:u}){const r=z,o=$(!1);async function x(){o.value=!1;try{await r.deleteFunction(),u("delete")}catch{o.value=!0}}return(p,d)=>(a(),l(e(K),{"action-button-text":r.actionButtonText,"confirmation-text":r.confirmationText,"is-visible":r.isVisible,"modal-id":r.modalId,title:r.title,type:"danger","data-testid":"delete-resource-modal",onCanceled:d[0]||(d[0]=f=>u("cancel")),onProceed:x},{"body-content":t(()=>[T(p.$slots,"body-content"),s(),o.value?(a(),l(e(F),{key:0,class:"mt-4",appearance:"danger","is-dismissible":""},{alertMessage:t(()=>[T(p.$slots,"error")]),_:3})):N("",!0)]),_:3},8,["action-button-text","confirmation-text","is-visible","modal-id","title"]))}}),ce=D({__name:"ZoneListView",props:{page:{type:Number,required:!0},size:{type:Number,required:!0}},setup(z){const u=z,r=J(),{t:o}=Q(),x=ee(),p=te(),d=$(!1),f=$(""),I=P(()=>p.getters["config/getEnvironment"]);function L(_){return _.map(b=>{var S;const{name:v}=b,w={name:"zone-cp-detail-view",params:{zone:v}};let c="";const V=I.value;let y=!0;(((S=b.zoneInsight)==null?void 0:S.subscriptions)??[]).forEach(k=>{if(k.version&&k.version.kumaCp){c=k.version.kumaCp.version;const{kumaCpGlobalCompatible:R=!0}=k.version.kumaCp;y=R}});const g=se(b.zoneInsight);return{detailViewRoute:w,name:v,status:g,zoneCpVersion:c,type:V,warnings:!y}})}async function q(){await x.deleteZone({name:f.value})}function C(){d.value=!d.value}function B(_){C(),f.value=_}return(_,b)=>{const v=W("RouterLink");return a(),l(ne,{name:"zone-cp-list-view"},{default:t(({route:w})=>[i(oe,{breadcrumbs:[{to:{name:"zone-cp-list-view"},text:e(o)("zone-cps.routes.items.breadcrumbs")}]},{title:t(()=>[h("h2",null,[i(ie,{title:e(o)("zone-cps.routes.items.title"),render:!0},null,8,["title"])])]),default:t(()=>[s(),e(p).getters["config/getMulticlusterStatus"]===!1?(a(),l(H,{key:0})):(a(),l(O,{key:1,src:`/zone-cps?size=${u.size}&page=${u.page}`},{default:t(({data:c,error:V,refresh:y})=>[i(e(X),null,{body:t(()=>[i(U,{class:"zone-cp-collection","data-testid":"zone-cp-collection",headers:[{label:"Name",key:"name"},{label:"Zone CP Version",key:"zoneCpVersion"},{label:"Type",key:"type"},{label:"Status",key:"status"},{label:"Warnings",key:"warnings",hideLabel:!0},{label:"Actions",key:"actions",hideLabel:!0}],"page-number":u.page,"page-size":u.size,total:c==null?void 0:c.total,items:c?L(c.items):void 0,error:V,onChange:w.update},{name:t(({row:n,rowValue:g})=>[i(v,{to:n.detailViewRoute,"data-testid":"detail-view-link"},{default:t(()=>[s(m(g),1)]),_:2},1032,["to"])]),zoneCpVersion:t(({rowValue:n})=>[s(m(n||"—"),1)]),type:t(({rowValue:n})=>[s(m(n||"—"),1)]),status:t(({rowValue:n})=>[n?(a(),l(le,{key:0,status:n},null,8,["status"])):(a(),A(M,{key:1},[s(`
                    —
                  `)],64))]),warnings:t(({rowValue:n})=>[n?(a(),l(e(Y),{key:0,label:e(o)("zone-cps.list.version_mismatch")},{default:t(()=>[i(e(E),{class:"mr-1",icon:"warning",color:"var(--black-500)","secondary-color":"var(--yellow-300)",size:"20","hide-title":""})]),_:1},8,["label"])):(a(),A(M,{key:1},[s(`
                     
                  `)],64))]),actions:t(({row:n})=>[i(e(j),{class:"actions-dropdown","data-testid":"actions-dropdown","kpop-attributes":{placement:"bottomEnd",popoverClasses:"mt-5 more-actions-popover"},width:"150"},{default:t(()=>[i(e(G),{class:"non-visual-button",appearance:"secondary",size:"small"},{icon:t(()=>[i(e(E),{color:"var(--black-400)",icon:"more",size:"16"})]),_:1})]),items:t(()=>[i(e(Z),{item:{to:n.detailViewRoute,label:e(o)("common.collection.actions.view")}},null,8,["item"]),s(),e(r)("KUMA_ZONE_CREATION_FLOW")==="enabled"?(a(),l(e(Z),{key:0,"has-divider":"","is-dangerous":"","data-testid":"dropdown-delete-item",onClick:g=>B(n.name)},{default:t(()=>[s(m(e(o)("common.collection.actions.delete")),1)]),_:2},1032,["onClick"])):N("",!0)]),_:2},1024)]),_:2},1032,["page-number","page-size","total","items","error","onChange"])]),_:2},1024),s(),d.value?(a(),l(re,{key:0,"confirmation-text":f.value,"delete-function":q,"is-visible":d.value,"modal-id":"delete-zone-modal","action-button-text":e(o)("zones.delete.confirmModal.proceedText"),title:e(o)("zones.delete.confirmModal.title"),onCancel:C,onDelete:()=>{C(),y()}},{"body-content":t(()=>[h("p",null,m(e(o)("zones.delete.confirmModal.text1",{zoneName:f.value})),1),s(),h("p",null,m(e(o)("zones.delete.confirmModal.text2")),1)]),error:t(()=>[s(m(e(o)("zones.delete.confirmModal.errorText")),1)]),_:2},1032,["confirmation-text","is-visible","action-button-text","title","onDelete"])):N("",!0)]),_:2},1032,["src"]))]),_:2},1032,["breadcrumbs"])]),_:1})}}});const be=ae(ce,[["__scopeId","data-v-41536af3"]]);export{be as default};
