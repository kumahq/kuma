import{d as Y,p as f,o as m,w as e,b as t,e as o,r as l,c as _,L as y,N as h,O as V,t as c,R as v,m as k,F as E,l as H,M as q,Y as L,H as S}from"./index-e9EOlcJX.js";const J=Y({__name:"MeshDetailView",props:{mesh:{}},setup(A){const d=A;return(D,s)=>{const N=l("RouteTitle"),X=l("XI18n"),b=l("XNotification"),R=l("XAction"),B=l("XBadge"),x=l("XAboutCard"),C=l("DataSource"),g=l("XLayout"),M=l("XCard"),P=l("XSelect"),T=l("XCodeBlock"),j=l("DataLoader"),z=l("AppView"),F=l("RouteView");return m(),f(F,{name:"mesh-detail-view",params:{mesh:"",environment:String}},{default:e(({route:u,t:r,uri:w})=>[t(N,{title:r("meshes.routes.overview.title"),render:!1},null,8,["title"]),s[11]||(s[11]=o()),t(C,{src:w(k(S),"/mesh-insights/:name",{name:u.params.mesh})},{default:e(({data:a})=>[t(z,{docs:r("meshes.href.docs"),notifications:!0},{default:e(()=>[t(b,{notify:!d.mesh.mtlsBackend,uri:`meshes.notifications.mtls-warning:${d.mesh.id}`},{default:e(()=>[t(X,{path:"meshes.notifications.mtls-warning"})]),_:1},8,["notify","uri"]),s[9]||(s[9]=o()),t(b,{notify:D.mesh.meshServices.mode==="Disabled",uri:`meshes.notifications.mesh-service-activation:${u.params.mesh}`,variant:"info"},{default:e(()=>[t(X,{path:"meshes.notifications.mesh-service-activation"})]),_:2},1032,["notify","uri"]),s[10]||(s[10]=o()),t(g,{type:"stack"},{default:e(()=>[t(x,{title:r("meshes.routes.item.about.title"),created:d.mesh.creationTime,modified:d.mesh.modificationTime},{default:e(()=>[(m(),_(h,null,y(["MeshTrafficPermission","MeshMetric","MeshAccessLog","MeshTrace"],i=>{var n;return m(),_(h,{key:i},[(m(!0),_(h,null,y([((n=a==null?void 0:a.policies)==null?void 0:n[i])??{total:0}],p=>(m(),_(h,{key:typeof p},[t(b,{notify:i==="MeshTrafficPermission"&&d.mesh.mtlsBackend&&p.total===0,uri:`meshes.notifications.mtp-warning:${d.mesh.id}`},{default:e(()=>[t(X,{path:"meshes.notifications.mtp-warning"})]),_:2},1032,["notify","uri"]),s[1]||(s[1]=o()),t(V,{layout:"horizontal"},{title:e(()=>[t(R,{to:{name:"policy-list-view",params:{mesh:u.params.mesh,policyPath:`${i.toLowerCase()}s`}}},{default:e(()=>[o(c(i),1)]),_:2},1032,["to"])]),body:e(()=>[t(B,{appearance:p.total>0?"success":"neutral"},{default:e(()=>[o(c(p.total>0?r("meshes.detail.enabled"):r("meshes.detail.disabled")),1)]),_:2},1032,["appearance"])]),_:2,__:[0]},1024)],64))),128))],64)}),64)),s[3]||(s[3]=o()),t(V,{layout:"horizontal"},{title:e(()=>[o(c(r("http.api.property.mtls")),1)]),body:e(()=>[d.mesh.mtlsBackend?(m(),f(B,{key:1,appearance:"info"},{default:e(()=>[o(c(d.mesh.mtlsBackend.type)+" / "+c(d.mesh.mtlsBackend.name),1)]),_:1})):(m(),f(B,{key:0,appearance:"neutral"},{default:e(()=>[o(c(r("meshes.detail.disabled")),1)]),_:2},1024))]),_:2,__:[2]},1024)]),_:2,__:[3]},1032,["title","created","modified"]),s[7]||(s[7]=o()),t(M,null,{default:e(()=>[t(g,{type:"columns",class:"columns-with-borders"},{default:e(()=>[t(v,{total:(a==null?void 0:a.services.total)??0,"data-testid":"services-status"},{title:e(()=>[o(c(r("meshes.detail.services")),1)]),_:2},1032,["total"]),s[4]||(s[4]=o()),t(v,{total:(a==null?void 0:a.dataplanesByType.standard.total)??0,online:(a==null?void 0:a.dataplanesByType.standard.online)??0,"data-testid":"data-plane-proxies-status"},{title:e(()=>[o(c(r("meshes.detail.data_plane_proxies")),1)]),_:2},1032,["total","online"]),s[5]||(s[5]=o()),t(C,{src:w(k(E),"/policy-types",{})},{default:e(({data:i})=>[(m(!0),_(h,null,y([i==null?void 0:i.policyTypes.map(n=>n.name)],n=>(m(),f(v,{key:typeof n,total:Object.entries((a==null?void 0:a.resources)||{}).reduce((p,[I,{total:O}])=>(n||[]).includes(I)?p+O:p,0),"data-testid":"policies-status"},{title:e(()=>[o(c(r("meshes.detail.policies")),1)]),_:2},1032,["total"]))),128))]),_:2},1032,["src"])]),_:2,__:[4,5]},1024)]),_:2},1024),s[8]||(s[8]=o()),t(M,null,{default:e(()=>[t(g,null,{default:e(()=>[t(g,{type:"separated",justify:"end"},{default:e(()=>[(m(),_(h,null,y([["universal","k8s"]],i=>H("div",{key:typeof i},[t(P,{label:r("meshes.routes.item.format"),selected:u.params.environment,onChange:n=>{u.update({environment:n})},onVnodeBeforeMount:n=>{var p;return((p=n==null?void 0:n.props)==null?void 0:p.selected)&&i.includes(n.props.selected)&&n.props.selected!==u.params.environment&&u.update({environment:n.props.selected})}},q({_:2},[y(i,n=>({name:`${n}-option`,fn:e(()=>[o(c(r(`meshes.routes.item.formats.${n}`)),1)])}))]),1032,["label","selected","onChange","onVnodeBeforeMount"])])),64))]),_:2},1024),s[6]||(s[6]=o()),u.params.environment==="universal"?(m(),f(T,{key:0,"data-testid":"codeblock-yaml-universal",language:"yaml",code:k(L).stringify(d.mesh.config)},null,8,["code"])):(m(),f(j,{key:1,src:w(k(S),"/meshes/:name/as/kubernetes",{name:u.params.mesh})},{default:e(({data:i})=>[t(T,{"data-testid":"codeblock-yaml-k8s",language:"yaml",code:k(L).stringify(i)},null,8,["code"])]),_:2},1032,["src"]))]),_:2,__:[6]},1024)]),_:2},1024)]),_:2,__:[7,8]},1024)]),_:2,__:[9,10]},1032,["docs"])]),_:2},1032,["src"])]),_:1,__:[11]})}}});export{J as default};
