import{d as S,j as p,k as R,A as j,o as z,e as w,q as t,h as l,w as r,a as E,b as e,v as q,g as n,z as I,E as H,u as U,c as C,t as o,p as G,m as J,D as A,_ as Q,a0 as W,B as X,f as D,x as B,F as Y,a1 as L,a2 as F}from"./index-5bb07d52.js";import{_ as k}from"./CodeBlock.vue_vue_type_style_index_0_lang-e3901ea1.js";import{s as ee,g as N,e as K,f as T,m as ne,A as te,E as oe,_ as se}from"./RouteView.vue_vue_type_script_setup_true_lang-8fc3121b.js";import{_ as ae}from"./RouteTitle.vue_vue_type_script_setup_true_lang-bfd57a26.js";import{g as re}from"./dataplane-30467516.js";const le={class:"scanner"},ie={class:"scanner-content"},ue={class:"mb-2"},ce=S({__name:"EntityScanner",props:{interval:{type:Number,required:!1,default:1e3},retries:{type:Number,required:!1,default:3600},hasError:{type:Boolean,default:!1},loaderFunction:{type:Function,required:!0},canComplete:{type:Boolean,default:!1}},emits:["hide-siblings"],setup(v,{emit:a}){const i=v,s=p(0),m=p(!1),h=p(!1),d=p(null);R(function(){g()}),j(function(){f()});function g(){m.value=!0,h.value=!1,f(),d.value=window.setInterval(async()=>{s.value++,await i.loaderFunction(),(s.value===i.retries||i.canComplete===!0)&&(f(),m.value=!1,h.value=!0,a("hide-siblings",!0))},i.interval)}function f(){d.value!==null&&window.clearInterval(d.value)}return(u,y)=>(z(),w("div",le,[t("div",ie,[l(e(H),{"cta-is-hidden":""},{title:r(()=>[t("div",ue,[m.value?(z(),E(e(q),{key:0,icon:"spinner",color:"var(--grey-300)",size:"42"})):v.hasError?(z(),E(e(q),{key:1,icon:"errorFilled",color:"var(--red-500)",size:"42"})):(z(),E(e(q),{key:2,icon:"circleCheck",color:"var(--green-500)",size:"42"}))]),n(),m.value?I(u.$slots,"loading-title",{key:0}):v.hasError?I(u.$slots,"error-title",{key:1}):I(u.$slots,"complete-title",{key:2})]),message:r(()=>[m.value?I(u.$slots,"loading-content",{key:0}):v.hasError?I(u.$slots,"error-content",{key:1}):I(u.$slots,"complete-content",{key:2})]),_:3})])]))}}),de=v=>(G("data-v-293c555d"),v=v(),J(),v),me={href:"https://helm.sh/docs/intro/install/"},pe=de(()=>t("p",null,"On your local machine, create a namespace in your Kubernetes cluster and pull down the kong Helm repo.",-1)),ve={class:"k-input-label mt-4"},fe={class:"mt-4"},be=S({__name:"ZoneCreateKubernetesInstructions",props:{zoneName:{type:String,required:!0},zoneIngressEnabled:{type:Boolean,required:!0},zoneEgressEnabled:{type:Boolean,required:!0},token:{type:String,required:!0},base64EncodedToken:{type:String,required:!0}},setup(v){const a=v,i=ee(),s=N(),m=U(),h=K(),d=C(()=>s.t("zones.form.kubernetes.secret.createSecretCommand",{token:a.base64EncodedToken}).trim()),g=C(()=>{const f={zoneName:a.zoneName,globalKdsAddress:h.state.globalKdsAddress,zoneIngressEnabled:String(a.zoneIngressEnabled),zoneEgressEnabled:String(a.zoneEgressEnabled)};return typeof m.params.virtualControlPlaneId=="string"&&(f.controlPlaneId=m.params.virtualControlPlaneId),s.t("zones.form.kubernetes.connectZone.config",f).trim()});return(f,u)=>(z(),w("div",null,[t("h3",null,"1. "+o(e(s).t("zones.form.kubernetes.prerequisites.title")),1),n(),t("ul",null,[t("li",null,[t("b",null,o(e(s).t("zones.form.kubernetes.prerequisites.step1Label"))+o(a.zoneIngressEnabled?" "+e(s).t("zones.form.kubernetes.prerequisites.step1LabelAddendum"):""),1),n(`:
        `+o(e(s).t("zones.form.kubernetes.prerequisites.step1Description",{productName:e(i)("KUMA_PRODUCT_NAME")})),1)]),n(),t("li",null,[t("b",null,o(e(s).t("zones.form.kubernetes.prerequisites.step2Label")),1),n(`:
        `+o(e(s).t("zones.form.kubernetes.prerequisites.step2Description")),1)]),n(),t("li",null,[t("a",me,o(e(s).t("zones.form.kubernetes.prerequisites.step3LinkTitle")),1),n(" "+o(e(s).t("zones.form.kubernetes.prerequisites.step3Tail")),1)])]),n(),t("h3",null,"2. "+o(e(s).t("zones.form.kubernetes.helm.title")),1),n(),pe,n(),t("ol",null,[t("li",null,[n(o(e(s).t("zones.form.kubernetes.helm.step1Description"))+" ",1),l(k,{id:"zone-kubernetes-create-namespace",class:"mt-4",code:e(s).t("zones.form.kubernetes.helm.step1Command"),language:"bash"},null,8,["code"])]),n(),t("li",null,[n(o(e(s).t("zones.form.kubernetes.helm.step2Description"))+" ",1),l(k,{id:"zone-kubernetes-add-charts-repo",class:"mt-4",code:e(s).t("zones.form.kubernetes.helm.step2Command"),language:"bash"},null,8,["code"])]),n(),t("li",null,[n(o(e(s).t("zones.form.kubernetes.helm.step3Description"))+" ",1),l(k,{id:"zone-kubernetes-repo-update",class:"mt-4",code:e(s).t("zones.form.kubernetes.helm.step3Command"),language:"bash"},null,8,["code"])])]),n(),t("h3",null,"3. "+o(e(s).t("zones.form.kubernetes.secret.title")),1),n(),t("p",null,o(e(s).t("zones.form.kubernetes.secret.createSecretDescription")),1),n(),l(k,{id:"zone-kubernetes-create-secret",class:"mt-4",code:d.value,language:"bash"},null,8,["code"]),n(),t("h3",null,"4. "+o(e(s).t("zones.form.kubernetes.connectZone.title")),1),n(),t("p",null,o(e(s).t("zones.form.kubernetes.connectZone.configDescription")),1),n(),t("span",ve,o(e(s).t("zones.form.kubernetes.connectZone.configFileName")),1),n(),l(k,{id:"zone-kubernetes-config-code-block",code:g.value,language:"yaml"},null,8,["code"]),n(),t("p",fe,o(e(s).t("zones.form.kubernetes.connectZone.connectDescription")),1),n(),l(k,{id:"zone-kubernetes-command-code-block",class:"mt-4",code:e(s).t("zones.form.kubernetes.connectZone.connectCommand").trim(),language:"bash"},null,8,["code"])]))}});const ze=T(be,[["__scopeId","data-v-293c555d"]]),ge={class:"k-input-label mt-4"},_e={class:"mt-4"},ke=S({__name:"ZoneCreateUniversalInstructions",props:{zoneName:{type:String,required:!0},token:{type:String,required:!0}},setup(v){const a=v,i=N(),s=U(),m=K(),h=C(()=>i.t("zones.form.universal.saveToken.saveTokenCommand",{token:a.token}).trim()),d=C(()=>{const g={zoneName:a.zoneName,globalKdsAddress:m.state.globalKdsAddress};return typeof s.params.virtualControlPlaneId=="string"&&(g.controlPlaneId=s.params.virtualControlPlaneId),i.t("zones.form.universal.connectZone.config",g).trim()});return(g,f)=>(z(),w("div",null,[t("h3",null,"1. "+o(e(i).t("zones.form.universal.saveToken.title")),1),n(),t("p",null,o(e(i).t("zones.form.universal.saveToken.saveTokenDescription")),1),n(),l(k,{id:"zone-kubernetes-token",class:"mt-4",code:h.value,language:"bash"},null,8,["code"]),n(),t("h3",null,"2. "+o(e(i).t("zones.form.universal.connectZone.title")),1),n(),t("p",null,o(e(i).t("zones.form.universal.connectZone.configDescription")),1),n(),t("span",ge,o(e(i).t("zones.form.universal.connectZone.configFileName")),1),n(),l(k,{id:"zone-universal-config-code-block",class:"mt-4",code:d.value,language:"yaml"},null,8,["code"]),n(),t("p",_e,o(e(i).t("zones.form.universal.connectZone.connectDescription")),1),n(),l(k,{id:"zone-universal-connect-command-code-block",class:"mt-4",code:e(i).t("zones.form.universal.connectZone.connectCommand").trim(),language:"bash"},null,8,["code"])]))}});const he=T(ke,[["__scopeId","data-v-ea760a7e"]]),ye={class:"form-content"},Ee={class:"form-wrapper mt-4"},Ce={key:1,class:"form-wrapper mt-4","data-testid":"connect-zone-instructions"},Ie={class:"k-input-label"},we={class:"radio-button-group"},Ze={class:"k-input-label"},Se={class:"radio-button-group"},Ve={class:"k-input-label"},$e={class:"radio-button-group"},qe={class:"mt-6"},Ae={class:"mt-2"},De=S({__name:"ZoneCreateView",setup(v){const{t:a}=N(),i=ne(),s=p(null),m=p(!1),h=p(null),d=p({error:null,title:null,icon:"warning",badgeAppearance:"warning"}),g=p(!1),f=p(null),u=p(""),y=p("kubernetes"),V=p(!0),$=p(!0),Z=C(()=>s.value!==null&&s.value.token?s.value.token:""),x=C(()=>Z.value!==""?window.btoa(Z.value):""),P=C(()=>u.value===""||m.value||s.value!==null);async function O(){m.value=!0,h.value=null;try{s.value=await i.createZone({name:u.value})}catch(c){c instanceof F&&[409,500].includes(c.status)?d.value={error:c,title:a(`zones.create.statusError.${c.status}.title`,{zoneName:u.value}),description:a(`zones.create.statusError.${c.status}.description`).trim(),icon:c.status===500?"warning":"errorFilled",badgeAppearance:c.status===500?"warning":"danger"}:c instanceof Error?d.value={error:c,title:c instanceof F?c.title:a("zones.create.generalError.title"),icon:"errorFilled",badgeAppearance:"danger"}:console.error(c)}finally{m.value=!1}}async function M(){g.value=!1,f.value=null;try{const c=await i.getZoneOverview({name:u.value}),b=re(c.zoneInsight);g.value=b==="online"}catch(c){c instanceof Error?f.value=c:console.error(c)}}return(c,b)=>(z(),E(se,{attrs:{class:"is-fullscreen"}},{default:r(()=>[l(te,{fullscreen:!0,breadcrumbs:[]},{title:r(()=>[t("h1",null,[l(ae,{title:e(a)("zones.routes.create.title"),render:!0},null,8,["title"])])]),actions:r(()=>[l(e(A),{appearance:"outline",to:{name:"zone-cp-list-view"}},{default:r(()=>[n(o(e(a)("zones.form.exit")),1)]),_:1})]),default:r(()=>[n(),n(),t("div",ye,[t("h1",null,o(e(a)("zones.routes.create.title")),1),n(),t("div",Ee,[t("div",null,[l(e(Q),{for:"zone-name",required:"","tooltip-attributes":{placement:"right"}},{tooltip:r(()=>[n(o(e(a)("zones.form.name_tooltip")),1)]),default:r(()=>[n(o(e(a)("zones.form.nameLabel"))+" ",1)]),_:1}),n(),l(e(W),{id:"zone-name",modelValue:u.value,"onUpdate:modelValue":b[0]||(b[0]=_=>u.value=_),type:"text",name:"zone-name","data-testid":"name-input",disabled:s.value!==null},null,8,["modelValue","disabled"])]),n(),l(e(A),{appearance:"creation",icon:m.value?"spinner":"plus",disabled:P.value,"data-testid":"create-zone-button",onClick:O},{default:r(()=>[n(o(e(a)("zones.form.createZoneButtonLabel")),1)]),_:1},8,["icon","disabled"])]),n(),d.value.error!==null?(z(),E(oe,{key:0,class:"mt-4",error:d.value.error,"badge-appearance":d.value.badgeAppearance,icon:d.value.icon,"data-testid":"create-zone-error"},X({default:r(()=>[t("p",null,o(d.value.title),1),n()]),_:2},[d.value.description?{name:"message",fn:r(()=>[t("p",null,o(d.value.description),1)]),key:"0"}:void 0]),1032,["error","badge-appearance","icon"])):D("",!0),n(),s.value!==null?(z(),w("div",Ce,[t("div",null,[t("span",Ie,o(e(a)("zones.form.environmentLabel"))+` *
            `,1),n(),t("div",we,[l(e(B),{id:"zone-environment-universal",modelValue:y.value,"onUpdate:modelValue":b[1]||(b[1]=_=>y.value=_),"selected-value":"universal",name:"zone-environment","data-testid":"environment-universal-radio-button"},{default:r(()=>[n(o(e(a)("zones.form.universalLabel")),1)]),_:1},8,["modelValue"]),n(),l(e(B),{id:"zone-environment-kubernetes",modelValue:y.value,"onUpdate:modelValue":b[2]||(b[2]=_=>y.value=_),"selected-value":"kubernetes",name:"zone-environment","data-testid":"environment-kubernetes-radio-button"},{default:r(()=>[n(o(e(a)("zones.form.kubernetesLabel")),1)]),_:1},8,["modelValue"])])]),n(),y.value==="kubernetes"?(z(),w(Y,{key:0},[t("div",null,[t("span",Ze,o(e(a)("zones.form.zoneIngressLabel"))+` *
              `,1),n(),t("div",Se,[l(e(L),{id:"zone-ingress-enabled",modelValue:V.value,"onUpdate:modelValue":b[3]||(b[3]=_=>V.value=_),"data-testid":"ingress-input-switch"},{label:r(()=>[n(o(e(a)("zones.form.zoneIngressEnabledLabel")),1)]),_:1},8,["modelValue"])])]),n(),t("div",null,[t("span",Ve,o(e(a)("zones.form.zoneEgressLabel"))+` *
              `,1),n(),t("div",$e,[l(e(L),{id:"zone-egress-enabled",modelValue:$.value,"onUpdate:modelValue":b[4]||(b[4]=_=>$.value=_),"data-testid":"egress-input-switch"},{label:r(()=>[n(o(e(a)("zones.form.zoneEgressEnabledLabel")),1)]),_:1},8,["modelValue"])])])],64)):D("",!0),n(),t("h2",qe,o(e(a)("zones.form.connectZone")),1),n(),y.value==="universal"?(z(),E(he,{key:1,"zone-name":u.value,token:Z.value},null,8,["zone-name","token"])):(z(),E(ze,{key:2,"zone-name":u.value,"zone-ingress-enabled":V.value,"zone-egress-enabled":$.value,token:Z.value,"base64-encoded-token":x.value},null,8,["zone-name","zone-ingress-enabled","zone-egress-enabled","token","base64-encoded-token"])),n(),l(ce,{"loader-function":M,"has-error":f.value!==null,"can-complete":g.value,"data-testid":"zone-connected-scanner"},{"loading-title":r(()=>[n(o(e(a)("zones.form.scan.waitTitle")),1)]),"complete-title":r(()=>[n(o(e(a)("zones.form.scan.completeTitle")),1)]),"complete-content":r(()=>[t("p",null,o(e(a)("zones.form.scan.completeDescription",{name:u.value})),1),n(),t("p",Ae,[l(e(A),{appearance:"primary",to:{name:"zone-cp-detail-view",params:{zone:u.value}}},{default:r(()=>[n(o(e(a)("zones.form.scan.completeButtonLabel",{name:u.value})),1)]),_:1},8,["to"])])]),"error-title":r(()=>[t("h3",null,o(e(a)("zones.form.scan.errorTitle")),1)]),"error-content":r(()=>[t("p",null,o(e(a)("zones.form.scan.errorDescription")),1)]),_:1},8,["has-error","can-complete"])])):D("",!0)])]),_:1})]),_:1}))}});const Ue=T(De,[["__scopeId","data-v-03544c6c"]]);export{Ue as default};
