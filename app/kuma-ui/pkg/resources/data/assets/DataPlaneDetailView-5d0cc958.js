import{d as O,g as z,f as L,h as v,r as P,o as n,i as y,w as a,j as l,a5 as S,n as t,p as r,k as p,a6 as C,a7 as _,H as s,a8 as H,a9 as K,K as F,m as N,l as u,F as m,I as b,aa as $,t as j}from"./index-6b78898f.js";import{S as U}from"./StatusBadge-40518821.js";import{_ as W}from"./SubscriptionList.vue_vue_type_script_setup_true_lang-47c9f844.js";import{T as R}from"./TagList-2b8c8eac.js";import{a as Z,d as x,b as G,c as X,C as q,I as J}from"./dataplane-0a086c06.js";import"./AccordionList-bd6ce1d9.js";const Q=["data-testid","innerHTML"],Y={class:"stack","data-testid":"detail-view-details"},tt={class:"columns"},at={class:"status-with-reason"},et={class:"columns"},st=["innerHTML"],nt={key:0},it=O({__name:"DataPlaneDetailView",props:{data:{}},setup(B){const{formatIsoDate:w}=z(),M=L(),o=B,D=v(()=>Z(o.data.dataplane,o.data.dataplaneInsight)),T=v(()=>x(o.data.dataplane)),V=v(()=>G(o.data.dataplaneInsight)),E=v(()=>{var d,k;const h=((d=o.data.dataplaneInsight)==null?void 0:d.subscriptions)??[];if(h.length===0)return[];const f=h[h.length-1];if(!("version"in f)||!f.version)return[];const c=f.version,g=[];if(c.kumaDp&&c.envoy){const i=X(c);i.kind!==q&&i.kind!==J&&g.push(i)}const e=(k=o.data.dataplaneInsight)==null?void 0:k.mTLS;return e&&Date.now()>new Date(e==null?void 0:e.certificateExpirationTime).getTime()&&g.push({kind:"CERT_EXPIRED",payload:{}}),M("use zones")&&x(o.data.dataplane).find(A=>A.label==="kuma.io/zone")&&typeof c.kumaDp.kumaCpCompatible=="boolean"&&!c.kumaDp.kumaCpCompatible&&g.push({kind:"INCOMPATIBLE_ZONE_CP_AND_KUMA_DP_VERSIONS",payload:{kumaDp:c.kumaDp.version}}),g});return(h,f)=>{const c=P("AppView"),g=P("RouteView");return n(),y(g,{name:"data-plane-detail-view"},{default:a(({t:e})=>[l(c,null,S({default:a(()=>{var d,k;return[t(),r("div",Y,[l(p(C),null,{body:a(()=>[r("div",tt,[l(_,null,{title:a(()=>[t(s(e("http.api.property.status")),1)]),body:a(()=>[r("div",at,[l(U,{status:D.value.status},null,8,["status"]),t(),D.value.reason.length>0?(n(),y(p(H),{key:0,label:D.value.reason.join(", "),class:"reason-tooltip"},{default:a(()=>[l(p(K),{size:p(F),"hide-title":""},null,8,["size"])]),_:1},8,["label"])):N("",!0)])]),_:2},1024),t(),l(_,null,{title:a(()=>[t(s(e("http.api.property.tags")),1)]),body:a(()=>[T.value.length>0?(n(),y(R,{key:0,tags:T.value},null,8,["tags"])):(n(),u(m,{key:1},[t(s(e("common.detail.none")),1)],64))]),_:2},1024),t(),l(_,null,{title:a(()=>[t(s(e("http.api.property.dependencies")),1)]),body:a(()=>[V.value!==null?(n(),y(R,{key:0,tags:V.value},null,8,["tags"])):(n(),u(m,{key:1},[t(s(e("common.detail.none")),1)],64))]),_:2},1024)])]),_:2},1024),t(),r("div",null,[r("h2",null,s(e("data-planes.routes.item.mtls.title")),1),t(),(d=o.data.dataplaneInsight)!=null&&d.mTLS?(n(!0),u(m,{key:0},b([o.data.dataplaneInsight.mTLS],i=>(n(),y(p(C),{key:i,class:"mt-4"},{body:a(()=>[r("div",et,[l(_,null,{title:a(()=>[t(s(e("data-planes.routes.item.mtls.expiration_time.title")),1)]),body:a(()=>[t(s(p(w)(i.certificateExpirationTime)),1)]),_:2},1024),t(),l(_,null,{title:a(()=>[t(s(e("data-planes.routes.item.mtls.generation_time.title")),1)]),body:a(()=>[t(s(p(w)(i.lastCertificateRegeneration)),1)]),_:2},1024),t(),l(_,null,{title:a(()=>[t(s(e("data-planes.routes.item.mtls.regenerations.title")),1)]),body:a(()=>[t(s(e("common.formats.integer",{value:i.certificateRegenerations})),1)]),_:2},1024),t(),l(_,null,{title:a(()=>[t(s(e("data-planes.routes.item.mtls.issued_backend.title")),1)]),body:a(()=>[t(s(i.issuedBackend),1)]),_:2},1024),t(),l(_,null,{title:a(()=>[t(s(e("data-planes.routes.item.mtls.supported_backends.title")),1)]),body:a(()=>[r("ul",null,[(n(!0),u(m,null,b(i.supportedBackends,I=>(n(),u("li",{key:I},s(I),1))),128))])]),_:2},1024)])]),_:2},1024))),128)):(n(),y(p($),{key:1,class:"mt-4",appearance:"warning"},{alertMessage:a(()=>[r("div",{innerHTML:e("data-planes.routes.item.mtls.disabled")},null,8,st)]),_:2},1024))]),t(),(n(!0),u(m,null,b([((k=o.data.dataplaneInsight)==null?void 0:k.subscriptions)??[]],i=>(n(),u(m,{key:i},[i.length>0?(n(),u("div",nt,[r("h2",null,s(e("data-planes.routes.item.subscriptions.title")),1),t(),l(p(C),{class:"mt-4"},{body:a(()=>[l(W,{subscriptions:i},null,8,["subscriptions"])]),_:2},1024)])):N("",!0)],64))),128))])]}),_:2},[E.value.length>0?{name:"notifications",fn:a(()=>[r("ul",null,[(n(!0),u(m,null,b(E.value,d=>(n(),u("li",{key:d.kind,"data-testid":`warning-${d.kind}`,innerHTML:e(`common.warnings.${d.kind}`,d.payload)},null,8,Q))),128)),t()])]),key:"0"}:void 0]),1024)]),_:1})}}});const ct=j(it,[["__scopeId","data-v-79d4a52d"]]);export{ct as default};
