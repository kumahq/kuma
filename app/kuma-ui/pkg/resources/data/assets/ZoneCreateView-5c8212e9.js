import{l as W,S as D,c as H,u as R,a as N,s as L}from"./kongponents.es-a99534bb.js";import{d as S,u as U,c as h,o as f,e as C,k as t,t as o,b as n,g as e,h as r,p as j,m as G,n as B,q as v,M as x,a as w,w as l,l as J,f as q,F as Q}from"./index-0b8ed13f.js";import{_ as z}from"./CodeBlock.vue_vue_type_style_index_0_lang-e187911d.js";import{l as X,k as A,f as K,h as V,j as Y,g as ee,_ as ne,E as te}from"./RouteView.vue_vue_type_script_setup_true_lang-4999f19d.js";import{_ as oe}from"./RouteTitle.vue_vue_type_script_setup_true_lang-65d5caa7.js";import{E as se}from"./ErrorBlock-ddeaa4b4.js";import{_ as ae}from"./EntityScanner.vue_vue_type_script_setup_true_lang-8f261140.js";const re=_=>(j("data-v-293c555d"),_=_(),G(),_),le={href:"https://helm.sh/docs/intro/install/"},ie=re(()=>t("p",null,"On your local machine, create a namespace in your Kubernetes cluster and pull down the kong Helm repo.",-1)),ue={class:"k-input-label mt-4"},ce={class:"mt-4"},de=S({__name:"ZoneCreateKubernetesInstructions",props:{zoneName:{type:String,required:!0},zoneIngressEnabled:{type:Boolean,required:!0},zoneEgressEnabled:{type:Boolean,required:!0},token:{type:String,required:!0},base64EncodedToken:{type:String,required:!0}},setup(_){const s=_,c=X(),a=A(),d=U(),g=K(),y=h(()=>a.t("zones.form.kubernetes.secret.createSecretCommand",{token:s.base64EncodedToken}).trim()),i=h(()=>{const k={zoneName:s.zoneName,globalKdsAddress:g.state.globalKdsAddress,zoneIngressEnabled:String(s.zoneIngressEnabled),zoneEgressEnabled:String(s.zoneEgressEnabled)};return typeof d.params.virtualControlPlaneId=="string"&&(k.controlPlaneId=d.params.virtualControlPlaneId),a.t("zones.form.kubernetes.connectZone.config",k).trim()});return(k,I)=>(f(),C("div",null,[t("h3",null,"1. "+o(n(a).t("zones.form.kubernetes.prerequisites.title")),1),e(),t("ul",null,[t("li",null,[t("b",null,o(n(a).t("zones.form.kubernetes.prerequisites.step1Label"))+o(s.zoneIngressEnabled?" "+n(a).t("zones.form.kubernetes.prerequisites.step1LabelAddendum"):""),1),e(`:
        `+o(n(a).t("zones.form.kubernetes.prerequisites.step1Description",{productName:n(c)("KUMA_PRODUCT_NAME")})),1)]),e(),t("li",null,[t("b",null,o(n(a).t("zones.form.kubernetes.prerequisites.step2Label")),1),e(`:
        `+o(n(a).t("zones.form.kubernetes.prerequisites.step2Description")),1)]),e(),t("li",null,[t("a",le,o(n(a).t("zones.form.kubernetes.prerequisites.step3LinkTitle")),1),e(" "+o(n(a).t("zones.form.kubernetes.prerequisites.step3Tail")),1)])]),e(),t("h3",null,"2. "+o(n(a).t("zones.form.kubernetes.helm.title")),1),e(),ie,e(),t("ol",null,[t("li",null,[e(o(n(a).t("zones.form.kubernetes.helm.step1Description"))+" ",1),r(z,{id:"zone-kubernetes-create-namespace",class:"mt-4",code:n(a).t("zones.form.kubernetes.helm.step1Command"),language:"bash"},null,8,["code"])]),e(),t("li",null,[e(o(n(a).t("zones.form.kubernetes.helm.step2Description"))+" ",1),r(z,{id:"zone-kubernetes-add-charts-repo",class:"mt-4",code:n(a).t("zones.form.kubernetes.helm.step2Command"),language:"bash"},null,8,["code"])]),e(),t("li",null,[e(o(n(a).t("zones.form.kubernetes.helm.step3Description"))+" ",1),r(z,{id:"zone-kubernetes-repo-update",class:"mt-4",code:n(a).t("zones.form.kubernetes.helm.step3Command"),language:"bash"},null,8,["code"])])]),e(),t("h3",null,"3. "+o(n(a).t("zones.form.kubernetes.secret.title")),1),e(),t("p",null,o(n(a).t("zones.form.kubernetes.secret.createSecretDescription")),1),e(),r(z,{id:"zone-kubernetes-create-secret",class:"mt-4",code:y.value,language:"bash"},null,8,["code"]),e(),t("h3",null,"4. "+o(n(a).t("zones.form.kubernetes.connectZone.title")),1),e(),t("p",null,o(n(a).t("zones.form.kubernetes.connectZone.configDescription")),1),e(),t("span",ue,o(n(a).t("zones.form.kubernetes.connectZone.configFileName")),1),e(),r(z,{id:"zone-kubernetes-config-code-block",code:i.value,language:"yaml"},null,8,["code"]),e(),t("p",ce,o(n(a).t("zones.form.kubernetes.connectZone.connectDescription")),1),e(),r(z,{id:"zone-kubernetes-command-code-block",class:"mt-4",code:n(a).t("zones.form.kubernetes.connectZone.connectCommand").trim(),language:"bash"},null,8,["code"])]))}});const me=V(de,[["__scopeId","data-v-293c555d"]]),pe={class:"k-input-label mt-4"},ve={class:"mt-4"},_e=S({__name:"ZoneCreateUniversalInstructions",props:{zoneName:{type:String,required:!0},token:{type:String,required:!0}},setup(_){const s=_,c=A(),a=U(),d=K(),g=h(()=>c.t("zones.form.universal.saveToken.saveTokenCommand",{token:s.token}).trim()),y=h(()=>{const i={zoneName:s.zoneName,globalKdsAddress:d.state.globalKdsAddress};return typeof a.params.virtualControlPlaneId=="string"&&(i.controlPlaneId=a.params.virtualControlPlaneId),c.t("zones.form.universal.connectZone.config",i).trim()});return(i,k)=>(f(),C("div",null,[t("h3",null,"1. "+o(n(c).t("zones.form.universal.saveToken.title")),1),e(),t("p",null,o(n(c).t("zones.form.universal.saveToken.saveTokenDescription")),1),e(),r(z,{id:"zone-kubernetes-token",class:"mt-4",code:g.value,language:"bash"},null,8,["code"]),e(),t("h3",null,"2. "+o(n(c).t("zones.form.universal.connectZone.title")),1),e(),t("p",null,o(n(c).t("zones.form.universal.connectZone.configDescription")),1),e(),t("span",pe,o(n(c).t("zones.form.universal.connectZone.configFileName")),1),e(),r(z,{id:"zone-universal-config-code-block",class:"mt-4",code:y.value,language:"yaml"},null,8,["code"]),e(),t("p",ve,o(n(c).t("zones.form.universal.connectZone.connectDescription")),1),e(),r(z,{id:"zone-universal-connect-command-code-block",class:"mt-4",code:n(c).t("zones.form.universal.connectZone.connectCommand").trim(),language:"bash"},null,8,["code"])]))}});const be=V(_e,[["__scopeId","data-v-ea760a7e"]]),fe={class:"app-title-bar"},ze={class:"title-wrapper"},ge={class:"title"},ke={class:"action-list"},he=S({__name:"WizardTitleBar",setup(_){return(s,c)=>(f(),C("div",fe,[t("div",ze,[r(n(W),{icon:"kong"}),e(),t("span",ge,[B(s.$slots,"title",{},void 0,!0)])]),e(),t("div",ke,[B(s.$slots,"actions",{},void 0,!0)])]))}});const Ee=V(he,[["__scopeId","data-v-f0a75c34"]]),ye={class:"form-content"},Ce={class:"form-wrapper mt-4"},Ie={key:1,class:"form-wrapper mt-4","data-testid":"connect-zone-instructions"},Ze={class:"k-input-label"},we={class:"radio-button-group"},Se={class:"k-input-label"},Ve={class:"radio-button-group"},$e={class:"k-input-label"},Te={class:"radio-button-group"},De={class:"mt-6"},qe={class:"mt-2"},Ae=S({__name:"ZoneCreateView",setup(_){const{t:s}=A(),c=Y(),a=[400,409,500],d=v(null),g=v(!1),y=v(null),i=v({error:null,title:null,icon:"warning",badgeAppearance:"warning"}),k=v(!1),I=v(null),p=v(""),E=v("kubernetes"),$=v(!0),T=v(!0),Z=h(()=>d.value!==null&&d.value.token?d.value.token:""),P=h(()=>Z.value!==""?window.btoa(Z.value):""),F=h(()=>p.value===""||g.value||d.value!==null||i.value.error instanceof x&&i.value.error.status===409);async function O(){g.value=!0,y.value=null;try{d.value=await c.createZone({name:p.value})}catch(u){u instanceof x&&a.includes(u.status)?i.value={error:u,title:s(`zones.create.statusError.${u.status}.title`,{zoneName:p.value}),description:s(`zones.create.statusError.${u.status}.description`).trim(),icon:u.status===500?"warning":"errorFilled",badgeAppearance:u.status===500?"warning":"danger"}:u instanceof Error?i.value={error:u,title:s("zones.create.generalError.title"),icon:"warning",badgeAppearance:"danger"}:console.error(u)}finally{g.value=!1}}async function M(){k.value=!1,I.value=null;try{const u=await c.getZoneOverview({name:p.value}),m=te(u.zoneInsight);k.value=m==="online"}catch(u){u instanceof Error?I.value=u:console.error(u)}}return(u,m)=>(f(),w(ne,{attrs:{class:"is-fullscreen"}},{default:l(()=>[r(oe,{title:n(s)("zones.routes.create.title")},null,8,["title"]),e(),r(ee,{breadcrumbs:[]},{default:l(()=>[r(Ee,{class:"mb-6"},{title:l(()=>[e(o(n(s)("zones.routes.create.title")),1)]),actions:l(()=>[r(n(D),{appearance:"outline",to:{name:"zone-cp-list-view"}},{default:l(()=>[e(o(n(s)("zones.form.exit")),1)]),_:1})]),_:1}),e(),t("div",ye,[t("h1",null,o(n(s)("zones.routes.create.title")),1),e(),t("div",Ce,[t("div",null,[r(n(H),{for:"zone-name"},{default:l(()=>[e(o(n(s)("zones.form.nameLabel"))+` *
            `,1)]),_:1}),e(),r(n(R),{id:"zone-name",modelValue:p.value,"onUpdate:modelValue":m[0]||(m[0]=b=>p.value=b),type:"text",name:"zone-name","data-testid":"name-input",disabled:d.value!==null},null,8,["modelValue","disabled"])]),e(),r(n(D),{appearance:"creation",icon:g.value?"spinner":"plus",disabled:F.value,"data-testid":"create-zone-button",onClick:O},{default:l(()=>[e(o(n(s)("zones.form.createZoneButtonLabel")),1)]),_:1},8,["icon","disabled"])]),e(),i.value.error!==null?(f(),w(se,{key:0,class:"mt-4",error:i.value.error,"badge-appearance":i.value.badgeAppearance,icon:i.value.icon,"data-testid":"create-zone-error"},J({default:l(()=>[t("p",null,o(i.value.title),1),e()]),_:2},[i.value.description?{name:"message",fn:l(()=>[t("p",null,o(i.value.description),1)]),key:"0"}:void 0]),1032,["error","badge-appearance","icon"])):q("",!0),e(),d.value!==null?(f(),C("div",Ie,[t("div",null,[t("span",Ze,o(n(s)("zones.form.environmentLabel"))+` *
            `,1),e(),t("div",we,[r(n(N),{id:"zone-environment-universal",modelValue:E.value,"onUpdate:modelValue":m[1]||(m[1]=b=>E.value=b),"selected-value":"universal",name:"zone-environment","data-testid":"environment-universal-radio-button"},{default:l(()=>[e(o(n(s)("zones.form.universalLabel")),1)]),_:1},8,["modelValue"]),e(),r(n(N),{id:"zone-environment-kubernetes",modelValue:E.value,"onUpdate:modelValue":m[2]||(m[2]=b=>E.value=b),"selected-value":"kubernetes",name:"zone-environment","data-testid":"environment-kubernetes-radio-button"},{default:l(()=>[e(o(n(s)("zones.form.kubernetesLabel")),1)]),_:1},8,["modelValue"])])]),e(),E.value==="kubernetes"?(f(),C(Q,{key:0},[t("div",null,[t("span",Se,o(n(s)("zones.form.zoneIngressLabel"))+` *
              `,1),e(),t("div",Ve,[r(n(L),{id:"zone-ingress-enabled",modelValue:$.value,"onUpdate:modelValue":m[3]||(m[3]=b=>$.value=b),"data-testid":"ingress-input-switch"},{label:l(()=>[e(o(n(s)("zones.form.zoneIngressEnabledLabel")),1)]),_:1},8,["modelValue"])])]),e(),t("div",null,[t("span",$e,o(n(s)("zones.form.zoneEgressLabel"))+` *
              `,1),e(),t("div",Te,[r(n(L),{id:"zone-egress-enabled",modelValue:T.value,"onUpdate:modelValue":m[4]||(m[4]=b=>T.value=b),"data-testid":"egress-input-switch"},{label:l(()=>[e(o(n(s)("zones.form.zoneEgressEnabledLabel")),1)]),_:1},8,["modelValue"])])])],64)):q("",!0),e(),t("h2",De,o(n(s)("zones.form.connectZone")),1),e(),E.value==="universal"?(f(),w(be,{key:1,"zone-name":p.value,token:Z.value},null,8,["zone-name","token"])):(f(),w(me,{key:2,"zone-name":p.value,"zone-ingress-enabled":$.value,"zone-egress-enabled":T.value,token:Z.value,"base64-encoded-token":P.value},null,8,["zone-name","zone-ingress-enabled","zone-egress-enabled","token","base64-encoded-token"])),e(),r(ae,{"loader-function":M,"has-error":I.value!==null,"can-complete":k.value,"data-testid":"zone-connected-scanner"},{"loading-title":l(()=>[e(o(n(s)("zones.form.scan.waitTitle")),1)]),"complete-title":l(()=>[e(o(n(s)("zones.form.scan.completeTitle")),1)]),"complete-content":l(()=>[t("p",null,o(n(s)("zones.form.scan.completeDescription",{name:p.value})),1),e(),t("p",qe,[r(n(D),{appearance:"primary",to:{name:"zone-cp-detail-view",params:{zone:p.value}}},{default:l(()=>[e(o(n(s)("zones.form.scan.completeButtonLabel",{name:p.value})),1)]),_:1},8,["to"])])]),"error-title":l(()=>[t("h3",null,o(n(s)("zones.form.scan.errorTitle")),1)]),"error-content":l(()=>[t("p",null,o(n(s)("zones.form.scan.errorDescription")),1)]),_:1},8,["has-error","can-complete"])])):q("",!0)])]),_:1})]),_:1}))}});const Fe=V(Ae,[["__scopeId","data-v-9b5b46cc"]]);export{Fe as default};
