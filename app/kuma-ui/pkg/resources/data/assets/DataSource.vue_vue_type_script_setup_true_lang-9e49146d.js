import{H as g}from"./RouteView.vue_vue_type_script_setup_true_lang-c12a3166.js";import{d as _,j as l,I as h,A as y,o as S,e as B,z as L,g as b,F as E,q as k}from"./index-4f1a7619.js";const q=k("span",{class:"visually-hidden"},null,-1),A=_({__name:"DataSource",props:{src:{type:String,required:!0}},emits:["change","error"],setup(m,{emit:c}){const u=m,i=g(),o=l(void 0),a=l(!1),s=l(void 0);let r={};const d=Symbol(""),v=async e=>{if(o.value=void 0,r=f(r),r.src=e,e==="")return;a.value=!0,r.controller=new AbortController;const n=i.source(e,d);n.addEventListener("message",t=>{o.value=t.data,s.value=void 0,a.value=!1,c("change",o.value)},{signal:r.controller.signal}),n.addEventListener("error",t=>{s.value=t.error,a.value=!1,c("error",s.value)},{signal:r.controller.signal})},f=e=>(typeof e.controller<"u"&&e.controller.abort(),typeof e.src<"u"&&i.close(e.src,d),{});h(()=>u.src,e=>v(e),{immediate:!0}),y(()=>{r=f(r)});const p=()=>{v(u.src)};return(e,n)=>(S(),B(E,null,[L(e.$slots,"default",{data:o.value,isLoading:a.value,error:s.value,refresh:p}),b(),q],64))}});export{A as _};
