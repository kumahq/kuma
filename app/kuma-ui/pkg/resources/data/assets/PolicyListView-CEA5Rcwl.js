import{d as S,a as r,o as i,b as c,w as e,a2 as $,t as l,f as t,e as m,F as k,q as u,m as d,c as h,V as K,p as v,K as N,D as I,H as A,_ as M}from"./index-291i1Sgi.js";import{D as q,A as E}from"./AppCollection-J3_bPiWW.js";import{P as H}from"./PolicyTypeTag-HzNtrq_o.js";import{S as F}from"./SummaryView-U6wIlsXk.js";const O={class:"stack"},Z={class:"visually-hidden"},G=["innerHTML"],U={key:0},j=S({__name:"PolicyListView",props:{policyTypes:{}},setup(C){const R=C;return(J,Q)=>{const f=r("KBadge"),z=r("KCard"),g=r("RouterLink"),V=r("RouterView"),D=r("DataLoader"),L=r("AppView"),P=r("DataCollection"),w=r("RouteView"),B=r("DataSource");return i(),c(B,{src:"/me"},{default:e(({data:b})=>[b?(i(),c(w,{key:0,name:"policy-list-view",params:{page:1,size:b.pageSize,mesh:"",policyPath:"",policy:""}},{default:e(({route:s,t:o,can:x})=>[m(P,{predicate:y=>typeof y<"u"&&y.path===s.params.policyPath,find:!0,items:R.policyTypes??[void 0]},{empty:e(()=>[m($,null,{message:e(()=>[t(l(o("policies.routes.items.empty")),1)]),_:2},1024)]),default:e(({items:y})=>[(i(!0),h(k,null,A([y[0]],n=>(i(),c(L,{key:n},{default:e(()=>[d("div",O,[m(z,null,{default:e(()=>[d("header",null,[d("div",null,[n.isExperimental?(i(),c(f,{key:0,appearance:"warning"},{default:e(()=>[t(l(o("policies.collection.beta")),1)]),_:2},1024)):u("",!0),t(),n.isInbound?(i(),c(f,{key:1,appearance:"neutral"},{default:e(()=>[t(l(o("policies.collection.inbound")),1)]),_:2},1024)):u("",!0),t(),n.isOutbound?(i(),c(f,{key:2,appearance:"neutral"},{default:e(()=>[t(l(o("policies.collection.outbound")),1)]),_:2},1024)):u("",!0),t(),m(q,{href:o("policies.href.docs",{name:n.name}),"data-testid":"policy-documentation-link"},{default:e(()=>[d("span",Z,l(o("common.documentation")),1)]),_:2},1032,["href"])]),t(),d("h3",null,[m(H,{"policy-type":n.name},{default:e(()=>[t(l(o("policies.collection.title",{name:n.name})),1)]),_:2},1032,["policy-type"])])]),t(),d("div",{innerHTML:o(`policies.type.${n.name}.description`,void 0,{defaultMessage:o("policies.collection.description")})},null,8,G)]),_:2},1024),t(),m(z,null,{default:e(()=>[m(D,{src:`/meshes/${s.params.mesh}/policy-path/${s.params.policyPath}?page=${s.params.page}&size=${s.params.size}`,loader:!1},{default:e(({data:p})=>[m(E,{class:"policy-collection","data-testid":"policy-collection","empty-state-message":o("common.emptyState.message",{type:`${n.name} policies`}),"empty-state-cta-to":o("policies.href.docs",{name:n.name}),"empty-state-cta-text":o("common.documentation"),headers:[{label:"Name",key:"name"},...x("use zones")&&n.isTargetRefBased||n.name==="MeshGateway"?[{label:"Zone",key:"zone"}]:[],...n.isTargetRefBased?[{label:"Target ref",key:"targetRef"}]:[],{label:"Details",key:"details",hideLabel:!0}],"page-number":s.params.page,"page-size":s.params.size,total:p==null?void 0:p.total,items:p==null?void 0:p.items,"is-selected-row":a=>a.name===s.params.policy,onChange:s.update},{name:e(({row:a})=>[m(g,{to:{name:"policy-summary-view",params:{mesh:a.mesh,policyPath:n.path,policy:a.name},query:{page:s.params.page,size:s.params.size}}},{default:e(()=>[t(l(a.name),1)]),_:2},1032,["to"])]),targetRef:e(({row:a})=>{var _;return[n.isTargetRefBased&&typeof((_=a.spec)==null?void 0:_.targetRef)<"u"?(i(),c(f,{key:0,appearance:"neutral"},{default:e(()=>[t(l(a.spec.targetRef.kind),1),a.spec.targetRef.name?(i(),h("span",U,[t(":"),d("b",null,l(a.spec.targetRef.name),1)])):u("",!0)]),_:2},1024)):(i(),h(k,{key:1},[t(l(o("common.detail.none")),1)],64))]}),zone:e(({row:a})=>[a.labels&&a.labels["kuma.io/origin"]==="zone"&&a.labels["kuma.io/zone"]?(i(),c(g,{key:0,to:{name:"zone-cp-detail-view",params:{zone:a.labels["kuma.io/zone"]}}},{default:e(()=>[t(l(a.labels["kuma.io/zone"]),1)]),_:2},1032,["to"])):(i(),h(k,{key:1},[t(l(o("common.detail.none")),1)],64))]),details:e(({row:a})=>[m(g,{class:"details-link","data-testid":"details-link",to:{name:"policy-detail-view",params:{mesh:a.mesh,policyPath:n.path,policy:a.name}}},{default:e(()=>[t(l(o("common.collection.details_link"))+" ",1),m(v(K),{decorative:"",size:v(N)},null,8,["size"])]),_:2},1032,["to"])]),_:2},1032,["empty-state-message","empty-state-cta-to","empty-state-cta-text","headers","page-number","page-size","total","items","is-selected-row","onChange"]),t(),s.params.policy?(i(),c(V,{key:0},{default:e(({Component:a})=>[m(F,{onClose:_=>s.replace({name:"policy-list-view",params:{mesh:s.params.mesh,policyPath:s.params.policyPath},query:{page:s.params.page,size:s.params.size}})},{default:e(()=>[(i(),c(I(a),{policy:p==null?void 0:p.items.find(_=>_.name===s.params.policy),"policy-type":n},null,8,["policy","policy-type"]))]),_:2},1032,["onClose"])]),_:2},1024)):u("",!0)]),_:2},1032,["src"])]),_:2},1024)])]),_:2},1024))),128))]),_:2},1032,["predicate","items"])]),_:2},1032,["params"])):u("",!0)]),_:1})}}}),ee=M(j,[["__scopeId","data-v-b8def6fc"]]);export{ee as default};
