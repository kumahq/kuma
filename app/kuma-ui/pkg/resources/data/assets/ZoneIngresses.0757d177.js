import{e as F,cj as Z,ck as B,P as q,cl as K,K as g,cm as M,m as N,f as y,c as u,w as t,r as s,o as a,a as o,b as O,p as f,g as l,t as _,F as v,i as E}from"./index.d0c2efa7.js";import{S as R,a as V}from"./SubscriptionHeader.81bb3179.js";import{M as H}from"./MultizoneInfo.1b8b5281.js";import{g as U}from"./tableDataUtils.4323c7bd.js";import{F as W}from"./FrameSkeleton.fba0c2e6.js";import{D as G}from"./DataOverview.c3903863.js";import{E as P}from"./EntityURLControl.b14a7a6c.js";import{T as j}from"./TabsWidget.d742b9a7.js";import{L as X}from"./LabelList.84abaca0.js";import{E as J}from"./EnvoyData.c359b2ec.js";import"./EmptyBlock.vue_vue_type_script_setup_true_lang.37c6fb15.js";import"./ErrorBlock.0c813134.js";import"./LoadingBlock.vue_vue_type_script_setup_true_lang.d2d6c4b6.js";import"./CodeBlock.22897d3f.js";import"./_commonjsHelpers.f037b798.js";const Q={name:"ZoneIngresses",components:{EnvoyData:J,FrameSkeleton:W,DataOverview:G,TabsWidget:j,LabelList:X,AccordionList:Z,AccordionItem:B,SubscriptionDetails:R,SubscriptionHeader:V,MultizoneInfo:H,EntityURLControl:P},data(){return{isLoading:!0,isEmpty:!1,hasError:!1,empty_state:{title:"No Data",message:"There are no Zone Ingresses present."},tableData:{headers:[{key:"actions",hideLabel:!0},{label:"Status",key:"status"},{label:"Name",key:"name"}],data:[]},tabs:[{hash:"#overview",title:"Overview"},{hash:"#insights",title:"Zone Ingress Insights"},{hash:"#xds-configuration",title:"XDS Configuration"},{hash:"#envoy-stats",title:"Stats"},{hash:"#envoy-clusters",title:"Clusters"}],entity:{},rawData:[],pageSize:q,next:null,subscriptionsReversed:[]}},computed:{...K({multicluster:"config/getMulticlusterStatus"})},watch:{$route(){this.isLoading=!0,this.isEmpty=!1,this.hasError=!1,this.init()}},beforeMount(){this.init()},methods:{init(){this.multicluster&&this.loadData()},tableAction(i){const r=i;this.getEntity(r)},async loadData(i="0"){this.isLoading=!0,this.isEmpty=!1;const r=this.$route.query.ns||null;try{const{data:n,next:p}=await U({getAllEntities:g.getAllZoneIngressOverviews.bind(g),getSingleEntity:g.getZoneIngressOverview.bind(g),size:this.pageSize,offset:i,query:r});this.next=p,n.length?(this.isEmpty=!1,this.rawData=n,this.getEntity({name:n[0].name}),this.tableData.data=n.map(e=>{const{zoneIngressInsight:c={}}=e;return{...e,...M(c)}})):(this.tableData.data=[],this.isEmpty=!0)}catch(n){this.hasError=!0,this.isEmpty=!0,console.error(n)}finally{this.isLoading=!1}},getEntity(i){var e,c;const r=["type","name"],n=this.rawData.find(h=>h.name===i.name),p=(c=(e=n==null?void 0:n.zoneIngressInsight)==null?void 0:e.subscriptions)!=null?c:[];this.subscriptionsReversed=Array.from(p).reverse(),this.entity=N(n,r)}}},Y={class:"zoneingresses"},$=l("span",{class:"custom-control-icon"}," \u2190 ",-1);function ee(i,r,n,p,e,c){const h=s("MultizoneInfo"),D=s("KButton"),L=s("DataOverview"),z=s("EntityURLControl"),S=s("LabelList"),I=s("SubscriptionHeader"),k=s("SubscriptionDetails"),w=s("AccordionItem"),A=s("AccordionList"),x=s("KCard"),b=s("EnvoyData"),C=s("TabsWidget"),T=s("FrameSkeleton");return a(),y("div",Y,[i.multicluster===!1?(a(),u(h,{key:0})):(a(),u(T,{key:1},{default:t(()=>[o(L,{"page-size":e.pageSize,"has-error":e.hasError,"is-loading":e.isLoading,"empty-state":e.empty_state,"table-data":e.tableData,"table-data-is-empty":e.isEmpty,next:e.next,onTableAction:c.tableAction,onLoadData:r[0]||(r[0]=m=>c.loadData(m))},{additionalControls:t(()=>[i.$route.query.ns?(a(),u(D,{key:0,class:"back-button",appearance:"primary",to:{name:"zoneingresses"}},{default:t(()=>[$,O(" View All ")]),_:1})):f("",!0)]),_:1},8,["page-size","has-error","is-loading","empty-state","table-data","table-data-is-empty","next","onTableAction"]),e.isEmpty===!1?(a(),u(C,{key:0,"has-error":e.hasError,"is-loading":e.isLoading,tabs:e.tabs,"initial-tab-override":"overview"},{tabHeader:t(()=>[l("div",null,[l("h3",null," Zone Ingress: "+_(e.entity.name),1)]),l("div",null,[o(z,{name:e.entity.name},null,8,["name"])])]),overview:t(()=>[o(S,null,{default:t(()=>[l("div",null,[l("ul",null,[(a(!0),y(v,null,E(e.entity,(m,d)=>(a(),y("li",{key:d},[l("h4",null,_(d),1),l("p",null,_(m),1)]))),128))])])]),_:1})]),insights:t(()=>[o(x,{"border-variant":"noBorder"},{body:t(()=>[o(A,{"initially-open":0},{default:t(()=>[(a(!0),y(v,null,E(e.subscriptionsReversed,(m,d)=>(a(),u(w,{key:d},{"accordion-header":t(()=>[o(I,{details:m},null,8,["details"])]),"accordion-content":t(()=>[o(k,{details:m,"is-discovery-subscription":""},null,8,["details"])]),_:2},1024))),128))]),_:1})]),_:1})]),"xds-configuration":t(()=>[o(b,{"data-path":"xds","zone-ingress-name":e.entity.name,"query-key":"envoy-data-zone-ingress"},null,8,["zone-ingress-name"])]),"envoy-stats":t(()=>[o(b,{"data-path":"stats","zone-ingress-name":e.entity.name,"query-key":"envoy-data-zone-ingress"},null,8,["zone-ingress-name"])]),"envoy-clusters":t(()=>[o(b,{"data-path":"clusters","zone-ingress-name":e.entity.name,"query-key":"envoy-data-zone-ingress"},null,8,["zone-ingress-name"])]),_:1},8,["has-error","is-loading","tabs"])):f("",!0)]),_:1}))])}const he=F(Q,[["render",ee]]);export{he as default};
