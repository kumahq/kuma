import{d as q,r as t,p as c,o as m,w as s,b as a,e as r,m as w,af as P,l as k,I as T,ac as G,q as f,B as K,t as p,c as b,M as C,y as F,_ as Z}from"./index-C42Nh-Sh.js";import{S as j}from"./SummaryView-BllAJBv5.js";const H=q({__name:"MeshExternalServiceListView",props:{mesh:{}},setup(x){const u=x;return(J,i)=>{const X=t("RouteTitle"),h=t("XI18n"),v=t("XNotification"),V=t("XSearch"),d=t("XAction"),S=t("XCopyButton"),N=t("KumaPort"),A=t("XActionGroup"),B=t("RouterView"),D=t("DataCollection"),R=t("DataLoader"),L=t("XLayout"),I=t("XCard"),E=t("AppView"),M=t("DataSource"),$=t("RouteView");return m(),c($,{name:"mesh-external-service-list-view",params:{page:1,size:Number,mesh:"",service:"",s:""}},{default:s(({route:o,t:_,can:g,uri:z,me:l})=>[a(X,{render:!1,title:_("services.routes.mesh-external-service-list-view.title")},null,8,["title"]),i[9]||(i[9]=r()),a(M,{src:z(w(P),"/zone-cps/:name/egresses",{name:"*"},{page:1,size:100})},{default:s(({data:y})=>[a(E,{docs:_("services.mesh-external-service.href.docs"),notifications:!0},{default:s(()=>[a(v,{notify:!u.mesh.mtlsBackend,uri:`mes-mtls-warning.${u.mesh.id}`},{default:s(()=>[a(h,{path:"services.mesh-external-service.notifications.mtls-warning"})]),_:1},8,["notify","uri"]),i[7]||(i[7]=r()),a(v,{notify:y&&!y.items.find(n=>typeof n.zoneEgressInsight.connectedSubscription<"u"),uri:`mes-no-zone-ingress.${u.mesh.id}`},{default:s(()=>[a(h,{path:"services.mesh-external-service.notifications.no-zone-egress"})]),_:2},1032,["notify","uri"]),i[8]||(i[8]=r()),a(I,null,{default:s(()=>[a(L,null,{default:s(()=>[k("search",null,[k("form",{onSubmit:i[0]||(i[0]=T(()=>{},["prevent"]))},[a(V,{class:"search-field",keys:["name","namespace",...g("use zones")?["zone"]:[],"label"],value:o.params.s,onChange:n=>o.update({s:n})},null,8,["keys","value","onChange"])],32)]),i[6]||(i[6]=r()),a(R,{src:z(w(G),"/meshes/:mesh/mesh-external-services",{mesh:o.params.mesh},{page:o.params.page,size:o.params.size,search:o.params.s})},{loadable:s(({data:n})=>[a(D,{type:"services",items:(n==null?void 0:n.items)??[void 0],page:o.params.page,"page-size":o.params.size,total:n==null?void 0:n.total,onChange:o.update},{default:s(()=>[a(K,{"data-testid":"service-collection",headers:[{...l.get("headers.name"),label:"Name",key:"name"},{...l.get("headers.namespace"),label:"Namespace",key:"namespace"},...g("use zones")?[{...l.get("headers.zone"),label:"Zone",key:"zone"}]:[],{...l.get("headers.port"),label:"Port",key:"port"},{...l.get("headers.actions"),label:"Actions",key:"actions",hideLabel:!0}],items:n==null?void 0:n.items,"is-selected-row":e=>e.name===o.params.service,onResize:l.set},{name:s(({row:e})=>[a(S,{text:e.name},{default:s(()=>[a(d,{"data-action":"",to:{name:"mesh-external-service-summary-view",params:{mesh:e.mesh,service:e.id},query:{page:o.params.page,size:o.params.size,s:o.params.s}}},{default:s(()=>[r(p(e.name),1)]),_:2},1032,["to"])]),_:2},1032,["text"])]),namespace:s(({row:e})=>[r(p(e.namespace),1)]),zone:s(({row:e})=>[e.labels&&e.labels["kuma.io/origin"]==="zone"&&e.labels["kuma.io/zone"]?(m(),b(C,{key:0},[e.labels["kuma.io/zone"]?(m(),c(d,{key:0,to:{name:"zone-cp-detail-view",params:{zone:e.labels["kuma.io/zone"]}}},{default:s(()=>[r(p(e.labels["kuma.io/zone"]),1)]),_:2},1032,["to"])):f("",!0)],64)):(m(),b(C,{key:1},[r(p(_("common.detail.none")),1)],64))]),port:s(({row:e})=>[e.spec.match?(m(),c(N,{key:0,port:e.spec.match},null,8,["port"])):f("",!0)]),actions:s(({row:e})=>[a(A,null,{default:s(()=>[a(d,{to:{name:"mesh-external-service-detail-view",params:{mesh:e.mesh,service:e.id}}},{default:s(()=>[r(p(_("common.collection.actions.view")),1)]),_:2},1032,["to"])]),_:2},1024)]),_:2,__:[1,2,3,4]},1032,["headers","items","is-selected-row","onResize"]),i[5]||(i[5]=r()),n!=null&&n.items&&o.params.service?(m(),c(B,{key:0},{default:s(e=>[a(j,{onClose:O=>o.replace({name:"mesh-external-service-list-view",params:{mesh:o.params.mesh},query:{page:o.params.page,size:o.params.size,s:o.params.s}})},{default:s(()=>[(m(),c(F(e.Component),{items:n==null?void 0:n.items},null,8,["items"]))]),_:2},1032,["onClose"])]),_:2},1024)):f("",!0)]),_:2,__:[5]},1032,["items","page","page-size","total","onChange"])]),_:2},1032,["src"])]),_:2,__:[6]},1024)]),_:2},1024)]),_:2,__:[7,8]},1032,["docs"])]),_:2},1032,["src"])]),_:1,__:[9]})}}}),W=Z(H,[["__scopeId","data-v-9b7c206a"]]);export{W as default};
