import{M as P}from"./kongponents.es-3141fcfd.js";import{d as $,u as Q,r as o,v as R,y as U,A as j,B as G,j as v,i as d,g as i,w as s,b as N,h as _,e as E,f as b,E as q,o as u,t as z,F as B,q as I}from"./index-bb404c7e.js";import{A as H,a as K}from"./AccordionList-2ec76ea8.js";import{D as W}from"./DataOverview-d0519692.js";import{E as w}from"./EnvoyData-cbbf3408.js";import{_ as X}from"./LabelList.vue_vue_type_style_index_0_lang-949ea421.js";import{_ as Y,S as J}from"./SubscriptionHeader.vue_vue_type_script_setup_true_lang-9d741f5c.js";import{T as ee}from"./TabsWidget-b0fcacf8.js";import{u as ae}from"./index-cb99abc8.js";import{Q as O}from"./QueryParameter-70743f73.js";import"./_plugin-vue_export-helper-c27b6911.js";import"./EmptyBlock.vue_vue_type_script_setup_true_lang-aa9d51da.js";import"./ErrorBlock-116c4df2.js";import"./LoadingBlock.vue_vue_type_script_setup_true_lang-c4f08245.js";import"./datadogLogEvents-302eea7b.js";import"./TagList-a77b041a.js";import"./store-674ffdd1.js";import"./StatusBadge-b11d7d44.js";import"./CodeBlock.vue_vue_type_style_index_0_lang-7ab44394.js";const se={class:"zoneegresses"},te={class:"kcard-stack"},ne={class:"kcard-border"},re={class:"kcard-border"},oe={class:"entity-heading"},le={key:0},De=$({__name:"ZoneEgresses",props:{selectedZoneEgressName:{type:String,required:!1,default:null},offset:{type:Number,required:!1,default:0}},setup(C){const p=C,k=ae(),L={title:"No Data",message:"There are no Zone Egresses present."},V=[{hash:"#overview",title:"Overview"},{hash:"#insights",title:"Zone Egress Insights"},{hash:"#xds-configuration",title:"XDS Configuration"},{hash:"#envoy-stats",title:"Stats"},{hash:"#envoy-clusters",title:"Clusters"}],f=Q(),m=o(!0),c=o(!1),g=o(null),y=o({headers:[{label:"Status",key:"status"},{label:"Name",key:"name"}],data:[]}),l=o(null),A=o([]),x=o(null),D=o([]),S=o(p.offset);R(()=>f.params.mesh,function(){f.name==="zoneegresses"&&(m.value=!0,c.value=!1,g.value=null,h(0))}),U(function(){h(p.offset)});async function h(a){S.value=a,O.set("offset",a>0?a:null),m.value=!0,c.value=!1;const t=f.query.ns||null,r=q;try{const{data:e,next:n}=await F(t,r,a);x.value=n,e.length?(c.value=!1,A.value=e,T({name:p.selectedZoneEgressName??e[0].name}),y.value.data=e.map(Z=>{const M=j(Z.zoneEgressInsight??{});return{...Z,status:M}})):(y.value.data=[],c.value=!0)}catch(e){e instanceof Error?g.value=e:console.error(e),c.value=!0}finally{m.value=!1}}function T({name:a}){var e;const t=A.value.find(n=>n.name===a),r=((e=t==null?void 0:t.zoneEgressInsight)==null?void 0:e.subscriptions)??[];D.value=Array.from(r).reverse(),l.value=G(t,["type","name"]),O.set("zoneEgress",a)}async function F(a,t,r){if(a)return{data:[await k.getZoneEgressOverview({name:a},{size:t,offset:r})],next:null};{const{items:e,next:n}=await k.getAllZoneEgressOverviews({size:t,offset:r});return{data:e??[],next:n}}}return(a,t)=>{var r;return u(),v("div",se,[d("div",te,[d("div",ne,[i(W,{"selected-entity-name":(r=l.value)==null?void 0:r.name,"page-size":N(q),"is-loading":m.value,error:g.value,"empty-state":L,"table-data":y.value,"table-data-is-empty":c.value,next:x.value,"page-offset":S.value,onTableAction:T,onLoadData:h},{additionalControls:s(()=>[a.$route.query.ns?(u(),E(N(P),{key:0,class:"back-button",appearance:"primary",icon:"arrowLeft",to:{name:"zoneegresses"}},{default:s(()=>[_(`
              View all
            `)]),_:1})):b("",!0)]),_:1},8,["selected-entity-name","page-size","is-loading","error","table-data","table-data-is-empty","next","page-offset"])]),_(),d("div",re,[c.value===!1&&l.value!==null?(u(),E(ee,{key:0,"has-error":g.value!==null,"is-loading":m.value,tabs:V},{tabHeader:s(()=>[d("h1",oe,`
              Zone Egress: `+z(l.value.name),1)]),overview:s(()=>[i(X,null,{default:s(()=>[d("div",null,[d("ul",null,[(u(!0),v(B,null,I(l.value,(e,n)=>(u(),v("li",{key:n},[e?(u(),v("h4",le,z(n),1)):b("",!0),_(),d("p",null,z(e),1)]))),128))])])]),_:1})]),insights:s(()=>[i(K,{"initially-open":0},{default:s(()=>[(u(!0),v(B,null,I(D.value,(e,n)=>(u(),E(H,{key:n},{"accordion-header":s(()=>[i(Y,{details:e},null,8,["details"])]),"accordion-content":s(()=>[i(J,{details:e,"is-discovery-subscription":""},null,8,["details"])]),_:2},1024))),128))]),_:1})]),"xds-configuration":s(()=>[i(w,{"data-path":"xds","zone-egress-name":l.value.name,"query-key":"envoy-data-zone-egress"},null,8,["zone-egress-name"])]),"envoy-stats":s(()=>[i(w,{"data-path":"stats","zone-egress-name":l.value.name,"query-key":"envoy-data-zone-egress"},null,8,["zone-egress-name"])]),"envoy-clusters":s(()=>[i(w,{"data-path":"clusters","zone-egress-name":l.value.name,"query-key":"envoy-data-zone-egress"},null,8,["zone-egress-name"])]),_:1},8,["has-error","is-loading"])):b("",!0)])])])}}});export{De as default};
