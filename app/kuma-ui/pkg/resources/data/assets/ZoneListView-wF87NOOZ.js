import{d as P,O,D as X,r as d,o,m as f,w as e,b as l,k as C,e as s,l as D,z as Q,P as W,c as _,F as y,t as r,p as b,A as j,s as V,Q as H,S as J,E as M,q as U}from"./index-BEf7lh5F.js";import{_ as Y}from"./DeleteResourceModal.vue_vue_type_script_setup_true_lang-3mB8acwD.js";import{S as ee}from"./SummaryView-NUHsA-KI.js";const ne=["data-testid"],te=P({__name:"ZoneListView",setup(oe){const R=O(),I=X({}),S=X({}),T=w=>{const h="zoneIngress";I.value=w.items.reduce((p,u)=>{var z;const i=(z=u[h])==null?void 0:z.zone;if(typeof i<"u"){typeof p[i]>"u"&&(p[i]={online:[],offline:[]});const k=typeof u[`${h}Insight`].connectedSubscription<"u"?"online":"offline";p[i][k].push(u)}return p},{})},Z=w=>{const h="zoneEgress";S.value=w.items.reduce((p,u)=>{var z;const i=(z=u[h])==null?void 0:z.zone;if(typeof i<"u"){typeof p[i]>"u"&&(p[i]={online:[],offline:[]});const k=typeof u[`${h}Insight`].connectedSubscription<"u"?"online":"offline";p[i][k].push(u)}return p},{})};async function $(w){await R.deleteZone({name:w})}return(w,h)=>{const p=d("RouteTitle"),u=d("DataSource"),i=d("XAction"),z=d("XTeleportTemplate"),k=d("XIcon"),B=d("XDisclosure"),E=d("XActionGroup"),L=d("KCard"),N=d("RouterView"),q=d("AppView"),K=d("RouteView");return o(),f(K,{name:"zone-cp-list-view",params:{page:1,size:50,zone:""}},{default:e(({route:c,t:a,can:v,uri:F,me:g})=>[l(q,null,{title:e(()=>[C("h1",null,[l(p,{title:a("zone-cps.routes.items.title")},null,8,["title"])])]),default:e(()=>[s(),l(u,{src:F(D(Q),"/zone-cps",{},{page:c.params.page,size:c.params.size})},{default:e(({data:m,error:x,refresh:G})=>[l(u,{src:"/zone-ingress-overviews?page=1&size=100",onChange:T}),s(),l(u,{src:"/zone-egress-overviews?page=1&size=100",onChange:Z}),s(),l(L,null,{default:e(()=>[x!==void 0?(o(),f(W,{key:0,error:x},null,8,["error"])):(o(),_(y,{key:1},[v("create zones")&&((m==null?void 0:m.items)??[]).length>0?(o(),f(z,{key:0,to:{name:"zone-cp-list-view-actions"}},{default:e(()=>[l(i,{type:"create",appearance:"primary",to:{name:"zone-create-view"},"data-testid":"create-zone-link"},{default:e(()=>[s(r(a("zones.index.create")),1)]),_:2},1024)]),_:2},1024)):b("",!0),s(),l(j,{class:"zone-cp-collection","data-testid":"zone-cp-collection",headers:[{...g.get("headers.type"),label:"Â ",key:"type"},{...g.get("headers.name"),label:"Name",key:"name"},{...g.get("headers.zoneCpVersion"),label:"Zone Leader CP Version",key:"zoneCpVersion"},{...g.get("headers.ingress"),label:"Ingresses (online / total)",key:"ingress"},{...g.get("headers.egress"),label:"Egresses (online / total)",key:"egress"},{...g.get("headers.state"),label:"Status",key:"state"},{...g.get("headers.warnings"),label:"Warnings",key:"warnings",hideLabel:!0},{...g.get("headers.actions"),label:"Actions",key:"actions",hideLabel:!0}],"page-number":c.params.page,"page-size":c.params.size,total:m==null?void 0:m.total,items:m==null?void 0:m.items,error:x,"empty-state-title":v("create zones")?a("zone-cps.empty_state.title"):void 0,"empty-state-message":v("create zones")?a("zone-cps.empty_state.message"):void 0,"empty-state-cta-to":v("create zones")?{name:"zone-create-view"}:void 0,"empty-state-cta-text":v("create zones")?a("zones.index.create"):void 0,"is-selected-row":n=>n.name===c.params.zone,onChange:c.update,onResize:g.set},{type:e(({row:n})=>[(o(!0),_(y,null,V([["kubernetes","universal"].find(t=>t===n.zoneInsight.environment)??"kubernetes"],t=>(o(),f(k,{key:t,name:t},{default:e(()=>[s(r(a(`common.product.environment.${t}`)),1)]),_:2},1032,["name"]))),128))]),name:e(({row:n})=>[l(i,{"data-action":"",to:{name:"zone-cp-detail-view",params:{zone:n.name},query:{page:c.params.page,size:c.params.size}}},{default:e(()=>[s(r(n.name),1)]),_:2},1032,["to"])]),zoneCpVersion:e(({row:n})=>[s(r(D(H)(n.zoneInsight,"version.kumaCp.version",a("common.collection.none"))),1)]),ingress:e(({row:n})=>[(o(!0),_(y,null,V([I.value[n.name]||{online:[],offline:[]}],t=>(o(),_(y,null,[s(r(t.online.length)+" / "+r(t.online.length+t.offline.length),1)],64))),256))]),egress:e(({row:n})=>[(o(!0),_(y,null,V([S.value[n.name]||{online:[],offline:[]}],t=>(o(),_(y,null,[s(r(t.online.length)+" / "+r(t.online.length+t.offline.length),1)],64))),256))]),state:e(({row:n})=>[l(J,{status:n.state},null,8,["status"])]),warnings:e(({row:n})=>[n.warnings.length>0?(o(),f(k,{key:0,name:"warning","data-testid":"warning"},{default:e(()=>[C("ul",null,[(o(!0),_(y,null,V(n.warnings,t=>(o(),_("li",{key:t.kind,"data-testid":`warning-${t.kind}`},r(a(`zone-cps.list.${t.kind}`)),9,ne))),128))])]),_:2},1024)):(o(),_(y,{key:1},[s(r(a("common.collection.none")),1)],64))]),actions:e(({row:n})=>[l(E,null,{default:e(()=>[l(B,null,{default:e(({expanded:t,toggle:A})=>[l(i,{to:{name:"zone-cp-detail-view",params:{zone:n.name}}},{default:e(()=>[s(r(a("common.collection.actions.view")),1)]),_:2},1032,["to"]),s(),v("create zones")?(o(),f(i,{key:0,appearance:"danger",onClick:A},{default:e(()=>[s(r(a("common.collection.actions.delete")),1)]),_:2},1032,["onClick"])):b("",!0),s(),l(z,{to:{name:"modal-layer"}},{default:e(()=>[t?(o(),f(Y,{key:0,"confirmation-text":n.name,"delete-function":()=>$(n.name),"is-visible":"","action-button-text":a("common.delete_modal.proceed_button"),title:a("common.delete_modal.title",{type:"Zone"}),"data-testid":"delete-zone-modal",onCancel:A,onDelete:()=>{A(),G()}},{default:e(()=>[C("p",null,r(a("common.delete_modal.text1",{type:"Zone",name:n.name})),1),s(),C("p",null,r(a("common.delete_modal.text2")),1)]),_:2},1032,["confirmation-text","delete-function","action-button-text","title","onCancel","onDelete"])):b("",!0)]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1032,["headers","page-number","page-size","total","items","error","empty-state-title","empty-state-message","empty-state-cta-to","empty-state-cta-text","is-selected-row","onChange","onResize"])],64))]),_:2},1024),s(),c.params.zone?(o(),f(N,{key:0},{default:e(n=>[l(ee,{onClose:t=>c.replace({name:"zone-cp-list-view",query:{page:c.params.page,size:c.params.size}})},{default:e(()=>[(o(),f(M(n.Component),{name:c.params.zone,"zone-overview":m==null?void 0:m.items.find(t=>t.name===c.params.zone)},null,8,["name","zone-overview"]))]),_:2},1032,["onClose"])]),_:2},1024)):b("",!0)]),_:2},1032,["src"])]),_:2},1024)]),_:1})}}}),ie=U(te,[["__scopeId","data-v-57ee9ac1"]]);export{ie as default};
