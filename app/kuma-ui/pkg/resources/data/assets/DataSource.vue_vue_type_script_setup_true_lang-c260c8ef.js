import{M as v}from"./RouteView.vue_vue_type_script_setup_true_lang-ae2f3329.js";import{d as g,q as m,s as _,A as h,o as y,e as S,n as B,g as b,F as k,k as E}from"./index-5fe06e34.js";const q=E("span",null,null,-1),A=g({__name:"DataSource",props:{src:{type:String,required:!0}},emits:["change","error"],setup(f,{emit:a}){const l=f,c=v(),o=m(void 0),n=m(void 0);let r={};const u=Symbol(""),d=async e=>{if(o.value=void 0,r=i(r),r.src=e,e==="")return;r.controller=new AbortController;const s=c.source(e,u);s.addEventListener("message",t=>{o.value=t.data,n.value=void 0,a("change",o.value)},{signal:r.controller.signal}),s.addEventListener("error",t=>{n.value=t.error,a("error",n.value)},{signal:r.controller.signal})},i=e=>(typeof e.controller<"u"&&e.controller.abort(),typeof e.src<"u"&&c.close(e.src,u),{});_(()=>l.src,e=>d(e),{immediate:!0}),h(()=>{r=i(r)});const p=()=>{d(l.src)};return(e,s)=>(y(),S(k,null,[B(e.$slots,"default",{data:o.value,error:n.value,refresh:p}),b(),q],64))}});export{A as _};
