import{d as N,h as m,o as p,a as r,w as e,j as t,ae as C,k as s,t as l,g as d,e as u,z as y,aA as K,Y as H,C as X,b as g,F as R,M as E,r as F,A as $}from"./index-ChMk9xbI.js";import{e as q}from"./kong-icons.es249-BqzxpUAd.js";import{P as O}from"./PolicyTypeTag-Bup486gi.js";import{S as Z}from"./SummaryView-awjXeDWd.js";const j={class:"stack"},U={class:"visually-hidden"},Y=["innerHTML"],G=["innerHTML"],J={key:0},Q=N({__name:"PolicyListView",props:{policyTypes:{}},setup(V){const T=V;return(W,k)=>{const _=m("KBadge"),h=m("XAction"),b=m("KCard"),w=m("XInput"),L=m("search"),P=m("RouterLink"),z=m("DataCollection"),x=m("RouterView"),B=m("DataLoader"),D=m("AppView"),S=m("RouteView"),A=m("DataSource");return p(),r(A,{src:"/me"},{default:e(({data:v})=>[v?(p(),r(S,{key:0,name:"policy-list-view",params:{page:1,size:v.pageSize,mesh:"",policyPath:"",policy:"",s:""}},{default:e(({route:n,t:o,can:I,uri:M})=>[t(z,{predicate:i=>typeof i<"u"&&i.path===n.params.policyPath,items:T.policyTypes??[]},{empty:e(()=>[t(C,null,{message:e(()=>[s(l(o("policies.routes.items.empty")),1)]),_:2},1024)]),item:e(({item:i})=>[t(D,null,{default:e(()=>[d("div",j,[t(b,null,{default:e(()=>[d("header",null,[d("div",null,[i.isExperimental?(p(),r(_,{key:0,appearance:"warning"},{default:e(()=>[s(l(o("policies.collection.beta")),1)]),_:2},1024)):u("",!0),s(),i.isInbound?(p(),r(_,{key:1,appearance:"neutral"},{default:e(()=>[s(l(o("policies.collection.inbound")),1)]),_:2},1024)):u("",!0),s(),i.isOutbound?(p(),r(_,{key:2,appearance:"neutral"},{default:e(()=>[s(l(o("policies.collection.outbound")),1)]),_:2},1024)):u("",!0),s(),t(h,{type:"docs",href:o("policies.href.docs",{name:i.name}),"data-testid":"policy-documentation-link"},{default:e(()=>[d("span",U,l(o("common.documentation")),1)]),_:2},1032,["href"])]),s(),d("h3",null,[t(O,{"policy-type":i.name},{default:e(()=>[s(l(o("policies.collection.title",{name:i.name})),1)]),_:2},1032,["policy-type"])])]),s(),d("div",{innerHTML:o(`policies.type.${i.name}.description`,void 0,{defaultMessage:o("policies.collection.description")})},null,8,Y)]),_:2},1024),s(),t(b,null,{default:e(()=>[t(B,{src:M(y(K),"/meshes/:mesh/policy-path/:path",{mesh:n.params.mesh,path:n.params.policyPath},{page:n.params.page,size:n.params.size,search:n.params.s})},{loadable:e(({data:c})=>[((c==null?void 0:c.items)??{length:0}).length>0||n.params.s.length>0?(p(),r(L,{key:0},{default:e(()=>[d("form",{onSubmit:k[0]||(k[0]=H(()=>{},["prevent"]))},[t(w,{placeholder:"Filter by name...",type:"search",appearance:"search",value:n.params.s,debounce:1e3,onChange:a=>n.update({s:a})},null,8,["value","onChange"])],32)]),_:2},1024)):u("",!0),s(),t(z,{items:(c==null?void 0:c.items)??[void 0]},{empty:e(()=>[t(C,null,{title:e(()=>[s(l(o("policies.x-empty-state.title")),1)]),action:e(()=>[t(h,{type:"docs",href:o("policies.href.docs",{name:i.name})},{default:e(()=>[s(l(o("common.documentation")),1)]),_:2},1032,["href"])]),default:e(()=>[s(),d("div",{innerHTML:o("policies.x-empty-state.body",{type:i.name,suffix:n.params.s.length>0?o("common.matchingsearch"):""})},null,8,G),s()]),_:2},1024)]),default:e(()=>[t(X,{headers:[{label:"Name",key:"name"},{label:"Namespace",key:"namespace"},...I("use zones")&&i.isTargetRefBased?[{label:"Zone",key:"zone"}]:[],...i.isTargetRefBased?[{label:"Target ref",key:"targetRef"}]:[],{label:"Details",key:"details",hideLabel:!0}],"page-number":n.params.page,"page-size":n.params.size,total:c==null?void 0:c.total,items:c==null?void 0:c.items,"is-selected-row":a=>a.id===n.params.policy,onChange:n.update},{name:e(({row:a})=>[t(h,{to:{name:"policy-summary-view",params:{mesh:a.mesh,policyPath:i.path,policy:a.id},query:{page:n.params.page,size:n.params.size}}},{default:e(()=>[s(l(a.name),1)]),_:2},1032,["to"])]),namespace:e(({row:a})=>[s(l(a.namespace.length>0?a.namespace:o("common.detail.none")),1)]),targetRef:e(({row:a})=>{var f;return[i.isTargetRefBased&&typeof((f=a.spec)==null?void 0:f.targetRef)<"u"?(p(),r(_,{key:0,appearance:"neutral"},{default:e(()=>[s(l(a.spec.targetRef.kind),1),a.spec.targetRef.name?(p(),g("span",J,[s(":"),d("b",null,l(a.spec.targetRef.name),1)])):u("",!0)]),_:2},1024)):(p(),g(R,{key:1},[s(l(o("common.detail.none")),1)],64))]}),zone:e(({row:a})=>[a.labels&&a.labels["kuma.io/origin"]==="zone"&&a.labels["kuma.io/zone"]?(p(),r(P,{key:0,to:{name:"zone-cp-detail-view",params:{zone:a.labels["kuma.io/zone"]}}},{default:e(()=>[s(l(a.labels["kuma.io/zone"]),1)]),_:2},1032,["to"])):(p(),g(R,{key:1},[s(l(o("common.detail.none")),1)],64))]),details:e(({row:a})=>[t(h,{class:"details-link","data-testid":"details-link",to:{name:"policy-detail-view",params:{mesh:a.mesh,policyPath:i.path,policy:a.id}}},{default:e(()=>[s(l(o("common.collection.details_link"))+" ",1),t(y(q),{decorative:"",size:y(E)},null,8,["size"])]),_:2},1032,["to"])]),_:2},1032,["headers","page-number","page-size","total","items","is-selected-row","onChange"])]),_:2},1032,["items"]),s(),n.params.policy?(p(),r(x,{key:1},{default:e(({Component:a})=>[t(Z,{onClose:f=>n.replace({name:"policy-list-view",params:{mesh:n.params.mesh,policyPath:n.params.policyPath},query:{page:n.params.page,size:n.params.size}})},{default:e(()=>[typeof c<"u"?(p(),r(F(a),{key:0,items:c.items,"policy-type":i},null,8,["items","policy-type"])):u("",!0)]),_:2},1032,["onClose"])]),_:2},1024)):u("",!0)]),_:2},1032,["src"])]),_:2},1024)])]),_:2},1024)]),_:2},1032,["predicate","items"])]),_:2},1032,["params"])):u("",!0)]),_:1})}}}),oe=$(Q,[["__scopeId","data-v-4c22a9b2"]]);export{oe as default};
