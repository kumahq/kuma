import{d as R,l as U,m as G,i as H,r as o,n as K,p as W,s as X,t as Y,o as l,c as f,u as p,k as d,w as t,a as i,E as j,b as I,x as N,P as B,f as v,y as z,F as O,z as q,A as J,B as ee,M as ae}from"./index-be86debd.js";import{_ as te}from"./MultizoneInfo.vue_vue_type_script_setup_true_lang-7993660b.js";import{D as se}from"./DataOverview-3a620f41.js";import{E as w}from"./EnvoyData-3a2852ce.js";import{F as ne}from"./FrameSkeleton-f30f8638.js";import{_ as re}from"./LabelList.vue_vue_type_style_index_0_lang-6231c603.js";import{_ as oe,S as le}from"./SubscriptionHeader.vue_vue_type_script_setup_true_lang-00104c2c.js";import{T as ie}from"./TabsWidget-78f80419.js";import{Q as L}from"./QueryParameter-70743f73.js";import"./EmptyBlock.vue_vue_type_script_setup_true_lang-4e97ff2e.js";import"./ErrorBlock-abdcf004.js";import"./LoadingBlock.vue_vue_type_script_setup_true_lang-f8a7cc1f.js";import"./TagList-b29c183b.js";import"./StatusBadge-16d25a68.js";import"./CodeBlock.vue_vue_type_style_index_0_lang-0ecd0eb5.js";const ue={class:"zoneingresses"},ce={class:"entity-heading"},xe=R({__name:"ZoneIngresses",props:{selectedZoneIngressName:{type:String,required:!1,default:null},offset:{type:Number,required:!1,default:0}},setup(C){const y=C,k=U(),F={title:"No Data",message:"There are no Zone Ingresses present."},M=[{hash:"#overview",title:"Overview"},{hash:"#insights",title:"Zone Ingress Insights"},{hash:"#xds-configuration",title:"XDS Configuration"},{hash:"#envoy-stats",title:"Stats"},{hash:"#envoy-clusters",title:"Clusters"}],h=G(),S=H(),m=o(!0),c=o(!1),g=o(null),_=o({headers:[{label:"Actions",key:"actions",hideLabel:!0},{label:"Status",key:"status"},{label:"Name",key:"name"}],data:[]}),u=o(null),x=o([]),A=o(null),E=o([]),D=o(y.offset);K(()=>h.params.mesh,function(){h.name==="zoneingresses"&&(m.value=!0,c.value=!1,g.value=null,b(0))}),W(function(){V(y.offset)});function V(a){S.getters["config/getMulticlusterStatus"]&&b(a)}async function b(a){D.value=a,L.set("offset",a>0?a:null),m.value=!0,c.value=!1;const s=h.query.ns||null,r=B;try{const{data:e,next:n}=await P(s,r,a);A.value=n,e.length?(c.value=!1,x.value=e,T({name:y.selectedZoneIngressName??e[0].name}),_.value.data=e.map(Z=>{const{zoneIngressInsight:$={}}=Z,Q=X($);return{...Z,status:Q}})):(_.value.data=[],c.value=!0)}catch(e){e instanceof Error?g.value=e:console.error(e),c.value=!0}finally{m.value=!1}}function T({name:a}){var e;const s=x.value.find(n=>n.name===a),r=((e=s==null?void 0:s.zoneIngressInsight)==null?void 0:e.subscriptions)??[];E.value=Array.from(r).reverse(),u.value=Y(s,["type","name"]),L.set("zoneIngress",a)}async function P(a,s,r){if(a)return{data:[await k.getZoneIngressOverview({name:a},{size:s,offset:r})],next:null};{const{items:e,next:n}=await k.getAllZoneIngressOverviews({size:s,offset:r});return{data:e??[],next:n}}}return(a,s)=>(l(),f("div",ue,[p(S).getters["config/getMulticlusterStatus"]===!1?(l(),d(te,{key:0})):(l(),d(ne,{key:1},{default:t(()=>{var r;return[i(se,{"selected-entity-name":(r=u.value)==null?void 0:r.name,"page-size":p(B),"is-loading":m.value,error:g.value,"empty-state":F,"table-data":_.value,"table-data-is-empty":c.value,next:A.value,"page-offset":D.value,onTableAction:T,onLoadData:b},{additionalControls:t(()=>[a.$route.query.ns?(l(),d(p(j),{key:0,class:"back-button",appearance:"primary",icon:"arrowLeft",to:{name:"zoneingresses"}},{default:t(()=>[I(`
            View all
          `)]),_:1})):N("",!0)]),_:1},8,["selected-entity-name","page-size","is-loading","error","table-data","table-data-is-empty","next","page-offset"]),I(),c.value===!1&&u.value!==null?(l(),d(ie,{key:0,"has-error":g.value!==null,"is-loading":m.value,tabs:M},{tabHeader:t(()=>[v("h1",ce,`
            Zone Ingress: `+z(u.value.name),1)]),overview:t(()=>[i(re,null,{default:t(()=>[v("div",null,[v("ul",null,[(l(!0),f(O,null,q(u.value,(e,n)=>(l(),f("li",{key:n},[v("h4",null,z(n),1),I(),v("p",null,z(e),1)]))),128))])])]),_:1})]),insights:t(()=>[i(p(ae),{"border-variant":"noBorder"},{body:t(()=>[i(J,{"initially-open":0},{default:t(()=>[(l(!0),f(O,null,q(E.value,(e,n)=>(l(),d(ee,{key:n},{"accordion-header":t(()=>[i(oe,{details:e},null,8,["details"])]),"accordion-content":t(()=>[i(le,{details:e,"is-discovery-subscription":""},null,8,["details"])]),_:2},1024))),128))]),_:1})]),_:1})]),"xds-configuration":t(()=>[i(w,{"data-path":"xds","zone-ingress-name":u.value.name,"query-key":"envoy-data-zone-ingress"},null,8,["zone-ingress-name"])]),"envoy-stats":t(()=>[i(w,{"data-path":"stats","zone-ingress-name":u.value.name,"query-key":"envoy-data-zone-ingress"},null,8,["zone-ingress-name"])]),"envoy-clusters":t(()=>[i(w,{"data-path":"clusters","zone-ingress-name":u.value.name,"query-key":"envoy-data-zone-ingress"},null,8,["zone-ingress-name"])]),_:1},8,["has-error","is-loading"])):N("",!0)]}),_:1}))]))}});export{xe as default};
