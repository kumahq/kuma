import{_ as T,r as N,p as x,o as d,w as y,l as r,e as s,a as v,d as M,k as P,c,q as B,t as i,N as g,L as S,m as a,n as X,b as G}from"./index-DI4CRQyW.js";import{T as Y}from"./TagList-z8-IP-o2.js";const F=["B","kB","MB","GB","TB","PB","EB","ZB","YB"],U=["B","KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"],Z=["b","kbit","Mbit","Gbit","Tbit","Pbit","Ebit","Zbit","Ybit"],D=["b","kibit","Mibit","Gibit","Tibit","Pibit","Eibit","Zibit","Yibit"],q=(o,t,e)=>{let f=o;return typeof t=="string"||Array.isArray(t)?f=o.toLocaleString(t,e):(t===!0||e!==void 0)&&(f=o.toLocaleString(void 0,e)),f},E=o=>{if(typeof o=="number")return Math.log10(o);const t=o.toString(10);return t.length+Math.log10(`0.${t.slice(0,15)}`)},V=o=>typeof o=="number"?Math.log(o):E(o)*Math.log(10),A=(o,t)=>{if(typeof o=="number")return o/t;const e=o/BigInt(t),f=o%BigInt(t);return Number(e)+Number(f)/t},w=(o,t)=>{if(t===void 0)return o;if(typeof t!="number"||!Number.isSafeInteger(t)||t<0)throw new TypeError(`Expected fixedWidth to be a non-negative integer, got ${typeof t}: ${t}`);return t===0?o:o.length<t?o.padStart(t," "):o},j=o=>{const{minimumFractionDigits:t,maximumFractionDigits:e}=o;if(!(t===void 0&&e===void 0))return{...t!==void 0&&{minimumFractionDigits:t},...e!==void 0&&{maximumFractionDigits:e},roundingMode:"trunc"}};function C(o,t){if(typeof o!="bigint"&&!Number.isFinite(o))throw new TypeError(`Expected a finite number, got ${typeof o}: ${o}`);t={bits:!1,binary:!1,space:!0,nonBreakingSpace:!1,...t};const e=t.bits?t.binary?D:Z:t.binary?U:F,f=t.space?t.nonBreakingSpace?"Â ":" ":"",m=typeof o=="number"?o===0:o===0n;if(t.signed&&m){const p=` 0${f}${e[0]}`;return w(p,t.fixedWidth)}const n=o<0,_=n?"-":t.signed?"+":"";n&&(o=-o);const u=j(t);let l;if(o<1){const p=q(o,t.locale,u);l=_+p+f+e[0]}else{const p=Math.min(Math.floor(t.binary?V(o)/Math.log(1024):E(o)/3),e.length-1);if(o=A(o,(t.binary?1024:1e3)**p),!u){const b=Math.max(3,Math.floor(o).toString().length);o=o.toPrecision(b)}const k=q(Number(o),t.locale,u),$=e[p];l=_+k+f+$}return w(l,t.fixedWidth)}const z={},K={class:"card"},H={class:"title"},J={class:"body"};function Q(o,t){const e=N("XCard");return d(),x(e,{class:"data-card"},{default:y(()=>[r("dl",null,[r("div",K,[r("dt",H,[v(o.$slots,"title",{},void 0,!0)]),t[0]||(t[0]=s()),r("dd",J,[v(o.$slots,"default",{},void 0,!0)])])])]),_:3})}const I=T(z,[["render",Q],["__scopeId","data-v-719ec237"]]),R={class:"title"},W={key:0},O={key:1},h={"data-testid":"grpc-success"},tt={"data-testid":"grpc-failure"},et={"data-testid":"rq-2xx"},nt={"data-testid":"rq-4xx"},ot={"data-testid":"rq-5xx"},rt={"data-testid":"connections-total"},st={key:0,"data-testid":"bytes-received"},it={key:1,"data-testid":"bytes-sent"},at=M({__name:"ConnectionCard",props:{protocol:{},service:{default:""},traffic:{default:void 0},direction:{default:"downstream"},portName:{default:void 0}},setup(o){const{t}=P(),e=o,f=m=>{const n=m.target;if(m.isTrusted&&n.nodeName.toLowerCase()!=="a"){const _=n.closest(".service-traffic-card, a");if(_){const u=_.nodeName.toLowerCase()==="a"?_:_.querySelector("[data-action]");u!==null&&"click"in u&&typeof u.click=="function"&&u.click()}}};return(m,n)=>{const _=N("XBadge"),u=N("XProgress");return d(),x(I,{class:"service-traffic-card",onClick:f},{title:y(()=>[e.service.length>0?(d(),x(Y,{key:0,tags:[{label:"kuma.io/service",value:e.service}]},null,8,["tags"])):B("",!0),n[1]||(n[1]=s()),r("div",R,[e.protocol!==""?(d(),x(_,{key:0,class:"protocol",appearance:e.protocol==="passthrough"?"success":"info"},{default:y(()=>[s(i(a(t)(`data-planes.components.service_traffic_card.protocol.${e.protocol}`,{},{defaultMessage:a(t)(`http.api.value.${e.protocol}`)})),1)]),_:1},8,["appearance"])):B("",!0),n[0]||(n[0]=s()),v(m.$slots,"default",{},void 0,!0)])]),default:y(()=>[n[24]||(n[24]=s()),e.portName?(d(),c("dl",W,[r("div",null,[n[2]||(n[2]=r("dt",null,"Name",-1)),n[3]||(n[3]=s()),r("dd",null,i(e.portName),1)])])):B("",!0),n[25]||(n[25]=s()),e.traffic?(d(),c("dl",O,[e.protocol==="passthrough"?(d(!0),c(g,{key:0},S([["http","tcp"].reduce((l,p)=>{const k=e.direction;return Object.entries(e.traffic?.[p]||{}).reduce(($,[b,L])=>[`${k}_cx_tx_bytes_total`,`${k}_cx_rx_bytes_total`].includes(b)?{...$,[b]:L+($[b]??0)}:$,l)},{})],(l,p)=>(d(),c(g,{key:p},[r("div",null,[r("dt",null,i(a(t)("data-planes.components.service_traffic_card.tx")),1),n[4]||(n[4]=s()),r("dd",null,i(a(C)(l.downstream_cx_rx_bytes_total??0)),1)]),n[6]||(n[6]=s()),r("div",null,[r("dt",null,i(a(t)("data-planes.components.service_traffic_card.rx")),1),n[5]||(n[5]=s()),r("dd",null,i(a(C)(l.downstream_cx_tx_bytes_total??0)),1)])],64))),128)):e.protocol==="grpc"?(d(),c(g,{key:1},[r("div",h,[r("dt",null,i(a(t)("data-planes.components.service_traffic_card.grpc_success")),1),n[7]||(n[7]=s()),r("dd",null,i(a(t)("common.formats.integer",{value:e.traffic.grpc?.success})),1)]),n[9]||(n[9]=s()),r("div",tt,[r("dt",null,i(a(t)("data-planes.components.service_traffic_card.grpc_failure")),1),n[8]||(n[8]=s()),r("dd",null,i(a(t)("common.formats.integer",{value:e.traffic.grpc?.failure})),1)])],64)):e.protocol.startsWith("http")?(d(),c(g,{key:2},[(d(!0),c(g,null,S([e.traffic.http?.[`${e.direction}_rq_1xx`]??0].filter(l=>l!==0),l=>(d(),c("div",{key:l,"data-testid":"rq-1xx"},[r("dt",null,i(a(t)("data-planes.components.service_traffic_card.1xx")),1),n[10]||(n[10]=s()),r("dd",null,i(a(t)("common.formats.integer",{value:l})),1)]))),128)),n[15]||(n[15]=s()),r("div",et,[r("dt",null,i(a(t)("data-planes.components.service_traffic_card.2xx")),1),n[11]||(n[11]=s()),r("dd",null,i(a(t)("common.formats.integer",{value:e.traffic.http?.[`${e.direction}_rq_2xx`]})),1)]),n[16]||(n[16]=s()),(d(!0),c(g,null,S([e.traffic.http?.[`${e.direction}_rq_3xx`]??0].filter(l=>l!==0),l=>(d(),c("div",{key:l,"data-testid":"rq-3xx"},[r("dt",null,i(a(t)("data-planes.components.service_traffic_card.3xx")),1),n[12]||(n[12]=s()),r("dd",null,i(a(t)("common.formats.integer",{value:l})),1)]))),128)),n[17]||(n[17]=s()),r("div",nt,[r("dt",null,i(a(t)("data-planes.components.service_traffic_card.4xx")),1),n[13]||(n[13]=s()),r("dd",null,i(a(t)("common.formats.integer",{value:e.traffic.http?.[`${e.direction}_rq_4xx`]})),1)]),n[18]||(n[18]=s()),r("div",ot,[r("dt",null,i(a(t)("data-planes.components.service_traffic_card.5xx")),1),n[14]||(n[14]=s()),r("dd",null,i(a(t)("common.formats.integer",{value:e.traffic.http?.[`${e.direction}_rq_5xx`]})),1)])],64)):(d(),c(g,{key:3},[r("div",rt,[r("dt",null,i(a(t)("data-planes.components.service_traffic_card.cx")),1),n[19]||(n[19]=s()),r("dd",null,i(a(t)("common.formats.integer",{value:e.traffic.tcp?.[`${e.direction}_cx_total`]})),1)]),n[22]||(n[22]=s()),typeof e.traffic.tcp?.[`${e.direction}_cx_tx_bytes_total`]<"u"?(d(),c("div",st,[r("dt",null,i(a(t)("data-planes.components.service_traffic_card.rx")),1),n[20]||(n[20]=s()),r("dd",null,i(a(C)(e.traffic.tcp?.[`${e.direction}_cx_tx_bytes_total`])),1)])):B("",!0),n[23]||(n[23]=s()),typeof e.traffic.tcp?.[`${e.direction}_cx_rx_bytes_total`]<"u"?(d(),c("div",it,[r("dt",null,i(a(t)("data-planes.components.service_traffic_card.tx")),1),n[21]||(n[21]=s()),r("dd",null,i(a(C)(e.traffic.tcp?.[`${e.direction}_cx_rx_bytes_total`])),1)])):B("",!0)],64))])):(d(),x(u,{key:2,variant:"line"}))]),_:3})}}}),mt=T(at,[["__scopeId","data-v-a3f939b9"]]),dt={class:"body"},lt=M({__name:"ConnectionGroup",props:{type:{}},setup(o){const t=o;return(e,f)=>{const m=N("XCard");return d(),x(m,{class:X(["service-traffic-group",`type-${t.type}`])},{default:y(()=>[r("div",dt,[v(e.$slots,"default",{},void 0,!0)])]),_:3},8,["class"])}}}),gt=T(lt,[["__scopeId","data-v-25c74403"]]),ct={class:"service-traffic"},ft={class:"actions"},ut=M({__name:"ConnectionTraffic",setup(o){return(t,e)=>(d(),c("div",ct,[r("div",ft,[v(t.$slots,"actions",{},void 0,!0)]),e[0]||(e[0]=s()),G(I,{class:"header"},{title:y(()=>[v(t.$slots,"title",{},void 0,!0)]),_:3}),e[1]||(e[1]=s()),v(t.$slots,"default",{},void 0,!0)]))}}),vt=T(ut,[["__scopeId","data-v-e6bd176c"]]);export{vt as C,gt as a,mt as b};
