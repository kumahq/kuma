import{J as w,cL as D,cH as l,cM as L,o as E,f as k,d as R,b as C,n as M,cN as N,K as i}from"./index.5371ce6a.js";import{D as T}from"./DataOverview.507aa4c7.js";import{_ as $}from"./ServiceDetails.vue_vue_type_script_setup_true_lang.e0c0b6f1.js";const B={class:"component-frame"},q=w({__name:"ServiceList",props:{type:{type:String,required:!0},tabHeaders:{type:Array,required:!0}},setup(_){const o=_,h=D(),b={ServiceInsight:"internal services",ExternalService:"external services"},u=l(!0),n=l(null),f=l(null),s=l(null),x={title:"No Data",message:`There are no ${b[o.type]} present.`},c=l({headers:o.tabHeaders,data:[]}),g=50;L(()=>h.params.mesh,function(){m(0)}),m(0);function y(e){return o.type==="ServiceInsight"?i.getAllServiceInsights(e):i.getAllExternalServices(e)}function A(e){return o.type==="ServiceInsight"?i.getAllServiceInsightsFromMesh({mesh:e}):i.getAllExternalServicesFromMesh({mesh:e})}function I(e){const a=e,v={name:e.type==="ServiceInsight"?"service-insight-detail-view":"external-service-detail-view",params:{mesh:e.mesh,service:e.name}};a.nameRoute=v;const t={name:"mesh-child",params:{mesh:e.mesh}};if(a.meshRoute=t,e.type==="ServiceInsight"){const{online:d=0,total:r=0}=e.dataplanes;a.totalOnline=`${d} / ${r}`,a.status=N[e.status].title}else a.address=e.networking.address,a.tlsEnabled=e.networking.tls.enabled?"Enabled":"Disabled";return a}async function m(e){u.value=!0,n.value=null;const a=h.params.mesh||null,v=()=>a==="all"||a===null?y({size:g,offset:e}):A(a);try{const{items:t,next:d}=await v();f.value=d,t.sort((r,p)=>r.name>p.name?1:r.name<p.name?-1:r.mesh.localeCompare(p.mesh)),t.length>0?(S(t[0]),c.value.data=t.map(r=>I(r))):(s.value=null,c.value.data=[])}catch(t){s.value=null,t instanceof Error?n.value=t:console.error(n)}finally{u.value=!1}}function S(e){s.value=e}return(e,a)=>(E(),k("div",B,[R(T,{"page-size":g,error:n.value,"has-error":n.value!==null,"is-loading":u.value,"empty-state":x,"table-data":c.value,"table-data-is-empty":c.value.data.length===0,next:f.value,onTableAction:S,onLoadData:m},null,8,["error","has-error","is-loading","table-data","table-data-is-empty","next"]),s.value!==null?(E(),C($,{key:0,type:s.value.type,name:s.value.name,mesh:s.value.mesh},null,8,["type","name","mesh"])):M("",!0)]))}});export{q as _};
