import{d as M,r as s,p as u,o,w as e,b as a,c as l,e as r,q as f,N as d,L as p,m as k,O as m,t as c,l as i,F as z,Y as G}from"./index-GFWvH1vH.js";import{A as H,a as J}from"./AccordionList-Cv11EaJI.js";import{P as Q}from"./PolicyTypeTag-C28z_SLd.js";import{T}from"./TagList-CQ7OYedf.js";import{C as U,K as W}from"./kri-D19gROKk.js";const Z={key:0,class:"stack-with-borders"},D={class:"stack-with-borders"},h={class:"mt-2"},lt=M({__name:"DataPlaneInboundSummaryOverviewView",props:{data:{},dataPlaneOverview:{},routeName:{}},setup(S){const g=S;return(tt,t)=>{const $=s("XBadge"),x=s("XCopyButton"),O=s("XAction"),K=s("XCodeBlock"),R=s("XCard"),F=s("DataLoader"),N=s("DataSource"),X=s("XLayout"),I=s("AppView"),Y=s("RouteView");return o(),u(Y,{params:{mesh:"",proxy:"",connection:""},name:g.routeName},{default:e(({t:j,route:v,uri:A})=>[a(I,null,{default:e(()=>[a(X,{type:"stack"},{default:e(()=>[(o(!0),l(d,null,p([g.dataPlaneOverview.dataplane.networking.inbounds.find(n=>n.portName===k(U).fromString(v.params.connection).sectionName&&n.port===g.data.port)],n=>(o(),l(d,{key:typeof n},[n?(o(),l("div",Z,[a(m,{layout:"horizontal"},{title:e(()=>t[0]||(t[0]=[r(`
                Tags
              `,-1)])),body:e(()=>[a(T,{tags:n.tags,alignment:"right"},null,8,["tags"])]),_:2,__:[1]},1024),t[10]||(t[10]=r()),a(m,{layout:"horizontal"},{title:e(()=>t[2]||(t[2]=[r(`
                Protocol
              `,-1)])),body:e(()=>[a($,{appearance:"info"},{default:e(()=>[r(c(j(`http.api.value.${n.protocol}`)),1)]),_:2},1024)]),_:2,__:[3]},1024),t[11]||(t[11]=r()),a(m,{layout:"horizontal"},{title:e(()=>t[4]||(t[4]=[r(`
                Address
              `,-1)])),body:e(()=>[a(x,{text:`${n.addressPort}`},null,8,["text"])]),_:2,__:[5]},1024),t[12]||(t[12]=r()),n.serviceAddressPort.length>0?(o(),u(m,{key:0,layout:"horizontal"},{title:e(()=>t[6]||(t[6]=[r(`
                Service address
              `,-1)])),body:e(()=>[a(x,{text:`${n.serviceAddressPort}`},null,8,["text"])]),_:2,__:[7]},1024)):f("",!0),t[13]||(t[13]=r()),n.portName.length>0?(o(),u(m,{key:1,layout:"horizontal"},{title:e(()=>t[8]||(t[8]=[r(`
                Name
              `,-1)])),body:e(()=>[a(x,{text:`${n.portName}`},null,8,["text"])]),_:2,__:[9]},1024)):f("",!0)])):f("",!0)],64))),128)),t[22]||(t[22]=r()),g.data?(o(),u(X,{key:0,type:"stack",size:"small"},{default:e(()=>[t[20]||(t[20]=i("h3",null,"Rules",-1)),t[21]||(t[21]=r()),a(N,{src:A(k(z),"/policy-types",{})},{default:e(({data:n,error:q})=>[a(N,{src:A(k(z),"/meshes/:mesh/dataplanes/:name/policies/for/inbound/:kri",{mesh:v.params.mesh,name:v.params.proxy,kri:v.params.connection})},{default:e(({data:w,error:E})=>[a(F,{data:[n,w],errors:[q,E]},{default:e(()=>[(o(!0),l(d,null,p([Object.groupBy((n==null?void 0:n.policyTypes)??[],({name:y})=>y)],y=>(o(),u(H,{key:`${typeof y}`,"initially-open":0,"multiple-open":"",class:"stack","data-testid":"inbound-policies-rules"},{default:e(()=>[(o(!0),l(d,null,p((w==null?void 0:w.policies)||[],({rules:B,kind:_,origins:P})=>(o(),u(R,{key:_},{default:e(()=>[a(J,null,{"accordion-header":e(()=>[a(Q,{"policy-type":_},{default:e(()=>[r(c(_)+" ("+c(B.length)+`)
                            `,1)]),_:2},1032,["policy-type"])]),"accordion-content":e(()=>[i("div",D,[(o(!0),l(d,null,p(B,L=>(o(),l(d,{key:L},[P.length>0?(o(),u(m,{key:0,layout:"horizontal"},{title:e(()=>t[14]||(t[14]=[r(`
                                    Origin policies
                                  `,-1)])),body:e(()=>[i("ul",null,[(o(!0),l(d,null,p(P,C=>(o(),l("li",{key:C.kri},[(o(!0),l(d,null,p([k(W).fromString(C.kri)],({mesh:V,name:b})=>(o(),l(d,{key:`${V}-${b}`},[y[_]?(o(),u(O,{key:0,to:{name:"policy-detail-view",params:{mesh:V,policyPath:y[_][0].path,policy:b}}},{default:e(()=>[r(c(C.kri),1)]),_:2},1032,["to"])):(o(),l(d,{key:1},[r(c(C.kri),1)],64))],64))),128))]))),128))])]),_:2,__:[15]},1024)):f("",!0),t[18]||(t[18]=r()),i("div",null,[t[16]||(t[16]=i("dt",null,`
                                    Config
                                  `,-1)),t[17]||(t[17]=r()),i("dd",h,[i("div",null,[a(K,{code:k(G).stringify(L.conf),language:"yaml","show-copy-button":!1},null,8,["code"])])])])],64))),128))])]),_:2,__:[19]},1024)]),_:2},1024))),128))]),_:2},1024))),128))]),_:2},1032,["data","errors"])]),_:2},1032,["src"])]),_:2},1032,["src"])]),_:2,__:[20,21]},1024)):f("",!0)]),_:2,__:[22]},1024)]),_:2},1024)]),_:1},8,["name"])}}});export{lt as default};
