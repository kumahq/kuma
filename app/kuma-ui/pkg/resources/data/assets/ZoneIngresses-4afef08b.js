import{d as R,l as U,m as G,i as H,r as o,n as K,p as W,s as X,t as Y,o as l,c as f,u as I,k as d,w as t,a as u,E as j,e as z,x as N,P as O,g,y as b,F as q,z as B,A as J,B as ee}from"./index-e096fb01.js";import{_ as ae}from"./MultizoneInfo.vue_vue_type_script_setup_true_lang-7e372d7d.js";import{D as te}from"./DataOverview-8ec2eb8a.js";import{E as w}from"./EnvoyData-e00d5aaf.js";import{F as se}from"./FrameSkeleton-f310b9e4.js";import{_ as ne}from"./LabelList.vue_vue_type_style_index_0_lang-4dec2f30.js";import{_ as re,S as oe}from"./SubscriptionHeader.vue_vue_type_script_setup_true_lang-bf69e6e6.js";import{T as le}from"./TabsWidget-760376e0.js";import{Q as C}from"./QueryParameter-70743f73.js";import"./EmptyBlock.vue_vue_type_script_setup_true_lang-467e5ff3.js";import"./ErrorBlock-e347ad5a.js";import"./LoadingBlock.vue_vue_type_script_setup_true_lang-7adf9901.js";import"./TagList-91f2b0bd.js";import"./StatusBadge-79f7109b.js";import"./CodeBlock.vue_vue_type_style_index_0_lang-25903ab0.js";const ie={class:"zoneingresses"},ue={class:"entity-heading"},ke=R({__name:"ZoneIngresses",props:{selectedZoneIngressName:{type:String,required:!1,default:null},offset:{type:Number,required:!1,default:0}},setup(F){const p=F,S=U(),L={title:"No Data",message:"There are no Zone Ingresses present."},V=[{hash:"#overview",title:"Overview"},{hash:"#insights",title:"Zone Ingress Insights"},{hash:"#xds-configuration",title:"XDS Configuration"},{hash:"#envoy-stats",title:"Stats"},{hash:"#envoy-clusters",title:"Clusters"}],y=G(),k=H(),m=o(!0),c=o(!1),v=o(null),h=o({headers:[{label:"Status",key:"status"},{label:"Name",key:"name"}],data:[]}),i=o(null),x=o([]),E=o(null),A=o([]),D=o(p.offset);K(()=>y.params.mesh,function(){y.name==="zoneingresses"&&(m.value=!0,c.value=!1,v.value=null,_(0))}),W(function(){M(p.offset)});function M(a){k.getters["config/getMulticlusterStatus"]&&_(a)}async function _(a){D.value=a,C.set("offset",a>0?a:null),m.value=!0,c.value=!1;const s=y.query.ns||null,r=O;try{const{data:e,next:n}=await P(s,r,a);E.value=n,e.length?(c.value=!1,x.value=e,T({name:p.selectedZoneIngressName??e[0].name}),h.value.data=e.map(Z=>{const{zoneIngressInsight:$={}}=Z,Q=X($);return{...Z,status:Q}})):(h.value.data=[],c.value=!0)}catch(e){e instanceof Error?v.value=e:console.error(e),c.value=!0}finally{m.value=!1}}function T({name:a}){var e;const s=x.value.find(n=>n.name===a),r=((e=s==null?void 0:s.zoneIngressInsight)==null?void 0:e.subscriptions)??[];A.value=Array.from(r).reverse(),i.value=Y(s,["type","name"]),C.set("zoneIngress",a)}async function P(a,s,r){if(a)return{data:[await S.getZoneIngressOverview({name:a},{size:s,offset:r})],next:null};{const{items:e,next:n}=await S.getAllZoneIngressOverviews({size:s,offset:r});return{data:e??[],next:n}}}return(a,s)=>(l(),f("div",ie,[I(k).getters["config/getMulticlusterStatus"]===!1?(l(),d(ae,{key:0})):(l(),d(se,{key:1},{default:t(()=>{var r;return[u(te,{"selected-entity-name":(r=i.value)==null?void 0:r.name,"page-size":I(O),"is-loading":m.value,error:v.value,"empty-state":L,"table-data":h.value,"table-data-is-empty":c.value,next:E.value,"page-offset":D.value,onTableAction:T,onLoadData:_},{additionalControls:t(()=>[a.$route.query.ns?(l(),d(I(j),{key:0,class:"back-button",appearance:"primary",icon:"arrowLeft",to:{name:"zoneingresses"}},{default:t(()=>[z(`
            View all
          `)]),_:1})):N("",!0)]),_:1},8,["selected-entity-name","page-size","is-loading","error","table-data","table-data-is-empty","next","page-offset"]),z(),c.value===!1&&i.value!==null?(l(),d(le,{key:0,"has-error":v.value!==null,"is-loading":m.value,tabs:V},{tabHeader:t(()=>[g("h1",ue,`
            Zone Ingress: `+b(i.value.name),1)]),overview:t(()=>[u(ne,null,{default:t(()=>[g("div",null,[g("ul",null,[(l(!0),f(q,null,B(i.value,(e,n)=>(l(),f("li",{key:n},[g("h4",null,b(n),1),z(),g("p",null,b(e),1)]))),128))])])]),_:1})]),insights:t(()=>[u(ee,{"initially-open":0},{default:t(()=>[(l(!0),f(q,null,B(A.value,(e,n)=>(l(),d(J,{key:n},{"accordion-header":t(()=>[u(re,{details:e},null,8,["details"])]),"accordion-content":t(()=>[u(oe,{details:e,"is-discovery-subscription":""},null,8,["details"])]),_:2},1024))),128))]),_:1})]),"xds-configuration":t(()=>[u(w,{"data-path":"xds","zone-ingress-name":i.value.name,"query-key":"envoy-data-zone-ingress"},null,8,["zone-ingress-name"])]),"envoy-stats":t(()=>[u(w,{"data-path":"stats","zone-ingress-name":i.value.name,"query-key":"envoy-data-zone-ingress"},null,8,["zone-ingress-name"])]),"envoy-clusters":t(()=>[u(w,{"data-path":"clusters","zone-ingress-name":i.value.name,"query-key":"envoy-data-zone-ingress"},null,8,["zone-ingress-name"])]),_:1},8,["has-error","is-loading"])):N("",!0)]}),_:1}))]))}});export{ke as default};
