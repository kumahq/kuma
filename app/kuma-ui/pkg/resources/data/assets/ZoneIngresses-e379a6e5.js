import{u as R}from"./vue-router-573afc44.js";import{P as U,D as G}from"./kongponents.es-3df60cd6.js";import{g as H}from"./dataplane-4aecf58f.js";import{a as W}from"./helpers-32595d9f.js";import{k as Z}from"./kumaApi-db784568.js";import{b as N}from"./constants-31fdaf55.js";import{Q as O}from"./QueryParameter-70743f73.js";import{u as X}from"./store-866e3b85.js";import{a as Y,A as j}from"./AccordionItem-5cf952b5.js";import{D as J}from"./DataOverview-07eb4ec1.js";import{E as I}from"./EnvoyData-f5c11e02.js";import{F as K}from"./FrameSkeleton-256a9a83.js";import{_ as ee}from"./LabelList.vue_vue_type_style_index_0_lang-4346c84c.js";import{_ as te}from"./MultizoneInfo.vue_vue_type_script_setup_true_lang-f8d86b15.js";import{_ as ae,S as se}from"./SubscriptionHeader.vue_vue_type_script_setup_true_lang-bf23b0a3.js";import{T as ne}from"./TabsWidget-aec0fabd.js";import{d as re,r as o,y as oe,_ as ie,h as v,u as g,a as d,w as a,o as i,e as l,f as z,b as q,g as f,t as w,F as B,v as L}from"./runtime-dom.esm-bundler-91b41870.js";import"./vuex.esm-bundler-df5bd11e.js";import"./ClientStorage-efe299d9.js";import"./_plugin-vue_export-helper-c27b6911.js";import"./datadogLogEvents-4578cfa7.js";import"./EmptyBlock.vue_vue_type_script_setup_true_lang-4047971f.js";import"./ErrorBlock-46fedade.js";import"./LoadingBlock.vue_vue_type_script_setup_true_lang-d3176fee.js";import"./StatusBadge-81464ebd.js";import"./TagList-91d1133a.js";import"./CodeBlock.vue_vue_type_style_index_0_lang-98064716.js";import"./_commonjsHelpers-87174ba5.js";import"./index-f6b877ca.js";const le={class:"zoneingresses"},ue={class:"entity-heading"},Pe=re({__name:"ZoneIngresses",props:{selectedZoneIngressName:{type:String,required:!1,default:null},offset:{type:Number,required:!1,default:0}},setup(C){const y=C,F={title:"No Data",message:"There are no Zone Ingresses present."},P=[{hash:"#overview",title:"Overview"},{hash:"#insights",title:"Zone Ingress Insights"},{hash:"#xds-configuration",title:"XDS Configuration"},{hash:"#envoy-stats",title:"Stats"},{hash:"#envoy-clusters",title:"Clusters"}],h=R(),k=X(),c=o(!0),m=o(!1),p=o(null),_=o({headers:[{label:"Actions",key:"actions",hideLabel:!0},{label:"Status",key:"status"},{label:"Name",key:"name"}],data:[]}),u=o(null),S=o([]),D=o(null),x=o([]),A=o(y.offset);oe(()=>h.params.mesh,function(){h.name==="zoneingresses"&&(c.value=!0,m.value=!1,p.value=null,b(0))}),ie(function(){V(y.offset)});function V(t){k.getters["config/getMulticlusterStatus"]&&b(t)}async function b(t){A.value=t,O.set("offset",t>0?t:null),c.value=!0,m.value=!1;const s=h.query.ns||null,r=N;try{const{data:e,next:n}=await M(s,r,t);D.value=n,e.length?(m.value=!1,S.value=e,E({name:y.selectedZoneIngressName??e[0].name}),_.value.data=e.map(T=>{const{zoneIngressInsight:$={}}=T,Q=H($);return{...T,status:Q}})):(_.value.data=[],m.value=!0)}catch(e){e instanceof Error?p.value=e:console.error(e),m.value=!0}finally{c.value=!1}}function E({name:t}){var e;const s=S.value.find(n=>n.name===t),r=((e=s==null?void 0:s.zoneIngressInsight)==null?void 0:e.subscriptions)??[];x.value=Array.from(r).reverse(),u.value=W(s,["type","name"]),O.set("zoneIngress",t)}async function M(t,s,r){if(t)return{data:[await Z.getZoneIngressOverview({name:t},{size:s,offset:r})],next:null};{const{items:e,next:n}=await Z.getAllZoneIngressOverviews({size:s,offset:r});return{data:e??[],next:n}}}return(t,s)=>(i(),v("div",le,[g(k).getters["config/getMulticlusterStatus"]===!1?(i(),d(te,{key:0})):(i(),d(K,{key:1},{default:a(()=>{var r;return[l(J,{"selected-entity-name":(r=u.value)==null?void 0:r.name,"page-size":g(N),"is-loading":c.value,error:p.value,"empty-state":F,"table-data":_.value,"table-data-is-empty":m.value,next:D.value,"page-offset":A.value,onTableAction:E,onLoadData:b},{additionalControls:a(()=>[t.$route.query.ns?(i(),d(g(U),{key:0,class:"back-button",appearance:"primary",icon:"arrowLeft",to:{name:"zoneingresses"}},{default:a(()=>[z(`
            View all
          `)]),_:1})):q("",!0)]),_:1},8,["selected-entity-name","page-size","is-loading","error","table-data","table-data-is-empty","next","page-offset"]),z(),m.value===!1&&u.value!==null?(i(),d(ne,{key:0,"has-error":p.value!==null,"is-loading":c.value,tabs:P},{tabHeader:a(()=>[f("h1",ue,`
            Zone Ingress: `+w(u.value.name),1)]),overview:a(()=>[l(ee,null,{default:a(()=>[f("div",null,[f("ul",null,[(i(!0),v(B,null,L(u.value,(e,n)=>(i(),v("li",{key:n},[f("h4",null,w(n),1),z(),f("p",null,w(e),1)]))),128))])])]),_:1})]),insights:a(()=>[l(g(G),{"border-variant":"noBorder"},{body:a(()=>[l(Y,{"initially-open":0},{default:a(()=>[(i(!0),v(B,null,L(x.value,(e,n)=>(i(),d(j,{key:n},{"accordion-header":a(()=>[l(ae,{details:e},null,8,["details"])]),"accordion-content":a(()=>[l(se,{details:e,"is-discovery-subscription":""},null,8,["details"])]),_:2},1024))),128))]),_:1})]),_:1})]),"xds-configuration":a(()=>[l(I,{"data-path":"xds","zone-ingress-name":u.value.name,"query-key":"envoy-data-zone-ingress"},null,8,["zone-ingress-name"])]),"envoy-stats":a(()=>[l(I,{"data-path":"stats","zone-ingress-name":u.value.name,"query-key":"envoy-data-zone-ingress"},null,8,["zone-ingress-name"])]),"envoy-clusters":a(()=>[l(I,{"data-path":"clusters","zone-ingress-name":u.value.name,"query-key":"envoy-data-zone-ingress"},null,8,["zone-ingress-name"])]),_:1},8,["has-error","is-loading"])):q("",!0)]}),_:1}))]))}});export{Pe as default};
