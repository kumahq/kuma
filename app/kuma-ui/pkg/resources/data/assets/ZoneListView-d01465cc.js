import{d as A,R as K,t as C,r as q,o as a,g as r,w as e,h as l,A as O,ae as U,m as w,C as F,l as n,p as G,i as s,a2 as J,E as M,a3 as P,D as m,X,j as x,F as V,ac as j,$ as H,K as Z,a4 as W,Z as N,H as Q,a5 as Y,a6 as E,k as R,_ as ee,aE as te,q as oe}from"./index-2c980e5c.js";import{_ as ne}from"./MultizoneInfo.vue_vue_type_script_setup_true_lang-db514388.js";import{_ as ae}from"./DeleteResourceModal.vue_vue_type_script_setup_true_lang-49b5a93e.js";const se=A({__name:"ZoneListView",props:{page:{type:Number,required:!0},size:{type:Number,required:!0}},setup($){const d=$,L=K(),k=C(!1),h=C(!1),_=C("");function B(p){return p.map(f=>{var o;const{name:y}=f,b={name:"zone-cp-detail-view",params:{zone:y}};let t="",i="kubernetes",u=!0;(((o=f.zoneInsight)==null?void 0:o.subscriptions)??[]).forEach(c=>{if(c.version&&c.version.kumaCp){t=c.version.kumaCp.version;const{kumaCpGlobalCompatible:T=!0}=c.version.kumaCp;u=T}c.config&&(i=JSON.parse(c.config).environment)});const g=te(f);return{detailViewRoute:b,name:y,status:g,zoneCpVersion:t,type:i,warnings:!u}})}async function D(){await L.deleteZone({name:_.value})}function v(){k.value=!k.value}function I(p){v(),_.value=p}function S(p){h.value=(p==null?void 0:p.items.length)>0}return(p,f)=>{const y=q("RouterLink");return a(),r(ee,{name:"zone-cp-list-view"},{default:e(({route:b,t,can:i})=>[l(O,null,U({title:e(()=>[w("h1",null,[l(F,{title:t("zone-cps.routes.items.title"),render:!0},null,8,["title"])])]),default:e(()=>[n(),n(),i("use zones")?(a(),r(G,{key:1,src:`/zone-cps?size=${d.size}&page=${d.page}`,onChange:S},{default:e(({data:u,error:z,refresh:g})=>[l(s(J),null,{body:e(()=>[z!==void 0?(a(),r(M,{key:0,error:z},null,8,["error"])):(a(),r(P,{key:1,class:"zone-cp-collection","data-testid":"zone-cp-collection",headers:[{label:"Name",key:"name"},{label:"Zone CP Version",key:"zoneCpVersion"},{label:"Type",key:"type"},{label:"Status",key:"status"},{label:"Warnings",key:"warnings",hideLabel:!0},{label:"Actions",key:"actions",hideLabel:!0}],"page-number":d.page,"page-size":d.size,total:u==null?void 0:u.total,items:u?B(u.items):void 0,error:z,"empty-state-title":i("create zones")?t("zone-cps.empty_state.title"):void 0,"empty-state-message":i("create zones")?t("zone-cps.empty_state.message"):void 0,"empty-state-cta-to":i("create zones")?{name:"zone-create-view"}:void 0,"empty-state-cta-text":i("create zones")?t("zones.index.create"):void 0,onChange:b.update},{name:e(({row:o,rowValue:c})=>[l(y,{to:o.detailViewRoute,"data-testid":"detail-view-link"},{default:e(()=>[n(m(c),1)]),_:2},1032,["to"])]),zoneCpVersion:e(({rowValue:o})=>[n(m(o||t("common.collection.none")),1)]),type:e(({rowValue:o})=>[n(m(o||t("common.collection.none")),1)]),status:e(({rowValue:o})=>[o?(a(),r(X,{key:0,status:o},null,8,["status"])):(a(),x(V,{key:1},[n(m(t("common.collection.none")),1)],64))]),warnings:e(({rowValue:o})=>[o?(a(),r(s(j),{key:0,label:t("zone-cps.list.version_mismatch")},{default:e(()=>[l(H,{class:"mr-1",size:s(Z),"hide-title":""},null,8,["size"])]),_:2},1032,["label"])):(a(),x(V,{key:1},[n(m(t("common.collection.none")),1)],64))]),actions:e(({row:o})=>[l(s(W),{class:"actions-dropdown","data-testid":"actions-dropdown","kpop-attributes":{placement:"bottomEnd",popoverClasses:"mt-5 more-actions-popover"},width:"150"},{default:e(()=>[l(s(N),{class:"non-visual-button",appearance:"secondary",size:"small"},{icon:e(()=>[l(s(Q),{color:s(Y),icon:"more",size:s(Z)},null,8,["color","size"])]),_:1})]),items:e(()=>[l(s(E),{item:{to:o.detailViewRoute,label:t("common.collection.actions.view")}},null,8,["item"]),n(),i("create zones")?(a(),r(s(E),{key:0,"has-divider":"","is-dangerous":"","data-testid":"dropdown-delete-item",onClick:c=>I(o.name)},{default:e(()=>[n(m(t("common.collection.actions.delete")),1)]),_:2},1032,["onClick"])):R("",!0)]),_:2},1024)]),_:2},1032,["page-number","page-size","total","items","error","empty-state-title","empty-state-message","empty-state-cta-to","empty-state-cta-text","onChange"]))]),_:2},1024),n(),k.value?(a(),r(ae,{key:0,"confirmation-text":_.value,"delete-function":D,"is-visible":"","action-button-text":t("common.delete_modal.proceed_button"),title:t("common.delete_modal.title",{type:"Zone"}),"data-testid":"delete-zone-modal",onCancel:v,onDelete:()=>{v(),g()}},{"body-content":e(()=>[w("p",null,m(t("common.delete_modal.text1",{type:"Zone",name:_.value})),1),n(),w("p",null,m(t("common.delete_modal.text2")),1)]),_:2},1032,["confirmation-text","action-button-text","title","onDelete"])):R("",!0)]),_:2},1032,["src"])):(a(),r(ne,{key:0}))]),_:2},[i("create zones")&&h.value?{name:"actions",fn:e(()=>[l(s(N),{appearance:"primary",icon:"plus",to:{name:"zone-create-view"},"data-testid":"create-zone-link"},{default:e(()=>[n(m(t("zones.index.create")),1)]),_:2},1024)]),key:"0"}:void 0]),1024)]),_:1})}}});const re=oe(se,[["__scopeId","data-v-a587f115"]]);export{re as default};
