import{d as E,ah as F,r as m,x as $,p as r,o as c,w as e,b as l,l as d,e as o,z as G,q as h,t as i,c as g,I as M,m as C,F as K,K as Z,N as b,y as j,_ as H}from"./index-DIsQPtUy.js";const J={class:"stack"},O={class:"visually-hidden"},Q={key:0},U=E({__name:"PolicyListView",props:{policyTypes:{}},setup(X){const V=X,P=F();return(W,s)=>{const k=m("XEmptyState"),_=m("XBadge"),f=m("XAction"),z=m("XI18n"),v=m("XCard"),D=m("XSearch"),x=m("XIcon"),w=m("DataCollection"),T=m("XDrawer"),A=m("RouterView"),N=m("DataLoader"),B=m("AppView"),I=m("RouteView"),L=$("icon-start");return c(),r(I,{name:"policy-list-view",params:{page:1,size:Number,mesh:"",policyPath:"",policy:"",s:""}},{default:e(({route:n,t:p,can:R,uri:S,me:u})=>[l(w,{predicate:t=>typeof t<"u"&&t.path===n.params.policyPath,items:V.policyTypes??[]},{empty:e(()=>[l(k,null,{default:e(()=>[o(i(p("policies.routes.items.empty")),1)]),_:2},1024)]),item:e(({item:t})=>[l(B,null,{default:e(()=>[d("div",J,[l(v,null,{default:e(()=>[d("header",null,[d("div",null,[t.policy.hasFromTargetRef?(c(),r(_,{key:0,appearance:"neutral"},{default:e(()=>[o(i(p("policies.collection.inbound")),1)]),_:2},1024)):h("",!0),s[1]||(s[1]=o()),t.policy.hasToTargetRef?(c(),r(_,{key:1,appearance:"neutral"},{default:e(()=>[o(i(p("policies.collection.outbound")),1)]),_:2},1024)):h("",!0),s[2]||(s[2]=o()),l(f,{action:"docs",href:p("policies.href.docs",{name:t.name}),"data-testid":"policy-documentation-link"},{default:e(()=>[d("span",O,i(p("common.documentation")),1)]),_:2},1032,["href"])]),s[3]||(s[3]=o()),G((c(),g("h3",null,[o(i(p("policies.collection.title",{name:t.name})),1)])),[[L,{name:t.name,size:"60",default:"policy"}]])]),s[4]||(s[4]=o()),l(z,{path:`policies.type.${t.name}.description`,"default-path":"policies.collection.description"},null,8,["path"])]),_:2},1024),s[17]||(s[17]=o()),l(v,null,{default:e(()=>[d("search",null,[d("form",{onSubmit:s[0]||(s[0]=M(()=>{},["prevent"]))},[l(D,{class:"search-field",keys:["name","namespace",...R("use zones")&&t.policy.isTargetRef?["zone"]:[],"label"],value:n.params.s,onChange:y=>n.update({s:y})},null,8,["keys","value","onChange"])],32)]),s[16]||(s[16]=o()),l(N,{src:S(C(K),"/meshes/:mesh/policy-path/:path",{mesh:n.params.mesh,path:n.params.policyPath},{page:n.params.page,size:n.params.size,search:n.params.s}),variant:"list"},{default:e(({data:y,refresh:q})=>[l(w,{items:y.items,page:n.params.page,"page-size":n.params.size,total:y.total,onChange:n.update},{empty:e(()=>[l(k,null,{title:e(()=>[d("h3",null,i(p("policies.x-empty-state.title")),1)]),action:e(()=>[l(f,{action:"docs",href:p("policies.href.docs",{name:t.name})},{default:e(()=>[o(i(p("common.documentation")),1)]),_:2},1032,["href"])]),default:e(()=>[s[5]||(s[5]=o()),l(z,{path:"policies.x-empty-state.body",params:{type:t.name,suffix:n.params.s.length>0?p("common.matchingsearch"):""}},null,8,["params"]),s[6]||(s[6]=o())]),_:2},1024)]),default:e(()=>[l(Z,{headers:[{...u.get("headers.role"),label:"Role",key:"role",hideLabel:!0},{...u.get("headers.name"),label:"Name",key:"name"},{...u.get("headers.namespace"),label:"Namespace",key:"namespace"},...R("use zones")&&t.policy.isTargetRef?[{...u.get("headers.zone"),label:"Zone",key:"zone"}]:[],...t.policy.isTargetRef?[{...u.get("headers.targetRef"),label:"Target ref",key:"targetRef"}]:[],{...u.get("headers.actions"),label:"Actions",key:"actions",hideLabel:!0}],items:y.items,"is-selected-row":a=>a.id===n.params.policy,onResize:u.set},{role:e(({row:a})=>[["producer","consumer","system","workload-owner"].includes(a.role)?(c(),r(x,{key:0,name:`policy-role-${a.role}`},{default:e(()=>[o(`
                            Role: `+i(a.role),1)]),_:2},1032,["name"])):(c(),g(b,{key:1},[o(`
                            Â 
                        `)],64))]),name:e(({row:a})=>[l(f,{"data-action":"",to:{name:"policy-summary-view",params:{mesh:a.mesh,policyPath:t.path,policy:a.id},query:{page:n.params.page,size:n.params.size,s:n.params.s}}},{default:e(()=>[o(i(a.name),1)]),_:2},1032,["to"])]),namespace:e(({row:a})=>[o(i(a.namespace.length>0?a.namespace:p("common.detail.none")),1)]),targetRef:e(({row:a})=>[typeof a.spec?.targetRef<"u"?(c(),r(_,{key:0,appearance:"neutral"},{default:e(()=>[o(i(a.spec.targetRef.kind),1),a.spec.targetRef.name?(c(),g("span",Q,[s[7]||(s[7]=o(":",-1)),d("b",null,i(a.spec.targetRef.name),1)])):h("",!0)]),_:2},1024)):(c(),r(_,{key:1,appearance:"neutral"},{default:e(()=>[...s[8]||(s[8]=[o(`
                          Mesh
                        `,-1)])]),_:1}))]),zone:e(({row:a})=>[a.zone?(c(),r(f,{key:0,to:{name:"zone-cp-detail-view",params:{zone:a.zone}}},{default:e(()=>[o(i(a.zone),1)]),_:2},1032,["to"])):(c(),g(b,{key:1},[o(i(p("common.detail.none")),1)],64))]),actions:e(({row:a})=>[l(C(P),{item:a,type:t,onChange:q},{default:e(()=>[l(f,{to:{name:"policy-detail-view",params:{mesh:a.mesh,policyPath:t.path,policy:a.id}}},{default:e(()=>[o(i(p("common.collection.actions.view")),1)]),_:2},1032,["to"])]),_:2},1032,["item","type","onChange"])]),_:2},1032,["headers","items","is-selected-row","onResize"])]),_:2},1032,["items","page","page-size","total","onChange"]),s[15]||(s[15]=o()),n.params.policy?(c(),r(A,{key:0},{default:e(({Component:a})=>[l(T,{onClose:Y=>n.replace({name:"policy-list-view",params:{mesh:n.params.mesh,policyPath:n.params.policyPath},query:{page:n.params.page,size:n.params.size,s:n.params.s}})},{default:e(()=>[typeof y<"u"?(c(),r(j(a),{key:0,items:y.items,"policy-type":t},null,8,["items","policy-type"])):h("",!0)]),_:2},1032,["onClose"])]),_:2},1024)):h("",!0)]),_:2},1032,["src"])]),_:2},1024)])]),_:2},1024)]),_:2},1032,["predicate","items"])]),_:1})}}}),ae=H(U,[["__scopeId","data-v-27d859f6"]]);export{ae as default};
