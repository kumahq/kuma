import{d as X,r as n,o as l,p as m,w as s,b as o,e as r,m as B,ar as L,A as N,V as S,t as c,c as g,J as w,K as T,F as q,q as F}from"./index-COAz_lIy.js";import{S as G}from"./SummaryView-Cu1duDPI.js";const Z=X({__name:"MeshServiceListView",setup($){return(E,_)=>{const f=n("RouteTitle"),d=n("XAction"),z=n("XBadge"),y=n("KumaPort"),C=n("KTruncate"),k=n("XActionGroup"),V=n("RouterView"),b=n("DataCollection"),x=n("DataLoader"),A=n("KCard"),P=n("AppView"),R=n("RouteView");return l(),m(R,{name:"mesh-service-list-view",params:{page:1,size:50,mesh:"",service:""}},{default:s(({route:t,t:u,can:D,uri:K,me:i})=>[o(f,{render:!1,title:u("services.routes.mesh-service-list-view.title")},null,8,["title"]),_[7]||(_[7]=r()),o(P,{docs:u("services.mesh-service.href.docs")},{default:s(()=>[o(A,null,{default:s(()=>[o(x,{src:K(B(L),"/meshes/:mesh/mesh-services",{mesh:t.params.mesh},{page:t.params.page,size:t.params.size})},{loadable:s(({data:a})=>[o(b,{type:"services",items:(a==null?void 0:a.items)??[void 0],page:t.params.page,"page-size":t.params.size,total:a==null?void 0:a.total,onChange:t.update},{default:s(()=>[o(N,{"data-testid":"service-collection",headers:[{...i.get("headers.name"),label:"Name",key:"name"},{...i.get("headers.namespace"),label:"Namespace",key:"namespace"},...D("use zones")?[{...i.get("headers.zone"),label:"Zone",key:"zone"}]:[],{...i.get("headers.state"),label:"State",key:"state"},{...i.get("headers.status"),label:"DP proxies (connected / healthy / total)",key:"status"},{...i.get("headers.ports"),label:"Ports",key:"ports"},{...i.get("headers.actions"),label:"Actions",key:"actions",hideLabel:!0}],items:a==null?void 0:a.items,"is-selected-row":e=>e.name===t.params.service,onResize:i.set},{name:s(({row:e})=>[o(S,{text:e.name},{default:s(()=>[o(d,{"data-action":"",to:{name:"mesh-service-summary-view",params:{mesh:e.mesh,service:e.id},query:{page:t.params.page,size:t.params.size}}},{default:s(()=>[r(c(e.name),1)]),_:2},1032,["to"])]),_:2},1032,["text"])]),namespace:s(({row:e})=>[r(c(e.namespace),1)]),zone:s(({row:e})=>[e.zone?(l(),m(d,{key:0,to:{name:"zone-cp-detail-view",params:{zone:e.zone}}},{default:s(()=>[r(c(e.zone),1)]),_:2},1032,["to"])):(l(),g(w,{key:1},[r(c(u("common.detail.none")),1)],64))]),state:s(({row:e})=>[o(z,{appearance:e.spec.state==="Available"?"success":"danger"},{default:s(()=>[r(c(e.spec.state),1)]),_:2},1032,["appearance"])]),status:s(({row:e})=>{var p,h,v;return[r(c((p=e.status.dataplaneProxies)==null?void 0:p.connected)+" / "+c((h=e.status.dataplaneProxies)==null?void 0:h.healthy)+" / "+c((v=e.status.dataplaneProxies)==null?void 0:v.total),1)]}),ports:s(({row:e})=>[o(C,null,{default:s(()=>[(l(!0),g(w,null,T(e.spec.ports,p=>(l(),m(y,{key:p.port,port:{...p,targetPort:void 0}},null,8,["port"]))),128))]),_:2},1024)]),actions:s(({row:e})=>[o(k,null,{default:s(()=>[o(d,{to:{name:"mesh-service-detail-view",params:{mesh:e.mesh,service:e.id}}},{default:s(()=>[r(c(u("common.collection.actions.view")),1)]),_:2},1032,["to"])]),_:2},1024)]),_:2},1032,["headers","items","is-selected-row","onResize"]),_[6]||(_[6]=r()),a!=null&&a.items&&t.params.service?(l(),m(V,{key:0},{default:s(e=>[o(G,{onClose:p=>t.replace({name:"mesh-service-list-view",params:{mesh:t.params.mesh},query:{page:t.params.page,size:t.params.size}})},{default:s(()=>[(l(),m(q(e.Component),{items:a==null?void 0:a.items},null,8,["items"]))]),_:2},1032,["onClose"])]),_:2},1024)):F("",!0)]),_:2},1032,["items","page","page-size","total","onChange"])]),_:2},1032,["src"])]),_:2},1024)]),_:2},1032,["docs"])]),_:1})}}});export{Z as default};
